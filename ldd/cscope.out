cscope 15 $HOME/ldd -q 0000003202 0000468168
	@/home/libin3-s/ldd/cage/acl.h

19 #iâdeà
LDD_CAGE_ACL_H_


20 
	#LDD_CAGE_ACL_H_


	)

22 
	~<¡ršg
>

23 
	~<zook“³r/zook“³r.ju‹.h
>

25 
Çme¥aû
 
	gldd
 {

26 
Çme¥aû
 
	gÿge
 {

28 şas 
	cId
 {

29 
	gpublic
:

30 
Id
() {}

31 
Id
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
id
)

32 : 
scheme_
(
scheme
), 
id_
(
id
) {}

33 
	g¡d
::
¡ršg
& 
scheme
(è{  
scheme_
; }

34 
	g¡d
::
¡ršg
& 
id
(è{  
id_
; }

36 cÚ¡ 
	g¡d
::
¡ršg
& 
scheme
(ècÚ¡ {  
scheme_
; }

37 cÚ¡ 
	g¡d
::
¡ršg
& 
id
(ècÚ¡ {  
id_
; }

39 cÚ¡ 
	gId
& 
Un§ã
();

40 cÚ¡ 
	gId
& 
Authed
();

43 
Id
(cÚ¡ ::Id & 
id
è{ *
this
 = id; }

44 cÚ¡ 
	gId
& 
	gİ”©Ü
 = (cÚ¡ ::
Id
 &
id
);

46 
	gİ”©Ü
 ::
Id
() const;

47 
	g´iv©e
:

48 
¡d
::
¡ršg
 
scheme_
;

49 
	g¡d
::
¡ršg
 
id_
;

52 şas 
	cAş
 {

53 
	gpublic
:

54 
	eP”m
 {

55 
kR—d
 = 1 << 0,

56 
	gkWr™e
 = 1 << 1,

57 
	gkC»©e
 = 1 << 2,

58 
	gkD–‘e
 = 1 << 3,

59 
	gkAdmš
 = 1 << 4,

60 
	gkAÎ
 = 0x1f,

63 
Aş
(): 
³rms_
(0) {}

64 
Aş
(
³rms
, cÚ¡ 
Id
& 
id
): 
³rms_
Õ”ms), 
id_
(id) {}

66 
	gšt32_t
& 
³rms
(è{  
	g³rms_
; }

67 
	gId
& 
id
(è{  
	gid_
; }

69 
št32_t
 
³rms
(ècÚ¡ {  
	g³rms_
; }

70 cÚ¡ 
	gId
& 
id
(ècÚ¡ {  
	gid_
; }

72 cÚ¡ 
	gAş
& 
Un§ãAÎ
();

73 cÚ¡ 
	gAş
& 
Un§ãR—d
();

74 cÚ¡ 
	gAş
& 
C»©ÜAÎ
();

76 
Aş
(cÚ¡ ::
ACL
& 
aş
è{ *
this
 =‡cl; }

77 cÚ¡ 
	gAş
& 
	gİ”©Ü
 = (cÚ¡ ::
ACL
& 
aş
);

78 
	gİ”©Ü
 ::
ACL
() const;

79 
	g´iv©e
:

80 
³rms_
;

81 
Id
 
	gid_
;

	@/home/libin3-s/ldd/cage/cage.h

4 #iâdeà
LDD_CAGE_CAGE_H_


5 
	#LDD_CAGE_CAGE_H_


	)

7 
	~<¡ršg
>

8 
	~<£t
>

9 
	~<ldd/Ãt/ev’t_loİ.h
>

10 
	~<ldd/Ãt/ev’t.h
>

11 
	~"ldd/ÿge/ÿÎback.h
"

12 
	~"ldd/ÿge/mode.h
"

14 
Çme¥aû
 
	gldd
 {

15 
Çme¥aû
 
	gÿge
 {

17 
şass
 
	gR‘ryLoİ
;

18 
şass
 
	gR‘ryPŞicy
;

20 şas 
	cCage
 {

21 
	gpublic
:

22 
şass
 
Im¶
;

23 
Cage
(
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
CageLi¡’”
& 
li¡’”
,

24 
R‘ryPŞicy
* 
pŞicy
 = 
NULL
);

25 ~
Cage
();

27 
boŞ
 
O³n
(cÚ¡ 
¡d
::
¡ršg
& 
de¡
, 
timeout
);

28 
Clo£
();

30 
AddAuth
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
û¹
,

31 cÚ¡ 
AddAuthC®lback
& 
ÿÎback
);

33 
C»©e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

34 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
,

35 cÚ¡ 
C»©eC®lback
& 
ÿÎback
);

37 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
,

38 cÚ¡ 
D–‘eC®lback
& 
ÿÎback
);

40 
Exi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

41 cÚ¡ 
Exi¡sC®lback
& 
ÿÎback
);

43 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

44 cÚ¡ 
G‘C®lback
& 
ÿÎback
);

46 
S‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

47 
št32_t
 
v”siÚ
, cÚ¡ 
S‘C®lback
& 
ÿÎback
);

49 
G‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
G‘AşC®lback
& 
ÿÎback
);

51 
S‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::
veùÜ
<
Aş
>& 
aşs
,

52 
št32_t
 
v”siÚ
, cÚ¡ 
S‘AşC®lback
& 
ÿÎback
);

54 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
ChdW©ch”
& 
w©ch”
,

55 cÚ¡ 
G‘Chd»nC®lback
& 
ÿÎback
);

57 
G‘Chd»nW™hSt
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

58 cÚ¡ 
ChdW©ch”
& 
w©ch”
,

59 cÚ¡ 
G‘Chd»nW™hStC®lback
& 
ÿÎback
);

61 
MuÉi
(cÚ¡ 
¡d
::
veùÜ
<
Op
*>& 
İs
, cÚ¡ 
MuÉiC®lback
& 
ÿÎback
);

63 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ
() const;

65 
	g´iv©e
:

66 
Im¶
* 
im¶_
;

	@/home/libin3-s/ldd/cage/cage_state.h

4 #iâdeà
LDD_CAGE_CAGE_STATE_H_


5 
	#LDD_CAGE_CAGE_STATE_H_


	)

7 
	~<boo¡/İ”©Üs.hµ
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÿge
 {

12 
şass
 
	gCageS‹
 : 
boo¡
::
equ®™y_com·¿bË
<
CageS‹
>,

13 
	gboo¡
::
equ®™y_com·¿bË
<
CageS‹
, > {

14 
	gpublic
:

15 
	eTy³
 {

16 
kCÚÃùed
 = 1,

17 
	gkSu¥’ded
 = 2,

18 
	gkRecÚÃùed
 = 3,

19 
	gkLo¡
 = 4,

21 
CageS‹
(è: 
ty³_
(0) {}

22 
CageS‹
(
Ty³
 
ty³
): 
ty³_
(type) {}

23 
CageS‹
 
CÚÃùed
(è{  CageS‹(
kCÚÃùed
); }

24 
CageS‹
 
Su¥’ded
(è{  CageS‹(
kSu¥’ded
); }

25 
CageS‹
 
RecÚÃùed
(è{  CageS‹(
kRecÚÃùed
); }

26 
CageS‹
 
Lo¡
(è{  CageS‹(
kLo¡
); }

27 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
CageS‹
& 
rhs
ècÚ¡ {  
ty³_
 ==„hs.type_; }

28 
boŞ
 
	gİ”©Ü
==(
¡©e
ècÚ¡ {  
ty³_
 == state; }

29 
ty³
(ècÚ¡ {  
	gty³_
; }

30 cÚ¡ * 
ToSŒšg
() const;

32 
boŞ
 
IsCÚÃùed
(ècÚ¡ {  
	gty³_
 =ğ
kCÚÃùed
; }

33 
boŞ
 
IsSu¥’ded
(ècÚ¡ {  
	gty³_
 =ğ
kSu¥’ded
; }

34 
boŞ
 
IsRecÚÃùed
(ècÚ¡ {  
	gty³_
 =ğ
kRecÚÃùed
; }

35 
boŞ
 
IsLo¡
(ècÚ¡ {  
	gty³_
 =ğ
kLo¡
; }

36 
boŞ
 
IsUnknown
(ècÚ¡ {  
	gty³_
 < 
	gkCÚÃùed
 ||y³_ > 
	gkLo¡
; }

37 
	g´iv©e
:

38 
ty³_
;

	@/home/libin3-s/ldd/cage/callback.h

1 #iâdeà
LDD_CAGE_CALLBACKS_H_


2 
	#LDD_CAGE_CALLBACKS_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<boo¡/funùiÚ.hµ
>

7 
	~"ldd/ÿge/¡©.h
"

8 
	~"ldd/ÿge/¡©us.h
"

9 
	~"ldd/ÿge/»suÉ.h
"

10 
	~"ldd/ÿge/ev’t.h
"

11 
	~"ldd/ÿge/k“³r_¡©e.h
"

12 
	~"ldd/ÿge/ÿge_¡©e.h
"

14 
Çme¥aû
 
	gldd
 {

15 
Çme¥aû
 
	gÿge
 {

17 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tAddAuthResuÉ
&)>

18 
	tAddAuthC®lback
;

19 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tC»©eResuÉ
&)>

20 
	tC»©eC®lback
;

21 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tD–‘eResuÉ
&)>

22 
	tD–‘eC®lback
;

23 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tExi¡sResuÉ
&)>

24 
	tExi¡sC®lback
;

25 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tG‘ResuÉ
&)>

26 
	tG‘C®lback
;

27 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tS‘ResuÉ
&)>

28 
	tS‘C®lback
;

29 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tG‘Chd»nResuÉ
&)>

30 
	tG‘Chd»nC®lback
;

31 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tG‘Chd»nW™hStResuÉ
&)>

32 
	tG‘Chd»nW™hStC®lback
;

33 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tG‘AşResuÉ
&)>

34 
	tG‘AşC®lback
;

35 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tS‘AşResuÉ
&)>

36 
	tS‘AşC®lback
;

37 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tMuÉiResuÉ
&)>

38 
	tMuÉiC®lback
;

40 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tNodeEv’t
&)>

41 
	tNodeW©ch”
;

42 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tChdEv’t
&)>

43 
	tChdW©ch”
;

45 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tK“³rS‹
&)>

46 
	tK“³rLi¡’”
;

47 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tCageS‹
&)>

48 
	tCageLi¡’”
;

	@/home/libin3-s/ldd/cage/event.h

1 #iâdeà
LDD_CAGE_EVENT_H_


2 
	#LDD_CAGE_EVENT_H_


	)

4 
	~<¡ršg
>

5 
	~<zook“³r/zook“³r.h
>

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gÿge
 {

10 şas 
	cNodeEv’t
 {

11 
	gpublic
:

12 
	eTy³
 {

13 
kC»©ed
 = 1,

14 
	gkD–‘ed
 = 2,

15 
	gkChªged
 = 3,

17 
NodeEv’t
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
Ty³
 
ty³
è: 
·th_
Õ©h), 
ty³_
(type) {}

18 
Ty³
 
ty³
(ècÚ¡ {  
	gty³_
; }

19 cÚ¡ 
	g¡d
::
¡ršg
& 
·th
(ècÚ¡ {  
·th_
; }

20 
boŞ
 
IsC»©ed
(ècÚ¡ {  
ty³
(è=ğ
kC»©ed
; }

21 
boŞ
 
IsD–‘ed
(ècÚ¡ {  
ty³
(è=ğ
kD–‘ed
; }

22 
boŞ
 
IsChªged
(ècÚ¡ {  
ty³
(è=ğ
kChªged
; }

23 
	g´iv©e
:

24 
¡d
::
¡ršg
 
·th_
;

25 
Ty³
 
	gty³_
;

28 şas 
	cChdEv’t
 {

29 
	gpublic
:

30 
ChdEv’t
(cÚ¡ 
¡d
::
¡ršg
& 
·th
è: 
·th_
(path) {}

31 cÚ¡ 
¡d
::
¡ršg
& 
·th
(ècÚ¡ {  
·th_
; }

32 
	g´iv©e
:

33 
¡d
::
¡ršg
 
·th_
;

	@/home/libin3-s/ldd/cage/internal/cage_impl.h

4 #iâdeà
LDD_CAGE_INTERNAL_CAGE_IMPL_H_


5 
	#LDD_CAGE_INTERNAL_CAGE_IMPL_H_


	)

7 
	~<¡ršg
>

8 
	~<£t
>

9 
	~<boo¡/šŒusive/li¡.hµ
>

10 
	~<ldd/Ãt/ev’t_loİ.h
>

11 
	~<ldd/Ãt/ev’t.h
>

12 
	~"ldd/ÿge/k“³r.h
"

13 
	~"ldd/ÿge/ÿÎback.h
"

14 
	~"ldd/ÿge/ÿge.h
"

15 
	~"»Œy_loİ.h
"

17 
Çme¥aû
 
	gldd
 {

18 
Çme¥aû
 
	gÿge
 {

20 
şass
 
	gR‘ryPŞicy
;

22 şas 
	cCage
::
Im¶
 {

23 
public
:

24 
Im¶
(
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
CageLi¡’”
& 
li¡’”
,

25 
R‘ryPŞicy
* 
pŞicy
 = 
NULL
);

26 ~
Im¶
();

28 
boŞ
 
O³n
(cÚ¡ 
¡d
::
¡ršg
& 
de¡
, 
timeout
);

29 
Clo£
();

31 
AddAuth
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
û¹
,

32 cÚ¡ 
AddAuthC®lback
& 
ÿÎback
);

34 
C»©e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

35 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
,

36 cÚ¡ 
C»©eC®lback
& 
ÿÎback
);

38 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
,

39 cÚ¡ 
D–‘eC®lback
& 
ÿÎback
);

41 
Exi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

42 cÚ¡ 
Exi¡sC®lback
& 
ÿÎback
);

44 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

45 cÚ¡ 
G‘C®lback
& 
ÿÎback
);

47 
S‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

48 
št32_t
 
v”siÚ
, cÚ¡ 
S‘C®lback
& 
ÿÎback
);

50 
G‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
G‘AşC®lback
& 
ÿÎback
);

52 
S‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::
veùÜ
<
Aş
>& 
aşs
,

53 
št32_t
 
v”siÚ
, cÚ¡ 
S‘AşC®lback
& 
ÿÎback
);

55 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
ChdW©ch”
& 
w©ch”
,

56 cÚ¡ 
G‘Chd»nC®lback
& 
ÿÎback
);

58 
G‘Chd»nW™hSt
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

59 cÚ¡ 
ChdW©ch”
& 
w©ch”
,

60 cÚ¡ 
G‘Chd»nW™hStC®lback
& 
ÿÎback
);

62 
MuÉi
(cÚ¡ 
¡d
::
veùÜ
<
Op
*>& 
İs
, cÚ¡ 
MuÉiC®lback
& 
ÿÎback
);

64 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ
(ècÚ¡ {  
ev’t_loİ_
; }

66 
	g´iv©e
:

67 
Li¡’K“³r
(cÚ¡ 
K“³rS‹
&);

68 
Lo¡
();

69 
Su¥’dTimeout
();

70 
NÙifyLi¡’”
();

71 
ä›nd
 
şass
 
	gR‘ryLoİ
;

72 
	g´iv©e
:

73 
Ãt
::
Ev’tLoİ
* 
ev’t_loİ_
;

74 
CageS‹
 
	g¡©e_
;

75 
K“³r
 
	gk“³r_
;

76 
	gÃt
::
Tim”Ev’t
 
tim”_
;

77 
CageLi¡’”
 
	gli¡’”_
;

78 
	gut
::
TimeDiff
 
timeout_
;

79 
R‘ryPŞicy
* 
	gpŞicy_
;

80 
R‘ryLi¡
 
	g»Œ›s_
;

	@/home/libin3-s/ldd/cage/internal/callback_wrapper.h

1 #iâdeà
LDD_CAGE_INTERNAL_CALLBACK_WRAPPER_H_


2 
	#LDD_CAGE_INTERNAL_CALLBACK_WRAPPER_H_


	)

4 
	~<£t
>

5 
	~<boo¡/funùiÚ.hµ
>

6 
	~<boo¡/fÜ—ch.hµ
>

7 
	~<glog/loggšg.h
>

8 
	~"ldd/ÿge/ÿÎback.h
"

9 
	~"ldd/ÿge/»suÉ.h
"

10 
	~"ldd/ÿge/İ.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÿge
 {

15 şas 
	cC®lbackW¿µ”
 {

16 
	gpublic
:

17 
vœtu®
 ~
C®lbackW¿µ”
() {}

19 
‹m¶©e
 <
şass
 
ResuÉT
>

20 
şass
 
Ba£
;

21 
	g‹m¶©e
 <
şass
 
	gResuÉT
>

22 
şass
 
	gIm¶
;

25 
	g‹m¶©e
 <
şass
 
	gResuÉT
>

26 şas 
	cC®lbackW¿µ”
::
Ba£
 : 
public
 
C®lbackW¿µ”
 {

27 
public
:

28 
Ba£
(cÚ¡ 
boo¡
::
funùiÚ
<(cÚ¡ 
ResuÉT
&)>& 
ÿÎback
)

29 : 
ÿÎback_
(
ÿÎback
) {}

30 
vœtu®
 
ProûssResuÉ
(
ResuÉT
 *
»suÉ
) {

31 
Œy
 {

32 
ÿÎback_
(*
»suÉ
);

33 } 
ÿtch
 (cÚ¡ 
¡d
::
exû±iÚ
 &
e
) {

34 
LOG
(
ERROR
è<< "Caughˆexû±iÚ: " << 
e
.
wh©
();

36 
d–‘e
 
	gthis
;

38 
	g´Ùeùed
:

39 
boo¡
::
funùiÚ
<(cÚ¡ 
ResuÉT
&)> 
ÿÎback_
;

42 
	g‹m¶©e
 <
şass
 
	gResuÉT
>

43 
şass
 
	gC®lbackW¿µ”
::
Im¶
 : 
public
 
C®lbackW¿µ”
::
Ba£
<
ResuÉT
> {

44 
C®lbackW¿µ”
::
	tBa£
<
	tResuÉT
> 
	tBa£T
;

45 
	gpublic
:

46 
Im¶
(cÚ¡ 
boo¡
::
funùiÚ
<(cÚ¡ 
ResuÉT
&)>& 
ÿÎback
)

47 : 
Ba£T
(
ÿÎback
) {}

50 
	g‹m¶©e
 <>

51 
şass
 
	gC®lbackW¿µ”
::
Im¶
<
MuÉiResuÉ
>

52 : 
public
 
C®lbackW¿µ”
::
Ba£
<
MuÉiResuÉ
> {

53 
C®lbackW¿µ”
::
	tBa£
<
	tMuÉiResuÉ
> 
	tBa£T
;

54 
	gpublic
:

55 
Im¶
(
size_t
 
couÁ
,

56 cÚ¡ 
boo¡
::
funùiÚ
<(cÚ¡ 
MuÉiResuÉ
&)>& 
ÿÎback
)

57 : 
Ba£T
(
ÿÎback
è, 
couÁ_
(
couÁ
)

58 , 
z»suÉs_
(
Ãw
 
zoo_İ_»suÉ_t
[
couÁ
]) {}

59 
	gvœtu®
 ~
Im¶
() {

60 
	gd–‘e
 [] 
	gz»suÉs_
;

61 
BOOST_FOREACH
(
Op
::
ResuÉ
* 
»suÉ
, 
»suÉs_
) {

62 
d–‘e
 
	g»suÉ
;

65 
vœtu®
 
ProûssResuÉ
(
MuÉiResuÉ
 *
»suÉ
) {

66 
	gi
 = 0; i < 
	g¡©ic_ÿ¡
<>(
	gcouÁ_
); ++i) {

67 
	grc
 = 
z»suÉs_
[
i
].
”r
;

68 
	g»suÉs_
[
i
]->
Upd©e
(
rc
);

70 
	gBa£T
::
ProûssResuÉ
(
»suÉ
);

73 cÚ¡ 
size_t
 
couÁ
(ècÚ¡ {  
	gcouÁ_
; }

74 
zoo_İ_»suÉ_t
* 
z»suÉs
(ècÚ¡ {  
	gz»suÉs_
; }

75 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*>& 
»suÉs
(è{  
»suÉs_
; }

77 cÚ¡ 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*>& 
»suÉs
(ècÚ¡ {  
»suÉs_
; }

78 
	g´iv©e
:

79 
size_t
 
couÁ_
;

80 
zoo_İ_»suÉ_t
* 
	gz»suÉs_
;

81 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*> 
»suÉs_
;

	@/home/libin3-s/ldd/cage/internal/failure_result.h

4 #iâdeà
LDD_CAGE_INTERNAL_FAILURE_RESULT_H_


5 
	#LDD_CAGE_INTERNAL_FAILURE_RESULT_H_


	)

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gÿge
 {

10 
	g‹m¶©e
 <
şass
 
	gR
>

11 
	gFau»ResuÉ
;

13 
	g‹m¶©e
 <>

14 
	gFau»ResuÉ
<
	gAddAuthResuÉ
> : 
public
 
AddAuthResuÉ
 {

15 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

16 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

17 
	g´iv©e
:

18 
Stus
 
¡©us_
;

21 
	g‹m¶©e
 <>

22 
	gFau»ResuÉ
<
	gC»©eResuÉ
> : 
public
 
C»©eResuÉ
 {

23 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
): 
¡©us_
(status) {}

24 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

25 cÚ¡ 
	g¡d
::
¡ršg
& 
·th_ü—‹d
(ècÚ¡ {  
·th_ü—‹d_
; }

26 
	g´iv©e
:

27 
Stus
 
¡©us_
;

28 
	g¡d
::
¡ršg
 
·th_ü—‹d_
;

31 
	g‹m¶©e
 <>

32 
	gFau»ResuÉ
<
	gD–‘eResuÉ
> : 
public
 
D–‘eResuÉ
 {

33 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

34 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

35 
	g´iv©e
:

36 
Stus
 
¡©us_
;

39 
	g‹m¶©e
 <>

40 
	gFau»ResuÉ
<
	gExi¡sResuÉ
> : 
public
 
Exi¡sResuÉ
 {

41 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

42 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

43 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

44 
	g´iv©e
:

45 
Stus
 
¡©us_
;

46 
St
 
	g¡©_
;

49 
	g‹m¶©e
 <>

50 
	gFau»ResuÉ
<
	gG‘ResuÉ
> : 
public
 
G‘ResuÉ
 {

51 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

52 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

53 cÚ¡ 
	g¡d
::
¡ršg
& 
d©a
(ècÚ¡ {  
d©a_
; }

54 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

55 
	g´iv©e
:

56 
Stus
 
¡©us_
;

57 
	g¡d
::
¡ršg
 
d©a_
;

58 
St
 
	g¡©_
;

61 
	g‹m¶©e
 <>

62 
	gFau»ResuÉ
<
	gS‘ResuÉ
> : 
public
 
S‘ResuÉ
 {

63 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

64 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

65 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

66 
	g´iv©e
:

67 
Stus
 
¡©us_
;

68 
St
 
	g¡©_
;

71 
	g‹m¶©e
 <>

72 
	gFau»ResuÉ
<
	gG‘AşResuÉ
> : 
public
 
G‘AşResuÉ
 {

73 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

74 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

75 cÚ¡ 
	g¡d
::
veùÜ
<
Aş
>& 
aşs
(ècÚ¡ {  
aşs_
; }

76 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

77 
	g´iv©e
:

78 
Stus
 
¡©us_
;

79 
	g¡d
::
veùÜ
<
Aş
> 
aşs_
;

80 
St
 
	g¡©_
;

83 
	g‹m¶©e
 <>

84 
	gFau»ResuÉ
<
	gS‘AşResuÉ
> : 
public
 
S‘AşResuÉ
 {

85 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

86 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

87 
	g´iv©e
:

88 
Stus
 
¡©us_
;

91 
	g‹m¶©e
 <>

92 
	gFau»ResuÉ
<
	gG‘Chd»nResuÉ
> : 
public
 
G‘Chd»nResuÉ
 {

93 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

94 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

95 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>& 
chd»n
(ècÚ¡ {  
chd»n_
; }

96 
	g´iv©e
:

97 
Stus
 
¡©us_
;

98 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
chd»n_
;

101 
	g‹m¶©e
 <>

102 
	gFau»ResuÉ
<
	gG‘Chd»nW™hStResuÉ
>

103 : 
public
 
G‘Chd»nW™hStResuÉ
 {

104 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

105 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

106 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>& 
chd»n
(ècÚ¡ {  
chd»n_
; }

107 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

108 
	g´iv©e
:

109 
Stus
 
¡©us_
;

110 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
chd»n_
;

111 
St
 
	g¡©_
;

114 
	g‹m¶©e
 <>

115 
	gFau»ResuÉ
<
	gMuÉiResuÉ
> : 
public
 
MuÉiResuÉ
 {

116 
Fau»ResuÉ
(cÚ¡ 
Stus
& 
¡©us
è: 
¡©us_
(status) {}

117 cÚ¡ 
Stus
& 
¡©us
(ècÚ¡ {  
¡©us_
; }

118 cÚ¡ 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*>& 
»suÉs
(ècÚ¡ {  
»suÉs_
; }

119 
	g´iv©e
:

120 
Stus
 
¡©us_
;

121 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*> 
»suÉs_
;

	@/home/libin3-s/ldd/cage/internal/functions.h

1 #iâdeà
LDD_CAGE_INTERNAL_FUNCTIONS_H_


2 
	#LDD_CAGE_INTERNAL_FUNCTIONS_H_


	)

4 
	~<zook“³r/zook“³r.h
>

5 
	~"ldd/ÿge/k“³r.h
"

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gÿge
 {

10 
W©chSessiÚ
(
zhªdË_t
 *
zh
, 
ev’t
, 
¡©e
, cÚ¡ *
·th
,

11 *
cÚ‹xt
);

12 
W©chNode
(
zhªdË_t
 *
zh
, 
ev’t
, 
¡©e
, cÚ¡ *
·th
,

13 *
cÚ‹xt
);

14 
W©chChd
(
zhªdË_t
 *
zh
, 
ev’t
, 
¡©e
, cÚ¡ *
·th
,

15 *
cÚ‹xt
);

17 
C»©eCom¶‘iÚ
(
rc
, cÚ¡ *
Çme
, cÚ¡ *
±r
);

18 
D–‘eCom¶‘iÚ
(
rc
, cÚ¡ *
±r
);

19 
Exi¡sCom¶‘iÚ
(
rc
, cÚ¡ ::
St
 *
¡©
,

20 cÚ¡ *
±r
);

21 
G‘Com¶‘iÚ
(
rc
, cÚ¡ *
v®ue
, 
v®ue_Ën
,

22 cÚ¡ ::
St
 *
¡©
, cÚ¡ *
±r
);

23 
S‘Com¶‘iÚ
(
rc
, cÚ¡ ::
St
 *
¡©
,

24 cÚ¡ *
±r
);

25 
G‘AşCom¶‘iÚ
(
rc
, ::
ACL_veùÜ
* 
aşs
,

26 ::
St
* 
¡©
, cÚ¡ *
±r
);

27 
S‘AşCom¶‘iÚ
(
rc
, cÚ¡ * 
±r
);

28 
G‘Chd»nCom¶‘iÚ
(
rc
, cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
,

29 cÚ¡ *
±r
);

30 
G‘Chd»nW™hStCom¶‘iÚ
(
rc
,

31 cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
, cÚ¡ ::
St
 *
¡©
,

32 cÚ¡ *
±r
);

33 
AddAuthCom¶‘iÚ
(
rc
, cÚ¡ * 
±r
);

34 
MuÉiCom¶‘iÚ
(
rc
, cÚ¡ * 
±r
);

	@/home/libin3-s/ldd/cage/internal/keeper_impl.h

1 #iâdeà
LDD_CAGE_ZOOKEEPER_IMPL_H_


2 
	#LDD_CAGE_ZOOKEEPER_IMPL_H_


	)

4 
	~<boo¡/nÚcİyabË.hµ
>

5 
	~<veùÜ
>

6 
	~<m­
>

7 
	~"ldd/ÿge/k“³r.h
"

8 
	~"funùiÚs.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÿge
 {

13 
	g¡d
::
	tveùÜ
<
	tNodeW©ch”
> 
	tNodeW©ch”s
;

14 
	g¡d
::
	tveùÜ
<
	tChdW©ch”
> 
	tChdW©ch”s
;

15 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, 
	tNodeW©ch”s
> 
	tNodeW©ch”sM­
;

16 
	g¡d
::
	tm­
<
	t¡d
::
	t¡ršg
, 
	tChdW©ch”s
> 
	tChdW©ch”sM­
;

18 şas 
	cK“³r
::
Im¶
 : 
boo¡
::
nÚcİyabË
 {

19 
public
:

20 
Im¶
(
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
K“³rLi¡’”
& 
li¡’”
);

21 ~
Im¶
();

23 
boŞ
 
IsO³n
() const;

24 
boŞ
 
IsUÄecov”abË
() const;

25 
timeout
() const;

27 
boŞ
 
O³n
(cÚ¡ 
¡d
::
¡ršg
& 
de¡
, 
timeout
);

28 
Clo£
();

30 
AddAuth
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
û¹
,

31 cÚ¡ 
AddAuthC®lback
& 
ÿÎback
);

33 
C»©e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
v®ue
,

34 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
,

35 cÚ¡ 
C»©eC®lback
& 
ÿÎback
);

37 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
,

38 cÚ¡ 
D–‘eC®lback
& 
ÿÎback
);

40 
Exi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

41 cÚ¡ 
NodeW©ch”
& 
w©ch”
,

42 cÚ¡ 
Exi¡sC®lback
& 
ÿÎback
);

44 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

45 cÚ¡ 
NodeW©ch”
& 
w©ch”
,

46 cÚ¡ 
G‘C®lback
& 
ÿÎback
);

48 
S‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
v®ue
,

49 
št32_t
 
v”siÚ
, cÚ¡ 
S‘C®lback
& 
ÿÎback
);

51 
G‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
G‘AşC®lback
& 
ÿÎback
);

53 
S‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::
veùÜ
<
Aş
>& 
aşs
,

54 
št32_t
 
v”siÚ
, cÚ¡ 
S‘AşC®lback
& 
ÿÎback
);

56 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

57 cÚ¡ 
ChdW©ch”
& 
w©ch”
,

58 cÚ¡ 
G‘Chd»nC®lback
& 
ÿÎback
);

60 
G‘Chd»nW™hSt
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

61 cÚ¡ 
ChdW©ch”
& 
w©ch”
,

62 cÚ¡ 
G‘Chd»nW™hStC®lback
& 
ÿÎback
);

64 
MuÉi
(cÚ¡ 
¡d
::
veùÜ
<
Op
*>& 
İs
, cÚ¡ 
MuÉiC®lback
& 
ÿÎback
);

66 
	g´iv©e
:

67 
ä›nd
 
W©chSessiÚ
(
zhªdË_t
*, , , const *, *);

68 
ä›nd
 
W©chNode
(
zhªdË_t
*, , , const *, *);

69 
ä›nd
 
W©chChd
(
zhªdË_t
*, , , const *, *);

71 
Stus
 
IÁ”e¡
(* 
fd
, * 
š‹»¡
, 
ldd
::
ut
::
TimeDiff
* 
timeout
);

72 
Stus
 
Proûss
(
ev’ts
);

73 
Upd©eEv’t
();

74 
CË¬Ev’t
();

75 
HªdËEv’t
(
ev’ts
);

77 
mubË
 
zhªdË_t
* 
	gzh_
;

78 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ_
;

79 
	gÃt
::
FdEv’t
 
ev’t_
;

80 
K“³rLi¡’”
 
	gli¡’”_
;

81 
NodeW©ch”sM­
 
	gnode_w©ch”_
;

82 
ChdW©ch”sM­
 
	gchd_w©ch”_
;

	@/home/libin3-s/ldd/cage/internal/op_result.h

1 #iâdeà
LDD_CAGE_INTERNAL_OP_RESULT_H_


2 
	#LDD_CAGE_INTERNAL_OP_RESULT_H_


	)

4 
	~"ldd/ÿge/İ.h
"

5 
	~"ut.h
"

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gÿge
 {

10 şas 
	cOpResuÉBa£
 : 
public
 
Op
::
ResuÉ
 {

11 
public
:

12 
OpResuÉBa£
() {}

13 
vœtu®
 
Stus
 
¡©us
(ècÚ¡ {  Stus(
rc_
); }

14 
vœtu®
 
	gOp
::
Ty³
 
ty³
() const = 0;

16 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
* 
·th_ü—‹d
(ècÚ¡ {  
NULL
; }

17 
vœtu®
 cÚ¡ 
St
* 
¡©_£t
(ècÚ¡ {  
	gNULL
; }

18 
vœtu®
 
Upd©e
(
rc
è{ 
	grc_
 =„c; 
Upd©eBufãr
(); }

19 
	g´Ùeùed
:

20 
vœtu®
 
Upd©eBufãr
() {};

21 
	grc_
;

24 şas 
	cOpC»©eResuÉ
 : 
public
 
OpResuÉBa£
 {

25 
public
:

26 
OpC»©eResuÉ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
Mode
::
Ty³
 
mode
)

27 : 
OpResuÉBa£
(),

28 
buæ’_
(
MaxC»©edP©hL’gth
(
·th
, 
mode
)),

29 
bufãr_
(
¡©ic_ÿ¡
<*>(
ÿÎoc
(
buæ’_
, 1))) {}

30 
	gvœtu®
 ~
OpC»©eResuÉ
(è{ 
ä“
(
bufãr_
); }

31 
vœtu®
 
	gOp
::
Ty³
 
ty³
(ècÚ¡ {  
Op
::
kC»©e
; }

32 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
* 
·th_ü—‹d
(ècÚ¡ {  &
·th_ü—‹d_
; }

34 
vœtu®
 
Upd©eBufãr
(è{ 
	g·th_ü—‹d_
.
assign
(
bufãr_
); }

35 * 
bufãr
(ècÚ¡ {  
	gbufãr_
; }

36 
size_t
 
buæ’
(ècÚ¡ {  
	gbuæ’_
; }

37 
	g´iv©e
:

38 
size_t
 
buæ’_
;

39 * 
	gbufãr_
;

40 
	g¡d
::
¡ršg
 
·th_ü—‹d_
;

43 şas 
	cOpD–‘eResuÉ
 : 
public
 
OpResuÉBa£
 {

44 
public
:

45 
OpD–‘eResuÉ
(è: 
OpResuÉBa£
() {}

46 
vœtu®
 
Op
::
Ty³
 
ty³
(ècÚ¡ {  Op::
kD–‘e
; }

49 şas 
	cOpS‘ResuÉ
 : 
public
 
OpResuÉBa£
 {

50 
public
:

51 
OpS‘ResuÉ
(è: 
OpResuÉBa£
() {}

52 
vœtu®
 
Op
::
Ty³
 
ty³
(ècÚ¡ {  Op::
kD–‘e
; }

53 
vœtu®
 cÚ¡ 
St
* 
¡©_£t
(ècÚ¡ {  &
	g¡©_
; }

54 
vœtu®
 
Upd©eBufãr
(è{ 
	g¡©_
 = 
bufãr_
; }

56 ::
St
* 
bufãr
(è{  &
bufãr_
; }

57 
	g´iv©e
:

58 ::
St
 
bufãr_
;

59 
St
 
	g¡©_
;

62 şas 
	cOpCheckResuÉ
 : 
public
 
OpResuÉBa£
 {

63 
public
:

64 
OpCheckResuÉ
(è: 
OpResuÉBa£
() {}

65 
vœtu®
 
Op
::
Ty³
 
ty³
(ècÚ¡ {  Op::
kCheck
; }

	@/home/libin3-s/ldd/cage/internal/operation.h

4 #iâdeà
LDD_CAGE_INTERNAL_OPERATION_H_


5 
	#LDD_CAGE_INTERNAL_OPERATION_H_


	)

7 
	~<¡ršg
>

8 
	~<veùÜ
>

9 
	~<boo¡/fÜ—ch.hµ
>

10 
	~"ldd/ÿge/k“³r.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÿge
 {

15 
	g‹m¶©e
 <
şass
 
	gR
>

16 
şass
 
	gO³¿tiÚ
;

18 
	g‹m¶©e
 <>

19 
şass
 
	gO³¿tiÚ
<
	gAddAuthResuÉ
> {

20 
	gpublic
:

21 
public
:

22 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
û¹
)

23 : 
scheme_
(
scheme
), 
û¹_
(
û¹
) {}

24 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
AddAuthC®lback
& 
ÿÎback
) {

25 
	gk“³r
->
AddAuth
(
scheme_
, 
û¹_
, 
ÿÎback
);

27 
	g´iv©e
:

28 
¡d
::
¡ršg
 
scheme_
;

29 
	g¡d
::
¡ršg
 
û¹_
;

32 
	g‹m¶©e
 <>

33 
şass
 
	gO³¿tiÚ
<
	gC»©eResuÉ
> {

34 
	gpublic
:

35 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

36 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
)

37 : 
·th_
(
·th
), 
d©a_
(
d©a
), 
aşs_
(
aşs
), 
mode_
(
mode
) {}

38 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
C»©eC®lback
& 
ÿÎback
) {

39 
	gk“³r
->
C»©e
(
·th_
, 
d©a_
, 
aşs_
, 
mode_
, 
ÿÎback
);

41 
	g´iv©e
:

42 
¡d
::
¡ršg
 
·th_
;

43 
	g¡d
::
¡ršg
 
d©a_
;

44 
	g¡d
::
veùÜ
<
Aş
> 
aşs_
;

45 
	gMode
::
Ty³
 
mode_
;

48 
	g‹m¶©e
 <>

49 
şass
 
	gO³¿tiÚ
<
	gD–‘eResuÉ
> {

50 
	gpublic
:

51 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
)

52 : 
·th_
(
·th
), 
v”siÚ_
(
v”siÚ
) {}

53 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
D–‘eC®lback
& 
ÿÎback
) {

54 
	gk“³r
->
D–‘e
(
·th_
, 
v”siÚ_
, 
ÿÎback
);

56 
	g´iv©e
:

57 
¡d
::
¡ršg
 
·th_
;

58 
št32_t
 
	gv”siÚ_
;

61 
	g‹m¶©e
 <>

62 
şass
 
	gO³¿tiÚ
<
	gExi¡sResuÉ
> {

63 
	gpublic
:

64 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
)

65 : 
·th_
(
·th
), 
w©ch”_
(
w©ch”
) {}

66 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
Exi¡sC®lback
& 
ÿÎback
) {

67 
	gk“³r
->
Exi¡s
(
·th_
, 
w©ch”_
, 
ÿÎback
);

69 
	g´iv©e
:

70 
¡d
::
¡ršg
 
·th_
;

71 
NodeW©ch”
 
	gw©ch”_
;

74 
	g‹m¶©e
 <>

75 
şass
 
	gO³¿tiÚ
<
	gG‘ResuÉ
> {

76 
	gpublic
:

77 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
)

78 : 
·th_
(
·th
), 
w©ch”_
(
w©ch”
) {}

79 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
G‘C®lback
& 
ÿÎback
) {

80 
	gk“³r
->
G‘
(
·th_
, 
w©ch”_
, 
ÿÎback
);

82 
	g´iv©e
:

83 
¡d
::
¡ršg
 
·th_
;

84 
NodeW©ch”
 
	gw©ch”_
;

87 
	g‹m¶©e
 <>

88 
şass
 
	gO³¿tiÚ
<
	gS‘ResuÉ
> {

89 
	gpublic
:

90 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
, 
št32_t
 
v”siÚ
)

91 : 
·th_
(
·th
), 
d©a_
(
d©a
), 
v”siÚ_
(
v”siÚ
) {}

92 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
S‘C®lback
& 
ÿÎback
) {

93 
	gk“³r
->
S‘
(
·th_
, 
d©a_
, 
v”siÚ_
, 
ÿÎback
);

95 
	g´iv©e
:

96 
¡d
::
¡ršg
 
·th_
;

97 
	g¡d
::
¡ršg
 
d©a_
;

98 
št32_t
 
	gv”siÚ_
;

101 
	g‹m¶©e
 <>

102 
şass
 
	gO³¿tiÚ
<
	gG‘AşResuÉ
> {

103 
	gpublic
:

104 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
è: 
·th_
(path) {}

105 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
G‘AşC®lback
& 
ÿÎback
) {

106 
	gk“³r
->
G‘Aş
(
·th_
, 
ÿÎback
);

108 
	g´iv©e
:

109 
¡d
::
¡ršg
 
·th_
;

112 
	g‹m¶©e
 <>

113 
şass
 
	gO³¿tiÚ
<
	gS‘AşResuÉ
> {

114 
	gpublic
:

115 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::
veùÜ
<
Aş
>& 
aşs
,

116 
št32_t
 
v”siÚ
è: 
·th_
(
·th
), 
aşs_
(
aşs
), 
v”siÚ_
(version) {}

117 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
S‘AşC®lback
& 
ÿÎback
) {

118 
	gk“³r
->
S‘Aş
(
·th_
, 
aşs_
, 
v”siÚ_
, 
ÿÎback
);

120 
	g´iv©e
:

121 
¡d
::
¡ršg
 
·th_
;

122 
	g¡d
::
veùÜ
<
Aş
> 
aşs_
;

123 
št32_t
 
	gv”siÚ_
;

126 
	g‹m¶©e
 <>

127 
şass
 
	gO³¿tiÚ
<
	gG‘Chd»nResuÉ
> {

128 
	gpublic
:

129 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
ChdW©ch”
& 
w©ch”
)

130 : 
·th_
(
·th
), 
w©ch”_
(
w©ch”
) {}

131 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
G‘Chd»nC®lback
& 
ÿÎback
) {

132 
	gk“³r
->
G‘Chd»n
(
·th_
, 
w©ch”_
, 
ÿÎback
);

134 
	g´iv©e
:

135 
¡d
::
¡ršg
 
·th_
;

136 
ChdW©ch”
 
	gw©ch”_
;

139 
	g‹m¶©e
 <>

140 
şass
 
	gO³¿tiÚ
<
	gG‘Chd»nW™hStResuÉ
> {

141 
	gpublic
:

142 
O³¿tiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
ChdW©ch”
& 
w©ch”
)

143 : 
·th_
(
·th
), 
w©ch”_
(
w©ch”
) {}

144 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
G‘Chd»nW™hStC®lback
& 
ÿÎback
) {

145 
	gk“³r
->
G‘Chd»nW™hSt
(
·th_
, 
w©ch”_
, 
ÿÎback
);

147 
	g´iv©e
:

148 
¡d
::
¡ršg
 
·th_
;

149 
ChdW©ch”
 
	gw©ch”_
;

152 
	g‹m¶©e
 <>

153 
şass
 
	gO³¿tiÚ
<
	gMuÉiResuÉ
> {

154 
	gpublic
:

155 
O³¿tiÚ
(cÚ¡ 
¡d
::
veùÜ
<
Op
*>& 
İs
): 
İs_
(ops) {}

156 ~
O³¿tiÚ
() {

157 
BOOST_FOREACH
(
Op
* 
İ
, 
İs_
) {

158 
d–‘e
 
	gİ
;

161 
Do
(
K“³r
* 
k“³r
, cÚ¡ 
MuÉiC®lback
& 
ÿÎback
) {

162 
	gk“³r
->
MuÉi
(
İs_
, 
ÿÎback
);

164 
	g´iv©e
:

165 
¡d
::
veùÜ
<
Op
*> 
İs_
;

	@/home/libin3-s/ldd/cage/internal/result_impl.h

1 #iâdeà
LDD_CAGE_INTERNAL_RESULT_IMPL_H_


2 
	#LDD_CAGE_INTERNAL_RESULT_IMPL_H_


	)

4 
	~"ldd/ÿge/»suÉ.h
"

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gÿge
 {

9 şas 
	cResuÉIm¶Ba£
 {

10 
	gpublic
:

11 
ResuÉIm¶Ba£
(
rc
è: 
¡©us_
(rc) {}

12 
vœtu®
 ~
ResuÉIm¶Ba£
() {}

14 
vœtu®
 
Proûss
() = 0;

15 
	g´Ùeùed
:

16 
Stus
 
¡©us_
;

19 
	g‹m¶©e
 <
şass
 
	gResuÉT
>

20 
şass
 
	gResuÉIm¶
 : 
public
 
ResuÉIm¶Ba£
,…ubliø
	gResuÉT
 {

21 
	gpublic
:

22 
ResuÉIm¶
(
rc
, cÚ¡ *
±r
)

23 : 
ResuÉIm¶Ba£
(
rc
)

24 , 
ÿÎback_
((
C®lbackW¿µ”
::
Im¶
<
ResuÉT
>*)
±r
) {}

25 
vœtu®
 ~
ResuÉIm¶
() {}

26 
vœtu®
 
Proûss
(è{ 
ÿÎback_
->
ProûssResuÉ
(
this
); }

27 
	g´Ùeùed
:

28 
C®lbackW¿µ”
::
Im¶
<
ResuÉT
> *
ÿÎback_
;

32 
şass
 
	gC»©eResuÉIm¶
 : 
public
 
ResuÉIm¶
<
C»©eResuÉ
> {

33 
public
:

34 
C»©eResuÉIm¶
(
rc
, cÚ¡ *
v®ue
, cÚ¡ *
±r
)

35 : 
ResuÉIm¶
<
C»©eResuÉ
>(
rc
, 
	g±r
)

37 ià(
	g¡©us_
.
IsOk
()) {

38 
	g·th_ü—‹d_
.
assign
(
v®ue
);

41 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

42 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
 &
·th_ü—‹d
(ècÚ¡ {  
·th_ü—‹d_
; }

43 
	g´iv©e
:

44 
¡d
::
¡ršg
 
·th_ü—‹d_
;

47 
şass
 
	gD–‘eResuÉIm¶
 : 
public
 
ResuÉIm¶
<
D–‘eResuÉ
> {

48 
public
:

49 
D–‘eResuÉIm¶
(
rc
, cÚ¡ *
±r
)

50 : 
ResuÉIm¶
<
D–‘eResuÉ
>(
rc
, 
	g±r
) {}

51 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

54 
şass
 
	gExi¡sResuÉIm¶
 : 
public
 
ResuÉIm¶
<
Exi¡sResuÉ
> {

55 
public
:

56 
Exi¡sResuÉIm¶
(
rc
, cÚ¡ ::
St
 *
¡©
, cÚ¡ *
±r
)

57 : 
ResuÉIm¶
<
Exi¡sResuÉ
>(
rc
, 
	g±r
)

59 ià(
	g¡©us_
.
IsOk
()) {

60 
	g¡©_
 = *
¡©
;

63 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

64 
vœtu®
 cÚ¡ 
	gSt
 &
¡©
(ècÚ¡ {  
	g¡©_
; }

65 
	g´iv©e
:

66 
St
 
¡©_
;

69 
şass
 
	gG‘ResuÉIm¶
 : 
public
 
ResuÉIm¶
<
G‘ResuÉ
> {

70 
public
:

71 
G‘ResuÉIm¶
(
rc
, cÚ¡ *
v®ue
, 
v®ue_Ën
,

72 cÚ¡ ::
St
 *
¡©
, cÚ¡ *
±r
)

73 : 
ResuÉIm¶
<
G‘ResuÉ
>(
rc
, 
	g±r
)

75 ià(
	g¡©us_
.
IsOk
()) {

76 
	gd©a_
.
assign
(
v®ue
, 
v®ue_Ën
);

77 
	g¡©_
 = *
¡©
;

80 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

81 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
 &
d©a
(ècÚ¡ {  
d©a_
; }

82 
vœtu®
 cÚ¡ 
	gSt
 &
¡©
(ècÚ¡ {  
	g¡©_
; }

83 
	g´iv©e
:

84 
¡d
::
¡ršg
 
d©a_
;

85 
St
 
	g¡©_
;

88 
şass
 
	gS‘ResuÉIm¶
 : 
public
 
ResuÉIm¶
<
S‘ResuÉ
> {

89 
public
:

90 
S‘ResuÉIm¶
(
rc
, cÚ¡ ::
St
 *
¡©
, cÚ¡ *
±r
)

91 : 
ResuÉIm¶
<
S‘ResuÉ
>(
rc
, 
	g±r
)

93 ià(
	g¡©us_
.
IsOk
()) {

94 
	g¡©_
 = *
¡©
;

97 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

98 
vœtu®
 cÚ¡ 
	gSt
 &
¡©
(ècÚ¡ {  
	g¡©_
; }

99 
	g´iv©e
:

100 
St
 
¡©_
;

103 
şass
 
	gG‘AşResuÉIm¶
 : 
public
 
ResuÉIm¶
<
G‘AşResuÉ
> {

104 
public
:

105 
G‘AşResuÉIm¶
(
rc
, cÚ¡ ::
ACL_veùÜ
* 
aşs
, cÚ¡ ::
St
* 
¡©
,

106 cÚ¡ * 
±r
)

107 : 
ResuÉIm¶
<
G‘AşResuÉ
>(
rc
, 
	g±r
)

109 ià(
	g¡©us_
.
IsOk
()) {

110 
	g¡d
::
cİy
(
aşs
->
d©a
,‡şs->d©¨+‡şs->
couÁ
,

111 
¡d
::
back_š£¹”
(
aşs_
));

112 
	g¡©_
 = *
¡©
;

115 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
(ècÚ¡ {  
	g¡©us_
; }

116 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
Aş
>& 
aşs
(ècÚ¡ {  
aşs_
; }

117 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
(ècÚ¡ {  
	g¡©_
; }

118 
	g´iv©e
:

119 
¡d
::
veùÜ
<
Aş
> 
aşs_
;

120 
St
 
	g¡©_
;

123 
şass
 
	gS‘AşResuÉIm¶
 : 
public
 
ResuÉIm¶
<
S‘AşResuÉ
> {

124 
public
:

125 
S‘AşResuÉIm¶
(
rc
, cÚ¡ * 
±r
)

126 : 
ResuÉIm¶
<
S‘AşResuÉ
>(
rc
, 
	g±r
) { }

127 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
(ècÚ¡ {  
	g¡©us_
; }

130 
şass
 
	gG‘Chd»nResuÉIm¶
 : 
public
 
ResuÉIm¶
<
G‘Chd»nResuÉ
> {

131 
public
:

132 
G‘Chd»nResuÉIm¶
(
rc
, cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
, cÚ¡ *
±r
)

133 : 
ResuÉIm¶
<
G‘Chd»nResuÉ
>(
rc
, 
	g±r
)

135 ià(
	g¡©us_
.
IsOk
()) {

136 
št32_t
 
	gi
 = 0; i < 
	g¡ršgs
->
	gcouÁ
; ++i) {

137 
	gchd»n_
.
push_back
(
¡ršgs
->
d©a
[
i
]);

141 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

142 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> &
chd»n
() const {

143  
chd»n_
;

145 
	g´iv©e
:

146 
¡d
::
veùÜ
<¡d::
¡ršg
> 
chd»n_
;

149 
şass
 
	gG‘Chd»nW™hStResuÉIm¶


150 : 
public
 
ResuÉIm¶
<
G‘Chd»nW™hStResuÉ
> {

151 
public
:

152 
G‘Chd»nW™hStResuÉIm¶
(

153 
rc
, cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
, cÚ¡ ::
St
 *
¡©
,

154 cÚ¡ *
±r
)

155 : 
ResuÉIm¶
<
G‘Chd»nW™hStResuÉ
>(
rc
, 
	g±r
)

157 ià(
	g¡©us_
.
IsOk
()) {

158 
št32_t
 
	gi
 = 0; i < 
	g¡ršgs
->
	gcouÁ
; ++i) {

159 
	gchd»n_
.
push_back
(
¡ršgs
->
d©a
[
i
]);

161 
	g¡©_
 = *
¡©
;

164 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

165 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> &
chd»n
(ècÚ¡ { 
chd»n_
;}

166 
vœtu®
 cÚ¡ 
	gSt
 &
¡©
(ècÚ¡ {  
	g¡©_
; }

167 
	g´iv©e
:

168 
¡d
::
veùÜ
<¡d::
¡ršg
> 
chd»n_
;

169 
St
 
	g¡©_
;

172 
şass
 
	gAddAuthResuÉIm¶
 : 
public
 
ResuÉIm¶
<
AddAuthResuÉ
> {

173 
public
:

174 
AddAuthResuÉIm¶
(
rc
, cÚ¡ *
±r
)

175 : 
ResuÉIm¶
<
AddAuthResuÉ
>(
rc
, 
	g±r
) {}

176 
vœtu®
 cÚ¡ 
	gStus
 &
¡©us
(ècÚ¡ {  
	g¡©us_
; }

179 
şass
 
	gMuÉiResuÉIm¶
 : 
public
 
ResuÉIm¶
<
MuÉiResuÉ
> {

180 
public
:

181 
MuÉiResuÉIm¶
(
rc
, cÚ¡ * 
±r
)

182 : 
ResuÉIm¶
<
MuÉiResuÉ
>(
rc
, 
	g±r
) {}

183 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
(ècÚ¡ {  
	g¡©us_
; }

184 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*>& 
»suÉs
() const {

185  
ÿÎback_
->
»suÉs
();

	@/home/libin3-s/ldd/cage/internal/retry_loop.h

4 #iâdeà
LDD_CAGE_INTERNAL_RETRY_LOOP_H_


5 
	#LDD_CAGE_INTERNAL_RETRY_LOOP_H_


	)

7 
	~<boo¡/šŒusive/li¡.hµ
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÿge
 {

12 
şass
 
	gR‘ryLoİ


13 : 
public
 
boo¡
::
šŒusive
::
li¡_ba£_hook
<

14 
boo¡
::
šŒusive
::
lšk_mode
<boo¡::šŒusive::
auto_uÆšk
> >{

15 
public
:

16 
vœtu®
 ~
R‘ryLoİ
() {}

17 
vœtu®
 
S¹
() = 0;

18 
vœtu®
 
Stİ
() = 0;

19 
	g‹m¶©e
 <
şass
 
	gR
>

20 
şass
 
	gIm¶
;

23 
	gboo¡
::
	tšŒusive
::
	tli¡
<
	tR‘ryLoİ
,

24 
	tboo¡
::
	tšŒusive
::
	tcÚ¡ªt_time_size
<
	tçl£
> > 
	tR‘ryLi¡
;

	@/home/libin3-s/ldd/cage/internal/retry_loop_impl.h

4 
	~"»Œy_loİ.h
"

5 
	~<ldd/Ãt/ev’t.h
>

6 
	~"ldd/ÿge/»Œy_pŞicy.h
"

7 
	~"ldd/ÿge/ÿge.h
"

8 
	~"İ”©iÚ.h
"

9 
	~"çu»_»suÉ.h
"

10 
	~"ÿge_im¶.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÿge
 {

15 
	g‹m¶©e
 <
şass
 
	gR
>

16 şas 
	cR‘ryLoİ
::
Im¶
 : 
public
 
R‘ryLoİ
 {

17 
public
:

18 
Im¶
(
Cage
::Im¶* 
ÿge
, 
R‘ryPŞicy
* 
pŞicy
, 
O³¿tiÚ
<
R
>* 
İ”©iÚ
,

19 cÚ¡ 
boo¡
::
funùiÚ
<(cÚ¡ 
R
&)>& 
ÿÎback
)

20 : 
ÿge_
(
ÿge
),

21 
pŞicy_
(
pŞicy
),

22 
İ”©iÚ_
(
İ”©iÚ
),

23 
ÿÎback_
(
ÿÎback
),

24 
tim”_
(
ÿge
->
ev’t_loİ
()),

25 
»Œy_couÁ_
(0),

26 
wa™šg_
(
çl£
) {}

27 ~
Im¶
() {

28 
d–‘e
 
	gİ”©iÚ_
;

30 
S¹
() {

31 
	g¡¬t_
 = 
ldd
::
ut
::
Time¡amp
::
Now
();

32 
Try
();

34 
Stİ
() {

35 ià(
	gwa™šg_
) {

36 
	gtim”_
.
Cªûl
();

38 
C®lback
(
Fau»ResuÉ
<
R
>(
Stus
::
kClosšg
));

40 
	g´iv©e
:

41 
Try
() {

42 
İ”©iÚ_
->
Do
(&
ÿge_
->
k“³r_
,

43 
boo¡
::
bšd
(&
Im¶
::
HªdËResuÉ
, 
this
, 
_1
));

45 
HªdËResuÉ
(cÚ¡ 
R
& 
»suÉ
) {

46 ià(
	g»suÉ
.
¡©us
().
IsCÚÃùiÚLoss
() ||

47 
	g»suÉ
.
¡©us
().
IsO³¿tiÚTimeout
() ||

48 
	g»suÉ
.
¡©us
().
IsSessiÚMoved
()) {

49 
	gldd
::
ut
::
TimeDiff
 
wa™
;

50 ià(
	gpŞicy_
->
ShouldR‘ry
(
»Œy_couÁ_
,

51 
ldd
::
ut
::
Time¡amp
::
Now
(è- 
¡¬t_
, &
wa™
)) {

52 
	g»Œy_couÁ_
++;

53 
	gtim”_
.
AsyncWa™
(
boo¡
::
bšd
(&
Im¶
::
R‘ry
, 
this
), 
wa™
);

54 
	gwa™šg_
 = 
Œue
;

58 
C®lback
(
»suÉ
);

60 
R‘ry
() {

61 
	gwa™šg_
 = 
çl£
;

62 
Try
();

64 
C®lback
(cÚ¡ 
R
& 
r
) {

65 
CHECK
(
is_lšked
());

66 
uÆšk
();

67 
ÿÎback_
(
r
);

68 
d–‘e
 
	gthis
;

71 
	g´iv©e
:

72 
Cage
::
Im¶
* 
ÿge_
;

73 
R‘ryPŞicy
* 
	gpŞicy_
;

74 
	gO³¿tiÚ
<
	gR
>* 
	gİ”©iÚ_
;

75 
	gboo¡
::
funùiÚ
<(cÚ¡ 
R
&)> 
ÿÎback_
;

76 
	gldd
::
Ãt
::
Tim”Ev’t
 
tim”_
;

77 
	g»Œy_couÁ_
;

78 
	gldd
::
ut
::
Time¡amp
 
¡¬t_
;

79 
boŞ
 
	gwa™šg_
;

	@/home/libin3-s/ldd/cage/internal/retry_policy.h

4 #iâdeà
LDD_CAGE_INTERNAL_RETRY_POLICY_H_


5 
	#LDD_CAGE_INTERNAL_RETRY_POLICY_H_


	)

7 
	~"ldd/ÿge/»Œy_pŞicy.h
"

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÿge
 {

12 şas 
	cNoR‘ry
 : 
public
 
R‘ryPŞicy
 {

13 
public
:

14 
boŞ
 
ShouldR‘ry
(
»Œy_couÁ
, cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
–­£d
,

15 
ldd
::
ut
::
TimeDiff
* 
wa™
) {

16  
çl£
;

20 şas 
	cWa™šgR‘ry
 : 
public
 
R‘ryPŞicy
 {

21 
public
:

22 
Wa™šgR‘ry
(
max
è: 
max_
(max >= 0 ? max : 0) {}

23 
boŞ
 
ShouldR‘ry
(
»Œy_couÁ
, cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
–­£d
,

24 
ldd
::
ut
::
TimeDiff
* 
wa™
) {

25 ià(
»Œy_couÁ
 > 
max_
 ||„etry_count < 0) {

26  
çl£
;

28 
Wa™FÜ
(
»Œy_couÁ
, 
–­£d
, 
wa™
);

29  
	gŒue
;

31 
	g´Ùeùed
:

32 
vœtu®
 
Wa™FÜ
(
»Œy_couÁ
,

33 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
–­£d
,

34 
ldd
::
ut
::
TimeDiff
* 
wa™
) = 0;

35 
	g´iv©e
:

36 
max_
;

39 şas 
	cR‘ryNTimes
 : 
public
 
Wa™šgR‘ry
 {

40 
public
:

41 
R‘ryNTimes
(
n
, cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
wa™
)

42 : 
Wa™šgR‘ry
(
n
), 
wa™_
(
wa™
) {}

43 
	g´iv©e
:

44 
Wa™FÜ
(
»Œy_couÁ
, cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
–­£d
,

45 
ldd
::
ut
::
TimeDiff
* 
wa™
) {

46 *
wa™
 = 
wa™_
;

48 
	gldd
::
ut
::
TimeDiff
 
wa™_
;

	@/home/libin3-s/ldd/cage/internal/util.h

1 #iâdeà
LDD_CAGE_INTERNAL_UTIL_H_


2 
	#LDD_CAGE_INTERNAL_UTIL_H_


	)

4 
	~<¡ršg
>

5 
	~<boo¡/nÚcİyabË.hµ
>

6 
	~"ldd/ÿge/mode.h
"

8 
Çme¥aû
 
	gldd
 {

9 
Çme¥aû
 
	gÿge
 {

11 
šlše
 
size_t
 
MaxC»©edP©hL’gth
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
Mode
::
Ty³
 
mode
) {

12 
size_t
 
Ën
 = 
·th
.
size
();

13 ià(
	gmode
 & 
	gMode
::
kP”si¡’tSequ’û
) {

14 cÚ¡ 
size_t
 
kSequ’ûSuffixL’gth
 = 12;

15 
	gËn
 +ğ
kSequ’ûSuffixL’gth
;

17  
	gËn
 + 1;

20 
AÎoÿ‹ACLVeùÜ
(
ACL_veùÜ
 *
v
, 
št32_t
 
Ën
);

	@/home/libin3-s/ldd/cage/keeper.h

1 #iâdeà
LDD_CAGE_ZOOKEEPER_H_


2 
	#LDD_CAGE_ZOOKEEPER_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<boo¡/±r_cÚš”/±r_veùÜ.hµ
>

7 
	~<zook“³r/zook“³r.h
>

8 
	~<ldd/Ãt/ev’t_loİ.h
>

9 
	~<ldd/Ãt/ev’t.h
>

10 
	~<ldd/ut/time_diff.h
>

11 
	~"ldd/ÿge/aş.h
"

12 
	~"ldd/ÿge/mode.h
"

13 
	~"ldd/ÿge/¡©.h
"

14 
	~"ldd/ÿge/¡©us.h
"

15 
	~"ldd/ÿge/ÿÎback.h
"

17 
Çme¥aû
 
	gldd
 {

18 
Çme¥aû
 
	gÿge
 {

20 şas 
	cK“³r
 {

21 
	gpublic
:

22 
şass
 
Im¶
;

23 
K“³r
(
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
K“³rLi¡’”
& 
li¡’”
);

24 ~
K“³r
();

26 
boŞ
 
IsO³n
() const;

27 
boŞ
 
IsUÄecov”abË
() const;

28 
timeout
() const;

30 
boŞ
 
O³n
(cÚ¡ 
¡d
::
¡ršg
& 
de¡
, 
timeout
);

31 
Clo£
();

33 
AddAuth
(cÚ¡ 
¡d
::
¡ršg
& 
scheme
, cÚ¡ std::¡ršg& 
û¹
,

34 cÚ¡ 
AddAuthC®lback
& 
ÿÎback
);

36 
C»©e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

37 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
,

38 cÚ¡ 
C»©eC®lback
& 
ÿÎback
);

40 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
,

41 cÚ¡ 
D–‘eC®lback
& 
ÿÎback
);

43 
Exi¡s
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

44 cÚ¡ 
Exi¡sC®lback
& 
ÿÎback
);

46 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
NodeW©ch”
& 
w©ch”
,

47 cÚ¡ 
G‘C®lback
& 
ÿÎback
);

49 
S‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

50 
št32_t
 
v”siÚ
, cÚ¡ 
S‘C®lback
& 
ÿÎback
);

52 
G‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
G‘AşC®lback
& 
ÿÎback
);

54 
S‘Aş
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::
veùÜ
<
Aş
>& 
aşs
,

55 
št32_t
 
v”siÚ
, cÚ¡ 
S‘AşC®lback
& 
ÿÎback
);

57 
G‘Chd»n
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ 
ChdW©ch”
& 
w©ch”
,

58 cÚ¡ 
G‘Chd»nC®lback
& 
ÿÎback
);

60 
G‘Chd»nW™hSt
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

61 cÚ¡ 
ChdW©ch”
& 
w©ch”
,

62 cÚ¡ 
G‘Chd»nW™hStC®lback
& 
ÿÎback
);

64 
MuÉi
(cÚ¡ 
¡d
::
veùÜ
<
Op
*>& 
İs
, cÚ¡ 
MuÉiC®lback
& 
ÿÎback
);

66 
	g´iv©e
:

68 
K“³r
(const Keeper&);

69 
	gK“³r
& 
	gİ”©Ü
 = (cÚ¡ 
K“³r
&);

71 
Im¶
* 
	gim¶_
;

	@/home/libin3-s/ldd/cage/keeper_state.h

1 #iâdeà
LDD_CAGE_KEEPER_STATE_H_


2 
	#LDD_CAGE_KEEPER_STATE_H_


	)

4 
	~<boo¡/İ”©Üs.hµ
>

5 
	~<zook“³r/zook“³r.h
>

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gÿge
 {

10 
şass
 
	gK“³rS‹
 : 
boo¡
::
equ®™y_com·¿bË
<
K“³rS‹
>,

11 
	gboo¡
::
equ®™y_com·¿bË
<
K“³rS‹
, > {

12 
	gpublic
:

13 
	eTy³
 {

14 
kClo£d
 = 0,

15 
	gkCÚÃùšg
 = 1,

16 
	gkAssocŸtšg
 = 2,

17 
	gkCÚÃùed
 = 3,

18 
	gkExpœed
 = -112,

19 
	gkAuthFaed
 = -113,

21 
K“³rS‹
(
¡©e
è: 
ty³_
(state) {}

22 
boŞ
 
İ”©Ü
==(
¡©e
ècÚ¡ {  
ty³_
 == state; }

23 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
K“³rS‹
 &
rhs
ècÚ¡ {  
ty³_
 =ğrhs.
ty³
();}

25 
ty³
(ècÚ¡ {  
	gty³_
; }

26 cÚ¡ *
ToSŒšg
() const;

28 
boŞ
 
IsClo£d
(ècÚ¡ {  
	gty³_
 =ğ
kClo£d
; }

29 
boŞ
 
IsCÚÃùšg
(ècÚ¡ {  
	gty³_
 =ğ
kCÚÃùšg
; }

30 
boŞ
 
IsAssocŸtšg
(ècÚ¡ {  
	gty³_
 =ğ
kAssocŸtšg
; }

31 
boŞ
 
IsCÚÃùed
(ècÚ¡ {  
	gty³_
 =ğ
kCÚÃùed
; }

32 
boŞ
 
IsExpœed
(ècÚ¡ {  
	gty³_
 =ğ
kExpœed
; }

33 
boŞ
 
IsAuthFaed
(ècÚ¡ {  
	gty³_
 =ğ
kAuthFaed
; }

35 
boŞ
 
IsUÄecov”abË
(ècÚ¡ {  
	gty³_
 < 0; }

36 
	g´iv©e
:

37 
ty³_
;

	@/home/libin3-s/ldd/cage/mode.h

1 #iâdeà
LDD_CAGE_MODE_H_


2 
	#LDD_CAGE_MODE_H_


	)

4 
	~<zook“³r/zook“³r.h
>

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gÿge
 {

9 
	sMode
 {

10 
	eTy³
 {

11 
	gkP”si¡’t
 = 0,

12 
	gkEphem”®
 = 1,

13 
	gkP”si¡’tSequ’û
 = 2,

14 
	gkEphem”®Sequ’û
 = 3,

16 cÚ¡ * 
ToSŒšg
(
Ty³
 
mode
);

	@/home/libin3-s/ldd/cage/op.h

1 #iâdeà
LDD_CAGE_OP_H_


2 
	#LDD_CAGE_OP_H_


	)

4 
	~<as£¹.h
>

5 
	~<¡ršg
>

6 
	~<veùÜ
>

7 
	~<boo¡/nÚcİyabË.hµ
>

8 
	~<zook“³r/´Ùo.h
>

9 
	~"ldd/ÿge/¡©us.h
"

10 
	~"ldd/ÿge/aş.h
"

11 
	~"ldd/ÿge/¡©.h
"

12 
	~"ldd/ÿge/mode.h
"

14 
Çme¥aû
 
	gldd
 {

15 
Çme¥aû
 
	gÿge
 {

17 
şass
 
	gOpC»©e
;

18 
şass
 
	gOpD–‘e
;

19 
şass
 
	gOpS‘
;

20 
şass
 
	gOpCheck
;

22 şas 
	cOp
 : 
boo¡
::
nÚcİyabË
 {

23 
public
:

24 
	eTy³
 {

25 
kC»©e
 = 
ZOO_CREATE_OP
,

26 
	gkD–‘e
 = 
ZOO_DELETE_OP
,

27 
	gkS‘
 = 
ZOO_SETDATA_OP
,

28 
	gkCheck
 = 
ZOO_CHECK_OP
,

30 
şass
 
	gResuÉ
;

31 
	gvœtu®
 ~
Op
() {}

33 
	g´Ùeùed
:

34 
ä›nd
 
şass
 
OpC»©e
;

35 
ä›nd
 
şass
 
	gOpD–‘e
;

36 
ä›nd
 
şass
 
	gOpS‘
;

37 
ä›nd
 
şass
 
	gOpCheck
;

38 
ä›nd
 
şass
 
	gK“³r
;

39 
Op
(cÚ¡ 
¡d
::
¡ršg
& 
·th
è: 
·th_
(path) {}

40 
vœtu®
 
ResuÉ
* 
MakeResuÉ
(
zoo_İ_t
* 
zİ
) const = 0;

41 
	g¡d
::
¡ršg
 
·th_
;

44 şas 
	cOp
::
ResuÉ
 : 
boo¡
::
nÚcİyabË
 {

45 
public
:

46 
vœtu®
 ~
ResuÉ
() {}

47 
vœtu®
 
Stus
 
¡©us
() const = 0;

48 
vœtu®
 
Ty³
 
ty³
() const = 0;

49 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
* 
·th_ü—‹d
() const = 0;

50 
vœtu®
 cÚ¡ 
St
* 
¡©_£t
() const = 0;

51 
	g´Ùeùed
:

52 
vœtu®
 
Upd©e
(
rc
) = 0;

53 
ä›nd
 
şass
 
	gC®lbackW¿µ”
;

57 şas 
	cOpC»©e
 : 
public
 
Op
 {

58 
public
:

59 
OpC»©e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
,

60 cÚ¡ 
¡d
::
veùÜ
<
Aş
>& 
aşs
, 
Mode
::
Ty³
 
mode
);

61 
	gvœtu®
 ~
OpC»©e
();

62 
	g´iv©e
:

63 
ä›nd
 
şass
 
K“³r
;

64 
vœtu®
 
ResuÉ
* 
MakeResuÉ
(
zoo_İ_t
* 
zİ
) const;

65 
	g¡d
::
¡ršg
 
d©a_
;

66 ::
ACL_veùÜ
 
aşs_
;

67 
	gMode
::
Ty³
 
mode_
;

70 şas 
	cOpD–‘e
 : 
public
 
Op
 {

71 
public
:

72 
OpD–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
);

73 
	g´iv©e
:

74 
ä›nd
 
şass
 
K“³r
;

75 
vœtu®
 
ResuÉ
* 
MakeResuÉ
(
zoo_İ_t
* 
zİ
) const;

76 
št32_t
 
	gv”siÚ_
;

79 şas 
	cOpS‘
 : 
public
 
Op
 {

80 
public
:

81 
OpS‘
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, cÚ¡ std::¡ršg& 
d©a
, 
št32_t
 
v”siÚ
);

82 
	g´iv©e
:

83 
ä›nd
 
şass
 
K“³r
;

84 
vœtu®
 
ResuÉ
* 
MakeResuÉ
(
zoo_İ_t
* 
zİ
) const;

85 
	g¡d
::
¡ršg
 
d©a_
;

86 
št32_t
 
	gv”siÚ_
;

89 şas 
	cOpCheck
 : 
public
 
Op
 {

90 
public
:

91 
OpCheck
(cÚ¡ 
¡d
::
¡ršg
& 
·th
, 
št32_t
 
v”siÚ
);

92 
	g´iv©e
:

93 
ä›nd
 
şass
 
K“³r
;

94 
vœtu®
 
ResuÉ
* 
MakeResuÉ
(
zoo_İ_t
* 
zİ
) const;

95 
št32_t
 
	gv”siÚ_
;

	@/home/libin3-s/ldd/cage/recipes/election.h

4 #iâdeà
LDD_CAGE_RECIPES_ELECTION_H_


5 
	#LDD_CAGE_RECIPES_ELECTION_H_


	)

7 
	~<¡dšt.h
>

8 
	~<boo¡/funùiÚ.hµ
>

9 
	~"ldd/ÿge/ÿge.h
"

10 
	~"ldd/ÿge/ut.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÿge
 {

14 
Çme¥aû
 
	g»ces
 {

16 şas 
	cEËùiÚ
 {

17 
	gpublic
:

18 
boo¡
::
	tfunùiÚ
<(
	tboŞ
)> 
	tNÙif›r
;

19 
EËùiÚ
(
Cage
* 
ÿge
, cÚ¡ 
¡d
::
¡ršg
& 
roÙ
, cÚ¡ 
NÙif›r
& 
nÙif›r
);

20 
S¹
();

21 
Stİ
();

22 
	g´iv©e
:

23 
C»©eRoÙ
();

24 
OnC»©eRoÙ
(cÚ¡ 
C»©eResuÉ
& 
»suÉ
);

25 
C»©eS–f
();

26 
OnC»©eS–f
(cÚ¡ 
C»©eResuÉ
& 
»suÉ
);

27 
boŞ
 
G‘NodeId
(cÚ¡ 
¡d
::
¡ršg
& 
node
, 
ušt32_t
* 
id
);

28 
boŞ
 
FšdP»vNode
(cÚ¡ 
¡d
::
veùÜ
<¡d::
¡ršg
>& 
nodes
,

29 
¡d
::
¡ršg
* 
´ev
);

30 
CheckL—d”
();

31 
OnG‘Chd»n
(cÚ¡ 
G‘Chd»nResuÉ
& 
»suÉ
);

32 
W©chP»v
(cÚ¡ 
NodeEv’t
& 
ev’t
);

33 
OnP»vExi¡s
(cÚ¡ 
Exi¡sResuÉ
& 
»suÉ
,

34 cÚ¡ 
¡d
::
¡ršg
& 
´ev
);

36 
Cage
* 
	gÿge_
;

37 
	g¡d
::
¡ršg
 
roÙ_
;

38 
NÙif›r
 
	gnÙif›r_
;

39 
Sequ’tŸlNode
 
	g£lf_
;

	@/home/libin3-s/ldd/cage/result.h

1 #iâdeà
LDD_CAGE_RESULTS_H_


2 
	#LDD_CAGE_RESULTS_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<boo¡/±r_cÚš”/±r_veùÜ.hµ
>

7 
	~"ldd/ÿge/İ.h
"

8 
	~"ldd/ÿge/aş.h
"

9 
	~"ldd/ÿge/¡©.h
"

10 
	~"ldd/ÿge/¡©us.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÿge
 {

15 
	sAddAuthResuÉ
 {

16 
	gvœtu®
 ~
AddAuthResuÉ
() {}

17 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

20 
	sC»©eResuÉ
 {

21 
	gvœtu®
 ~
C»©eResuÉ
() {}

22 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

23 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
& 
·th_ü—‹d
() const = 0;

26 
	sD–‘eResuÉ
 {

27 
	gvœtu®
 ~
D–‘eResuÉ
() {}

28 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

31 
	sExi¡sResuÉ
 {

32 
	gvœtu®
 ~
Exi¡sResuÉ
() {}

33 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

34 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
() const = 0;

37 
	sG‘ResuÉ
 {

38 
	gvœtu®
 ~
G‘ResuÉ
() {}

39 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

40 
vœtu®
 cÚ¡ 
	g¡d
::
¡ršg
& 
d©a
() const = 0;

41 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
() const = 0;

44 
	sS‘ResuÉ
 {

45 
	gvœtu®
 ~
S‘ResuÉ
() {}

46 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

47 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
() const = 0;

50 
	sG‘AşResuÉ
 {

51 
	gvœtu®
 ~
G‘AşResuÉ
() {}

52 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

53 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
Aş
>& 
aşs
() const = 0;

54 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
() const = 0;

57 
	sS‘AşResuÉ
 {

58 
	gvœtu®
 ~
S‘AşResuÉ
() {}

59 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

62 
	sG‘Chd»nResuÉ
 {

63 
	gvœtu®
 ~
G‘Chd»nResuÉ
() {}

64 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

65 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>& 
chd»n
() const = 0;

68 
	sG‘Chd»nW™hStResuÉ
 {

69 
	gvœtu®
 ~
G‘Chd»nW™hStResuÉ
() {}

70 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

71 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
>& 
chd»n
() const = 0;

72 
vœtu®
 cÚ¡ 
	gSt
& 
¡©
() const = 0;

75 
	sMuÉiResuÉ
 {

76 
	gvœtu®
 ~
MuÉiResuÉ
() {}

77 
vœtu®
 cÚ¡ 
	gStus
& 
¡©us
() const = 0;

78 
vœtu®
 cÚ¡ 
	g¡d
::
veùÜ
<
Op
::
ResuÉ
*>& 
»suÉs
() const = 0;

	@/home/libin3-s/ldd/cage/retry_policy.h

4 #iâdeà
LDD_CAGE_RETRY_POLICY_H_


5 
	#LDD_CAGE_RETRY_POLICY_H_


	)

7 
	~<ldd/ut/time_diff.h
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÿge
 {

12 şas 
	cR‘ryPŞicy
 {

13 
	gpublic
:

14 
vœtu®
 ~
R‘ryPŞicy
() {}

15 
vœtu®
 
boŞ
 
ShouldR‘ry
(
»Œy_couÁ
,

16 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
–­£d
,†dd::ut::TimeDiff* 
wa™
) = 0;

18 
R‘ryPŞicy
* 
NewR‘ryNTimesPŞicy
(

19 
n
, cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
wa™
);

	@/home/libin3-s/ldd/cage/stat.h

1 #iâdeà
LDD_CAGE_STAT_H_


2 
	#LDD_CAGE_STAT_H_


	)

4 
	~<zook“³r/zook“³r.ju‹.h
>

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gÿge
 {

9 
	gSt
 : 
public
 ::
St
 {

10 
St
(è{ 
CË¬
(); }

11 ~
St
() {}

13 
CË¬
() {

14 
	gczxid
 = 0;

15 
	gmzxid
 = 0;

16 
	gùime
 = 0;

17 
	gmtime
 = 0;

18 
	gv”siÚ
 = 0;

19 
	gcv”siÚ
 = 0;

20 
	gav”siÚ
 = 0;

21 
	g•hem”®OwÃr
 = 0;

22 
	gd©aL’gth
 = 0;

23 
	gnumChd»n
 = 0;

24 
	gpzxid
 = 0;

27 
St
(cÚ¡ ::Sˆ&
¡©
) {

28 *
this
 = 
¡©
;

31 cÚ¡ 
	gSt
& 
	gİ”©Ü
 = (cÚ¡ ::
St
 &
¡©
) {

32 
czxid
 = 
¡©
.czxid;

33 
	gmzxid
 = 
¡©
.
mzxid
;

34 
	gùime
 = 
¡©
.
ùime
;

35 
	gmtime
 = 
¡©
.
mtime
;

36 
	gv”siÚ
 = 
¡©
.
v”siÚ
;

37 
	gcv”siÚ
 = 
¡©
.
cv”siÚ
;

38 
	gav”siÚ
 = 
¡©
.
av”siÚ
;

39 
	g•hem”®OwÃr
 = 
¡©
.
•hem”®OwÃr
;

40 
	gd©aL’gth
 = 
¡©
.
d©aL’gth
;

41 
	gnumChd»n
 = 
¡©
.
numChd»n
;

42 
	gpzxid
 = 
¡©
.
pzxid
;

43  *
	gthis
;

	@/home/libin3-s/ldd/cage/status.h

1 #iâdeà
LDD_CAGE_STATUS_H_


2 
	#LDD_CAGE_STATUS_H_


	)

4 
	~<zook“³r/zook“³r.h
>

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gÿge
 {

9 şas 
	cStus
 {

10 
	gpublic
:

11 
	eCode
 {

12 
kOk
 = 
ZOK
,

14 
	gkSy¡emE¼Ü
 = 
ZSYSTEMERROR
,

15 
	gkRuÁimeIncÚsi¡’cy
 = 
ZRUNTIMEINCONSISTENCY
,

16 
	gkD©aIncÚsi¡’cy
 = 
ZDATAINCONSISTENCY
,

17 
	gkCÚÃùiÚLoss
 = 
ZCONNECTIONLOSS
,

18 
	gkM¬sh®lšgE¼Ü
 = 
ZMARSHALLINGERROR
,

19 
	gkUnim¶em’‹d
 = 
ZUNIMPLEMENTED
,

20 
	gkO³¿tiÚTimeout
 = 
ZOPERATIONTIMEOUT
,

21 
	gkBadArgum’ts
 = 
ZBADARGUMENTS
,

22 
	gkInv®idS‹
 = 
ZINVALIDSTATE
,

24 
	gkApiE¼Ü
 = 
ZAPIERROR
,

25 
	gkNoNode
 = 
ZNONODE
,

26 
	gkNoAuth
 = 
ZNOAUTH
,

27 
	gkBadV”siÚ
 = 
ZBADVERSION
,

28 
	gkNoChd»nFÜEphem”®s
 = 
ZNOCHILDRENFOREPHEMERALS
,

29 
	gkNodeExi¡s
 = 
ZNODEEXISTS
,

30 
	gkNÙEm±y
 = 
ZNOTEMPTY
,

31 
	gkSessiÚExpœed
 = 
ZSESSIONEXPIRED
,

32 
	gkInv®idC®lback
 = 
ZINVALIDCALLBACK
,

33 
	gkInv®idACL
 = 
ZINVALIDACL
,

34 
	gkAuthFaed
 = 
ZAUTHFAILED
,

35 
	gkClosšg
 = 
ZCLOSING
,

36 
	gkNÙhšg
 = 
ZNOTHING
,

37 
	gkSessiÚMoved
 = 
ZSESSIONMOVED
,

40 
Stus
(è: 
code_
(
kOk
) {}

41 
Stus
(
code
è: 
code_
(code) {}

42 
Stus
& 
İ”©Ü
 = (
code
è{ 
code_
 = code;  *
	gthis
; }

44 
boŞ
 
	gİ”©Ü
 =ğ(cÚ¡ 
Stus
 &
rhs
è{  
code
() ==„hs.code(); }

45 
boŞ
 
	gİ”©Ü
 !ğ(cÚ¡ 
Stus
 &
rhs
è{  
code
() !=„hs.code(); }

47 
code
(ècÚ¡ {  
	gcode_
; }

49 
boŞ
 
IsOk
(ècÚ¡ {  
code
(è=ğ
kOk
; }

51 
boŞ
 
IsSy¡emE¼Ü
() const {

52  (
code
(è< 
	gkSy¡emE¼Ü
è&& (code(è> 
	gkApiE¼Ü
);

54 
boŞ
 
IsRuÁimeIncÚsi¡’cy
(ècÚ¡ { 
code
(è==
kRuÁimeIncÚsi¡’cy
;}

55 
boŞ
 
IsD©aIncÚsi¡’cy
(ècÚ¡ {  
code
(è=ğ
kD©aIncÚsi¡’cy
; }

56 
boŞ
 
IsCÚÃùiÚLoss
(ècÚ¡ {  
code
(è=ğ
kCÚÃùiÚLoss
; }

57 
boŞ
 
IsM¬sh®lšgE¼Ü
(ècÚ¡ {  
code
(è=ğ
kM¬sh®lšgE¼Ü
; }

58 
boŞ
 
IsUnim¶em’‹d
(ècÚ¡ {  
code
(è=ğ
kUnim¶em’‹d
; }

59 
boŞ
 
IsO³¿tiÚTimeout
(ècÚ¡ {  
code
(è=ğ
kO³¿tiÚTimeout
; }

60 
boŞ
 
IsBadArgum’ts
(ècÚ¡ {  
code
(è=ğ
kBadArgum’ts
; }

61 
boŞ
 
IsInv®idS‹
(ècÚ¡ {  
code
(è=ğ
kInv®idS‹
; }

63 
boŞ
 
IsApiE¼Ü
(ècÚ¡ {  
code
(è< 
	gkApiE¼Ü
; }

64 
boŞ
 
IsNoNode
(ècÚ¡ {  
code
(è=ğ
kNoNode
; }

65 
boŞ
 
IsNoAuth
(ècÚ¡ {  
code
(è=ğ
kNoAuth
; }

66 
boŞ
 
IsBadV”siÚ
(ècÚ¡ {  
code
(è=ğ
kBadV”siÚ
; }

67 
boŞ
 
IsNoChd»nFÜEphem”®s
() const {

68  
code
(è=ğ
kNoChd»nFÜEphem”®s
; }

69 
boŞ
 
IsNodeExi¡s
(ècÚ¡ {  
code
(è=ğ
kNodeExi¡s
; }

70 
boŞ
 
IsNÙEm±y
(ècÚ¡ {  
code
(è=ğ
kNÙEm±y
; }

71 
boŞ
 
IsSessiÚExpœed
(ècÚ¡ {  
code
(è=ğ
kSessiÚExpœed
; }

72 
boŞ
 
IsInv®idC®lback
(ècÚ¡ {  
code
(è=ğ
kInv®idC®lback
; }

73 
boŞ
 
IsInv®idACL
(ècÚ¡ {  
code
(è=ğ
kInv®idACL
; }

74 
boŞ
 
IsAuthFaed
(ècÚ¡ {  
code
(è=ğ
kAuthFaed
; }

75 
boŞ
 
IsClosšg
(ècÚ¡ {  
code
(è=ğ
kClosšg
; }

76 
boŞ
 
IsNÙhšg
(ècÚ¡ {  
code
(è=ğ
kNÙhšg
; }

77 
boŞ
 
IsSessiÚMoved
(ècÚ¡ {  
code
(è=ğ
kSessiÚMoved
; }

79 cÚ¡ *
ToSŒšg
(ècÚ¡ {  
z”rÜ
(
code_
); }

80 
	g´iv©e
:

81 
code_
;

	@/home/libin3-s/ldd/cage/util.h

4 #iâdeà
LDD_CAGE_UTIL_H_


5 
	#LDD_CAGE_UTIL_H_


	)

7 
	~<¡ršg
>

8 
	~<¡dšt.h
>

9 
	~<s¡»am
>

10 
	~<boo¡/İ”©Üs.hµ
>

11 
	~<boo¡/®gÜ™hm/¡ršg/Œim.hµ
>

12 
	~<boo¡/®gÜ™hm/¡ršg/još.hµ
>

13 
	~<boo¡/®gÜ™hm/¡ršg/şassifiÿtiÚ.hµ
>

14 
	~<boo¡/assign/li¡_of.hµ
>

16 
Çme¥aû
 
	gldd
 {

17 
Çme¥aû
 
	gÿge
 {

19 
şass
 
	gSequ’tŸlNode
 : 
boo¡
::
Ëss_thª_com·¿bË
<
Sequ’tŸlNode
> {

20 
public
:

21 
Sequ’tŸlNode
(cÚ¡ 
¡d
::
¡ršg
& 
´efix
);

22 
boŞ
 
P¬£
(cÚ¡ 
¡d
::
¡ršg
& 
Çme
);

23 
CË¬
(è{  
	gÇme_
.
ş—r
(); 
	g£qu’û_
 = 0; }

24 
boŞ
 
IsV®id
(ècÚ¡ {  !
	gÇme_
.
em±y
(); }

26 cÚ¡ 
	g¡d
::
¡ršg
& 
´efix
(ècÚ¡ {  
´efix_
; }

27 cÚ¡ 
	g¡d
::
¡ršg
& 
Çme
(ècÚ¡ {  
Çme_
; }

28 
ušt32_t
 
£qu’û
(ècÚ¡ {  
	g£qu’û_
; }

29 
boŞ
 
	gİ”©Ü
 < (cÚ¡ 
	gSequ’tŸlNode
& 
	grhs
) const;

30 
	g´iv©e
:

31 
¡d
::
¡ršg
 
´efix_
;

32 
	g¡d
::
¡ršg
 
Çme_
;

33 
ušt32_t
 
	g£qu’û_
;

36 
	g‹m¶©e
 <
şass
 
	gSequ’ûSequ’ûT
>

37 
šlše
 
ty³Çme
 
	gboo¡
::
¿nge_v®ue
<
Sequ’ûSequ’ûT
>::
ty³


38 
JošP©h
(cÚ¡ 
Sequ’ûSequ’ûT
& 
s
) {

39 
ty³Çme
 
	tboo¡
::
	t¿nge_v®ue
<
	tSequ’ûSequ’ûT
>::
	tty³
 
	tResuÉT
;

40 
ty³Çme
 
	tboo¡
::
	t¿nge_cÚ¡_™”©Ü
<
	tSequ’ûSequ’ûT
>::
	tty³
 
	tI‹rT
;

41 cÚ¡ 
ResuÉT
 
	gkSÏsh
 = "/";

42 cÚ¡ 
ResuÉT
 
	gkEm±y
 = "";

44 
I‹rT
 
	gpos
 = 
boo¡
::
begš
(
s
);

45 
I‹rT
 
	g’d
 = 
boo¡
::
’d
(
s
);

46 
	g¡d
::
veùÜ
<
ResuÉT
> 
–em’ts
(1, 
kEm±y
);

47 ; 
	gpos
 !ğ
’d
; ++pos) {

48 
ResuÉT
 
	g–em’t
 = 
boo¡
::
Œim_cİy_if
(*
pos
, boo¡::
is_ªy_of
(
kSÏsh
));

49 ià(
	gboo¡
::
em±y
(
–em’t
)) {

52 
	g–em’ts
.
push_back
(
–em’t
);

54  
	gboo¡
::
još
(
–em’ts
, 
kSÏsh
);

57 
šlše
 
	g¡d
::
¡ršg
 
JošP©h
(cÚ¡ 
¡d
::¡ršg& 
p1
, cÚ¡ std::¡ršg& 
p2
) {

58  
JošP©h
(
boo¡
::
assign
::
li¡_of
(
p1
)(
p2
));

61 
šlše
 
	g¡d
::
¡ršg
 
JošP©h
(cÚ¡ 
¡d
::¡ršg& 
p1
, cÚ¡ std::¡ršg& 
p2
,

62 cÚ¡ 
¡d
::
¡ršg
& 
p3
) {

63  
JošP©h
(
boo¡
::
assign
::
li¡_of
(
p1
)(
p2
)(
p3
));

66 
šlše
 
	g¡d
::
¡ršg
 
JošP©h
(cÚ¡ 
¡d
::¡ršg& 
p1
, cÚ¡ std::¡ršg& 
p2
,

67 cÚ¡ 
¡d
::
¡ršg
& 
p3
, cÚ¡ std::¡ršg& 
p4
) {

68  
JošP©h
(
boo¡
::
assign
::
li¡_of
(
p1
)(
p2
)(
p3
)(
p4
));

71 
šlše
 
	g¡d
::
¡ršg
 
JošP©h
(cÚ¡ 
¡d
::¡ršg& 
p1
, cÚ¡ std::¡ršg& 
p2
,

72 cÚ¡ 
¡d
::
¡ršg
& 
p3
, cÚ¡ std::¡ršg& 
p4
,

73 cÚ¡ 
¡d
::
¡ršg
& 
p5
) {

74  
JošP©h
(
boo¡
::
assign
::
li¡_of
(
p1
)(
p2
)(
p3
)(
p4
)(
p5
));

77 
šlše
 
	g¡d
::
¡ršg
 
JošP©h
(cÚ¡ 
¡d
::¡ršg& 
p1
, cÚ¡ std::¡ršg& 
p2
,

78 cÚ¡ 
¡d
::
¡ršg
& 
p3
, cÚ¡ std::¡ršg& 
p4
,

79 cÚ¡ 
¡d
::
¡ršg
& 
p5
, cÚ¡ std::¡ršg& 
p6
) {

80  
JošP©h
(
boo¡
::
assign
::
li¡_of
(
p1
)(
p2
)(
p3
)(
p4
)(
p5
)(
p6
));

83 
	g¡d
::
¡ršg
 
G‘L—f
(cÚ¡ 
¡d
::¡ršg& 
·th
);

84 
	g¡d
::
¡ršg
 
RemoveL—f
(cÚ¡ 
¡d
::¡ršg& 
·th
);

	@/home/libin3-s/ldd/client/client.h

2 #iâdeà
__LDD_CLIENT_RAW_CLIENT__H_


3 
	#__LDD_CLIENT_RAW_CLIENT__H_


	)

5 
	~<Œ1/funùiÚ®
>

6 
	~<¡ršg
>

8 
Çme¥aû
 
	gldd
 {

9 
Çme¥aû
 
	gÃt
{

10 
şass
 
	gCl›Á
;

11 
şass
 
	gEv’tLoİ
;

18 
Çme¥aû
 
	gldd
 {

19 
Çme¥aû
 
	gş›Á
 {

20 
Çme¥aû
 
	g¿w
 {

28 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	tšt64_t
 
	tv”siÚ
,

29 cÚ¡ 
	t¡d
::
	t¡ršg
& 
	tv®ue
, 
	tušt32_t
 
	t‰l
)>
	tD©aCom¶‘iÚ
;

31 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	tšt64_t
 
	tv”siÚ
,

32 
	tušt32_t
 
	t‰l
)>
	tCheckCom¶‘iÚ
;

34 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	tšt64_t
 
	tv”siÚ
)>
	tMu‹Com¶‘iÚ
;

36 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	tšt64_t
 
	tv”siÚ
,

37 cÚ¡ 
	t¡d
::
	t¡ršg
& 
	tv®ue
)>
	tCasCom¶‘iÚ
;

40 
	eş›Á_code
{

41 
	gkOK
 = 0 ,

43 
	gkCªûl
 = -800,

44 
	gkFaed
 = -801

47 
şass
 
	gRedoPŞicy
;

48 
	sO±iÚs
 {

49 
O±iÚs
(è: 
time_out
(0), 
½
(
NULL
){

53 
	g»cv_timeout
 ;

54 
	gdÚe_timeout
 ;

56 
št64_t
 
	gtime_out
;

57 
RedoPŞicy
* 
	g½
;

60 şas 
	cMutiÚ


62 
	gpublic
:

66 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

67 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
, 
ušt64_t
 
‰l
);

69 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

70 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
, 
ušt64_t
 
‰l
,

71 
št64_t
 
ex³ùed_v”siÚ
);

73 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

74 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
, 
ušt64_t
 
‰l
,

75 cÚ¡ 
¡d
::
¡ršg
& 
ex³ùed_v®ue
);

77 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

78 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
, 
ušt64_t
 
‰l
,

79 
št64_t
 
ex³ùed_v”siÚ
,

80 cÚ¡ 
¡d
::
¡ršg
& 
ex³ùed_v®ue
);

85 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
);

88 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

89 
št64_t
 
ex³ùed_v”siÚ
);

91 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

92 cÚ¡ 
¡d
::
¡ršg
& 
ex³ùed_v®ue
);

94 
MutiÚ
(cÚ¡ 
¡d
::
¡ršg
& 
ns
,cÚ¡ std::¡ršg& 
key
,

95 
št64_t
 
ex³ùed_v”siÚ
,

96 cÚ¡ 
¡d
::
¡ršg
& 
ex³ùed_v®ue
);

98 
	g´iv©e
:

99 
ä›nd
 
şass
 
Mu‹Reque¡
;

100 
MutiÚ
(const Mutation&);

101 
	gMutiÚ
& 
	gİ”©Ü
=(cÚ¡ 
MutiÚ
&);

104 
	g¡d
::
¡ršg
 
Çme_¥aû_
;

105 
	g¡d
::
¡ršg
 
key_
;

107 
ušt8_t
 
	gİt_ty³_
;

108 
ušt8_t
 
	ghas_ex³ùed_v”siÚ_
;

109 
št64_t
 
	gex³ùed_v”siÚ_
;

110 
ušt8_t
 
	ghas_ex³ùed_v®_
;

111 
	g¡d
::
¡ršg
 
ex³ùed_v®ue_
;

113 
	g¡d
::
¡ršg
 
v®ue_
;

114 
ušt8_t
 
	ghas_‰l_
;

115 
ušt64_t
 
	g‰l_
;

118 
şass
 
	gProvid”
;

121 şas 
	cCl›Á
 {

122 
	gpublic
:

123 
Cl›Á
();

124 
	gvœtu®
 ~
Cl›Á
();

127 
vœtu®
 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

128 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
) = 0;

130 
vœtu®
 
Check
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

131 cÚ¡ 
CheckCom¶‘iÚ
& 
com¶‘iÚ
) = 0;

132 
vœtu®
 
Mu‹
(cÚ¡ 
MutiÚ
& 
mutiÚ
, cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
) = 0;

134 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

135 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
,

136 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
) = 0;

138 
vœtu®
 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

139 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
) = 0;

141 
vœtu®
 
Li¡
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

142 
ušt32_t
 
u32lim™_
, 
ušt8_t
 
u8pos™iÚ_
,

143 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
) = 0;

145 
vœtu®
 
Inü
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

146 
št32_t
 
s32İ”ªd
, iÁ32_ˆ
s32š™Ÿl
,

147 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
) = 0;

149 
vœtu®
 
Aµ’d
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

150 
ušt8_t
 
u8pos™iÚ
, cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹Á
,

151 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
) = 0;

155 
Cl›Á
* 
NewCl›Á
(
Ãt
::Cl›Á* 
ş›Á
,‚‘::
Ev’tLoİ
* 
ev’t_loİ
,

156 
Provid”
* 
´ovid”
, cÚ¡ 
O±iÚs
& 
İtiÚ
);

	@/home/libin3-s/ldd/client/internal/atomic_append.h

1 #iâdeà
__LDD_CLIENT_RAW_ATOMIC_APPEND__H_


2 
	#__LDD_CLIENT_RAW_ATOMIC_APPEND__H_


	)

4 
	~"ldd/Ãt/outgošg_msg.h
"

6 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

8 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

9 
	~"ş›Á_im¶.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gş›Á
 {

14 
Çme¥aû
 
	g¿w
 {

16 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

18 
şass
 
	gAtomicAµ’dReque¡
 :

19 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_APPEND
> {

20 
public
:

21 
AtomicAµ’dReque¡
(
Cl›ÁIm¶
* 
ù
, cÚ¡ 
¡d
::
¡ršg
& 
ns
,

22 cÚ¡ 
¡d
::
¡ršg
& 
key
,

23 
ušt8_t
 
u8pos™iÚ
, cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹Á
,

24 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
,

25 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
, 
usšg_pÜt
,

26 
RedoPŞicy
* 
½
);

28 
	gvœtu®
 ~
AtomicAµ’dReque¡
() {}

31 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

33 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

34 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

35 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

36 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

39 
	g´iv©e
:

40 
Cl›ÁIm¶
* 
ş›Á_
;

41 
	g¡d
::
¡ršg
 
ns_
;

42 
	g¡d
::
¡ršg
 
key_
;

43 
ušt8_t
 
	gu8pos™iÚ_
;

44 
	g¡d
::
¡ršg
 
cÚ‹Á_
;

45 
ušt64_t
 
	gu64‰l_
;

46 
CasCom¶‘iÚ
 
	gÿs_com¶‘iÚ_
;

47 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

48 
	gusšg_pÜt_
;

49 
RedoPŞicy
* 
	g½_
;

51 
	g´ÙocŞ
::
CasRe¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/atomic_incr.h

1 #iâdeà
__LDD_CLIENT_RAW_ATOMIC_INCR__H_


2 
	#__LDD_CLIENT_RAW_ATOMIC_INCR__H_


	)

5 
	~"ldd/Ãt/outgošg_msg.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

8 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

11 
	~"ş›Á_im¶.h
"

13 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

15 
Çme¥aû
 
	gldd
 {

16 
Çme¥aû
 
	gş›Á
 {

17 
Çme¥aû
 
	g¿w
 {

19 
şass
 
	gAtomicInüReque¡
 :

20 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_INCR
>{

21 
public
:

22 
AtomicInüReque¡
(
Cl›ÁIm¶
* 
ù
, cÚ¡ 
¡d
::
¡ršg
& 
ns
,

23 cÚ¡ 
¡d
::
¡ršg
& 
key
,

24 
št32_t
 
s32İ”ªd
, iÁ32_ˆ
s32š™Ÿl
,

25 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
,

26 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
, 
usšg_pÜt
,

27 
RedoPŞicy
* 
½
);

29 
	gvœtu®
 ~
AtomicInüReque¡
() {}

31 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

33 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

34 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

35 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

36 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

38 
	g´iv©e
:

39 
Cl›ÁIm¶
* 
ş›Á_
;

40 
	g¡d
::
¡ršg
 
ns_
;

41 
	g¡d
::
¡ršg
 
key_
;

42 
št32_t
 
	gs32İ”ªd_
;

43 
št32_t
 
	gs32š™Ÿl_
;

44 
ušt64_t
 
	gu64‰l_
;

45 
CasCom¶‘iÚ
 
	gÿs_com¶‘iÚ_
;

46 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

47 
	gusšg_pÜt_
;

48 
RedoPŞicy
* 
	g½_
;

50 
	g´ÙocŞ
::
CasRe¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/check.h

1 #iâdeà
__LDD_CLIENT_RAW_CHECK__H_


2 
	#__LDD_CLIENT_RAW_CHECK__H_


	)

5 
	~"ldd/Ãt/outgošg_msg.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

8 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

11 
	~"ş›Á_im¶.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gş›Á
 {

14 
Çme¥aû
 
	g¿w
 {

16 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

18 
şass
 
	gCheckReque¡
 : 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_CHECK
>{

19 
public
:

20 
CheckReque¡
(
Cl›ÁIm¶
* 
ù
, cÚ¡ 
¡d
::
¡ršg
&
ns
, cÚ¡ std::¡ršg& 
key
,

21 cÚ¡ 
CheckCom¶‘iÚ
& 
com¶‘e
,

22 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
,

23 
usšg_pÜt
,

24 
RedoPŞicy
* 
½
);

25 
	gvœtu®
 ~
CheckReque¡
() {}

27 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

28 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

29 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

30 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

31 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

32 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

47 
	g´iv©e
:

48 
Cl›ÁIm¶
* 
ş›Á_
;

49 
	g¡d
::
¡ršg
 
ns_
;

50 
	g¡d
::
¡ršg
 
key_
;

51 
CheckCom¶‘iÚ
 
	gcheck_com¶‘iÚ_
;

52 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

53 
	gusšg_pÜt_
;

54 
RedoPŞicy
* 
	g½_
;

56 
	g´ÙocŞ
::
CheckRe¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/client_impl.h

1 #iâdeà
__LDD_CLIENT_RAW_CLIENT_IMPLE__H_


2 
	#__LDD_CLIENT_RAW_CLIENT_IMPLE__H_


	)

4 
	~"ldd/ut/mu‹x.h
"

5 
	~"ldd/Ãt/ş›Á.h
"

6 
	~"ldd/Ãt/chªÃl.h
"

7 
	~"ldd/Ãt/outgošg_msg.h
"

9 
	~"../ş›Á.h
"

10 
	~"../´ovid”.h
"

13 
Çme¥aû
 
	gldd
 {

14 
Çme¥aû
 
	gş›Á
 {

15 
Çme¥aû
 
	g¿w
 {

17 
şass
 
	gRedoPŞicy
;

18 şas 
	cCl›ÁIm¶
 : 
public
 
Cl›Á
{

19 
public
:

20 
Cl›ÁIm¶
(
Ãt
::
Cl›Á
* 
ş›Á
,

21 
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
,

22 
Provid”
 *
´ovid”
,

23 cÚ¡ 
O±iÚs
 &
İtiÚ
);

24 ~
Cl›ÁIm¶
();

25 
boŞ
 
In™
();

27 
g‘_»cv_timeout
(){

28  
	gİtiÚ_
.
	g»cv_timeout
;

31 
g‘_dÚe_timeout
(){

32  
	gİtiÚ_
.
	gdÚe_timeout
;

35 
vœtu®
 
G‘
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

36 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
);

38 
vœtu®
 
Check
(cÚ¡ 
¡d
::
¡ršg
& 
ns
,cÚ¡ std::¡ršg& 
key
,

39 cÚ¡ 
CheckCom¶‘iÚ
& 
com¶‘iÚ
) ;

41 
vœtu®
 
Li¡
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

42 
ušt32_t
 
u32lim™_
, 
ušt8_t
 
u8pos™iÚ_
,

43 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
);

45 
vœtu®
 
Mu‹
(cÚ¡ 
MutiÚ
& 
mutiÚ
,

46 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
);

48 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

49 cÚ¡ 
¡d
::
¡ršg
& 
v®ue
,

50 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
) ;

52 
vœtu®
 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

53 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
);

55 
vœtu®
 
Inü
(cÚ¡ 
¡d
::
¡ršg
& 
ns
,cÚ¡ std::¡ršg& 
key
,

56 
št32_t
 
s32İ”ªd_
, iÁ32_ˆ
s32š™Ÿl_
,

57 
ušt64_t
 
u64‰l_
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
);

59 
vœtu®
 
Aµ’d
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

60 
ušt8_t
 
u8pos™iÚ
, cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹Á
,

61 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
);

64 
	gpublic
:

65 
G‘
(cÚ¡ 
¡d
::
¡ršg
&
ns
, cÚ¡ std::¡ršg& 
key
,

66 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
,

67 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

68 
Check
(cÚ¡ 
¡d
::
¡ršg
& 
ns
,cÚ¡ std::¡ršg& 
key
,

69 cÚ¡ 
CheckCom¶‘iÚ
& 
com¶‘iÚ
,

70 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

72 
Li¡
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

73 
ušt32_t
 
u32lim™_
, 
ušt8_t
 
u8pos™iÚ_
,

74 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
,

75 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

77 
Mu‹
(cÚ¡ 
MutiÚ
& 
mutiÚ
, cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
,

78 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

80 
Inü
(cÚ¡ 
¡d
::
¡ršg
& 
ns
,cÚ¡ std::¡ršg& 
key
,

81 
št32_t
 
s32İ”ªd_
, iÁ32_ˆ
s32š™Ÿl_
,

82 
ušt64_t
 
u64‰l_
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
,

83 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

85 
Aµ’d
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

86 
ušt8_t
 
u8pos™iÚ
, cÚ¡ 
¡d
::
¡ršg
& 
cÚ‹Á
,

87 
ušt64_t
 
u64‰l
, cÚ¡ 
CasCom¶‘iÚ
& 
com¶‘iÚ
,

88 cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, 
f‹r_pÜt
, 
RedoPŞicy
* 
½
);

90 
boŞ
 
G‘ChªÃl
(cÚ¡ 
¡d
::
¡ršg
& 
f‹r_ho¡
, cÚ¡ 
f‹r_pÜt
,

91 
¡d
::
¡ršg
& 
usšg_ho¡
, & 
usšg_pÜt
,

92 
boo¡
::
sh¬ed_±r
<
Ãt
::
ChªÃl
>& 
chªÃl
);

94 
NodeLi¡ChªgedNÙify
(
”r_code
, 
cour›r
::
NodeChªgedTy³
 
ty³
,

95 cÚ¡ 
¡d
::
¡ršg
& 
node
);

97 
	g´iv©e
:

98 
¡d
::
	t·œ
<
	t¡d
::
	t¡ršg
, > 
	tHo¡PÜt
;

100 
	gÃt
::
Cl›Á
* 
ş›Á_
;

101 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ_
;

102 
Provid”
* 
	g´ovid”_
;

103 
O±iÚs
 
	gİtiÚ_
;

105 
	g´oxy_šdex_
;

107 
	gut
::
RWMu‹x
 
rwmtx_
;

108 
	g¡d
::
m­
<
Ho¡PÜt
, 
	gboo¡
::
sh¬ed_±r
<
Ãt
::
ChªÃl
> > 
nodes_
;

109 
	g¡d
::
veùÜ
<
Ho¡PÜt
> 
Üd”ed_nodes_
;

110 
RedoPŞicy
* 
	g»do_pŞicy_
;

111 
	gcb_id_
;

	@/home/libin3-s/ldd/client/internal/get.h

1 #iâdeà
__LDD_CLIENT_RAW_GET__H_


2 
	#__LDD_CLIENT_RAW_GET__H_


	)

5 
	~<sys/time.h
>

6 
	~"ldd/Ãt/outgošg_msg.h
"

7 
	~"ldd/ut/mu‹x.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
	~"ş›Á_im¶.h
"

15 
Çme¥aû
 
	gldd
 {

16 
Çme¥aû
 
	gş›Á
 {

17 
Çme¥aû
 
	g¿w
 {

19 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

21 
şass
 
	gG‘Reque¡
 : 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_GET
> {

22 
public
:

23 
G‘Reque¡
(
Cl›ÁIm¶
* 
ù
, cÚ¡ 
¡d
::
¡ršg
&
ns
, cÚ¡ std::¡ršg& 
key
,

24 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘e
,

25 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
,

26 
usšg_pÜt
,

27 
RedoPŞicy
* 
½
);

29 
	gvœtu®
 ~
G‘Reque¡
() {}

31 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

33 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

34 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

35 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

36 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

38 
	g´iv©e
:

39 
Cl›ÁIm¶
* 
ş›Á_
;

40 
	g¡d
::
¡ršg
 
ns_
;

41 
	g¡d
::
¡ršg
 
key_
;

42 
D©aCom¶‘iÚ
 
	gg‘_com¶‘iÚ_
;

43 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

44 
	gusšg_pÜt_
;

45 
RedoPŞicy
* 
	g½_
;

47 
	g´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/list.h

1 #iâdeà
__LDD_CLIENT_RAW_LIST__H_


2 
	#__LDD_CLIENT_RAW_LIST__H_


	)

4 
	~"ldd/Ãt/outgošg_msg.h
"

5 
	~"ldd/ut/mu‹x.h
"

6 
	~<sys/time.h
>

8 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
	~"ş›Á_im¶.h
"

14 
Çme¥aû
 
	gldd
 {

15 
Çme¥aû
 
	gş›Á
 {

16 
Çme¥aû
 
	g¿w
 {

18 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

20 
şass
 
	gLi¡Reque¡
 : 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_LIST
> {

21 
public
:

22 
Li¡Reque¡
(
Cl›ÁIm¶
* 
ci
, cÚ¡ 
¡d
::
¡ršg
& 
ns
, cÚ¡ std::¡ršg& 
key
,

23 
ušt32_t
 
u32lim™
, 
ušt8_t
 
u8pos™iÚ
,

24 cÚ¡ 
D©aCom¶‘iÚ
& 
com¶‘iÚ
,

25 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
,

26 
usšg_pÜt
,

27 
RedoPŞicy
* 
½
);

28 
	gvœtu®
 ~
Li¡Reque¡
() {}

30 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

31 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

32 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

33 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

34 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

35 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

37 
	g´iv©e
:

38 
Cl›ÁIm¶
* 
ş›Á_
;

39 
	g¡d
::
¡ršg
 
ns_
;

40 
	g¡d
::
¡ršg
 
key_
;

41 
ušt32_t
 
	gu32lim™_
;

42 
ušt8_t
 
	gu8pos™iÚ_
;

43 
D©aCom¶‘iÚ
 
	gcom¶‘iÚ_
;

44 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

45 
	gusšg_pÜt_
;

46 
RedoPŞicy
* 
	g½_
;

48 
	g´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/mutate.h

2 #iâdeà
__LDD_CLIENT_RAW_MUTATE__H_


3 
	#__LDD_CLIENT_RAW_MUTATE__H_


	)

5 
	~"ldd/Ãt/outgošg_msg.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

10 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
	~"ş›Á_im¶.h
"

15 
Çme¥aû
 
	gldd
 {

16 
Çme¥aû
 
	gş›Á
 {

17 
Çme¥aû
 
	g¿w
 {

19 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

21 
şass
 
	gMu‹Reque¡
 : 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_MUTATE
> {

22 
public
:

23 
Mu‹Reque¡
(
Cl›ÁIm¶
* 
ù
, cÚ¡ 
MutiÚ
& 
m
,

24 cÚ¡ 
Mu‹Com¶‘iÚ
& 
com¶‘iÚ
,

25 cÚ¡ 
¡d
::
¡ršg
& 
usšg_ho¡
,

26 
usšg_pÜt
,

27 
RedoPŞicy
* 
½
) ;

29 
	gvœtu®
 ~
Mu‹Reque¡
() {}

31 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

33 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

34 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

35 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

36 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

39 
	g´iv©e
:

40 
Cl›ÁIm¶
* 
ş›Á_
;

42 
	g¡d
::
¡ršg
 
Çme_¥aû_
;

43 
	g¡d
::
¡ršg
 
key_
;

44 
	g¡d
::
¡ršg
 
ex³ùed_v®ue_
;

45 
	g¡d
::
¡ršg
 
v®ue_
;

47 
Mu‹Com¶‘iÚ
 
	gcom¶‘iÚ_
;

48 
	g¡d
::
¡ršg
 
usšg_ho¡_
;

49 
	gusšg_pÜt_
;

50 
RedoPŞicy
* 
	g½_
;

52 
	g´ÙocŞ
::
Mu‹Mes§ge
 
»que¡_
;

53 
	g´ÙocŞ
::
Mu‹Re¥Ú£
 
»¥Ú£_
;

	@/home/libin3-s/ldd/client/internal/str_util.h

1 #iâdeà
__LDD_CLIENT_STRING_UTILITY__H_


2 
	#__LDD_CLIENT_STRING_UTILITY__H_


	)

3 
	~<¡ršg
>

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gş›Á
 {

8 
Çme¥aû
 
	g¿w
 {

11 
boŞ
 
G‘Ho¡Po¡
(cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
, std::¡ršg& 
ho¡
, & 
pÜt
);

	@/home/libin3-s/ldd/client/provider.h

1 #iâdeà
__LDD_CLIENT_RAW_PROVIDER__H_


2 
	#__LDD_CLIENT_RAW_PROVIDER__H_


	)

4 
	~<veùÜ
>

5 
	~<m­
>

6 
	~<¡ršg
>

7 
	~<Œ1/funùiÚ®
>

8 
	~<ldd/ut/mu‹x.h
>

9 
	~"ldd/cour›r/ş›Á.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gş›Á
 {

14 
Çme¥aû
 
	g¿w
 {

16 
	g¡d
::
	tveùÜ
<
	t¡d
::
	t·œ
<¡d::
	t¡ršg
, > > 
	tProxyHo¡s
;

18 şas 
	cProvid”
 {

19 
	gpublic
:

20 
Provid”
(è: 
id_
(0) {}

21 
vœtu®
 ~
Provid”
() {

25 
Regi¡”NÙify
(
cour›r
::
NodeLi¡ChªgedNÙify
 
nÙify
);

26 
UnRegi¡”NÙify
(
id
);

27 
NodeLi¡ChªgedNÙify
(
”r_code
, 
cour›r
::
NodeChªgedTy³
 
ty³
,

28 cÚ¡ 
¡d
::
¡ršg
& 
node
);

30 
vœtu®
 
boŞ
 
In™
() = 0;

31 
	gProxyHo¡s
& 
ho¡s
();

33 
	g´Ùeùed
:

34 
ProxyHo¡s
 
ho¡s_
;

35 
	g¡d
::
m­
<, 
	gcour›r
::
NodeLi¡ChªgedNÙify
> 
v_nÙify_
;

36 
	gut
::
Mu‹x
 
mu‹x_
;

37 
	gid_
;

40 şas 
	cProxySticProvid”
 : 
public
 
Provid”
 {

41 
public
:

42 
ProxySticProvid”
(cÚ¡ * 
ho¡s
);

43 
	gvœtu®
 ~
ProxySticProvid”
() {

46 
vœtu®
 
boŞ
 
In™
();

47 cÚ¡ * 
	gho¡Çme_
;

51 
	gboo¡
::
	tfunùiÚ
<(
	t”r_code
)>
	tHªdËZKERROR
;

52 şas 
	cProxyZkProvid”
 : 
public
 
Provid”
 {

53 
public
:

55 
ProxyZkProvid”
(
¡d
::
¡ršg
 
zk_ho¡
, std::¡ršg 
zk_·th
, 
zk_timeout
);

56 
	gvœtu®
 ~
ProxyZkProvid”
();

58 
vœtu®
 
boŞ
 
In™
();

60 
HªdËE¼Ü
(
”rÜ_code
);

62 
	g´iv©e
:

63 
cour›r
::
Cl›Á
* 
zk_ş›Á_
;

64 
	gcour›r
::
O±iÚs
 
İtiÚ_
;

66 
	g´iv©e
:

67 
»t_
;

68 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
£rv”_li¡_
;

	@/home/libin3-s/ldd/client/redo_policy.h

2 #iâdeà
__LDD_CLIENT_RAW_REDO_POLICY_H_


3 
	#__LDD_CLIENT_RAW_REDO_POLICY_H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

8 
Çme¥aû
 
	gldd
 {

9 
Çme¥aû
 
	gş›Á
 {

10 
Çme¥aû
 
	g¿w
 {

12 şas 
	cRedoPŞicy
{

13 
	gpublic
:

14 
RedoPŞicy
();

15 
	gvœtu®
 ~
RedoPŞicy
();

16 
vœtu®
 
boŞ
 
ShouldR‘y
(
št64_t
 
cur_mli£cÚds
)= 0;

17 
vœtu®
 
RedoPŞicy
* 
Cİy
() = 0;

19 
št64_t
 
FœeTime
();

20 
FœeTime
(
št64_t
 
time
);

21 
št32_t
 
CurTimes
();

23 
	g´Ùeùed
:

24 
Inü
();

26 
	g´iv©e
:

27 
RedoPŞicy
(const RedoPolicy&);

28 
	gRedoPŞicy
& 
	gİ”©Ü
=(cÚ¡ 
RedoPŞicy
&);

29 
	g´iv©e
:

30 
cur_»Œy_times
;

31 
št64_t
 
	gfœe_time_
;

	@/home/libin3-s/ldd/client/redo_simple_policy.h

2 #iâdeà
__LDD_CLIENT_RAW_REDO_POLICY_SIMPLE_H_


3 
	#__LDD_CLIENT_RAW_REDO_POLICY_SIMPLE_H_


	)

5 
	~<¡dšt.h
>

6 
	~"»do_pŞicy.h
"

8 
Çme¥aû
 
	gldd
 {

9 
Çme¥aû
 
	gş›Á
 {

10 
Çme¥aû
 
	g¿w
 {

12 şas 
	cRedoPŞicySim¶e
 : 
public
 
RedoPŞicy
{

13 
public
:

14 
RedoPŞicySim¶e
(
max_»Œy_times
, 
št64_t
 
time_out
);

15 
	gvœtu®
 ~
RedoPŞicySim¶e
();

17 
boŞ
 
ShouldR‘y
(
št64_t
 
cur_mli£cÚds
);

18 
vœtu®
 
RedoPŞicy
* 
Cİy
();

20 
	g´iv©e
:

21 
max_»Œy_times_
;

22 
št64_t
 
	gtime_out_
;

	@/home/libin3-s/ldd/courier/EventList.h

1 #iâdeà
__LDD_COURIER_EVENT_LIST_H_


2 
	#__LDD_COURIER_EVENT_LIST_H_


	)

4 
	~<as£¹.h
>

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

10 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

11 şas 
	cEv’tLi¡
{

12 
	g´iv©e
:

13 
şass
 
Node
;

14 
	gpublic
:

15 
Ev’tLi¡
(
Com·¿tÜ
 
cmp
);

16 ~
Ev’tLi¡
(){

17 
D–Node
(
h—d_
);

20 
In£¹
(cÚ¡ 
Key
& 
key
);

21 
PİFrÚt
();

22 
	gKey
& 
FrÚt
();

23 
boŞ
 
Em±y
();

25 
	g´iv©e
:

28 
Ev’tLi¡
(cÚ¡ Ev’tLi¡& 
a
);

29 
	gİ”©Ü
=(cÚ¡ 
Ev’tLi¡
& 
b
);

31 
Node
* 
NewNode
(cÚ¡ 
Key
& 
key
);

32 
D–Node
(cÚ¡ 
Node
* 
n
);

33 
boŞ
 
KeyIsAá”Node
(cÚ¡ 
Key
& 
key
, 
Node
* 
n
) const;

34 
Node
* 
FšdG»©”OrEqu®
(cÚ¡ 
Key
& 
key
);

35 
	g´iv©e
:

36 
Com·¿tÜ
 cÚ¡ 
com·»_
;

37 
Node
* 
	gh—d_
;

42 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

43 
şass
 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Node
 {

44 
public
:

45 
ex¶ic™
 
Node
(cÚ¡ 
Key
& 
k
è: 
key_
(k), 
Ãxt_
(
NULL
) {}

47 
S‘Next
(
Node
* 
x
){

48 
	gÃxt_
=
x
;

51 
Node
* 
Next
(){

52  
	gÃxt_
;

54 
Key
 
	gkey_
;

55 
	g´iv©e
:

56 
Node
* 
Ãxt_
;

61 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

62 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Ev’tLi¡
(
Com·¿tÜ
 
cmp
)

63 : 
com·»_
(
cmp
), 
h—d_
Ğ
NewNode
(0) ) {

64 
	gh—d_
->
S‘Next
(
NULL
);

68 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

69 
ty³Çme
 
	gEv’tLi¡
<
	gKey
,
	gCom·¿tÜ
>::
Node
* 
Ev’tLi¡
<
Key
, Com·¿tÜ>::
NewNode
(cÚ¡ Key& 
key
){

70 
Node
* 
p
 = 
Ãw
 Node(
key
);

71 
	gp
->
S‘Next
(
NULL
);

72  
	gp
;

75 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

76 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
D–Node
(cÚ¡ 
Node
* 
n
){

77 
d–‘e
 
n
;

81 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

82 
boŞ
 
	gEv’tLi¡
<
	gKey
,
	gCom·¿tÜ
>::
KeyIsAá”Node
(cÚ¡ 
Key
& 
key
, 
Node
* 
n
) const {

84  (
	gn
 !ğ
NULL
è&& (
com·»_
(
n
->
key_
, 
key
) < 0);

88 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

89 
ty³Çme
 
	gEv’tLi¡
<
	gKey
,
	gCom·¿tÜ
>::
Node
* 
Ev’tLi¡
<
Key
,Com·¿tÜ>::
FšdG»©”OrEqu®
(cÚ¡ Key& 
key
){

90 
Node
* 
x
 = 
h—d_
;

92 
	gŒue
){

93 
Node
* 
	gÃxt
 = 
x
->
Next
();

94 if(
KeyIsAá”Node
(
key
, 
Ãxt
)){

95 
	gx
 = 
Ãxt
;

97  
	gx
;

102 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

103 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
In£¹
(cÚ¡ 
Key
& 
key
){

104 
Node
* 
x
ğ
FšdG»©”OrEqu®
(
key
);

105 
Node
* 
	gc
ğ
NewNode
(
key
);

107 
	gc
->
S‘Next
(
x
->
Next
());

108 
	gx
->
S‘Next
(
c
);

111 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

112 
boŞ
 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
Em±y
(){

113  ((
h—d_
->
Next
(è=ğ
NULL
è? 
Œue
 : 
çl£
) ;

116 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

117 
	gKey
& 
	gEv’tLi¡
<Key, 
	gCom·¿tÜ
>::
FrÚt
(){

118 
as£¹
(
h—d_
->
Next
(è!ğ
NULL
);

119  
	gh—d_
->
Next
()->
	gkey_
;

122 
	g‹m¶©e
<
ty³Çme
 
	gKey
, 
şass
 
	gCom·¿tÜ
>

123 
	gEv’tLi¡
<
	gKey
, 
	gCom·¿tÜ
>::
PİFrÚt
(){

124 if(
h—d_
->
Next
(è=ğ
NULL
)

126 
Node
* 
	gx
 = 
h—d_
->
Next
();

127 
	gh—d_
->
S‘Next
(
x
->
Next
());

128 
D–Node
(
x
);

	@/home/libin3-s/ldd/courier/client.h

1 #iâdeà
__LDD_COURIER_CLIENT_H_


2 
	#__LDD_COURIER_CLIENT_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<Œ1/funùiÚ®
>

7 
	~"İtiÚs.h
"

8 
	~"cour›r.h
"

11 
Çme¥aû
 
	gldd
{

12 
Çme¥aû
 
	gcour›r
{

15 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	t”r_code
, 
	tNodeChªgedTy³
 
	tty³
,

16 cÚ¡ 
	t¡d
::
	t¡ršg
& 
	tnode
)>
	tNodeLi¡ChªgedNÙify
;

19 şas 
	cCl›Á
{

20 
	gpublic
:

21 
Cl›Á
();

22 
	gvœtu®
 ~
Cl›Á
();

24 
	gpublic
:

25 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
, cÚ¡ std::¡ršg& 
roÙ_·th
,

26 
Cl›Á
** 
brok”_±r
);

28 
vœtu®
 
G‘ProxyLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

29 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
) = 0;

30 
	g´iv©e
:

31 
Cl›Á
(const Client&);

32 cÚ¡ 
	gCl›Á
& 
	gİ”©Ü
=(cÚ¡ 
Cl›Á
&);

	@/home/libin3-s/ldd/courier/client_impl.h

1 #iâdeà
__LDD_COURIER_CLIENT_IMPLE_H_


2 
	#__LDD_COURIER_CLIENT_IMPLE_H_


	)

5 
	~"ş›Á.h
"

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZkBrok”Cl›Á
;

12 şas 
	cCl›ÁIm¶
 : 
public
 
Cl›Á
{

13 
public
:

14 
Cl›ÁIm¶
();

15 
	gvœtu®
 ~
Cl›ÁIm¶
();

17 
	gpublic
:

18 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
, cÚ¡ std::¡ršg& 
roÙ_·th
,

19 
Cl›ÁIm¶
* 
b
);

22 
vœtu®
 
G‘ProxyLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

23 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
);

24 
S‘ZooK“³rBrok”
(
ZkBrok”Cl›Á
* 
z
);

26 
	g´iv©e
:

27 
Cl›ÁIm¶
(const ClientImpl&);

28 
	gİ”©Ü
=(cÚ¡ 
Cl›ÁIm¶
&);

30 
	g´iv©e
:

31 
ZkBrok”Cl›Á
 * 
zk_ş›Á_brok”_
;

	@/home/libin3-s/ldd/courier/completion_callback.h

2 #iâdeà
__LDD_COURIER_COMPLETION_CALL_BACK_H_


3 
	#__LDD_COURIER_COMPLETION_CALL_BACK_H_


	)

5 
	~<zook“³r/zook“³r.h
>

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

10 
şass
 
	gRedoPŞicy
;

11 şas 
	cCom¶‘iÚC®lBack
{

12 
	gpublic
:

13 
Com¶‘iÚC®lBack
();

14 
	gvœtu®
 ~
Com¶‘iÚC®lBack
();

20 
ZkC»©eCom¶‘iÚ
(
rc
, cÚ¡ * 
v®ue
, cÚ¡ *
d©a
);

25 
ZkExi¡sCom¶‘iÚ
(
rc
, cÚ¡ 
St
 *
¡©
,

26 cÚ¡ *
d©a
);

32 
ZkD–‘eCom¶‘iÚ
(
rc
, cÚ¡ *
d©a
);

38 
ZkG‘Com¶‘iÚ
(
rc
, cÚ¡ * 
v®ue
, 
v®ue_Ën
,

39 cÚ¡ 
St
* 
¡©
, cÚ¡ * 
d©a
);

46 
ZkG‘Chd»nCom¶‘iÚ
(
rc
, cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
,

47 cÚ¡ * 
d©a
);

49 
NÙOkHªdË
(
Com¶‘iÚC®lBack
 * 
cb
, 
rc
);

52 
vœtu®
 
C»©eCom¶‘iÚ
(cÚ¡ * 
v®ue
) {}

53 
vœtu®
 
Exi¡sCom¶‘iÚ
(cÚ¡ 
St
 *
¡©
){}

54 
vœtu®
 
D–‘eCom¶‘iÚ
(){}

55 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

56 cÚ¡ 
St
* 
¡©
){}

57 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
){}

59 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
){};

60 
vœtu®
 
E¼ÜHªdË
(){};

61 
	gpublic
:

62 
S‘RedoPŞicy
(
RedoPŞicy
* 
»do_pŞicy
);

63 
RedoPŞicy
* 
G‘RedoPŞicy
();

65 
	g´iv©e
:

66 
Com¶‘iÚC®lBack
(const CompletionCallBack&);

67 
	gİ”©Ü
=(cÚ¡ 
Com¶‘iÚC®lBack
&);

68 
	g´iv©e
:

69 
RedoPŞicy
* 
»do_pŞicy_c_
;

	@/home/libin3-s/ldd/courier/completion_callback_client.h

1 #iâdeà
__LDD_COURIER_COMPLETION_CALLBACK_CLIENT_H_


2 
	#__LDD_COURIER_COMPLETION_CALLBACK_CLIENT_H_


	)

4 
	~"com¶‘iÚ_ÿÎback.h
"

5 
	~"zkbrok”_ş›Á.h
"

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	gcour›r
{

13 şas 
	cCl›ÁNodeLi¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

14 
public
:

15 
Cl›ÁNodeLi¡CB
(
ZkBrok”Cl›Á
* 
b
): 
brok”_
(b){

17 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
){

18 
	gveùÜ
<
	g¡ršg
> 
	gÃw_li¡
;

21 ià(
	g¡ršgs
->
	gd©a
){

22 
DLOG
(
INFO
)<<"ok ProxyNodeLi¡CB::G‘Chd»À¡ršgs->couÁ: "<<
	g¡ršgs
->
	gcouÁ
;

23 
št32_t
 
	gi
=0; i<
	g¡ršgs
->
	gcouÁ
; i++){

24 * 
	gp
 = 
¡ršgs
->
d©a
[
i
];

25 
¡ršg
 
	gkey
; key = 
p
;

26 
	gÃw_li¡
.
push_back
(
key
);

27 
DLOG
(
INFO
)<<"OK…roxy::ProxyNodeLi¡CB::G‘Chd»ÀNodeKey:"<<
	gkey
;

29 
boŞ
 
	gadded
 =
Œue
;

30 
size_t
 
	gi
=0; i<
	gbrok”_
->
	gnode_cŞËùiÚ_
.
size
(); i++){

31 ià(
	gkey
.
com·»
(
brok”_
->
node_cŞËùiÚ_
[
i
]) == 0 ){

32 
added
 = 
çl£
;

36 ià(
	gadded
 && 
	gbrok”_
->
	gnode_li¡_nÙify_
){

37 
LOG
(
INFO
)<<"´oxy::ProxyNodeLi¡CB::G‘Chd»ÀnÙify wh’‚ew‚odoà·th:"<<
	gkey
;

38 
	gbrok”_
->
node_li¡_nÙify_
(0, 
kC»©eNode
, 
key
);

43 
size_t
 
	gi
=0; i<
	gbrok”_
->
	gnode_cŞËùiÚ_
.
size
(); i++){

44 
boŞ
 
	gd–‘ed
 = 
Œue
;

45 
size_t
 
	gj
=0; j<
	gÃw_li¡
.
size
(); j++){

46 ià(
	gbrok”_
->
	gnode_cŞËùiÚ_
[
i
].
com·»
(
Ãw_li¡
[
j
]) == 0){

47 
d–‘ed
 =
çl£
;

51 ià(
	gd–‘ed
 && 
	gbrok”_
->
	gnode_li¡_nÙify_
){

52 
LOG
(
INFO
)<<"´oxy::nÙify wh’ d–‘nodoà·th:"<<
	gbrok”_
->
	gnode_cŞËùiÚ_
[
i
];

53 
	gbrok”_
->
node_li¡_nÙify_
(0, 
kD–‘eNode
, 
brok”_
->
node_cŞËùiÚ_
[
i
]);

58 
	gut
::
RWMu‹xLock
 
wlock
(
brok”_
->
G‘RwLockPŒ
(), 
Œue
);

59 
	gbrok”_
->
	gnode_cŞËùiÚ_
.
ş—r
();

60 
DLOG
(
INFO
)<<"G‘Chd»nCom¶‘iÚ(ènode_cŞËùiÚ size()="<<
	gÃw_li¡
.
size
();

61 
	gbrok”_
->
	gnode_cŞËùiÚ_
 = 
Ãw_li¡
;

64 
	gbrok”_
->
DeüI‹mNum
();

66 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
){

67 
DLOG
(
WARNING
)<<"proxy::reGetReplicaSize()";

68 
	gbrok”_
->
G‘ProxyLi¡
(
»do_pŞicy_
);

69 
	gbrok”_
->
DeüI‹mNum
();

71 
vœtu®
 
E¼ÜHªdË
(){

72 
LOG
(
ERROR
)<<"proxy::GetNodeList() ErrorHandle() ";

73 
	gbrok”_
->
S‘Cour›rE¼ÜCode
(
kInv®idBa£P¬amInZk
);

74 
	gbrok”_
->
DeüI‹mNum
();

76 
	g´iv©e
:

77 
ZkBrok”Cl›Á
* 
brok”_
;

	@/home/libin3-s/ldd/courier/completion_callback_impl.h

1 #iâdeà
__LDD_COURIER_COMPLETION_CALLBACK_IMPL_H_


2 
	#__LDD_COURIER_COMPLETION_CALLBACK_IMPL_H_


	)

4 
	~"com¶‘iÚ_ÿÎback.h
"

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZooK“³rBrok”
;

13 şas 
	cR•liÿNodeCB
 : 
public
 
Com¶‘iÚC®lBack
{

14 
public
:

15 
R•liÿNodeCB
(
ZooK“³rBrok”
* 
b
): 
brok”_
(b){

18 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

19 cÚ¡ 
St
* 
¡©
);

20 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

21 
vœtu®
 
E¼ÜHªdË
();

22 
	g´iv©e
:

23 
ZooK“³rBrok”
* 
brok”_
;

26 şas 
	cEngšeNodeCB
 : 
public
 
Com¶‘iÚC®lBack
{

27 
public
:

28 
EngšeNodeCB
(
ZooK“³rBrok”
* 
b
): 
brok”_
(b){

31 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

32 cÚ¡ 
St
* 
¡©
);

33 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

34 
vœtu®
 
E¼ÜHªdË
();

35 
	g´iv©e
:

36 
ZooK“³rBrok”
* 
brok”_
;

39 şas 
	cG‘MaxBšLogCB
 : 
public
 
Com¶‘iÚC®lBack
{

40 
public
:

41 
G‘MaxBšLogCB
(
ZooK“³rBrok”
* 
b
): 
brok”_
(b){

44 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

45 cÚ¡ 
St
* 
¡©
);

46 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

47 
vœtu®
 
E¼ÜHªdË
();

48 
	g´iv©e
:

49 
ZooK“³rBrok”
* 
brok”_
;

52 şas 
	cG‘Buck‘SizeCB
 : 
public
 
Com¶‘iÚC®lBack
{

53 
public
:

54 
G‘Buck‘SizeCB
(
ZooK“³rBrok”
* 
b
): 
brok”_
(b){

57 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

58 cÚ¡ 
St
* 
¡©
);

59 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

60 
vœtu®
 
E¼ÜHªdË
();

61 
	g´iv©e
:

62 
ZooK“³rBrok”
* 
brok”_
;

65 şas 
	cBuck‘Li¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

66 
public
:

67 
Buck‘Li¡CB
(
ZooK“³rBrok”
* 
b
): 
brok”_
(b){

70 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

71 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

72 
vœtu®
 
E¼ÜHªdË
();

73 
	g´iv©e
:

74 
ZooK“³rBrok”
* 
brok”_
;

76 şas 
	cG‘F¬mIdOfBuck‘IdCB
 : 
public
 
Com¶‘iÚC®lBack
{

77 
public
:

78 
G‘F¬mIdOfBuck‘IdCB
(
ZooK“³rBrok”
* 
b
, 
¡d
::
¡ršg
& 
buck‘ID
) :

79 
brok”_
(
b
), 
buck‘ID_
(
buck‘ID
){};

81 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

82 cÚ¡ 
St
* 
¡©
);

83 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

84 
vœtu®
 
E¼ÜHªdË
();

85 
	g´iv©e
:

86 
ZooK“³rBrok”
* 
brok”_
;

87 
	g¡d
::
¡ršg
 
buck‘ID_
;

	@/home/libin3-s/ldd/courier/completion_callback_proxy.h

1 #iâdeà
__LDD_COURIER_COMPLETION_CALLBACK_PROXY_H_


2 
	#__LDD_COURIER_COMPLETION_CALLBACK_PROXY_H_


	)

4 
	~<¡ršg
>

5 
	~"com¶‘iÚ_ÿÎback.h
"

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZkBrok”Proxy
;

13 şas 
	cNodeLi¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

14 
public
:

15 
NodeLi¡CB
(
ZkBrok”Proxy
* 
b
): 
brok”_
(b){

18 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

19 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

20 
vœtu®
 
E¼ÜHªdË
();

21 
	g´iv©e
:

22 
ZkBrok”Proxy
* 
brok”_
;

25 şas 
	cC»©eProxyNodeCB
 : 
public
 
Com¶‘iÚC®lBack
{

26 
public
:

27 
C»©eProxyNodeCB
(
ZkBrok”Proxy
* 
b
è: 
brok”_
(b){};

28 
vœtu®
 
C»©eCom¶‘iÚ
(cÚ¡ * 
v®ue
);

29 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

30 
vœtu®
 
E¼ÜHªdË
();

31 
	g´iv©e
:

32 
ZkBrok”Proxy
* 
brok”_
;

35 şas 
	cNSLi¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

36 
public
:

37 
NSLi¡CB
(
ZkBrok”Proxy
* 
b
): 
brok”_
(b){

40 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

41 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

42 
vœtu®
 
E¼ÜHªdË
();

43 
	g´iv©e
:

44 
ZkBrok”Proxy
* 
brok”_
;

46 şas 
	cG‘NsIdIÁCB
 : 
public
 
Com¶‘iÚC®lBack
{

47 
public
:

48 
G‘NsIdIÁCB
(
ZkBrok”Proxy
* 
b
, 
¡d
::
¡ršg
& 
ns
) :

49 
brok”_
(
b
), 
ns_
(
ns
){};

51 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

52 cÚ¡ 
St
* 
¡©
);

53 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

54 
vœtu®
 
E¼ÜHªdË
();

55 
	g´iv©e
:

56 
ZkBrok”Proxy
* 
brok”_
;

57 
	g¡d
::
¡ršg
 
ns_
;

60 şas 
	cF¬mLi¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

61 
public
:

62 
F¬mLi¡CB
(
ZkBrok”Proxy
* 
b
): 
brok”_
(b){};

63 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

64 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

65 
vœtu®
 
E¼ÜHªdË
();

66 
	g´iv©e
:

67 
ZkBrok”Proxy
* 
brok”_
;

69 şas 
	cProxyRŞesChd»nM­CB
 : 
public
 
Com¶‘iÚC®lBack
{

70 
public
:

71 
ProxyRŞesChd»nM­CB
(
ZkBrok”Proxy
* 
b
, cÚ¡ 
¡d
::
¡ršg
& 
çrm_id
):

72 
brok”_
(
b
),
çrm_id_
(
çrm_id
){};

73 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

74 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

75 
vœtu®
 
E¼ÜHªdË
();

76 
	g´iv©e
:

77 
ZkBrok”Proxy
* 
brok”_
;

78 
	g¡d
::
¡ršg
 
çrm_id_
;

79 
	g¡d
::
¡ršg
 
cur_v”siÚ_·th_
;

81 şas 
	cProxyG‘V”siÚV®ueCb
 : 
public
 
Com¶‘iÚC®lBack
{

82 
public
:

83 
ProxyG‘V”siÚV®ueCb
(
ZkBrok”Proxy
* 
b
,

84 cÚ¡ 
¡d
::
¡ršg
 
çrm_id
, cÚ¡ std::¡ršg 
v”siÚ
) :

85 
brok”_
(
b
), 
çrm_id_
(
çrm_id
), 
v”siÚ_·th_
(
v”siÚ
){};

86 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

87 cÚ¡ 
St
* 
¡©
);

88 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

89 
vœtu®
 
E¼ÜHªdË
();

90 
	g´iv©e
:

91 
ZkBrok”Proxy
* 
brok”_
;

92 cÚ¡ 
	g¡d
::
¡ršg
 
çrm_id_
;

93 cÚ¡ 
	g¡d
::
¡ršg
 
v”siÚ_·th_
;

	@/home/libin3-s/ldd/courier/completion_callback_store.h

1 #iâdeà
__LDD_COURIER_COMPLETION_CALLBACK_STORE_H_


2 
	#__LDD_COURIER_COMPLETION_CALLBACK_STORE_H_


	)

4 
	~<¡ršg
>

5 
	~"com¶‘iÚ_ÿÎback.h
"

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

13 
şass
 
	gZkBrok”StÜe
;

14 şas 
	cCoÜdš©ÜNodeExi¡sCB
 : 
public
 
Com¶‘iÚC®lBack
{

15 
public
:

16 
CoÜdš©ÜNodeExi¡sCB
(
ZkBrok”StÜe
* 
b
): 
brok”_
(b){

19 
vœtu®
 
Exi¡sCom¶‘iÚ
(cÚ¡ 
St
 *
¡©
);

20 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

21 
vœtu®
 
E¼ÜHªdË
();

22 
	g´iv©e
:

23 
ZkBrok”StÜe
* 
brok”_
;

26 şas 
	cCÜdChd»nLi¡CB
 : 
public
 
Com¶‘iÚC®lBack
{

27 
public
:

28 
CÜdChd»nLi¡CB
(
ZkBrok”StÜe
* 
b
): 
brok”_
(b){

31 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

32 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

33 
vœtu®
 
E¼ÜHªdË
();

34 
	g´iv©e
:

35 
ZkBrok”StÜe
* 
brok”_
;

38 şas 
	cC»©eNodeUnd”CÜdCB
 : 
public
 
Com¶‘iÚC®lBack
{

39 
public
:

40 
C»©eNodeUnd”CÜdCB
(
ZkBrok”StÜe
* 
b
): 
brok”_
(b){

43 
vœtu®
 
C»©eCom¶‘iÚ
(cÚ¡ * 
v®ue
);

44 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

45 
vœtu®
 
E¼ÜHªdË
();

46 
	g´iv©e
:

47 
ZkBrok”StÜe
* 
brok”_
;

50 şas 
	cC»©eV”siÚNodeCB
 : 
public
 
Com¶‘iÚC®lBack
{

51 
public
:

52 
C»©eV”siÚNodeCB
(
ZkBrok”StÜe
* 
b
, 
¡d
::
¡ršg
& 
rŞes_desc
):

53 
brok”_
(
b
), 
rŞes_desc_
(
rŞes_desc
){};

55 
vœtu®
 
C»©eCom¶‘iÚ
(cÚ¡ * 
v®ue
);

56 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

57 
vœtu®
 
E¼ÜHªdË
();

58 
	g´iv©e
:

59 
ZkBrok”StÜe
* 
brok”_
;

60 
	g¡d
::
¡ršg
 
rŞes_desc_
;

63 şas 
	cC»©eAliveNodeCB
 : 
public
 
Com¶‘iÚC®lBack
{

64 
public
:

65 
C»©eAliveNodeCB
(
ZkBrok”StÜe
* 
b
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
) :

66 
brok”_
(
b
), 
ho¡_pÜt_
(
ho¡_pÜt
){};

67 
vœtu®
 
C»©eCom¶‘iÚ
(cÚ¡ * 
v®ue
);

68 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

69 
vœtu®
 
E¼ÜHªdË
();

70 
	g´iv©e
:

71 
ZkBrok”StÜe
* 
brok”_
;

72 
	g¡d
::
¡ršg
 
ho¡_pÜt_
;

75 şas 
	cNodesM­CB
 : 
public
 
Com¶‘iÚC®lBack
{

76 
public
:

77 
NodesM­CB
(
ZkBrok”StÜe
* 
b
): 
brok”_
(b){};

79 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

80 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

81 
vœtu®
 
E¼ÜHªdË
();

82 
	g´iv©e
:

83 
ZkBrok”StÜe
* 
brok”_
;

86 şas 
	cG‘F¬mIdOfNodeCb
 : 
public
 
Com¶‘iÚC®lBack
{

87 
public
:

88 
ex¶ic™
 
G‘F¬mIdOfNodeCb
(
ZkBrok”StÜe
* 
b
, cÚ¡ 
¡d
::
¡ršg
& 
s
è: 
brok”_
(b), 
ho¡_pÜt_
(s){};

89 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

90 cÚ¡ 
St
* 
¡©
);

91 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

92 
vœtu®
 
E¼ÜHªdË
();

93 
	g´iv©e
:

94 
ZkBrok”StÜe
* 
brok”_
;

95 
	g¡d
::
¡ršg
 
ho¡_pÜt_
;

98 şas 
	cAliveNodeM­CB
 : 
public
 
Com¶‘iÚC®lBack
{

99 
public
:

100 
AliveNodeM­CB
(
ZkBrok”StÜe
* 
b
): 
brok”_
(b){};

101 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

102 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

103 
vœtu®
 
E¼ÜHªdË
();

104 
	g´iv©e
:

105 
ZkBrok”StÜe
* 
brok”_
;

109 şas 
	cV”siÚNodeM­CB
 : 
public
 
Com¶‘iÚC®lBack
{

110 
public
:

111 
V”siÚNodeM­CB
(
ZkBrok”StÜe
* 
b
, 
¡d
::
¡ršg
& 
v”siÚ_·th
) :

112 
brok”_
(
b
), 
cur_v”siÚ_·th_
(
v”siÚ_·th
){

115 
vœtu®
 
G‘Chd»nCom¶‘iÚ
(cÚ¡ 
SŒšg_veùÜ
 *
¡ršgs
);

116 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

117 
vœtu®
 
E¼ÜHªdË
();

118 
	g´iv©e
:

119 
ZkBrok”StÜe
* 
brok”_
;

120 
	g¡d
::
¡ršg
& 
cur_v”siÚ_·th_
;

123 şas 
	cG‘V”siÚV®ueCb
 : 
public
 
Com¶‘iÚC®lBack
{

124 
public
:

125 
ex¶ic™
 
G‘V”siÚV®ueCb
(
ZkBrok”StÜe
* 
b
, 
¡d
::
¡ršg
 
s
) :

126 
brok”_
(
b
), 
v”siÚ_·th_
(
s
){};

127 
vœtu®
 
G‘Com¶‘iÚ
(cÚ¡ * 
v®ue
, 
v®ue_Ën
,

128 cÚ¡ 
St
* 
¡©
);

129 
vœtu®
 
R‘ry
(
RedoPŞicy
* 
»do_pŞicy_
);

130 
vœtu®
 
E¼ÜHªdË
();

131 
	g´iv©e
:

132 
ZkBrok”StÜe
* 
brok”_
;

133 
	g¡d
::
¡ršg
 
v”siÚ_·th_
;

	@/home/libin3-s/ldd/courier/configure.h

1 #iâdeà
__LDD_COURIER_CONFIGURE_H_


2 
	#__LDD_COURIER_CONFIGURE_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<Œ1/funùiÚ®
>

7 
	~"İtiÚs.h
"

8 
	~"cour›r.h
"

11 
Çme¥aû
 
	gldd
{

12 
Çme¥aû
 
	gcour›r
{

15 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	t”r_code
, 
	tNodeChªgedTy³
 
	tty³
,

16 cÚ¡ 
	t¡d
::
	t¡ršg
& 
	tnode
)>
	tNodeLi¡ChªgedNÙify
;

19 şas 
	cCÚfigu»
{

20 
	gpublic
:

21 
CÚfigu»
();

22 
	gvœtu®
 ~
CÚfigu»
();

24 
	gpublic
:

25 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
,

26 cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

27 cÚ¡ 
¡d
::
¡ršg
& 
zk_ho¡_pÜt
,

28 cÚ¡ 
¡d
::
¡ršg
& 
roÙ_·th
,

29 
CÚfigu»
** 
brok”_±r
);

31 
vœtu®
 
G‘R•liÿSize
(*
size
) = 0;

32 
vœtu®
 
G‘StÜeEngše
(
¡d
::
¡ršg
* 
’gše_Çme
) = 0;

33 
vœtu®
 
G‘MaxBšLogFe
(*
size
) = 0;

34 
vœtu®
 
G‘Buck‘Size
(*
size
) = 0;

36 
vœtu®
 
G‘NameS·ûID
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, * 
id
) = 0;

37 
vœtu®
 
FšdF¬mIdInBuck‘Li¡
(cÚ¡ 
buck‘_id
, * 
çrm_id
) = 0;

38 
vœtu®
 
G‘RŞes
(cÚ¡ 
çrm_id
, 
RŞes
** 
rŞes
) = 0;

39 
vœtu®
 
G‘NodeLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

40 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
) = 0;

41 
vœtu®
 
G‘F¬mLi¡
(
¡d
::
veùÜ
<>** 
çrm_li¡
) = 0;

43 
	g´iv©e
:

44 
CÚfigu»
(const Configure&);

45 cÚ¡ 
	gCÚfigu»
& 
	gİ”©Ü
=(cÚ¡ 
CÚfigu»
&);

	@/home/libin3-s/ldd/courier/configure_impl.h

1 #iâdeà
__LDD_COURIER_BROKER_IMPL_H_


2 
	#__LDD_COURIER_BROKER_IMPL_H_


	)

5 
	~"cÚfigu».h
"

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZkBrok”Proxy
;

12 şas 
	cCÚfigu»Im¶
 : 
public
 
CÚfigu»
{

13 
public
:

14 
CÚfigu»Im¶
();

15 
	gvœtu®
 ~
CÚfigu»Im¶
();

17 
	gpublic
:

18 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
,

19 cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

20 cÚ¡ 
¡d
::
¡ršg
& 
zk_ho¡_pÜt
,

21 cÚ¡ 
¡d
::
¡ršg
& 
roÙ_·th
,

22 
CÚfigu»Im¶
* 
b
);

24 
vœtu®
 
G‘R•liÿSize
(*
size
);

25 
vœtu®
 
G‘StÜeEngše
(
¡d
::
¡ršg
* 
’gše_Çme
);

26 
vœtu®
 
G‘MaxBšLogFe
(*
size
);

27 
vœtu®
 
G‘Buck‘Size
(*
size
);

29 
vœtu®
 
G‘NameS·ûID
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, * 
id
);

30 
vœtu®
 
FšdF¬mIdInBuck‘Li¡
(cÚ¡ 
buck‘_id
, * 
çrm_id
);

31 
vœtu®
 
G‘RŞes
(cÚ¡ 
çrm_id
, 
RŞes
** 
rŞes
);

32 
vœtu®
 
G‘NodeLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

33 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
);

34 
vœtu®
 
G‘F¬mLi¡
(
¡d
::
veùÜ
<>** 
çrm_li¡
) ;

36 
S‘ZooK“³rBrok”
(
ZkBrok”Proxy
* 
z
);

38 
	g´iv©e
:

39 
CÚfigu»Im¶
(const ConfigureImpl&);

40 
	gİ”©Ü
=(cÚ¡ 
CÚfigu»Im¶
&);

42 
	g´iv©e
:

43 
ZkBrok”Proxy
 * 
zk_´oxy_brok”_
;

	@/home/libin3-s/ldd/courier/courier.h

2 #iâdeà
__LDD_COURIER_COURIER_H_


3 
	#__LDD_COURIER_COURIER_H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

7 
	~<veùÜ
>

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	gcour›r
{

15 
	eCour›rE¼Ü
{

16 
	gkCour›rOk
 = 0,

18 
	gkInv®idBa£P¬amInZk
 = -202,

19 
	gkInv®idArgum’t
 = -203,

20 
	gkNÙFound
 = -204,

21 
	gkInv®idHomeAdd»ss
 = -205,

22 
	gkSy¡emE¼Ü
 = -206,

23 
	gkZooK“³rNÙWÜk
 = -207

27 
	g¡d
::
¡ršg
 
ma¡”
;

28 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
¦aves
;

29 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
fŞlow”s
;

30 }
	tRŞes
;

32 
	eNodeChªgedTy³
{

33 
	gkC»©eNode
 = 0,

34 
	gkD–‘eNode
 = 1

	@/home/libin3-s/ldd/courier/keeper.h

1 #iâdeà
__LDD_COURIER_KEEPER_H_


2 
	#__LDD_COURIER_KEEPER_H_


	)

4 
	~<¡ršg
>

5 
	~<veùÜ
>

6 
	~<£t
>

7 
	~<Œ1/funùiÚ®
>

8 
	~"İtiÚs.h
"

9 
	~"cour›r.h
"

11 
Çme¥aû
 
	gldd
{

12 
Çme¥aû
 
	gcour›r
{

16 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	t”r_code
, 
	tNodeChªgedTy³
 
	tty³
,

17 cÚ¡ 
	t¡d
::
	t¡ršg
& 
	tho¡_pÜt
)>
	tOÆšeNodesChªgedNÙify
;

18 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	t”r_code
, 
	tboŞ
 
	tgÙ_Ëad”sh
)>
	tL—d”ShChªgedNÙify
;

19 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<(
	t”r_code
, 
	tRŞes
& 
	trŞes
)>
	tRŞesChªgedNÙify
;

21 şas 
	cK“³r
{

22 
	gpublic
:

23 
K“³r
();

24 
	gvœtu®
 ~
K“³r
();

26 
	gpublic
:

27 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
, cÚ¡ 
¡d
::
¡ršg
& 
zk_£rv”_ho¡_pÜt
,

28 cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

29 cÚ¡ 
¡d
::
¡ršg
& 
roÙ_·th
,

30 
K“³r
** 
k“³r_±r
);

32 
vœtu®
 
G‘R•liÿSize
(*
size
) = 0;

33 
vœtu®
 
G‘StÜeEngše
(
¡d
::
¡ršg
* 
’gše_Çme
) = 0;

34 
vœtu®
 
G‘MaxBšLogFe
(*
size
) = 0;

35 
vœtu®
 
G‘Buck‘Size
(*
size
) = 0;

37 
vœtu®
 
S¹L—d”EËùiÚ
(
L—d”ShChªgedNÙify
 
cb
) = 0;

39 
vœtu®
 
	g¡d
::
£t
<
ušt16_t
>& 
G‘Buck‘S‘
() = 0;

41 
vœtu®
 
G‘AliveNodes
(
OÆšeNodesChªgedNÙify
 
cb
, 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
) = 0;

42 
vœtu®
 
AddNewRŞes
(cÚ¡ 
RŞes
& 
rŞes
) = 0;

43 
vœtu®
 
G‘RŞes
(
RŞesChªgedNÙify
 
cb
, 
RŞes
* 
rŞes
) = 0;

47 
	g´iv©e
:

48 
K“³r
(const Keeper&);

49 
	gİ”©Ü
=(cÚ¡ 
K“³r
&);

	@/home/libin3-s/ldd/courier/keeper_impl.h

1 #iâdeà
__LDD_COURIER_KEEPER_IMPL_H_


2 
	#__LDD_COURIER_KEEPER_IMPL_H_


	)

5 
	~"k“³r.h
"

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZkBrok”StÜe
;

12 şas 
	cK“³rIm¶
 : 
public
 
K“³r
{

13 
public
:

14 
K“³rIm¶
();

15 
	gvœtu®
 ~
K“³rIm¶
();

17 
	gpublic
:

18 
In™
(cÚ¡ 
O±iÚs
& 
İtiÚ
,cÚ¡ 
¡d
::
¡ršg
& 
£rv”_ho¡_pÜt
,

19 cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

20 cÚ¡ 
¡d
::
¡ršg
& 
roÙ_·th
, 
K“³rIm¶
* 
b
);

22 
vœtu®
 
G‘R•liÿSize
(*
size
) ;

23 
vœtu®
 
G‘StÜeEngše
(
¡d
::
¡ršg
* 
’gše_Çme
) ;

24 
vœtu®
 
G‘MaxBšLogFe
(*
size
) ;

25 
vœtu®
 
G‘Buck‘Size
(*
size
);

27 
vœtu®
 
S¹L—d”EËùiÚ
(
L—d”ShChªgedNÙify
 
cb
);

28 
vœtu®
 
	g¡d
::
£t
<
ušt16_t
>& 
G‘Buck‘S‘
();

30 
vœtu®
 
AddNewRŞes
(cÚ¡ 
RŞes
& 
rŞes
);

31 
vœtu®
 
G‘RŞes
(
RŞesChªgedNÙify
 
cb
, 
RŞes
* 
rŞes
);

32 
vœtu®
 
G‘AliveNodes
(
OÆšeNodesChªgedNÙify
 
cb
, 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
);

34 
	gpublic
:

35 
S‘ZooK“³rBrok”
(
ZkBrok”StÜe
* 
z
);

37 
	g´iv©e
:

38 
K“³rIm¶
(const KeeperImpl&);

39 
	gİ”©Ü
=(cÚ¡ 
K“³rIm¶
&);

41 
	g´iv©e
:

42 
ZkBrok”StÜe
* 
zk_brok”_
;

	@/home/libin3-s/ldd/courier/options.h

2 #iâdeà
__LDD_COURIER_OPTIONS_H_


3 
	#__LDD_COURIER_OPTIONS_H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

7 
	~<boo¡/funùiÚ.hµ
>

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	gcour›r
{

12 
	gboo¡
::
	tfunùiÚ
<(
	t”r_code
)>
	tHªdËZkE¼Ü
;

14 
şass
 
	gRedoPŞicy
;

16 
	sO±iÚs
{

17 
O±iÚs
(è:
timeout
(0), 
»do_pŞicy
(
NULL
){}

18 
	gtimeout
;

19 
RedoPŞicy
* 
	g»do_pŞicy
;

20 
HªdËZkE¼Ü
 
	gcb
;

	@/home/libin3-s/ldd/courier/rapidjson/document.h

1 #iâdeà
RAPIDJSON_DOCUMENT_H_


2 
	#RAPIDJSON_DOCUMENT_H_


	)

4 
	~"»ad”.h
"

5 
	~"š‹º®/¡rfunc.h
"

6 
	~<Ãw
>

8 #ifdeà
_MSC_VER


9 #´agm¨
w¬nšg
(
push
)

10 #´agm¨
w¬nšg
(
di§bË
 : 4127)

13 
Çme¥aû
 
	g¿pidjsÚ
 {

28 #´agm¨
·ck
 (
push
, 4)

29 
	g‹m¶©e
 <
ty³Çme
 
	gEncodšg
,y³Çm
	gAÎoÿtÜ
 = 
MemÜyPoŞAÎoÿtÜ
<> >

30 şas 
	cG’”icV®ue
 {

31 
public
:

33 
	sMemb”
 {

34 
G’”icV®ue
<
Encodšg
, 
AÎoÿtÜ
> 
Çme
;

35 
	gG’”icV®ue
<
	gEncodšg
, 
	gAÎoÿtÜ
> 
	gv®ue
;

38 
Encodšg
 
	tEncodšgTy³
;

39 
AÎoÿtÜ
 
	tAÎoÿtÜTy³
;

40 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

41 
Memb”
* 
	tMemb”I‹¿tÜ
;

42 cÚ¡ 
	tMemb”
* 
	tCÚ¡Memb”I‹¿tÜ
;

43 
G’”icV®ue
* 
	tV®ueI‹¿tÜ
;

44 cÚ¡ 
	tG’”icV®ue
* 
	tCÚ¡V®ueI‹¿tÜ
;

50 
G’”icV®ue
(è: 
æags_
(
kNuÎFÏg
) {}

53 
´iv©e
:

54 
G’”icV®ue
(cÚ¡ G’”icV®ue& 
rhs
);

56 
	gpublic
:

63 
G’”icV®ue
(
Ty³
 
ty³
) {

64 cÚ¡ 
deçuÉFÏgs
[7] = {

65 
kNuÎFÏg
, 
kF®£FÏg
, 
kTrueFÏg
, 
kObjeùFÏg
, 
kA¼ayFÏg
, 
kCÚ¡SŒšgFÏg
,

66 
kNumb”FÏg
 | 
kIÁFÏg
 | 
kUštFÏg
 | 
kIÁ64FÏg
 | 
kUšt64FÏg
 | 
kDoubËFÏg


68 
RAPIDJSON_ASSERT
(
ty³
 <ğ
kNumb”Ty³
);

69 
	gæags_
 = 
deçuÉFÏgs
[
ty³
];

70 
mem£t
(&
d©a_
, 0, (data_));

74 
G’”icV®ue
(
boŞ
 
b
è: 
æags_
(b ? 
kTrueFÏg
 : 
kF®£FÏg
) {}

77 
G’”icV®ue
(
i
è: 
æags_
(
kNumb”IÁFÏg
) {

78 
d©a_
.
n
.
i64
 = 
i
;

79 ià(
	gi
 >= 0)

80 
æags_
 |ğ
kUštFÏg
 | 
kUšt64FÏg
;

84 
G’”icV®ue
(
u
è: 
æags_
(
kNumb”UštFÏg
) {

85 
d©a_
.
n
.
u64
 = 
u
;

86 ià(!(
	gu
 & 0x80000000))

87 
	gæags_
 |ğ
kIÁFÏg
 | 
kIÁ64FÏg
;

91 
G’”icV®ue
(
št64_t
 
i64
è: 
æags_
(
kNumb”IÁ64FÏg
) {

92 
d©a_
.
n
.
i64
 = i64;

93 ià(
	gi64
 >= 0) {

94 
æags_
 |ğ
kNumb”Ušt64FÏg
;

95 ià(!(
	gi64
 & 0xFFFFFFFF00000000LL))

96 
	gæags_
 |ğ
kUštFÏg
;

97 ià(!(
	gi64
 & 0xFFFFFFFF80000000LL))

98 
	gæags_
 |ğ
kIÁFÏg
;

100 ià(
	gi64
 >= -2147483648LL)

101 
æags_
 |ğ
kIÁFÏg
;

105 
G’”icV®ue
(
ušt64_t
 
u64
è: 
æags_
(
kNumb”Ušt64FÏg
) {

106 
d©a_
.
n
.
u64
 = u64;

107 ià(!(
	gu64
 & 0x8000000000000000ULL))

108 
	gæags_
 |ğ
kIÁ64FÏg
;

109 ià(!(
	gu64
 & 0xFFFFFFFF00000000ULL))

110 
	gæags_
 |ğ
kUštFÏg
;

111 ià(!(
	gu64
 & 0xFFFFFFFF80000000ULL))

112 
	gæags_
 |ğ
kIÁFÏg
;

116 
G’”icV®ue
(
d
è: 
æags_
(
kNumb”DoubËFÏg
è{ 
d©a_
.
n
.d = d; }

119 
G’”icV®ue
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
) {

120 
RAPIDJSON_ASSERT
(
s
 !ğ
NULL
);

121 
	gæags_
 = 
kCÚ¡SŒšgFÏg
;

122 
	gd©a_
.
	gs
.
	g¡r
 = 
s
;

123 
	gd©a_
.
	gs
.
	gËngth
 = 
Ëngth
;

127 
G’”icV®ue
(cÚ¡ 
Ch
* 
s
è{ 
S‘SŒšgRaw
(s, 
š‹º®
::
SŒL’
(s)); }

130 
G’”icV®ue
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
, 
AÎoÿtÜ
& 
®loÿtÜ
è{ 
S‘SŒšgRaw
(s,†ength,‡llocator); }

133 
G’”icV®ue
(cÚ¡ 
Ch
*
s
, 
AÎoÿtÜ
& 
®loÿtÜ
è{ 
S‘SŒšgRaw
(s, 
š‹º®
::
SŒL’
(s),‡llocator); }

138 ~
G’”icV®ue
() {

139 ià(
	gAÎoÿtÜ
::
kN“dF»e
) {

140 
æags_
) {

141 
kA¼ayFÏg
:

142 
G’”icV®ue
* 
v
 = 
d©a_
.
a
.
–em’ts
; 
	gv
 !ğd©a_.a.–em’t + d©a_.a.
size
; ++v)

143 
	gv
->~
G’”icV®ue
();

144 
	gAÎoÿtÜ
::
F»e
(
d©a_
.
a
.
–em’ts
);

147 
	gkObjeùFÏg
:

148 
Memb”
* 
m
 = 
d©a_
.
o
.
memb”s
; 
	gm
 !ğd©a_.o.memb” + d©a_.o.
size
; ++m) {

149 
	gm
->
	gÇme
.~
G’”icV®ue
();

150 
	gm
->
	gv®ue
.~
G’”icV®ue
();

152 
	gAÎoÿtÜ
::
F»e
(
d©a_
.
o
.
memb”s
);

155 
	gkCİySŒšgFÏg
:

156 
AÎoÿtÜ
::
F»e
(
cÚ¡_ÿ¡
<
Ch
*>(
d©a_
.
s
.
¡r
));

170 
	gG’”icV®ue
& 
	gİ”©Ü
=(
G’”icV®ue
& 
rhs
) {

171 
RAPIDJSON_ASSERT
(
this
 !ğ&
rhs
);

172 
	gthis
->~
G’”icV®ue
();

173 
memıy
(
this
, &
rhs
, (
G’”icV®ue
));

174 
	grhs
.
	gæags_
 = 
kNuÎFÏg
;

175  *
	gthis
;

182 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

183 
	gG’”icV®ue
& 
	gİ”©Ü
=(
T
 
v®ue
) {

184 
this
->~
G’”icV®ue
();

185 
Ãw
 (
this
è
G’”icV®ue
(
v®ue
);

186  *
	gthis
;

193 
Ty³
 
G‘Ty³
(ècÚ¡ {  
	g¡©ic_ÿ¡
<
	gTy³
>(
	gæags_
 & 
	gkTy³Mask
); }

194 
boŞ
 
IsNuÎ
(ècÚ¡ {  
	gæags_
 =ğ
kNuÎFÏg
; }

195 
boŞ
 
IsF®£
(ècÚ¡ {  
	gæags_
 =ğ
kF®£FÏg
; }

196 
boŞ
 
IsTrue
(ècÚ¡ {  
	gæags_
 =ğ
kTrueFÏg
; }

197 
boŞ
 
IsBoŞ
(ècÚ¡ {  (
	gæags_
 & 
	gkBoŞFÏg
) != 0; }

198 
boŞ
 
IsObjeù
(ècÚ¡ {  
	gæags_
 =ğ
kObjeùFÏg
; }

199 
boŞ
 
IsA¼ay
(ècÚ¡ {  
	gæags_
 =ğ
kA¼ayFÏg
; }

200 
boŞ
 
IsNumb”
(ècÚ¡ {  (
	gæags_
 & 
	gkNumb”FÏg
) != 0; }

201 
boŞ
 
IsIÁ
(ècÚ¡ {  (
	gæags_
 & 
	gkIÁFÏg
) != 0; }

202 
boŞ
 
IsUšt
(ècÚ¡ {  (
	gæags_
 & 
	gkUštFÏg
) != 0; }

203 
boŞ
 
IsIÁ64
(ècÚ¡ {  (
	gæags_
 & 
	gkIÁ64FÏg
) != 0; }

204 
boŞ
 
IsUšt64
(ècÚ¡ {  (
	gæags_
 & 
	gkUšt64FÏg
) != 0; }

205 
boŞ
 
IsDoubË
(ècÚ¡ {  (
	gæags_
 & 
	gkDoubËFÏg
) != 0; }

206 
boŞ
 
IsSŒšg
(ècÚ¡ {  (
	gæags_
 & 
	gkSŒšgFÏg
) != 0; }

213 
	gG’”icV®ue
& 
S‘NuÎ
(è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue();  *this; }

220 
boŞ
 
G‘BoŞ
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsBoŞ
());  
	gæags_
 =ğ
kTrueFÏg
; }

221 
	gG’”icV®ue
& 
S‘BoŞ
(
boŞ
 
b
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(b);  *this; }

229 
	gG’”icV®ue
& 
S‘Objeù
(è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
èG’”icV®ue(
kObjeùTy³
);  *this; }

232 
	gG’”icV®ue
& 
	gİ”©Ü
[](cÚ¡ 
Ch
* 
	gÇme
) {

233 ià(
Memb”
* 
	gmemb”
 = 
FšdMemb”
(
Çme
))

234  
memb”
->
v®ue
;

236 
G’”icV®ue
 
	gNuÎV®ue
;

237  
	gNuÎV®ue
;

240 cÚ¡ 
	gG’”icV®ue
& 
	gİ”©Ü
[](cÚ¡ 
Ch
* 
	gÇme
ècÚ¡ {  
	gcÚ¡_ÿ¡
<G’”icV®ue&>(*
	gthis
)[
Çme
]; }

243 
CÚ¡Memb”I‹¿tÜ
 
Memb”Begš
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsObjeù
());  
	gd©a_
.
	go
.
	gmemb”s
; }

244 
CÚ¡Memb”I‹¿tÜ
 
Memb”End
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsObjeù
());  
	gd©a_
.
	go
.
	gmemb”s
 + d©a_.o.
	gsize
; }

245 
Memb”I‹¿tÜ
 
Memb”Begš
(è{ 
RAPIDJSON_ASSERT
(
IsObjeù
());  
	gd©a_
.
	go
.
	gmemb”s
; }

246 
Memb”I‹¿tÜ
 
Memb”End
(è{ 
RAPIDJSON_ASSERT
(
IsObjeù
());  
	gd©a_
.
	go
.
	gmemb”s
 + d©a_.o.
	gsize
; }

249 
boŞ
 
HasMemb”
(cÚ¡ 
Ch
* 
Çme
ècÚ¡ {  
FšdMemb”
(name) != 0; }

258 
	gG’”icV®ue
& 
AddMemb”
(
G’”icV®ue
& 
Çme
, G’”icV®ue& 
v®ue
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

259 
RAPIDJSON_ASSERT
(
IsObjeù
());

260 
RAPIDJSON_ASSERT
(
Çme
.
IsSŒšg
());

261 
	gObjeù
& 
	go
 = 
d©a_
.
o
;

262 ià(
	go
.
	gsize
 >ğ
o
.
ÿ·c™y
) {

263 ià(
o
.
ÿ·c™y
 == 0) {

264 
o
.
ÿ·c™y
 = 
kDeçuÉObjeùC­ac™y
;

265 
	go
.
	gmemb”s
 = (
Memb”
*)
®loÿtÜ
.
M®loc
(
o
.
ÿ·c™y
 * (Member));

268 
SizeTy³
 
	gŞdC­ac™y
 = 
o
.
ÿ·c™y
;

269 
	go
.
	gÿ·c™y
 *= 2;

270 
	go
.
	gmemb”s
 = (
Memb”
*)
®loÿtÜ
.
R—Îoc
(
o
.
memb”s
, 
ŞdC­ac™y
 * (Memb”), o.
ÿ·c™y
 * (Member));

273 
	go
.
	gmemb”s
[
o
.
size
].
	gÇme
.
RawAssign
(
Çme
);

274 
	go
.
	gmemb”s
[
o
.
size
].
	gv®ue
.
RawAssign
(
v®ue
);

275 
	go
.
	gsize
++;

276  *
	gthis
;

279 
	gG’”icV®ue
& 
AddMemb”
(cÚ¡ 
Ch
* 
Çme
, 
AÎoÿtÜ
& 
ÇmeAÎoÿtÜ
, 
G’”icV®ue
& 
v®ue
, AÎoÿtÜ& 
®loÿtÜ
) {

280 
G’”icV®ue
 
n
(
Çme
, 
š‹º®
::
SŒL’
Òame), 
ÇmeAÎoÿtÜ
);

281  
AddMemb”
(
n
, 
v®ue
, 
®loÿtÜ
);

284 
	gG’”icV®ue
& 
AddMemb”
(cÚ¡ 
Ch
* 
Çme
, 
G’”icV®ue
& 
v®ue
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

285 
G’”icV®ue
 
n
(
Çme
, 
š‹º®
::
SŒL’
(name));

286  
AddMemb”
(
n
, 
v®ue
, 
®loÿtÜ
);

289 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

290 
	gG’”icV®ue
& 
AddMemb”
(cÚ¡ 
Ch
* 
Çme
, 
T
 
v®ue
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

291 
G’”icV®ue
 
n
(
Çme
, 
š‹º®
::
SŒL’
(name));

292 
G’”icV®ue
 
v
(
v®ue
);

293  
AddMemb”
(
n
, 
v
, 
®loÿtÜ
);

301 
boŞ
 
RemoveMemb”
(cÚ¡ 
Ch
* 
Çme
) {

302 
RAPIDJSON_ASSERT
(
IsObjeù
());

303 ià(
Memb”
* 
	gm
 = 
FšdMemb”
(
Çme
)) {

304 
RAPIDJSON_ASSERT
(
d©a_
.
o
.
size
 > 0);

305 
RAPIDJSON_ASSERT
(
d©a_
.
o
.
memb”s
 != 0);

307 
Memb”
* 
	gÏ¡
 = 
d©a_
.
o
.
memb”s
 + (d©a_.o.
size
 - 1);

308 ià(
	gd©a_
.
	go
.
	gsize
 > 1 && 
	gm
 !ğ
Ï¡
) {

310 
m
->
Çme
 = 
Ï¡
->name;

311 
	gm
->
	gv®ue
 = 
Ï¡
->
v®ue
;

315 
	gm
->
	gÇme
.~
G’”icV®ue
();

316 
	gm
->
	gv®ue
.~
G’”icV®ue
();

318 --
	gd©a_
.
	go
.
	gsize
;

319  
	gŒue
;

321  
	gçl£
;

330 
	gG’”icV®ue
& 
S‘A¼ay
(è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
èG’”icV®ue(
kA¼ayTy³
);  *this; }

333 
SizeTy³
 
Size
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsA¼ay
());  
	gd©a_
.
	ga
.
	gsize
; }

336 
SizeTy³
 
C­ac™y
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsA¼ay
());  
	gd©a_
.
	ga
.
	gÿ·c™y
; }

339 
boŞ
 
Em±y
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsA¼ay
());  
	gd©a_
.
	ga
.
	gsize
 == 0; }

344 
CË¬
() {

345 
RAPIDJSON_ASSERT
(
IsA¼ay
());

346 
SizeTy³
 
	gi
 = 0; i < 
	gd©a_
.
	ga
.
	gsize
; ++i)

347 
	gd©a_
.
	ga
.
	g–em’ts
[
i
].~
G’”icV®ue
();

348 
	gd©a_
.
	ga
.
	gsize
 = 0;

362 
	gG’”icV®ue
& 
	gİ”©Ü
[](
SizeTy³
 
	gšdex
) {

363 
RAPIDJSON_ASSERT
(
IsA¼ay
());

364 
RAPIDJSON_ASSERT
(
šdex
 < 
d©a_
.
a
.
size
);

365  
	gd©a_
.
	ga
.
	g–em’ts
[
šdex
];

367 cÚ¡ 
	gG’”icV®ue
& 
	gİ”©Ü
[](
SizeTy³
 
	gšdex
ècÚ¡ {  
	gcÚ¡_ÿ¡
<G’”icV®ue&>(*
	gthis
)[
šdex
]; }

370 
V®ueI‹¿tÜ
 
Begš
(è{ 
RAPIDJSON_ASSERT
(
IsA¼ay
());  
	gd©a_
.
	ga
.
	g–em’ts
; }

371 
V®ueI‹¿tÜ
 
End
(è{ 
RAPIDJSON_ASSERT
(
IsA¼ay
());  
	gd©a_
.
	ga
.
	g–em’ts
 + d©a_.a.
	gsize
; }

372 
CÚ¡V®ueI‹¿tÜ
 
Begš
(ècÚ¡ {  
	gcÚ¡_ÿ¡
<
	gG’”icV®ue
&>(*
	gthis
).Begin(); }

373 
CÚ¡V®ueI‹¿tÜ
 
End
(ècÚ¡ {  
	gcÚ¡_ÿ¡
<
	gG’”icV®ue
&>(*
	gthis
).End(); }

380 
	gG’”icV®ue
& 
Re£rve
(
SizeTy³
 
ÃwC­ac™y
, 
AÎoÿtÜ
 &
®loÿtÜ
) {

381 
RAPIDJSON_ASSERT
(
IsA¼ay
());

382 ià(
	gÃwC­ac™y
 > 
	gd©a_
.
	ga
.
	gÿ·c™y
) {

383 
	gd©a_
.
	ga
.
	g–em’ts
 = (
G’”icV®ue
*)
®loÿtÜ
.
R—Îoc
(
d©a_
.
a
.
–em’ts
, d©a_.a.
ÿ·c™y
 * (G’”icV®ue), 
ÃwC­ac™y
 * (GenericValue));

384 
	gd©a_
.
	ga
.
	gÿ·c™y
 = 
ÃwC­ac™y
;

386  *
	gthis
;

396 
	gG’”icV®ue
& 
PushBack
(
G’”icV®ue
& 
v®ue
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

397 
RAPIDJSON_ASSERT
(
IsA¼ay
());

398 ià(
	gd©a_
.
	ga
.
	gsize
 >ğ
d©a_
.
a
.
ÿ·c™y
)

399 
Re£rve
(
d©a_
.
a
.
ÿ·c™y
 =ğ0 ? 
kDeçuÉA¼ayC­ac™y
 : d©a_.a.ÿ·c™y * 2, 
®loÿtÜ
);

400 
	gd©a_
.
	ga
.
	g–em’ts
[
d©a_
.
a
.
size
++].
RawAssign
(
v®ue
);

401  *
	gthis
;

404 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

405 
	gG’”icV®ue
& 
PushBack
(
T
 
v®ue
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

406 
G’”icV®ue
 
v
(
v®ue
);

407  
PushBack
(
v
, 
®loÿtÜ
);

411 
	gG’”icV®ue
& 
PİBack
() {

412 
RAPIDJSON_ASSERT
(
IsA¼ay
());

413 
RAPIDJSON_ASSERT
(!
Em±y
());

414 
	gd©a_
.
	ga
.
	g–em’ts
[--
d©a_
.
a
.
size
].~
G’”icV®ue
();

415  *
	gthis
;

422 
G‘IÁ
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
æags_
 & 
kIÁFÏg
);  
	gd©a_
.
	gn
.
	gi
.i; }

423 
G‘Ušt
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
æags_
 & 
kUštFÏg
);  
	gd©a_
.
	gn
.
	gu
.u; }

424 
št64_t
 
G‘IÁ64
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
æags_
 & 
kIÁ64FÏg
);  
	gd©a_
.
	gn
.
	gi64
; }

425 
ušt64_t
 
G‘Ušt64
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
æags_
 & 
kUšt64FÏg
);  
	gd©a_
.
	gn
.
	gu64
; }

427 
G‘DoubË
() const {

428 
RAPIDJSON_ASSERT
(
IsNumb”
());

429 ià((
	gæags_
 & 
	gkDoubËFÏg
è!ğ0è 
d©a_
.
n
.
d
;

430 ià((
	gæags_
 & 
	gkIÁFÏg
è!ğ0è 
d©a_
.
n
.
i
.i;

431 ià((
	gæags_
 & 
	gkUštFÏg
è!ğ0è 
d©a_
.
n
.
u
.u;

432 ià((
	gæags_
 & 
	gkIÁ64FÏg
è!ğ0è ()
d©a_
.
n
.
i64
;

433 
RAPIDJSON_ASSERT
((
æags_
 & 
kUšt64FÏg
è!ğ0);  ()
	gd©a_
.
	gn
.
	gu64
;

436 
	gG’”icV®ue
& 
S‘IÁ
(
i
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(i);  *this; }

437 
	gG’”icV®ue
& 
S‘Ušt
(
u
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(u);  *this; }

438 
	gG’”icV®ue
& 
S‘IÁ64
(
št64_t
 
i64
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(i64);  *this; }

439 
	gG’”icV®ue
& 
S‘Ušt64
(
ušt64_t
 
u64
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(u64);  *this; }

440 
	gG’”icV®ue
& 
S‘DoubË
(
d
è{ 
	gthis
->~
G’”icV®ue
(); 
Ãw
 (
this
) GenericValue(d);  *this; }

447 cÚ¡ 
Ch
* 
G‘SŒšg
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsSŒšg
());  
	gd©a_
.
	gs
.
	g¡r
; }

452 
SizeTy³
 
G‘SŒšgL’gth
(ècÚ¡ { 
RAPIDJSON_ASSERT
(
IsSŒšg
());  
	gd©a_
.
	gs
.
	gËngth
; }

460 
	gG’”icV®ue
& 
S‘SŒšg
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
è{ 
	gthis
->~
G’”icV®ue
(); 
S‘SŒšgRaw
(s,†ength);  *this; }

466 
	gG’”icV®ue
& 
S‘SŒšg
(cÚ¡ 
Ch
* 
s
è{  S‘SŒšg(s, 
š‹º®
::
SŒL’
(s)); }

475 
	gG’”icV®ue
& 
S‘SŒšg
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
, 
AÎoÿtÜ
& 
®loÿtÜ
è{ 
	gthis
->~
G’”icV®ue
(); 
S‘SŒšgRaw
(s,†ength,‡llocator);  *this; }

482 
	gG’”icV®ue
& 
S‘SŒšg
(cÚ¡ 
Ch
* 
s
, 
AÎoÿtÜ
& 
®loÿtÜ
è{ S‘SŒšg(s, 
š‹º®
::
SŒL’
(s),‡ÎoÿtÜ);  *
	gthis
; }

493 
	g‹m¶©e
 <
ty³Çme
 
	gHªdËr
>

494 cÚ¡ 
	gG’”icV®ue
& 
Acû±
(
HªdËr
& 
hªdËr
) const {

495 
G‘Ty³
()) {

496 
	gkNuÎTy³
: 
hªdËr
.
NuÎ
(); ;

497 
	gkF®£Ty³
: 
hªdËr
.
BoŞ
(
çl£
); ;

498 
	gkTrueTy³
: 
hªdËr
.
BoŞ
(
Œue
); ;

500 
	gkObjeùTy³
:

501 
hªdËr
.
S¹Objeù
();

502 
Memb”
* 
	gm
 = 
d©a_
.
o
.
memb”s
; m !ğd©a_.o.memb” + d©a_.o.
size
; ++m) {

503 
	ghªdËr
.
SŒšg
(
m
->
Çme
.
d©a_
.
s
.
¡r
, m->Çme.d©a_.s.
Ëngth
, 
çl£
);

504 
	gm
->
	gv®ue
.
Acû±
(
hªdËr
);

506 
	ghªdËr
.
EndObjeù
(
d©a_
.
o
.
size
);

509 
	gkA¼ayTy³
:

510 
hªdËr
.
S¹A¼ay
();

511 
G’”icV®ue
* 
	gv
 = 
d©a_
.
a
.
–em’ts
; v !ğd©a_.a.–em’t + d©a_.a.
size
; ++v)

512 
	gv
->
Acû±
(
hªdËr
);

513 
	ghªdËr
.
EndA¼ay
(
d©a_
.
a
.
size
);

516 
	gkSŒšgTy³
:

517 
hªdËr
.
SŒšg
(
d©a_
.
s
.
¡r
, d©a_.s.
Ëngth
, 
çl£
);

520 
	gkNumb”Ty³
:

521 ià(
IsIÁ
()è
hªdËr
.
IÁ
(
d©a_
.
n
.
i
.i);

522 ià(
IsUšt
()è
	ghªdËr
.
Ušt
(
d©a_
.
n
.
u
.u);

523 ià(
IsIÁ64
()è
	ghªdËr
.
IÁ64
(
d©a_
.
n
.
i64
);

524 ià(
IsUšt64
()è
	ghªdËr
.
Ušt64
(
d©a_
.
n
.
u64
);

525 
	ghªdËr
.
DoubË
(
d©a_
.
n
.
d
);

528  *
	gthis
;

531 
	g´iv©e
:

532 
‹m¶©e
 <
ty³Çme
, 
	gty³Çme
>

533 
ä›nd
 
şass
 
	gG’”icDocum’t
;

536 
	gkBoŞFÏg
 = 0x100,

537 
	gkNumb”FÏg
 = 0x200,

538 
	gkIÁFÏg
 = 0x400,

539 
	gkUštFÏg
 = 0x800,

540 
	gkIÁ64FÏg
 = 0x1000,

541 
	gkUšt64FÏg
 = 0x2000,

542 
	gkDoubËFÏg
 = 0x4000,

543 
	gkSŒšgFÏg
 = 0x100000,

544 
	gkCİyFÏg
 = 0x200000,

547 
	gkNuÎFÏg
 = 
kNuÎTy³
,

548 
	gkTrueFÏg
 = 
kTrueTy³
 | 
kBoŞFÏg
,

549 
	gkF®£FÏg
 = 
kF®£Ty³
 | 
kBoŞFÏg
,

550 
	gkNumb”IÁFÏg
 = 
kNumb”Ty³
 | 
kNumb”FÏg
 | 
kIÁFÏg
 | 
kIÁ64FÏg
,

551 
	gkNumb”UštFÏg
 = 
kNumb”Ty³
 | 
kNumb”FÏg
 | 
kUštFÏg
 | 
kUšt64FÏg
 | 
kIÁ64FÏg
,

552 
	gkNumb”IÁ64FÏg
 = 
kNumb”Ty³
 | 
kNumb”FÏg
 | 
kIÁ64FÏg
,

553 
	gkNumb”Ušt64FÏg
 = 
kNumb”Ty³
 | 
kNumb”FÏg
 | 
kUšt64FÏg
,

554 
	gkNumb”DoubËFÏg
 = 
kNumb”Ty³
 | 
kNumb”FÏg
 | 
kDoubËFÏg
,

555 
	gkCÚ¡SŒšgFÏg
 = 
kSŒšgTy³
 | 
kSŒšgFÏg
,

556 
	gkCİySŒšgFÏg
 = 
kSŒšgTy³
 | 
kSŒšgFÏg
 | 
kCİyFÏg
,

557 
	gkObjeùFÏg
 = 
kObjeùTy³
,

558 
	gkA¼ayFÏg
 = 
kA¼ayTy³
,

560 
	gkTy³Mask
 = 0xFF

563 cÚ¡ 
SizeTy³
 
	gkDeçuÉA¼ayC­ac™y
 = 16;

564 cÚ¡ 
SizeTy³
 
	gkDeçuÉObjeùC­ac™y
 = 16;

566 
	sSŒšg
 {

567 cÚ¡ 
Ch
* 
	g¡r
;

568 
SizeTy³
 
	gËngth
;

569 
	ghashcode
;

573 
	uNumb”
 {

574 #ià
RAPIDJSON_ENDIAN
 =ğ
RAPIDJSON_LITTLEENDIAN


575 
	sI
 {

576 
	gi
;

577 
	g·ddšg
[4];

578 }
	gi
;

579 
	sU
 {

580 
	gu
;

581 
	g·ddšg2
[4];

582 }
	gu
;

584 
	sI
 {

585 
	g·ddšg
[4];

586 
	gi
;

587 }
	gi
;

588 
	sU
 {

589 
	g·ddšg2
[4];

590 
	gu
;

591 }
	gu
;

593 
št64_t
 
	gi64
;

594 
ušt64_t
 
	gu64
;

595 
	gd
;

598 
	sObjeù
 {

599 
Memb”
* 
	gmemb”s
;

600 
SizeTy³
 
	gsize
;

601 
SizeTy³
 
	gÿ·c™y
;

604 
	sA¼ay
 {

605 
	gG’”icV®ue
<
	gEncodšg
, 
	gAÎoÿtÜ
>* 
	g–em’ts
;

606 
SizeTy³
 
	gsize
;

607 
SizeTy³
 
	gÿ·c™y
;

610 
	uD©a
 {

611 
SŒšg
 
	gs
;

612 
Numb”
 
	gn
;

613 
Objeù
 
	go
;

614 
A¼ay
 
	ga
;

618 
Memb”
* 
FšdMemb”
(cÚ¡ 
Ch
* 
Çme
) {

619 
RAPIDJSON_ASSERT
(
Çme
);

620 
RAPIDJSON_ASSERT
(
IsObjeù
());

622 
SizeTy³
 
	gËngth
 = 
š‹º®
::
SŒL’
(
Çme
);

624 
	gObjeù
& 
	go
 = 
d©a_
.
o
;

625 
Memb”
* 
	gmemb”
 = 
o
.
memb”s
; memb” !ğ
d©a_
.o.memb” + d©a_.o.
size
; ++member)

626 ià(
	gËngth
 =ğ
memb”
->
Çme
.
d©a_
.
s
.
Ëngth
 && 
memcmp
(memb”->Çme.d©a_.s.
¡r
,‚ame,†’gth * (
Ch
)) == 0)

627  
memb”
;

631 cÚ¡ 
Memb”
* 
FšdMemb”
(cÚ¡ 
Ch
* 
Çme
ècÚ¡ {  
	gcÚ¡_ÿ¡
<
	gG’”icV®ue
&>(*
	gthis
).FindMember(name); }

634 
S‘A¼ayRaw
(
G’”icV®ue
* 
v®ues
, 
SizeTy³
 
couÁ
, 
AÎoÿtÜ
& 
®loùaÜ
) {

635 
	gæags_
 = 
kA¼ayFÏg
;

636 
	gd©a_
.
	ga
.
	g–em’ts
 = (
G’”icV®ue
*)
®loùaÜ
.
M®loc
(
couÁ
 * (GenericValue));

637 
memıy
(
d©a_
.
a
.
–em’ts
, 
v®ues
, 
couÁ
 * (
G’”icV®ue
));

638 
	gd©a_
.
	ga
.
	gsize
 = 
d©a_
.
a
.
ÿ·c™y
 = 
couÁ
;

642 
S‘ObjeùRaw
(
Memb”
* 
memb”s
, 
SizeTy³
 
couÁ
, 
AÎoÿtÜ
& 
®loùaÜ
) {

643 
	gæags_
 = 
kObjeùFÏg
;

644 
	gd©a_
.
	go
.
	gmemb”s
 = (
Memb”
*)
®loùaÜ
.
M®loc
(
couÁ
 * (Member));

645 
memıy
(
d©a_
.
o
.
memb”s
, memb”s, 
couÁ
 * (
Memb”
));

646 
	gd©a_
.
	go
.
	gsize
 = 
d©a_
.
o
.
ÿ·c™y
 = 
couÁ
;

650 
S‘SŒšgRaw
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
) {

651 
RAPIDJSON_ASSERT
(
s
 !ğ
NULL
);

652 
	gæags_
 = 
kCÚ¡SŒšgFÏg
;

653 
	gd©a_
.
	gs
.
	g¡r
 = 
s
;

654 
	gd©a_
.
	gs
.
	gËngth
 = 
Ëngth
;

658 
S‘SŒšgRaw
(cÚ¡ 
Ch
* 
s
, 
SizeTy³
 
Ëngth
, 
AÎoÿtÜ
& 
®loÿtÜ
) {

659 
RAPIDJSON_ASSERT
(
s
 !ğ
NULL
);

660 
	gæags_
 = 
kCİySŒšgFÏg
;

661 
	gd©a_
.
	gs
.
	g¡r
 = (
Ch
 *)
®loÿtÜ
.
M®loc
((
Ëngth
 + 1) * (Ch));

662 
	gd©a_
.
	gs
.
	gËngth
 = 
Ëngth
;

663 
memıy
(
cÚ¡_ÿ¡
<
Ch
*>(
d©a_
.
s
.
¡r
), s, 
Ëngth
 * (Ch));

664 
	gcÚ¡_ÿ¡
<
	gCh
*>(
	gd©a_
.
	gs
.
	g¡r
)[
Ëngth
] = '\0';

668 
RawAssign
(
G’”icV®ue
& 
rhs
) {

669 
memıy
(
this
, &
rhs
, (
G’”icV®ue
));

670 
	grhs
.
	gæags_
 = 
kNuÎFÏg
;

673 
D©a
 
	gd©a_
;

674 
	gæags_
;

676 #´agm¨
	$·ck
 (
pİ
)

679 
G’”icV®ue
<
	tUTF8
<> > 
	tV®ue
;

690 
‹m¶©e
 <
ty³Çme
 
Encodšg
,y³Çm
AÎoÿtÜ
 = 
MemÜyPoŞAÎoÿtÜ
<> >

691 
şass
 
G’”icDocum’t
 : 
public
 
G’”icV®ue
<
Encodšg
, 
AÎoÿtÜ
> {

692 
public
:

693 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

694 
G’”icV®ue
<
	tEncodšg
, 
	tAÎoÿtÜ
> 
	tV®ueTy³
;

695 
AÎoÿtÜ
 
	tAÎoÿtÜTy³
;

701 
	`G’”icDocum’t
(
AÎoÿtÜ
* 
®loÿtÜ
 = 0, 
size_t
 
¡ackC­ac™y
 = 
kDeçuÉSckC­ac™y
è: 
	`¡ack_
×ÎoÿtÜ, sckC­ac™y), 
	`·r£E¼Ü_
(0), 
	`”rÜOff£t_
(0) {}

708 
‹m¶©e
 <
·r£FÏgs
, 
ty³Çme
 
SŒ—m
>

709 
G’”icDocum’t
& 
	`P¬£SŒ—m
(
SŒ—m
& 
¡»am
) {

710 
V®ueTy³
::
	`S‘NuÎ
();

711 
G’”icR—d”
<
Encodšg
, 
AÎoÿtÜ
> 
»ad”
;

712 ià(
»ad”
.
‹m¶©e
 
P¬£
<
·r£FÏgs
>(
¡»am
, *
this
)) {

713 
	`RAPIDJSON_ASSERT
(
¡ack_
.
	`G‘Size
(è=ğ(
V®ueTy³
));

714 
this
->
	`RawAssign
(*
¡ack_
.
‹m¶©e
 
Pİ
<
V®ueTy³
>(1));

715 
·r£E¼Ü_
 = 0;

716 
”rÜOff£t_
 = 0;

719 
·r£E¼Ü_
 = 
»ad”
.
	`G‘P¬£E¼Ü
();

720 
”rÜOff£t_
 = 
»ad”
.
	`G‘E¼ÜOff£t
();

721 
	`CË¬Sck
();

723  *
this
;

731 
‹m¶©e
 <
·r£FÏgs
>

732 
G’”icDocum’t
& 
	`P¬£Ins™u
(
Ch
* 
¡r
) {

733 
G’”icIns™uSŒšgSŒ—m
<
Encodšg
> 
	`s
(
¡r
);

734  
P¬£SŒ—m
<
·r£FÏgs
 | 
kP¬£Ins™uFÏg
>(
s
);

741 
‹m¶©e
 <
·r£FÏgs
>

742 
G’”icDocum’t
& 
	`P¬£
(cÚ¡ 
Ch
* 
¡r
) {

743 
	`RAPIDJSON_ASSERT
(!(
·r£FÏgs
 & 
kP¬£Ins™uFÏg
));

744 
G’”icSŒšgSŒ—m
<
Encodšg
> 
	`s
(
¡r
);

745  
P¬£SŒ—m
<
·r£FÏgs
>(
s
);

749 
boŞ
 
	`HasP¬£E¼Ü
(ècÚ¡ {  
·r£E¼Ü_
 != 0; }

752 cÚ¡ * 
	`G‘P¬£E¼Ü
(ècÚ¡ {  
·r£E¼Ü_
; }

755 
size_t
 
	`G‘E¼ÜOff£t
(ècÚ¡ {  
”rÜOff£t_
; }

758 
AÎoÿtÜ
& 
	`G‘AÎoÿtÜ
(è{  
¡ack_
.GetAllocator(); }

761 
size_t
 
	`G‘SckC­ac™y
(ècÚ¡ {  
¡ack_
.
	`G‘C­ac™y
(); }

763 
´iv©e
:

765 
G’”icDocum’t
& 
İ”©Ü
=(const GenericDocument&);

767 
ä›nd
 
şass
 
G’”icR—d”
<
Encodšg
, 
AÎoÿtÜ
>;

770 
	`NuÎ
(è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(); }

771 
	`BoŞ
(
boŞ
 
b
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(b); }

772 
	`IÁ
(
i
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(i); }

773 
	`Ušt
(
i
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(i); }

774 
	`IÁ64
(
št64_t
 
i
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(i); }

775 
	`Ušt64
(
ušt64_t
 
i
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(i); }

776 
	`DoubË
(
d
è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(d); }

778 
	`SŒšg
(cÚ¡ 
Ch
* 
¡r
, 
SizeTy³
 
Ëngth
, 
boŞ
 
cİy
) {

779 ià(
cİy
)

780 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(
¡r
, 
Ëngth
, 
	`G‘AÎoÿtÜ
());

782 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(
¡r
, 
Ëngth
);

785 
	`S¹Objeù
(è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(
kObjeùTy³
); }

787 
	`EndObjeù
(
SizeTy³
 
memb”CouÁ
) {

788 
ty³Çme
 
V®ueTy³
::
Memb”
* 
memb”s
 = 
¡ack_
.
‹m¶©e
 
Pİ
<ty³ÇmV®ueTy³::Memb”>(
memb”CouÁ
);

789 
¡ack_
.
‹m¶©e
 
Tİ
<
V®ueTy³
>()->
	`S‘ObjeùRaw
(
memb”s
, (
SizeTy³
)
memb”CouÁ
, 
	`G‘AÎoÿtÜ
());

792 
	`S¹A¼ay
(è{ 
	`Ãw
 (
¡ack_
.
‹m¶©e
 
Push
<
V®ueTy³
>()è
	`V®ueTy³
(
kA¼ayTy³
); }

794 
	`EndA¼ay
(
SizeTy³
 
–em’tCouÁ
) {

795 
V®ueTy³
* 
–em’ts
 = 
¡ack_
.
‹m¶©e
 
Pİ
<V®ueTy³>(
–em’tCouÁ
);

796 
¡ack_
.
‹m¶©e
 
Tİ
<
V®ueTy³
>()->
	`S‘A¼ayRaw
(
–em’ts
, 
–em’tCouÁ
, 
	`G‘AÎoÿtÜ
());

799 
	`CË¬Sck
() {

800 ià(
AÎoÿtÜ
::
kN“dF»e
)

801 
¡ack_
.
	`G‘Size
() > 0)

802 (
¡ack_
.
‹m¶©e
 
Pİ
<
V®ueTy³
>(1))->~
	`V®ueTy³
();

804 
¡ack_
.
	`CË¬
();

807 cÚ¡ 
size_t
 
kDeçuÉSckC­ac™y
 = 1024;

808 
š‹º®
::
Sck
<
AÎoÿtÜ
> 
¡ack_
;

809 cÚ¡ * 
·r£E¼Ü_
;

810 
size_t
 
”rÜOff£t_
;

811 
	}
};

813 
	gG’”icDocum’t
<
	tUTF8
<> > 
	tDocum’t
;

817 #ifdeà
_MSC_VER


818 #´agm¨
w¬nšg
(
pİ
)

	@/home/libin3-s/ldd/courier/rapidjson/filestream.h

1 #iâdeà
RAPIDJSON_FILESTREAM_H_


2 
	#RAPIDJSON_FILESTREAM_H_


	)

4 
	~<c¡dio
>

6 
Çme¥aû
 
	g¿pidjsÚ
 {

13 şas 
	cFeSŒ—m
 {

14 
	gpublic
:

15 
	tCh
;

17 
FeSŒ—m
(
FILE
* 
å
è: 
å_
(å), 
couÁ_
(0è{ 
R—d
(); }

18 
P“k
(ècÚ¡ {  
	gcu¼’t_
; }

19 
Take
(è{ 
	gc
 = 
cu¼’t_
; 
R—d
();  c; }

20 
size_t
 
T–l
(ècÚ¡ {  
	gcouÁ_
; }

21 
Put
(
c
è{ 
åutc
(c, 
å_
); }

24 * 
PutBegš
() {  0; }

25 
size_t
 
PutEnd
(*) {  0; }

27 
	g´iv©e
:

28 
R—d
() {

29 
RAPIDJSON_ASSERT
(
å_
 != 0);

30 
	gc
 = 
fg‘c
(
å_
);

31 ià(
	gc
 !ğ
EOF
) {

32 
cu¼’t_
 = ()
c
;

33 
	gcouÁ_
++;

36 
	gcu¼’t_
 = '\0';

39 
FILE
* 
	gå_
;

40 
	gcu¼’t_
;

41 
size_t
 
	gcouÁ_
;

	@/home/libin3-s/ldd/courier/rapidjson/internal/pow10.h

1 #iâdeà
RAPIDJSON_POW10_


2 
	#RAPIDJSON_POW10_


	)

4 
Çme¥aû
 
	g¿pidjsÚ
 {

5 
Çme¥aû
 
	gš‹º®
 {

12 
šlše
 
Pow10
(
n
) {

13 cÚ¡ 
	ge
[] = {

47 
RAPIDJSON_ASSERT
(
n
 <= 308);

48  
	gn
 < -308 ? 0.0 : 
e
[
n
 + 308];

	@/home/libin3-s/ldd/courier/rapidjson/internal/stack.h

1 #iâdeà
RAPIDJSON_INTERNAL_STACK_H_


2 
	#RAPIDJSON_INTERNAL_STACK_H_


	)

4 
Çme¥aû
 
	g¿pidjsÚ
 {

5 
Çme¥aû
 
	gš‹º®
 {

13 
	g‹m¶©e
 <
ty³Çme
 
	gAÎoÿtÜ
>

14 şas 
	cSck
 {

15 
	gpublic
:

16 
Sck
(
AÎoÿtÜ
* 
®loÿtÜ
, 
size_t
 
¡ack_ÿ·c™y
è: 
®loÿtÜ_
×ÎoÿtÜ), 
own_®loÿtÜ_
(0), 
¡ack_
(0), 
¡ack_tİ_
(0), 
¡ack_’d_
(0), 
¡ack_ÿ·c™y_
(stack_capacity) {

17 
RAPIDJSON_ASSERT
(
¡ack_ÿ·c™y_
 > 0);

18 ià(!
	g®loÿtÜ_
)

19 
	gown_®loÿtÜ_
 = 
®loÿtÜ_
 = 
Ãw
 
AÎoÿtÜ
();

20 
	g¡ack_tİ_
 = 
¡ack_
 = (*)
®loÿtÜ_
->
M®loc
(
¡ack_ÿ·c™y_
);

21 
	g¡ack_’d_
 = 
¡ack_
 + 
¡ack_ÿ·c™y_
;

24 ~
Sck
() {

25 
	gAÎoÿtÜ
::
F»e
(
¡ack_
);

26 
d–‘e
 
	gown_®loÿtÜ_
;

29 
CË¬
(è{ 
	g¡ack_tİ_
 = 
¡ack_
; }

31 
	g‹m¶©e
<
ty³Çme
 
	gT
>

32 
T
* 
Push
(
size_t
 
couÁ
 = 1) {

34 ià(
¡ack_tİ_
 + (
T
è* 
couÁ
 >ğ
¡ack_’d_
) {

35 
size_t
 
Ãw_ÿ·c™y
 = 
¡ack_ÿ·c™y_
 * 2;

36 
size_t
 
	gsize
 = 
G‘Size
();

37 
size_t
 
	gÃw_size
 = 
G‘Size
(è+ (
T
è* 
couÁ
;

38 ià(
	gÃw_ÿ·c™y
 < 
	gÃw_size
)

39 
	gÃw_ÿ·c™y
 = 
Ãw_size
;

40 
	g¡ack_
 = (*)
®loÿtÜ_
->
R—Îoc
(
¡ack_
, 
¡ack_ÿ·c™y_
, 
Ãw_ÿ·c™y
);

41 
	g¡ack_ÿ·c™y_
 = 
Ãw_ÿ·c™y
;

42 
	g¡ack_tİ_
 = 
¡ack_
 + 
size
;

43 
	g¡ack_’d_
 = 
¡ack_
 + 
¡ack_ÿ·c™y_
;

45 
T
* 
	g»t
 = (T*)
¡ack_tİ_
;

46 
	g¡ack_tİ_
 +ğ(
T
è* 
couÁ
;

47  
	g»t
;

50 
	g‹m¶©e
<
ty³Çme
 
	gT
>

51 
T
* 
Pİ
(
size_t
 
couÁ
) {

52 
RAPIDJSON_ASSERT
(
G‘Size
(è>ğ
couÁ
 * (
T
));

53 
	g¡ack_tİ_
 -ğ
couÁ
 * (
T
);

54  (
	gT
*)
	g¡ack_tİ_
;

57 
	g‹m¶©e
<
ty³Çme
 
	gT
>

58 
T
* 
Tİ
() {

59 
RAPIDJSON_ASSERT
(
G‘Size
(è>ğ(
T
));

60  (
	gT
*)(
	g¡ack_tİ_
 - (T));

63 
	g‹m¶©e
<
ty³Çme
 
	gT
>

64 
T
* 
BÙtom
(è{  (
	gT
*)
	g¡ack_
; }

66 
	gAÎoÿtÜ
& 
G‘AÎoÿtÜ
(è{  *
	g®loÿtÜ_
; }

67 
size_t
 
G‘Size
(ècÚ¡ {  
	g¡ack_tİ_
 - 
	g¡ack_
; }

68 
size_t
 
G‘C­ac™y
(ècÚ¡ {  
	g¡ack_ÿ·c™y_
; }

70 
	g´iv©e
:

71 
AÎoÿtÜ
* 
®loÿtÜ_
;

72 
AÎoÿtÜ
* 
	gown_®loÿtÜ_
;

73 *
	g¡ack_
;

74 *
	g¡ack_tİ_
;

75 *
	g¡ack_’d_
;

76 
size_t
 
	g¡ack_ÿ·c™y_
;

	@/home/libin3-s/ldd/courier/rapidjson/internal/strfunc.h

1 #iâdeà
RAPIDJSON_INTERNAL_STRFUNC_H_


2 
	#RAPIDJSON_INTERNAL_STRFUNC_H_


	)

4 
Çme¥aû
 
	g¿pidjsÚ
 {

5 
Çme¥aû
 
	gš‹º®
 {

13 
	g‹m¶©e
 <
ty³Çme
 
	gCh
>

14 
šlše
 
SizeTy³
 
SŒL’
(cÚ¡ 
Ch
* 
s
) {

15 cÚ¡ 
Ch
* 
	gp
 = 
s
;

16 *
	gp
 != '\0')

17 ++
p
;

18  
SizeTy³
(
p
 - 
s
);

	@/home/libin3-s/ldd/courier/rapidjson/prettywriter.h

1 #iâdeà
RAPIDJSON_PRETTYWRITER_H_


2 
	#RAPIDJSON_PRETTYWRITER_H_


	)

4 
	~"wr™”.h
"

6 
Çme¥aû
 
	g¿pidjsÚ
 {

14 
	g‹m¶©e
<
ty³Çme
 
	gSŒ—m
,y³Çm
	gEncodšg
 = 
UTF8
<>,y³Çm
	gAÎoÿtÜ
 = 
MemÜyPoŞAÎoÿtÜ
<> >

15 
şass
 
P»‰yWr™”
 : 
public
 
Wr™”
<
SŒ—m
, 
	gEncodšg
, 
	gAÎoÿtÜ
> {

16 
	gpublic
:

17 
Wr™”
<
	tSŒ—m
, 
	tEncodšg
, 
	tAÎoÿtÜ
> 
	tBa£
;

18 
ty³Çme
 
	tBa£
::
	tCh
 Ch;

25 
P»‰yWr™”
(
SŒ—m
& 
¡»am
, 
AÎoÿtÜ
* 
®loÿtÜ
 = 0, 
size_t
 
Ëv–D•th
 = 
Ba£
::
kDeçuÉLev–D•th
) :

26 
Ba£
(
¡»am
, 
®loÿtÜ
, 
Ëv–D•th
), 
šd’tCh¬_
(' '), 
šd’tCh¬CouÁ_
(4) {}

33 
	gP»‰yWr™”
& 
S‘Ind’t
(
Ch
 
šd’tCh¬
, 
šd’tCh¬CouÁ
) {

34 
RAPIDJSON_ASSERT
(
šd’tCh¬
 == ' ' || indentChar == '\t' || indentChar == '\n' || indentChar == '\r');

35 
	gšd’tCh¬_
 = 
šd’tCh¬
;

36 
	gšd’tCh¬CouÁ_
 = 
šd’tCh¬CouÁ
;

37  *
	gthis
;

43 
	gP»‰yWr™”
& 
NuÎ
(è{ 
P»‰yP»fix
(
kNuÎTy³
); 
	gBa£
::
Wr™eNuÎ
();  *
	gthis
; }

44 
	gP»‰yWr™”
& 
BoŞ
(
boŞ
 
b
è{ 
P»‰yP»fix
(b ? 
kTrueTy³
 : 
kF®£Ty³
); 
	gBa£
::
Wr™eBoŞ
(b);  *
	gthis
; }

45 
	gP»‰yWr™”
& 
IÁ
(
i
è{ 
P»‰yP»fix
(
kNumb”Ty³
); 
	gBa£
::
Wr™eIÁ
(i);  *
	gthis
; }

46 
	gP»‰yWr™”
& 
Ušt
(
u
è{ 
P»‰yP»fix
(
kNumb”Ty³
); 
	gBa£
::
Wr™eUšt
(u);  *
	gthis
; }

47 
	gP»‰yWr™”
& 
IÁ64
(
št64_t
 
i64
è{ 
P»‰yP»fix
(
kNumb”Ty³
); 
	gBa£
::
Wr™eIÁ64
(i64);  *
	gthis
; }

48 
	gP»‰yWr™”
& 
Ušt64
(
ušt64_t
 
u64
è{ 
P»‰yP»fix
(
kNumb”Ty³
); 
	gBa£
::
Wr™eUšt64
(u64);  *
	gthis
; }

49 
	gP»‰yWr™”
& 
DoubË
(
d
è{ 
P»‰yP»fix
(
kNumb”Ty³
); 
	gBa£
::
Wr™eDoubË
(d);  *
	gthis
; }

51 
	gP»‰yWr™”
& 
SŒšg
(cÚ¡ 
Ch
* 
¡r
, 
SizeTy³
 
Ëngth
, 
boŞ
 
cİy
 = 
çl£
) {

52 ()
cİy
;

53 
P»‰yP»fix
(
kSŒšgTy³
);

54 
	gBa£
::
Wr™eSŒšg
(
¡r
, 
Ëngth
);

55  *
	gthis
;

58 
	gP»‰yWr™”
& 
S¹Objeù
() {

59 
P»‰yP»fix
(
kObjeùTy³
);

60 
Ãw
 (
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Push
<
ty³Çme
 Ba£::
Lev–
>()èty³ÇmBa£::Lev–(
çl£
);

61 
	gBa£
::
Wr™eS¹Objeù
();

62  *
	gthis
;

65 
	gP»‰yWr™”
& 
EndObjeù
(
SizeTy³
 
memb”CouÁ
 = 0) {

66 ()
memb”CouÁ
;

67 
RAPIDJSON_ASSERT
(
Ba£
::
Ëv–_¡ack_
.
G‘Size
(è>ğ(
ty³Çme
 Ba£::
Lev–
));

68 
RAPIDJSON_ASSERT
(!
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<
ty³Çme
 Ba£::
Lev–
>()->
šA¼ay
);

69 
boŞ
 
	gem±y
 = 
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Pİ
<
ty³Çme
 Ba£::
Lev–
>(1)->
v®ueCouÁ
 == 0;

71 ià(!
	gem±y
) {

72 
	gBa£
::
¡»am_
.
Put
('\n');

73 
Wr™eInd’t
();

75 
	gBa£
::
Wr™eEndObjeù
();

76  *
	gthis
;

79 
	gP»‰yWr™”
& 
S¹A¼ay
() {

80 
P»‰yP»fix
(
kA¼ayTy³
);

81 
Ãw
 (
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Push
<
ty³Çme
 Ba£::
Lev–
>()èty³ÇmBa£::Lev–(
Œue
);

82 
	gBa£
::
Wr™eS¹A¼ay
();

83  *
	gthis
;

86 
	gP»‰yWr™”
& 
EndA¼ay
(
SizeTy³
 
memb”CouÁ
 = 0) {

87 ()
memb”CouÁ
;

88 
RAPIDJSON_ASSERT
(
Ba£
::
Ëv–_¡ack_
.
G‘Size
(è>ğ(
ty³Çme
 Ba£::
Lev–
));

89 
RAPIDJSON_ASSERT
(
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<
ty³Çme
 Ba£::
Lev–
>()->
šA¼ay
);

90 
boŞ
 
	gem±y
 = 
Ba£
::
Ëv–_¡ack_
.
‹m¶©e
 
Pİ
<
ty³Çme
 Ba£::
Lev–
>(1)->
v®ueCouÁ
 == 0;

92 ià(!
	gem±y
) {

93 
	gBa£
::
¡»am_
.
Put
('\n');

94 
Wr™eInd’t
();

96 
	gBa£
::
Wr™eEndA¼ay
();

97  *
	gthis
;

103 
	gP»‰yWr™”
& 
SŒšg
(cÚ¡ 
Ch
* 
¡r
è{  SŒšg(¡r, 
š‹º®
::
SŒL’
(str)); }

105 
	g´Ùeùed
:

106 
P»‰yP»fix
(
Ty³
 
ty³
) {

107 ()
ty³
;

108 ià(
	gBa£
::
Ëv–_¡ack_
.
G‘Size
() != 0) {

109 
ty³Çme
 
Ba£
::
Lev–
* 
Ëv–
 = Ba£::
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<typename Base::Level>();

111 ià(
	gËv–
->
	gšA¼ay
) {

112 ià(
	gËv–
->
	gv®ueCouÁ
 > 0) {

113 
	gBa£
::
¡»am_
.
Put
(',');

114 
	gBa£
::
¡»am_
.
Put
('\n');

117 
	gBa£
::
¡»am_
.
Put
('\n');

118 
Wr™eInd’t
();

121 ià(
	gËv–
->
	gv®ueCouÁ
 > 0) {

122 ià(
	gËv–
->
	gv®ueCouÁ
 % 2 == 0) {

123 
Ba£
::
¡»am_
.
Put
(',');

124 
	gBa£
::
¡»am_
.
Put
('\n');

127 
	gBa£
::
¡»am_
.
Put
(':');

128 
	gBa£
::
¡»am_
.
Put
(' ');

132 
	gBa£
::
¡»am_
.
Put
('\n');

134 ià(
	gËv–
->
	gv®ueCouÁ
 % 2 == 0)

135 
Wr™eInd’t
();

137 ià(!
	gËv–
->
	gšA¼ay
 &&†ev–->
	gv®ueCouÁ
 % 2 == 0)

138 
RAPIDJSON_ASSERT
(
ty³
 =ğ
kSŒšgTy³
);

139 
	gËv–
->
	gv®ueCouÁ
++;

142 
RAPIDJSON_ASSERT
(
ty³
 =ğ
kObjeùTy³
 ||y³ =ğ
kA¼ayTy³
);

145 
Wr™eInd’t
() {

146 
size_t
 
	gcouÁ
 = (
Ba£
::
Ëv–_¡ack_
.
G‘Size
(è/ (
ty³Çme
 Ba£::
Lev–
)è* 
šd’tCh¬CouÁ_
;

147 
PutN
(
Ba£
::
¡»am_
, 
šd’tCh¬_
, 
couÁ
);

150 
Ch
 
	gšd’tCh¬_
;

151 
	gšd’tCh¬CouÁ_
;

	@/home/libin3-s/ldd/courier/rapidjson/rapidjson.h

1 #iâdeà
RAPIDJSON_RAPIDJSON_H_


2 
	#RAPIDJSON_RAPIDJSON_H_


	)

7 
	~<c¡dlib
>

8 
	~<c¡ršg
>

15 #iâdeà
RAPIDJSON_NO_INT64DEFINE


16 #ifdeà
_MSC_VER


17 
__št64
 
	tšt64_t
;

18 
	t__št64
 
	tušt64_t
;

20 
	~<š‰y³s.h
>

26 
	#RAPIDJSON_LITTLEENDIAN
 0

27 
	#RAPIDJSON_BIGENDIAN
 1

28 

	)

34 #iâdeà
RAPIDJSON_ENDIAN


35 #ifdeà
__BYTE_ORDER__


36 #ià
__BYTE_ORDER__
 =ğ
__ORDER_LITTLE_ENDIAN__


37 
	#RAPIDJSON_ENDIAN
 
RAPIDJSON_LITTLEENDIAN


	)

39 
	#RAPIDJSON_ENDIAN
 
RAPIDJSON_BIGENDIAN


	)

42 
	#RAPIDJSON_ENDIAN
 
RAPIDJSON_LITTLEENDIAN


45 

	)

55 #ià
defšed
(
RAPIDJSON_SSE2
è|| defšed(
RAPIDJSON_SSE42
)

56 
	#RAPIDJSON_SIMD


	)

62 #iâdeà
RAPIDJSON_NO_SIZETYPEDEFINE


63 
Çme¥aû
 
	g¿pidjsÚ
 {

67 
	tSizeTy³
;

78 #iâdeà
RAPIDJSON_ASSERT


79 
	~<ÿs£¹
>

80 
	#RAPIDJSON_ASSERT
(
x
è
	`as£¹
(x)

	)

86 
	#RAPIDJSON_MULTILINEMACRO_BEGIN
 dØ{

	)

87 
	#RAPIDJSON_MULTILINEMACRO_END
 \

	)

90 
Çme¥aû
 
	g¿pidjsÚ
 {

132 şas 
	cC¹AÎoÿtÜ
 {

133 
	gpublic
:

134 cÚ¡ 
boŞ
 
kN“dF»e
 = 
Œue
;

135 * 
M®loc
(
size_t
 
size
è{  
m®loc
(size); }

136 * 
R—Îoc
(* 
Üigš®PŒ
, 
size_t
 
Üigš®Size
, size_ˆ
ÃwSize
è{ ()
	gÜigš®Size
;  
»®loc
(originalPtr,‚ewSize); }

137 
F»e
(*
±r
è{ 
ä“
(ptr); }

159 
	g‹m¶©e
 <
ty³Çme
 
	gBa£AÎoÿtÜ
 = 
C¹AÎoÿtÜ
>

160 şas 
	cMemÜyPoŞAÎoÿtÜ
 {

161 
public
:

162 cÚ¡ 
boŞ
 
kN“dF»e
 = 
çl£
;

168 
MemÜyPoŞAÎoÿtÜ
(
size_t
 
chunkSize
 = 
kDeçuÉChunkC­ac™y
, 
Ba£AÎoÿtÜ
* 
ba£AÎoÿtÜ
 = 0) :

169 
chunkH—d_
(0), 
chunk_ÿ·c™y_
(
chunkSize
), 
u£rBufãr_
(0), 
ba£AÎoÿtÜ_
(
ba£AÎoÿtÜ
), 
ownBa£AÎoÿtÜ_
(0)

171 ià(!
	gba£AÎoÿtÜ_
)

172 
	gownBa£AÎoÿtÜ_
 = 
ba£AÎoÿtÜ_
 = 
Ãw
 
Ba£AÎoÿtÜ
();

173 
AddChunk
(
chunk_ÿ·c™y_
);

186 
MemÜyPoŞAÎoÿtÜ
(*
bufãr
, 
size_t
 
size
, size_ˆ
chunkSize
 = 
kDeçuÉChunkC­ac™y
, 
Ba£AÎoÿtÜ
* 
ba£AÎoÿtÜ
 = 0) :

187 
chunkH—d_
(0), 
chunk_ÿ·c™y_
(
chunkSize
), 
u£rBufãr_
(
bufãr
), 
ba£AÎoÿtÜ_
(
ba£AÎoÿtÜ
), 
ownBa£AÎoÿtÜ_
(0)

189 
RAPIDJSON_ASSERT
(
bufãr
 != 0);

190 
RAPIDJSON_ASSERT
(
size
 > (
ChunkH—d”
));

191 
	gchunkH—d_
 = (
ChunkH—d”
*)
bufãr
;

192 
	gchunkH—d_
->
	gÿ·c™y
 = 
size
 - (
ChunkH—d”
);

193 
	gchunkH—d_
->
	gsize
 = 0;

194 
	gchunkH—d_
->
	gÃxt
 = 0;

200 ~
MemÜyPoŞAÎoÿtÜ
() {

201 
CË¬
();

202 
d–‘e
 
	gownBa£AÎoÿtÜ_
;

206 
CË¬
() {

207 
	gchunkH—d_
 !ğ0 && 
chunkH—d_
 !ğ(
ChunkH—d”
 *)
u£rBufãr_
) {

208 
ChunkH—d”
* 
Ãxt
 = 
chunkH—d_
->next;

209 
	gba£AÎoÿtÜ_
->
F»e
(
chunkH—d_
);

210 
	gchunkH—d_
 = 
Ãxt
;

217 
size_t
 
C­ac™y
() {

218 
size_t
 
	gÿ·c™y
 = 0;

219 
ChunkH—d”
* 
	gc
 = 
chunkH—d_
; c !ğ0; c = 
c
->
Ãxt
)

220 
ÿ·c™y
 +ğ
c
->capacity;

221  
	gÿ·c™y
;

227 
size_t
 
Size
() {

228 
size_t
 
	gsize
 = 0;

229 
ChunkH—d”
* 
	gc
 = 
chunkH—d_
; c !ğ0; c = 
c
->
Ãxt
)

230 
size
 +ğ
c
->size;

231  
	gsize
;

235 * 
M®loc
(
size_t
 
size
) {

236 
	gsize
 = (
size
 + 3) & ~3;

238 ià(
	gchunkH—d_
->
	gsize
 + siz> chunkH—d_->
	gÿ·c™y
)

239 
AddChunk
(
chunk_ÿ·c™y_
 > 
size
 ? chunk_capacity_ : size);

241 *
	gbufãr
 = (*)(
chunkH—d_
 + 1è+ chunkH—d_->
size
;

242 
RAPIDJSON_ASSERT
(((
ušŒ_t
)
bufãr
 & 3) == 0);

243 
	gchunkH—d_
->
	gsize
 +ğ
size
;

245  
	gbufãr
;

249 * 
R—Îoc
(* 
Üigš®PŒ
, 
size_t
 
Üigš®Size
, size_ˆ
ÃwSize
) {

250 ià(
	gÜigš®PŒ
 == 0)

251  
M®loc
(
ÃwSize
);

254 ià(
	gÜigš®Size
 >ğ
ÃwSize
)

255  
Üigš®PŒ
;

258 ià(
	gÜigš®PŒ
 =ğ(*)(
chunkH—d_
 + 1è+ chunkH—d_->
size
 - 
Üigš®Size
) {

259 
size_t
 
šüem’t
 = 
ÃwSize
 - 
Üigš®Size
;

260 
	gšüem’t
 = (
šüem’t
 + 3) & ~3;

261 ià(
	gchunkH—d_
->
	gsize
 + 
	gšüem’t
 <ğ
chunkH—d_
->
ÿ·c™y
) {

262 
chunkH—d_
->
size
 +ğ
šüem’t
;

263 
RAPIDJSON_ASSERT
(((
ušŒ_t
)
Üigš®PŒ
 & 3) == 0);

264  
	gÜigš®PŒ
;

269 * 
	gÃwBufãr
 = 
M®loc
(
ÃwSize
);

270 
RAPIDJSON_ASSERT
(
ÃwBufãr
 != 0);

271  
memıy
(
ÃwBufãr
, 
Üigš®PŒ
, 
Üigš®Size
);

275 
F»e
(*) {}

277 
	g´iv©e
:

281 
AddChunk
(
size_t
 
ÿ·c™y
) {

282 
ChunkH—d”
* 
chunk
 = (ChunkH—d”*)
ba£AÎoÿtÜ_
->
M®loc
((ChunkH—d”è+ 
ÿ·c™y
);

283 
	gchunk
->
	gÿ·c™y
 = 
ÿ·c™y
;

284 
	gchunk
->
	gsize
 = 0;

285 
	gchunk
->
	gÃxt
 = 
chunkH—d_
;

286 
	gchunkH—d_
 = 
chunk
;

289 cÚ¡ 
	gkDeçuÉChunkC­ac™y
 = 64 * 1024;

294 
	sChunkH—d”
 {

295 
size_t
 
	gÿ·c™y
;

296 
size_t
 
	gsize
;

297 
ChunkH—d”
 *
	gÃxt
;

300 
ChunkH—d”
 *
	gchunkH—d_
;

301 
size_t
 
	gchunk_ÿ·c™y_
;

302 *
	gu£rBufãr_
;

303 
Ba£AÎoÿtÜ
* 
	gba£AÎoÿtÜ_
;

304 
Ba£AÎoÿtÜ
* 
	gownBa£AÎoÿtÜ_
;

334 
	g‹m¶©e
<
ty³Çme
 
	gCh¬Ty³
 = >

335 
	sUTF8
 {

336 
Ch¬Ty³
 
	tCh
;

338 
Ch
* 
Encode
(Ch *
bufãr
, 
cod•ošt
) {

339 ià(
	gcod•ošt
 <= 0x7F)

340 *
bufãr
++ = 
cod•ošt
 & 0xFF;

341 ià(
	gcod•ošt
 <= 0x7FF) {

342 *
bufãr
++ = 0xC0 | ((
cod•ošt
 >> 6) & 0xFF);

343 *
	gbufãr
++ = 0x80 | ((
cod•ošt
 & 0x3F));

345 ià(
	gcod•ošt
 <= 0xFFFF) {

346 *
bufãr
++ = 0xE0 | ((
cod•ošt
 >> 12) & 0xFF);

347 *
	gbufãr
++ = 0x80 | ((
cod•ošt
 >> 6) & 0x3F);

348 *
	gbufãr
++ = 0x80 | (
cod•ošt
 & 0x3F);

351 
RAPIDJSON_ASSERT
(
cod•ošt
 <= 0x10FFFF);

352 *
	gbufãr
++ = 0xF0 | ((
cod•ošt
 >> 18) & 0xFF);

353 *
	gbufãr
++ = 0x80 | ((
cod•ošt
 >> 12) & 0x3F);

354 *
	gbufãr
++ = 0x80 | ((
cod•ošt
 >> 6) & 0x3F);

355 *
	gbufãr
++ = 0x80 | (
cod•ošt
 & 0x3F);

357  
	gbufãr
;

369 
	g‹m¶©e
<
ty³Çme
 
	gCh¬Ty³
 = 
wch¬_t
>

370 
	sUTF16
 {

371 
Ch¬Ty³
 
	tCh
;

373 
Ch
* 
Encode
(Ch* 
bufãr
, 
cod•ošt
) {

374 ià(
	gcod•ošt
 <= 0xFFFF) {

375 
RAPIDJSON_ASSERT
(
cod•ošt
 < 0xD800 || codepoint > 0xDFFF);

376 *
	gbufãr
++ = 
¡©ic_ÿ¡
<
Ch
>(
cod•ošt
);

379 
RAPIDJSON_ASSERT
(
cod•ošt
 <= 0x10FFFF);

380 
	gv
 = 
cod•ošt
 - 0x10000;

381 *
	gbufãr
++ = 
¡©ic_ÿ¡
<
Ch
>((
v
 >> 10) + 0xD800);

382 *
	gbufãr
++ = (
v
 & 0x3FF) + 0xDC00;

384  
	gbufãr
;

396 
	g‹m¶©e
<
ty³Çme
 
	gCh¬Ty³
 = >

397 
	sUTF32
 {

398 
Ch¬Ty³
 
	tCh
;

400 
Ch
 *
Encode
(Ch* 
bufãr
, 
cod•ošt
) {

401 
RAPIDJSON_ASSERT
(
cod•ošt
 <= 0x10FFFF);

402 *
	gbufãr
++ = 
cod•ošt
;

403  
	gbufãr
;

447 
	g‹m¶©e
<
ty³Çme
 
	gSŒ—m
,y³Çm
	gCh
>

448 
šlše
 
	$PutN
(
SŒ—m
& 
¡»am
, 
Ch
 
c
, 
size_t
 
n
) {

449 
size_t
 
i
 = 0; i < 
n
; i++)

450 
¡»am
.
	`Put
(
c
);

451 
	}
}

459 
	g‹m¶©e
 <
ty³Çme
 
	gEncodšg
>

460 
	sG’”icSŒšgSŒ—m
 {

461 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

463 
G’”icSŒšgSŒ—m
(cÚ¡ 
Ch
 *
¤c
è: 
¤c_
(¤c), 
h—d_
(src) {}

465 
Ch
 
P“k
(ècÚ¡ {  *
	g¤c_
; }

466 
Ch
 
Take
(è{  *
	g¤c_
++; }

467 
size_t
 
T–l
(ècÚ¡ {  
	g¤c_
 - 
	gh—d_
; }

469 
Ch
* 
PutBegš
(è{ 
RAPIDJSON_ASSERT
(
çl£
);  0; }

470 
Put
(
Ch
è{ 
RAPIDJSON_ASSERT
(
çl£
); }

471 
size_t
 
PutEnd
(
Ch
*è{ 
RAPIDJSON_ASSERT
(
çl£
);  0; }

473 cÚ¡ 
Ch
* 
	g¤c_
;

474 cÚ¡ 
Ch
* 
	gh—d_
;

477 
	gG’”icSŒšgSŒ—m
<
	tUTF8
<> > 
	tSŒšgSŒ—m
;

486 
	g‹m¶©e
 <
ty³Çme
 
	gEncodšg
>

487 
	sG’”icIns™uSŒšgSŒ—m
 {

488 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

490 
G’”icIns™uSŒšgSŒ—m
(
Ch
 *
¤c
è: 
¤c_
(¤c), 
d¡_
(0), 
h—d_
(src) {}

493 
Ch
 
P“k
(è{  *
	g¤c_
; }

494 
Ch
 
Take
(è{  *
	g¤c_
++; }

495 
size_t
 
T–l
(è{  
	g¤c_
 - 
	gh—d_
; }

498 
Ch
* 
PutBegš
(è{  
	gd¡_
 = 
¤c_
; }

499 
Put
(
Ch
 
c
è{ 
RAPIDJSON_ASSERT
(
d¡_
 !ğ0); *
	gd¡_
++ = c; }

500 
size_t
 
PutEnd
(
Ch
* 
begš
è{  
	gd¡_
 - 
	gbegš
; }

502 
Ch
* 
	g¤c_
;

503 
Ch
* 
	gd¡_
;

504 
Ch
* 
	gh—d_
;

507 
	gG’”icIns™uSŒšgSŒ—m
<
	tUTF8
<> > 
	tIns™uSŒšgSŒ—m
;

513 
	eTy³
 {

514 
	gkNuÎTy³
 = 0,

515 
	gkF®£Ty³
 = 1,

516 
	gkTrueTy³
 = 2,

517 
	gkObjeùTy³
 = 3,

518 
	gkA¼ayTy³
 = 4,

519 
	gkSŒšgTy³
 = 5,

520 
	gkNumb”Ty³
 = 6,

	@/home/libin3-s/ldd/courier/rapidjson/reader.h

1 #iâdeà
RAPIDJSON_READER_H_


2 
	#RAPIDJSON_READER_H_


	)

7 
	~"¿pidjsÚ.h
"

8 
	~"š‹º®/pow10.h
"

9 
	~"š‹º®/¡ack.h
"

10 
	~<c£tjmp
>

12 #ifdeà
RAPIDJSON_SSE42


13 
	~<nmmšŒš.h
>

14 #–ià
defšed
(
RAPIDJSON_SSE2
)

15 
	~<emmšŒš.h
>

18 #ifdeà
_MSC_VER


19 #´agm¨
w¬nšg
(
push
)

20 #´agm¨
w¬nšg
(
di§bË
 : 4127)

23 #iâdeà
RAPIDJSON_PARSE_ERROR


24 
	#RAPIDJSON_PARSE_ERROR
(
msg
, 
off£t
è\

	)

25 
	gRAPIDJSON_MULTILINEMACRO_BEGIN
 \

26 
	g·r£E¼Ü_
 = 
msg
; \

27 
	g”rÜOff£t_
 = 
off£t
; \

28 
lÚgjmp
(
jmpbuf_
, 1); \

29 
	gRAPIDJSON_MULTILINEMACRO_END


32 
Çme¥aû
 
	g¿pidjsÚ
 {

38 
	eP¬£FÏg
 {

39 
	gkP¬£DeçuÉFÏgs
 = 0,

40 
	gkP¬£Ins™uFÏg
 = 1

74 
	g‹m¶©e
<
ty³Çme
 
	gEncodšg
 = 
UTF8
<> >

75 
	sBa£R—d”HªdËr
 {

76 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

78 
DeçuÉ
() {}

79 
NuÎ
(è{ 
DeçuÉ
(); }

80 
BoŞ
(
boŞ
è{ 
DeçuÉ
(); }

81 
IÁ
(è{ 
DeçuÉ
(); }

82 
Ušt
(è{ 
DeçuÉ
(); }

83 
IÁ64
(
št64_t
è{ 
DeçuÉ
(); }

84 
Ušt64
(
ušt64_t
è{ 
DeçuÉ
(); }

85 
DoubË
(è{ 
DeçuÉ
(); }

86 
SŒšg
(cÚ¡ 
Ch
*, 
SizeTy³
, 
boŞ
è{ 
DeçuÉ
(); }

87 
S¹Objeù
(è{ 
DeçuÉ
(); }

88 
EndObjeù
(
SizeTy³
è{ 
DeçuÉ
(); }

89 
S¹A¼ay
(è{ 
DeçuÉ
(); }

90 
EndA¼ay
(
SizeTy³
è{ 
DeçuÉ
(); }

100 
	g‹m¶©e
<
ty³Çme
 
	gSŒ—m
>

101 
SkWh™e¥aû
(
SŒ—m
& 
¡»am
) {

102 
SŒ—m
 
	gs
 = 
¡»am
;

103 
	gs
.
P“k
(è=ğ' ' || 
s
.Peek() == '\n' || s.Peek() == '\r' || s.Peek() == '\t')

104 
s
.
Take
();

105 
	g¡»am
 = 
s
;

108 #ifdeà
RAPIDJSON_SSE42


110 
šlše
 cÚ¡ *
SkWh™e¥aû_SIMD
(cÚ¡ * 
p
) {

111 cÚ¡ 
	gwh™e¥aû
[16] = " \n\r\t";

112 
__m128i
 
	gw
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)&
wh™e¥aû
[0]);

115 
__m128i
 
	gs
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)
p
);

116 
	gr
 = 
_mm_cvtsi128_si32
(
_mm_cmpi¡rm
(
w
, 
s
, 
_SIDD_UBYTE_OPS
 | 
_SIDD_CMP_EQUAL_ANY
 | 
_SIDD_BIT_MASK
 | 
_SIDD_NEGATIVE_POLARITY
));

117 ià(
	gr
 == 0)

118 
p
 += 16;

120 #ifdeà
_MSC_VER


121 
	goff£t
;

122 ià(
_B™SÿnFÜw¬d
(&
off£t
, 
r
))

123  
	gp
 + 
	goff£t
;

125 ià(
	gr
 != 0)

126  
p
 + 
__butš_ffs
(
r
) - 1;

132 #–ià
defšed
(
RAPIDJSON_SSE2
)

135 
šlše
 cÚ¡ *
SkWh™e¥aû_SIMD
(cÚ¡ * 
p
) {

136 cÚ¡ 
	gwh™e¥aûs
[4][17] = {

142 
__m128i
 
	gw0
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)&
wh™e¥aûs
[0][0]);

143 
__m128i
 
	gw1
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)&
wh™e¥aûs
[1][0]);

144 
__m128i
 
	gw2
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)&
wh™e¥aûs
[2][0]);

145 
__m128i
 
	gw3
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)&
wh™e¥aûs
[3][0]);

148 
__m128i
 
	gs
 = 
_mm_lßdu_si128
((cÚ¡ __m128˜*)
p
);

149 
__m128i
 
	gx
 = 
_mm_cm³q_•i8
(
s
, 
w0
);

150 
	gx
 = 
_mm_Ü_si128
(
x
, 
_mm_cm³q_•i8
(
s
, 
w1
));

151 
	gx
 = 
_mm_Ü_si128
(
x
, 
_mm_cm³q_•i8
(
s
, 
w2
));

152 
	gx
 = 
_mm_Ü_si128
(
x
, 
_mm_cm³q_•i8
(
s
, 
w3
));

153 
	gr
 = ~
_mm_movemask_•i8
(
x
);

154 ià(
	gr
 == 0)

155 
p
 += 16;

157 #ifdeà
_MSC_VER


158 
	goff£t
;

159 ià(
_B™SÿnFÜw¬d
(&
off£t
, 
r
))

160  
	gp
 + 
	goff£t
;

162 ià(
	gr
 != 0)

163  
p
 + 
__butš_ffs
(
r
) - 1;

171 #ifdeà
RAPIDJSON_SIMD


173 
	g‹m¶©e
<> 
šlše
 
SkWh™e¥aû
(
Ins™uSŒšgSŒ—m
& 
¡»am
) {

174 
	g¡»am
.
	g¤c_
 = 
cÚ¡_ÿ¡
<*>(
SkWh™e¥aû_SIMD
(
¡»am
.
¤c_
));

178 
	g‹m¶©e
<> 
šlše
 
SkWh™e¥aû
(
SŒšgSŒ—m
& 
¡»am
) {

179 
	g¡»am
.
	g¤c_
 = 
SkWh™e¥aû_SIMD
(
¡»am
.
¤c_
);

201 
	g‹m¶©e
 <
ty³Çme
 
	gEncodšg
,y³Çm
	gAÎoÿtÜ
 = 
MemÜyPoŞAÎoÿtÜ
<> >

202 şas 
	cG’”icR—d”
 {

203 
public
:

204 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

210 
G’”icR—d”
(
AÎoÿtÜ
* 
®loÿtÜ
 = 0, 
size_t
 
¡ackC­ac™y
 = 
kDeçuÉSckC­ac™y
è: 
¡ack_
×ÎoÿtÜ, sckC­ac™y), 
·r£E¼Ü_
(0), 
”rÜOff£t_
(0) {}

220 
	g‹m¶©e
 <
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

221 
boŞ
 
P¬£
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

222 
	g·r£E¼Ü_
 = 0;

223 
	g”rÜOff£t_
 = 0;

225 #ifdeà
_MSC_VER


226 #´agm¨
w¬nšg
(
push
)

227 #´agm¨
w¬nšg
(
di§bË
 : 4611)

229 ià(
£tjmp
(
jmpbuf_
)) {

230 #ifdeà
_MSC_VER


231 #´agm¨
w¬nšg
(
pİ
)

233 
	g¡ack_
.
CË¬
();

234  
	gçl£
;

237 
SkWh™e¥aû
(
¡»am
);

239 ià(
	g¡»am
.
P“k
() == '\0')

240 
RAPIDJSON_PARSE_ERROR
("TexˆÚly cÚš wh™¥aû(s)", 
¡»am
.
T–l
());

242 
	g¡»am
.
P“k
()) {

243 '{': 
P¬£Objeù
<
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

244 '[': 
P¬£A¼ay
<
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

245 : 
RAPIDJSON_PARSE_ERROR
("Ex³ùƒ™h”‡Àobjeù o¸¬¿y‡ˆroÙ", 
¡»am
.
T–l
());

247 
SkWh™e¥aû
(
¡»am
);

249 ià(
	g¡»am
.
P“k
() != '\0')

250 
RAPIDJSON_PARSE_ERROR
("NÙhšg should fŞlowhroÙ objeù o¸¬¿y.", 
¡»am
.
T–l
());

253  
	gŒue
;

256 
boŞ
 
HasP¬£E¼Ü
(ècÚ¡ {  
	g·r£E¼Ü_
 != 0; }

257 cÚ¡ * 
G‘P¬£E¼Ü
(ècÚ¡ {  
	g·r£E¼Ü_
; }

258 
size_t
 
G‘E¼ÜOff£t
(ècÚ¡ {  
	g”rÜOff£t_
; }

260 
	g´iv©e
:

262 
‹m¶©e
<
·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

263 
P¬£Objeù
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

264 
RAPIDJSON_ASSERT
(
¡»am
.
P“k
() == '{');

265 
	g¡»am
.
Take
();

266 
	ghªdËr
.
S¹Objeù
();

267 
SkWh™e¥aû
(
¡»am
);

269 ià(
	g¡»am
.
P“k
() == '}') {

270 
¡»am
.
Take
();

271 
	ghªdËr
.
EndObjeù
(0);

275 
SizeTy³
 
	gmemb”CouÁ
 = 0;;) {

276 ià(
	g¡»am
.
P“k
() != '"') {

277 
RAPIDJSON_PARSE_ERROR
("Namoàª objeù memb” mu¡ b¨¡ršg", 
¡»am
.
T–l
());

281 
	gP¬£SŒšg
<
	g·r£FÏgs
>(
	g¡»am
, 
	ghªdËr
);

282 
SkWh™e¥aû
(
¡»am
);

284 ià(
	g¡»am
.
Take
() != ':') {

285 
RAPIDJSON_PARSE_ERROR
("Th”mu¡ b¨cŞÚ‡á”hÇmoàobjeù memb”", 
¡»am
.
T–l
());

288 
SkWh™e¥aû
(
¡»am
);

290 
	gP¬£V®ue
<
	g·r£FÏgs
>(
	g¡»am
, 
	ghªdËr
);

291 
SkWh™e¥aû
(
¡»am
);

293 ++
	gmemb”CouÁ
;

295 
	g¡»am
.
Take
()) {

296 ',': 
SkWh™e¥aû
(
¡»am
); ;

297 '}': 
hªdËr
.
EndObjeù
(
memb”CouÁ
); ;

298 : 
RAPIDJSON_PARSE_ERROR
("Mu¡ b¨comm¨Ü '}'‡á”‡Àobjeù memb”", 
¡»am
.
T–l
());

304 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

305 
P¬£A¼ay
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

306 
RAPIDJSON_ASSERT
(
¡»am
.
P“k
() == '[');

307 
	g¡»am
.
Take
();

308 
	ghªdËr
.
S¹A¼ay
();

309 
SkWh™e¥aû
(
¡»am
);

311 ià(
	g¡»am
.
P“k
() == ']') {

312 
¡»am
.
Take
();

313 
	ghªdËr
.
EndA¼ay
(0);

317 
SizeTy³
 
	g–em’tCouÁ
 = 0;;) {

318 
	gP¬£V®ue
<
	g·r£FÏgs
>(
	g¡»am
, 
	ghªdËr
);

319 ++
	g–em’tCouÁ
;

320 
SkWh™e¥aû
(
¡»am
);

322 
	g¡»am
.
Take
()) {

323 ',': 
SkWh™e¥aû
(
¡»am
); ;

324 ']': 
hªdËr
.
EndA¼ay
(
–em’tCouÁ
); ;

325 : 
RAPIDJSON_PARSE_ERROR
("Mu¡ b¨comm¨Ü ']'‡á”‡À¬¿yƒËm’t.", 
¡»am
.
T–l
());

330 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

331 
P¬£NuÎ
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

332 
RAPIDJSON_ASSERT
(
¡»am
.
P“k
() == 'n');

333 
	g¡»am
.
Take
();

335 ià(
	g¡»am
.
Take
(è=ğ'u' && 
¡»am
.Take() == 'l' && stream.Take() == 'l')

336 
hªdËr
.
NuÎ
();

338 
RAPIDJSON_PARSE_ERROR
("Inv®id v®ue", 
¡»am
.
T–l
() - 1);

341 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

342 
P¬£True
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

343 
RAPIDJSON_ASSERT
(
¡»am
.
P“k
() == 't');

344 
	g¡»am
.
Take
();

346 ià(
	g¡»am
.
Take
(è=ğ'r' && 
¡»am
.Take() == 'u' && stream.Take() == 'e')

347 
hªdËr
.
BoŞ
(
Œue
);

349 
RAPIDJSON_PARSE_ERROR
("Inv®id v®ue", 
¡»am
.
T–l
());

352 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

353 
P¬£F®£
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

354 
RAPIDJSON_ASSERT
(
¡»am
.
P“k
() == 'f');

355 
	g¡»am
.
Take
();

357 ià(
	g¡»am
.
Take
(è=ğ'a' && 
¡»am
.Take() == 'l' && stream.Take() == 's' && stream.Take() == 'e')

358 
hªdËr
.
BoŞ
(
çl£
);

360 
RAPIDJSON_PARSE_ERROR
("Inv®id v®ue", 
¡»am
.
T–l
() - 1);

364 
	g‹m¶©e
<
ty³Çme
 
	gSŒ—m
>

365 
P¬£Hex4
(
SŒ—m
& 
¡»am
) {

366 
SŒ—m
 
	gs
 = 
¡»am
;

367 
	gcod•ošt
 = 0;

368 
	gi
 = 0; i < 4; i++) {

369 
Ch
 
	gc
 = 
s
.
Take
();

370 
	gcod•ošt
 <<= 4;

371 
	gcod•ošt
 +ğ
c
;

372 ià(
	gc
 >ğ'0' && 
c
 <= '9')

373 
cod•ošt
 -= '0';

374 ià(
	gc
 >ğ'A' && 
c
 <= 'F')

375 
cod•ošt
 -= 'A' - 10;

376 ià(
	gc
 >ğ'a' && 
c
 <= 'f')

377 
cod•ošt
 -= 'a' - 10;

379 
RAPIDJSON_PARSE_ERROR
("IncÜ»ù hex dig™‡á” \\uƒsÿ³", 
s
.
T–l
() - 1);

381 
	g¡»am
 = 
s
;

382  
	gcod•ošt
;

386 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

387 
P¬£SŒšg
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

388 
	#Z16
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

	)

389 cÚ¡ 
Ch
 
	gesÿ³
[256] = {

390 
Z16
, Z16, 0, 0,'\"', 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,'/',

391 
Z16
, Z16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,'\\', 0, 0, 0,

394 
Z16
, Z16, Z16, Z16, Z16, Z16, Z16, Z16

396 #undeà
Z16


398 
SŒ—m
 
	gs
 = 
¡»am
;

399 
RAPIDJSON_ASSERT
(
s
.
P“k
() == '\"');

400 
	gs
.
Take
();

401 
Ch
 *
	gh—d
;

402 
SizeTy³
 
	gËn
;

403 ià(
	g·r£FÏgs
 & 
	gkP¬£Ins™uFÏg
)

404 
	gh—d
 = 
s
.
PutBegš
();

406 
	gËn
 = 0;

408 
	#RAPIDJSON_PUT
(
x
è\

	)

410 ià(
	g·r£FÏgs
 & 
	gkP¬£Ins™uFÏg
) \

411 
	gs
.
Put
(
x
); \

413 *
	g¡ack_
.
‹m¶©e
 
	gPush
<
	gCh
>(èğ
x
; \

414 ++
	gËn
; \

416 } 
	gçl£
)

419 
Ch
 
	gc
 = 
s
.
Take
();

420 ià(
	gc
 == '\\') {

421 
Ch
 
e
 = 
s
.
Take
();

422 ià(((
	gCh
è=ğ1 || 
e
 < 127 ) && 
esÿ³
[()e])

423 
RAPIDJSON_PUT
(
esÿ³
[()
e
]);

424 ià(
	ge
 == 'u') {

425 
cod•ošt
 = 
P¬£Hex4
(
s
);

426 ià(
	gcod•ošt
 >ğ0xD800 && 
cod•ošt
 <= 0xDBFF) {

427 ià(
s
.
Take
() != '\\' || s.Take() != 'u') {

428 
RAPIDJSON_PARSE_ERROR
("Missšgh£cÚd \\u iÀsu¼og©·œ", 
s
.
T–l
() - 2);

431 
	gcod•ošt2
 = 
P¬£Hex4
(
s
);

432 ià(
	gcod•ošt2
 < 0xDC00 || codepoint2 > 0xDFFF) {

433 
RAPIDJSON_PARSE_ERROR
("Th£cÚd \\u iÀsu¼og©·œ i šv®id", 
s
.
T–l
() - 2);

436 
	gcod•ošt
 = (((
cod•ošt
 - 0xD800è<< 10è| (
cod•ošt2
 - 0xDC00)) + 0x10000;

439 
Ch
 
	gbufãr
[4];

440 
SizeTy³
 
	gcouÁ
 = SizeTy³(
Encodšg
::
Encode
(
bufãr
, 
cod•ošt
) - &buffer[0]);

442 ià(
	g·r£FÏgs
 & 
	gkP¬£Ins™uFÏg
)

443 
SizeTy³
 
	gi
 = 0; i < 
	gcouÁ
; i++)

444 
	gs
.
Put
(
bufãr
[
i
]);

446 
memıy
(
¡ack_
.
‹m¶©e
 
Push
<
Ch
>(
couÁ
), 
bufãr
, count * (Ch));

447 
	gËn
 +ğ
couÁ
;

451 
RAPIDJSON_PARSE_ERROR
("UnknowÀesÿ³ ch¬aù”", 
¡»am
.
T–l
() - 1);

455 ià(
	gc
 == '"') {

456 ià(
·r£FÏgs
 & 
kP¬£Ins™uFÏg
) {

457 
size_t
 
Ëngth
 = 
s
.
PutEnd
(
h—d
);

458 
RAPIDJSON_ASSERT
(
Ëngth
 <= 0xFFFFFFFF);

459 
RAPIDJSON_PUT
('\0');

460 
	ghªdËr
.
SŒšg
(
h—d
, 
SizeTy³
(
Ëngth
), 
çl£
);

463 
RAPIDJSON_PUT
('\0');

464 
	ghªdËr
.
SŒšg
(
¡ack_
.
‹m¶©e
 
Pİ
<
Ch
>(
Ën
),†’ - 1, 
Œue
);

466 
	g¡»am
 = 
s
;

469 ià(
	gc
 == '\0') {

470 
RAPIDJSON_PARSE_ERROR
("Ïck ’dšg quÙ©iÚ befÜth’d oà¡ršg", 
¡»am
.
T–l
() - 1);

473 ià(()
	gc
 < 0x20) {

474 
RAPIDJSON_PARSE_ERROR
("IncÜ»ù uÃsÿ³d ch¬aù” iÀ¡ršg", 
¡»am
.
T–l
() - 1);

478 
RAPIDJSON_PUT
(
c
);

480 #undeà
RAPIDJSON_PUT


483 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

484 
P¬£Numb”
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

485 
SŒ—m
 
	gs
 = 
¡»am
;

487 
boŞ
 
	gmšus
 = 
çl£
;

488 ià(
	gs
.
P“k
() == '-') {

489 
mšus
 = 
Œue
;

490 
	gs
.
Take
();

494 
	gi
;

495 
boŞ
 
	gŒy64b™
 = 
çl£
;

496 ià(
	gs
.
P“k
() == '0') {

497 
i
 = 0;

498 
	gs
.
Take
();

500 ià(
	gs
.
P“k
(è>ğ'1' && 
s
.Peek() <= '9') {

501 
i
 = 
s
.
Take
() - '0';

503 ià(
	gmšus
)

504 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

505 ià(
i
 >= 214748364) {

506 ià(
i
 !ğ214748364 || 
s
.
P“k
() > '8') {

507 
Œy64b™
 = 
Œue
;

511 
	gi
 = 
i
 * 10 + (
s
.
Take
() - '0');

514 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

515 ià(
i
 >= 429496729) {

516 ià(
i
 !ğ429496729 || 
s
.
P“k
() > '5') {

517 
Œy64b™
 = 
Œue
;

521 
	gi
 = 
i
 * 10 + (
s
.
Take
() - '0');

525 
RAPIDJSON_PARSE_ERROR
("Ex³ù‡ v®uh”e.", 
¡»am
.
T–l
());

530 
ušt64_t
 
	gi64
 = 0;

531 
boŞ
 
	gu£DoubË
 = 
çl£
;

532 ià(
	gŒy64b™
) {

533 
	gi64
 = 
i
;

534 ià(
	gmšus
)

535 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

536 ià(
i64
 >= 922337203685477580uLL)

537 ià(
i64
 !ğ922337203685477580uLL || 
s
.
P“k
() > '8') {

538 
u£DoubË
 = 
Œue
;

541 
	gi64
 = 
i64
 * 10 + (
s
.
Take
() - '0');

544 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

545 ià(
i64
 >= 1844674407370955161uLL)

546 ià(
i64
 !ğ1844674407370955161uLL || 
s
.
P“k
() > '5') {

547 
u£DoubË
 = 
Œue
;

550 
	gi64
 = 
i64
 * 10 + (
s
.
Take
() - '0');

555 
	gd
 = 0.0;

556 ià(
	gu£DoubË
) {

557 
	gd
 = ()
i64
;

558 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

559 ià(
d
 >= 1E307) {

560 
RAPIDJSON_PARSE_ERROR
("Numb”oØbigØ¡Üš doubË", 
¡»am
.
T–l
());

563 
	gd
 = 
d
 * 10 + (
s
.
Take
() - '0');

568 
	gexpF¿c
 = 0;

569 ià(
	gs
.
P“k
() == '.') {

570 ià(!
u£DoubË
) {

571 
d
 = 
Œy64b™
 ? ()
i64
 : ()
i
;

572 
	gu£DoubË
 = 
Œue
;

574 
	gs
.
Take
();

576 ià(
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

577 
d
 = d * 10 + (
s
.
Take
() - '0');

578 --
	gexpF¿c
;

581 
RAPIDJSON_PARSE_ERROR
("AˆËa¡ oÃ dig™ iÀäaùiÚ…¬t", 
¡»am
.
T–l
());

585 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

586 ià(
expF¿c
 > -16) {

587 
d
 = d * 10 + (
s
.
P“k
() - '0');

588 --
	gexpF¿c
;

590 
	gs
.
Take
();

595 
	gexp
 = 0;

596 ià(
	gs
.
P“k
(è=ğ'e' || 
s
.Peek() == 'E') {

597 ià(!
u£DoubË
) {

598 
d
 = 
Œy64b™
 ? ()
i64
 : ()
i
;

599 
	gu£DoubË
 = 
Œue
;

601 
	gs
.
Take
();

603 
boŞ
 
	gexpMšus
 = 
çl£
;

604 ià(
	gs
.
P“k
() == '+')

605 
s
.
Take
();

606 ià(
	gs
.
P“k
() == '-') {

607 
s
.
Take
();

608 
	gexpMšus
 = 
Œue
;

611 ià(
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

612 
exp
 = 
s
.
Take
() - '0';

613 
	gs
.
P“k
(è>ğ'0' && 
s
.Peek() <= '9') {

614 
exp
 =ƒx°* 10 + (
s
.
Take
() - '0');

615 ià(
	gexp
 > 308) {

616 
RAPIDJSON_PARSE_ERROR
("Numb”oØbigØ¡Üš doubË", 
¡»am
.
T–l
());

622 
RAPIDJSON_PARSE_ERROR
("AˆËa¡ oÃ dig™ iÀexpÚ’t", 
s
.
T–l
());

626 ià(
	gexpMšus
)

627 
	gexp
 = -
exp
;

631 ià(
	gu£DoubË
) {

632 
	gd
 *ğ
š‹º®
::
Pow10
(
exp
 + 
expF¿c
);

633 
	ghªdËr
.
DoubË
(
mšus
 ? -
d
 : d);

636 ià(
	gŒy64b™
) {

637 ià(
	gmšus
)

638 
	ghªdËr
.
IÁ64
(-(
št64_t
)
i64
);

640 
	ghªdËr
.
Ušt64
(
i64
);

643 ià(
	gmšus
)

644 
	ghªdËr
.
IÁ
(-()
i
);

646 
	ghªdËr
.
Ušt
(
i
);

650 
	g¡»am
 = 
s
;

654 
	g‹m¶©e
<
	g·r£FÏgs
, 
ty³Çme
 
	gSŒ—m
,y³Çm
	gHªdËr
>

655 
P¬£V®ue
(
SŒ—m
& 
¡»am
, 
HªdËr
& 
hªdËr
) {

656 
	g¡»am
.
P“k
()) {

657 'n': 
P¬£NuÎ
 <
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

658 't': 
P¬£True
 <
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

659 'f': 
P¬£F®£
 <
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

660 '"': 
P¬£SŒšg
<
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

661 '{': 
P¬£Objeù
<
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

662 '[': 
P¬£A¼ay
 <
·r£FÏgs
>(
¡»am
, 
	ghªdËr
); ;

663  : 
P¬£Numb”
<
·r£FÏgs
>(
¡»am
, 
	ghªdËr
);

667 cÚ¡ 
size_t
 
	gkDeçuÉSckC­ac™y
 = 256;

668 
	gš‹º®
::
Sck
<
AÎoÿtÜ
> 
¡ack_
;

669 
jmp_buf
 
	gjmpbuf_
;

670 cÚ¡ * 
	g·r£E¼Ü_
;

671 
size_t
 
	g”rÜOff£t_
;

675 
	gG’”icR—d”
<
	tUTF8
<> > 
	tR—d”
;

679 #ifdeà
_MSC_VER


680 #´agm¨
w¬nšg
(
pİ
)

	@/home/libin3-s/ldd/courier/rapidjson/stringbuffer.h

1 #iâdeà
RAPIDJSON_STRINGBUFFER_H_


2 
	#RAPIDJSON_STRINGBUFFER_H_


	)

4 
	~"¿pidjsÚ.h
"

5 
	~"š‹º®/¡ack.h
"

7 
Çme¥aû
 
	g¿pidjsÚ
 {

15 
	g‹m¶©e
 <
ty³Çme
 
	gEncodšg
,y³Çm
	gAÎoÿtÜ
 = 
C¹AÎoÿtÜ
>

16 
	sG’”icSŒšgBufãr
 {

17 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

19 
G’”icSŒšgBufãr
(
AÎoÿtÜ
* 
®loÿtÜ
 = 0, 
size_t
 
ÿ·c™y
 = 
kDeçuÉC­ac™y
è: 
¡ack_
(allocator, capacity) {}

21 
Put
(
Ch
 
c
è{ *
	g¡ack_
.
‹m¶©e
 
	gPush
<
	gCh
>() = c; }

23 
CË¬
(è{ 
	g¡ack_
.Clear(); }

25 cÚ¡ * 
G‘SŒšg
() const {

27 *
	g¡ack_
.
‹m¶©e
 
	gPush
<
	gCh
>() = '\0';

28 
	g¡ack_
.
‹m¶©e
 
	gPİ
<
	gCh
>(1);

30  
	g¡ack_
.
‹m¶©e
 
	gBÙtom
<
	gCh
>();

33 
size_t
 
Size
(ècÚ¡ {  
	g¡ack_
.
G‘Size
(); }

35 cÚ¡ 
size_t
 
	gkDeçuÉC­ac™y
 = 256;

36 
mubË
 
	gš‹º®
::
Sck
<
AÎoÿtÜ
> 
¡ack_
;

39 
	gG’”icSŒšgBufãr
<
	tUTF8
<> > 
	tSŒšgBufãr
;

42 
	g‹m¶©e
<>

43 
šlše
 
PutN
(
G’”icSŒšgBufãr
<
UTF8
<> >& 
¡»am
, 
c
, 
size_t
 
n
) {

44 
mem£t
(
¡»am
.
¡ack_
.
Push
<>(
n
), 
c
,‚ * (c));

	@/home/libin3-s/ldd/courier/rapidjson/writer.h

1 #iâdeà
RAPIDJSON_WRITER_H_


2 
	#RAPIDJSON_WRITER_H_


	)

4 
	~"¿pidjsÚ.h
"

5 
	~"š‹º®/¡ack.h
"

6 
	~"š‹º®/¡rfunc.h
"

7 
	~<c¡dio
>

8 
	~<Ãw
>

10 #ifdeà
_MSC_VER


11 #´agm¨
w¬nšg
(
push
)

12 #´agm¨
w¬nšg
(
di§bË
 : 4127)

15 
Çme¥aû
 
	g¿pidjsÚ
 {

31 
	g‹m¶©e
<
ty³Çme
 
	gSŒ—m
,y³Çm
	gEncodšg
 = 
UTF8
<>,y³Çm
	gAÎoÿtÜ
 = 
MemÜyPoŞAÎoÿtÜ
<> >

32 şas 
	cWr™”
 {

33 
public
:

34 
ty³Çme
 
	tEncodšg
::
	tCh
 Ch;

36 
Wr™”
(
SŒ—m
& 
¡»am
, 
AÎoÿtÜ
* 
®loÿtÜ
 = 0, 
size_t
 
Ëv–D•th
 = 
kDeçuÉLev–D•th
) :

37 
¡»am_
(
¡»am
), 
Ëv–_¡ack_
(
®loÿtÜ
, 
Ëv–D•th
 * (
Lev–
)) {}

41 
	gWr™”
& 
NuÎ
(è{ 
P»fix
(
kNuÎTy³
); 
Wr™eNuÎ
();  *
	gthis
; }

42 
	gWr™”
& 
BoŞ
(
boŞ
 
b
è{ 
P»fix
(b ? 
kTrueTy³
 : 
kF®£Ty³
); 
Wr™eBoŞ
(b);  *
	gthis
; }

43 
	gWr™”
& 
IÁ
(
i
è{ 
P»fix
(
kNumb”Ty³
); 
Wr™eIÁ
(i);  *
	gthis
; }

44 
	gWr™”
& 
Ušt
(
u
è{ 
P»fix
(
kNumb”Ty³
); 
Wr™eUšt
(u);  *
	gthis
; }

45 
	gWr™”
& 
IÁ64
(
št64_t
 
i64
è{ 
P»fix
(
kNumb”Ty³
); 
Wr™eIÁ64
(i64);  *
	gthis
; }

46 
	gWr™”
& 
Ušt64
(
ušt64_t
 
u64
è{ 
P»fix
(
kNumb”Ty³
); 
Wr™eUšt64
(u64);  *
	gthis
; }

47 
	gWr™”
& 
DoubË
(
d
è{ 
P»fix
(
kNumb”Ty³
); 
Wr™eDoubË
(d);  *
	gthis
; }

49 
	gWr™”
& 
SŒšg
(cÚ¡ 
Ch
* 
¡r
, 
SizeTy³
 
Ëngth
, 
boŞ
 
cİy
 = 
çl£
) {

50 ()
cİy
;

51 
P»fix
(
kSŒšgTy³
);

52 
Wr™eSŒšg
(
¡r
, 
Ëngth
);

53  *
	gthis
;

56 
	gWr™”
& 
S¹Objeù
() {

57 
P»fix
(
kObjeùTy³
);

58 
Ãw
 (
Ëv–_¡ack_
.
‹m¶©e
 
Push
<
Lev–
>()èLev–(
çl£
);

59 
Wr™eS¹Objeù
();

60  *
	gthis
;

63 
	gWr™”
& 
EndObjeù
(
SizeTy³
 
memb”CouÁ
 = 0) {

64 ()
memb”CouÁ
;

65 
RAPIDJSON_ASSERT
(
Ëv–_¡ack_
.
G‘Size
(è>ğ(
Lev–
));

66 
RAPIDJSON_ASSERT
(!
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<
Lev–
>()->
šA¼ay
);

67 
	gËv–_¡ack_
.
‹m¶©e
 
	gPİ
<
	gLev–
>(1);

68 
Wr™eEndObjeù
();

69  *
	gthis
;

72 
	gWr™”
& 
S¹A¼ay
() {

73 
P»fix
(
kA¼ayTy³
);

74 
Ãw
 (
Ëv–_¡ack_
.
‹m¶©e
 
Push
<
Lev–
>()èLev–(
Œue
);

75 
Wr™eS¹A¼ay
();

76  *
	gthis
;

79 
	gWr™”
& 
EndA¼ay
(
SizeTy³
 
–em’tCouÁ
 = 0) {

80 ()
–em’tCouÁ
;

81 
RAPIDJSON_ASSERT
(
Ëv–_¡ack_
.
G‘Size
(è>ğ(
Lev–
));

82 
RAPIDJSON_ASSERT
(
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<
Lev–
>()->
šA¼ay
);

83 
	gËv–_¡ack_
.
‹m¶©e
 
	gPİ
<
	gLev–
>(1);

84 
Wr™eEndA¼ay
();

85  *
	gthis
;

90 
	gWr™”
& 
SŒšg
(cÚ¡ 
Ch
* 
¡r
è{  SŒšg(¡r, 
š‹º®
::
SŒL’
(str)); }

92 
	g´Ùeùed
:

94 
	sLev–
 {

95 
Lev–
(
boŞ
 
šA¼ay_
è: 
šA¼ay
(šA¼ay_), 
v®ueCouÁ
(0) {}

96 
boŞ
 
	gšA¼ay
;

97 
size_t
 
	gv®ueCouÁ
;

100 cÚ¡ 
size_t
 
	gkDeçuÉLev–D•th
 = 32;

102 
Wr™eNuÎ
() {

103 
	g¡»am_
.
Put
('n'); stream_.Put('u'); stream_.Put('l'); stream_.Put('l');

106 
Wr™eBoŞ
(
boŞ
 
b
) {

107 ià(
	gb
) {

108 
	g¡»am_
.
Put
('t'); stream_.Put('r'); stream_.Put('u'); stream_.Put('e');

111 
	g¡»am_
.
Put
('f'); stream_.Put('a'); stream_.Put('l'); stream_.Put('s'); stream_.Put('e');

115 
Wr™eIÁ
(
i
) {

116 ià(
	gi
 < 0) {

117 
	g¡»am_
.
Put
('-');

118 
	gi
 = -
i
;

120 
Wr™eUšt
(()
i
);

123 
Wr™eUšt
(
u
) {

124 
	gbufãr
[10];

125 *
	gp
 = 
bufãr
;

127 *
	gp
++ = (
u
 % 10) + '0';

128 
	gu
 /= 10;

129 } 
	gu
 > 0);

132 --
	gp
;

133 
	g¡»am_
.
Put
(*
p
);

134 } 
	gp
 !ğ
bufãr
);

137 
Wr™eIÁ64
(
št64_t
 
i64
) {

138 ià(
	gi64
 < 0) {

139 
	g¡»am_
.
Put
('-');

140 
	gi64
 = -
i64
;

142 
Wr™eUšt64
((
ušt64_t
)
i64
);

145 
Wr™eUšt64
(
ušt64_t
 
u64
) {

146 
	gbufãr
[20];

147 *
	gp
 = 
bufãr
;

149 *
	gp
++ = (
u64
 % 10) + '0';

150 
	gu64
 /= 10;

151 } 
	gu64
 > 0);

154 --
	gp
;

155 
	g¡»am_
.
Put
(*
p
);

156 } 
	gp
 !ğ
bufãr
);

160 
Wr™eDoubË
(
d
) {

161 
	gbufãr
[100];

162 #ià
_MSC_VER


163 
	g»t
 = 
¥rštf_s
(
bufãr
, (bufãr), "%g", 
d
);

165 
	g»t
 = 
¢´štf
(
bufãr
, (bufãr), "%g", 
d
);

167 
RAPIDJSON_ASSERT
(
»t
 >= 1);

168 
	gi
 = 0; i < 
	g»t
; i++)

169 
	g¡»am_
.
Put
(
bufãr
[
i
]);

172 
Wr™eSŒšg
(cÚ¡ 
Ch
* 
¡r
, 
SizeTy³
 
Ëngth
) {

173 cÚ¡ 
	ghexDig™s
[] = "0123456789ABCDEF";

174 cÚ¡ 
	gesÿ³
[256] = {

175 
	#Z16
 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0

	)

180 
Z16
, Z16,

182 
Z16
, Z16, Z16, Z16, Z16, Z16, Z16, Z16, Z16, Z16

183 #undeà
Z16


186 
	g¡»am_
.
Put
('\"');

187 cÚ¡ 
Ch
* 
	gp
 = 
¡r
;… !ğ¡¸+ 
Ëngth
; ++p) {

188 ià(((
	gCh
è=ğ1 || *
p
 < 256è&& 
esÿ³
[()*p]) {

189 
¡»am_
.
Put
('\\');

190 
	g¡»am_
.
Put
(
esÿ³
[()*
p
]);

191 ià(
	gesÿ³
[()*
p
] == 'u') {

192 
¡»am_
.
Put
('0');

193 
	g¡»am_
.
Put
('0');

194 
	g¡»am_
.
Put
(
hexDig™s
[(*
p
) >> 4]);

195 
	g¡»am_
.
Put
(
hexDig™s
[(*
p
) & 0xF]);

199 
	g¡»am_
.
Put
(*
p
);

201 
	g¡»am_
.
Put
('\"');

204 
Wr™eS¹Objeù
(è{ 
	g¡»am_
.
Put
('{'); }

205 
Wr™eEndObjeù
(è{ 
	g¡»am_
.
Put
('}'); }

206 
Wr™eS¹A¼ay
(è{ 
	g¡»am_
.
Put
('['); }

207 
Wr™eEndA¼ay
(è{ 
	g¡»am_
.
Put
(']'); }

209 
P»fix
(
Ty³
 
ty³
) {

210 ()
	gty³
;

211 ià(
	gËv–_¡ack_
.
G‘Size
() != 0) {

212 
Lev–
* 
Ëv–
 = 
Ëv–_¡ack_
.
‹m¶©e
 
Tİ
<Level>();

213 ià(
	gËv–
->
	gv®ueCouÁ
 > 0) {

214 ià(
	gËv–
->
	gšA¼ay
)

215 
	g¡»am_
.
Put
(',');

217 
	g¡»am_
.
Put
((
Ëv–
->
v®ueCouÁ
 % 2 == 0) ? ',' : ':');

219 ià(!
	gËv–
->
	gšA¼ay
 &&†ev–->
	gv®ueCouÁ
 % 2 == 0)

220 
RAPIDJSON_ASSERT
(
ty³
 =ğ
kSŒšgTy³
);

221 
	gËv–
->
	gv®ueCouÁ
++;

224 
RAPIDJSON_ASSERT
(
ty³
 =ğ
kObjeùTy³
 ||y³ =ğ
kA¼ayTy³
);

227 
	gSŒ—m
& 
	g¡»am_
;

228 
	gš‹º®
::
Sck
<
AÎoÿtÜ
> 
Ëv–_¡ack_
;

230 
	g´iv©e
:

232 
Wr™”
& 
İ”©Ü
=(cÚ¡ Wr™”& 
w
);

237 #ifdeà
_MSC_VER


238 #´agm¨
w¬nšg
(
pİ
)

	@/home/libin3-s/ldd/courier/reactor.h

3 #iâdeà
__LDD_COURIER_ZK_REACTOR_H_


4 
	#__LDD_COURIER_ZK_REACTOR_H_


	)

6 
	~<±h»ad.h
>

7 
	~<¡ršg
>

8 
	~<pŞl.h
>

9 
	~<¡dšt.h
>

10 
	~<sys/time.h
>

11 
	~<zook“³r/zook“³r.h
>

12 
	~<ldd/ut/©omic.h
>

13 
	~<ldd/ut/mu‹x.h
>

15 
	~"Ev’tLi¡.h
"

16 
	~"İtiÚs.h
"

21 
Çme¥aû
 
	gldd
{

22 
Çme¥aû
 
	gcour›r
{

24 
şass
 
	gCÚ‹xt
;

25 
şass
 
	gZkCÚ‹xt
;

26 
şass
 
	gCom¶‘iÚC®lBack
;

27 
şass
 
	gW©ch”AùiÚ
;

29 şas 
	cZooK“³rR—ùÜ


31 
	gpublic
:

32 
ZooK“³rR—ùÜ
(
HªdËZkE¼Ü
 
hªdË_”rÜ
,

33 cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
, 
timeout
);

34 ~
ZooK“³rR—ùÜ
();

36 
	gpublic
:

37 
boŞ
 
S¹Up
();

39 
	gpublic
:

41 
boŞ
 
C»©eNode
(
¡d
::
¡ršg
& 
node_·th
, std::¡ršg& 
v®ue
, 
ü—‹_æags
,

42 
Com¶‘iÚC®lBack
* 
comp_ÿÎ_back
, 
W©ch”AùiÚ
* 
aùiÚ
,

43 
št32_t
 
fœe_time
);

44 
boŞ
 
Exi¡s
(
¡d
::
¡ršg
& 
node_·th
, 
Com¶‘iÚC®lBack
* 
comp_ÿÎ_back
,

45 
W©ch”AùiÚ
* 
aùiÚ
, 
št32_t
 
fœe_time
);

46 
boŞ
 
G‘NodeV®ue
(
¡d
::
¡ršg
& 
node_·th
,
Com¶‘iÚC®lBack
* 
comp_ÿÎ_back
,

47 
W©ch”AùiÚ
* 
aùiÚ
, 
št32_t
 
fœe_time
);

48 
boŞ
 
D–‘eNode
(
¡d
::
¡ršg
& 
node_·th
, 
v”siÚ
, 
Com¶‘iÚC®lBack
* 
comp_ÿÎ_back
,

49 
W©ch”AùiÚ
* 
aùiÚ
, 
št32_t
 
fœe_time
);

50 
boŞ
 
G‘Chd»nLi¡
(
¡d
::
¡ršg
& 
node_·th
, 
Com¶‘iÚC®lBack
* 
comp_ÿÎ_back
,

51 
W©ch”AùiÚ
* 
aùiÚ
, 
št32_t
 
fœe_time
);

53 
	eZooK“³rS‹
{

55 
	gkZkS¹E¼Ü
 = -1,

56 
	gkZkUnRecov”®
 = -2,

57 
	gkZkTimeOut
 = -3,

60 
	gkZkNuÎ
 = 0,

61 
	gkZkCÚÃùšg
 = 1,

62 
	gkZkCÚÃùed
 = 2,

66 
št64_t
 
Cl›ÁId
();

67 
Clo£
();

69 
	g´iv©e
:

70 * 
Th»adFunc
(* 
¬g
);

71 
Clo£Th»ad
();

72 
run
();

73 
boŞ
 
ProûssTimeEv’t
(cÚ¡ 
ZkCÚ‹xt
* 
c
);

74 
ZkGlob®W©h”
(
zhªdË_t
 *
zh
, 
ty³
, 
¡©e
,

75 cÚ¡ *
·th
,*
w©ch”Ctx
);

76 
boŞ
 
CheckTimeOut
();

77 
št64_t
 
G‘TickCouÁ
();

78 
S‘ZkS‹
(
ZooK“³rS‹
 
e
 );

79 
ZooK“³rS‹
 
G‘ZkS‹
();

81 
HªdËZkE¼Ü
 
	ghªdË_”rÜ_
;

82 cÚ¡ 
	g¡d
::
¡ršg
 
ho¡_pÜt_
;

83 
zhªdË_t
* 
	gzhªdË_
;

84 
	gut
::
Atomic
<
boŞ
> 
¡¬‹d_zkth»ad_
;

85 
	gtimeout_
;

86 
±h»ad_t
 
	gzkth»ad_
;

87 
	gut
::
Atomic
<
ZooK“³rS‹
> 
zk_cur_¡©e_
;

88 
št64_t
 
	gcur_tick_couÁ_
;

89 
	g´iv©e
:

91 şas 
	cKeyCom·¿tÜ
{

92 
public
:

93 
KeyCom·¿tÜ
(){}

94 
İ”©Ü
()(cÚ¡ 
ZkCÚ‹xt
* 
a
, cÚ¡ ZkCÚ‹xt* 
	gb
) const;

96 
KeyCom·¿tÜ
 
	gcom·¿tÜ_
;

97 
	gEv’tLi¡
<cÚ¡ 
	tZkCÚ‹xt
*, 
	tKeyCom·¿tÜ
> 
	tEv’tLi¡Ex
;

98 
Ev’tLi¡Ex
 
	gtime_ev’t_li¡_
;

99 
	gut
::
Mu‹x
 
mu_
;

	@/home/libin3-s/ldd/courier/redo_policy.h

2 #iâdeà
__LDD_COURIER_REDO_POLICY_H_


3 
	#__LDD_COURIER_REDO_POLICY_H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

11 şas 
	cRedoPŞicy
{

12 
	gpublic
:

13 
RedoPŞicy
();

14 
	gvœtu®
 ~
RedoPŞicy
();

15 
vœtu®
 
boŞ
 
ShouldR‘y
()= 0;

16 
vœtu®
 
št32_t
 
G‘RedoTimeIÁ”v®
() = 0;

17 
vœtu®
 
RedoPŞicy
* 
Cİy
() = 0;

18 
šü
();

19 
št32_t
 
CurTimes
();

20 
	g´iv©e
:

21 
RedoPŞicy
(const RedoPolicy&);

22 
	gRedoPŞicy
& 
	gİ”©Ü
=(cÚ¡ 
RedoPŞicy
&);

23 
	g´iv©e
:

24 
cur_»Œy_times
;

	@/home/libin3-s/ldd/courier/redo_simple_policy.h

2 #iâdeà
__LDD_COURIER_REDO_POLICY_SIMPLE_H_


3 
	#__LDD_COURIER_REDO_POLICY_SIMPLE_H_


	)

5 
	~<¡dšt.h
>

6 
	~"»do_pŞicy.h
"

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

11 şas 
	cRedoPŞicySim¶e
 : 
public
 
RedoPŞicy
{

12 
public
:

13 
RedoPŞicySim¶e
(
max_»Œy_times
, 
št32_t
 
»Œy_š‹rv®_ms
);

14 
	gvœtu®
 ~
RedoPŞicySim¶e
();

16 
boŞ
 
ShouldR‘y
();

17 
št32_t
 
G‘RedoTimeIÁ”v®
();

18 
vœtu®
 
RedoPŞicy
* 
Cİy
();

19 
	g´iv©e
:

20 
max_»Œy_times_
;

21 
št32_t
 
	g»Œy_š‹rv®_ms_
;

	@/home/libin3-s/ldd/courier/ut/ut_common.h

3 #iâdeà
_LDD_UT_COMMON_H_


4 
	#_LDD_UT_COMMON_H_


	)

6 
	~<¡dio.h
>

7 
	~<”ºo.h
>

8 
	~<¡ršg
>

9 
	~<¡dšt.h
>

10 
	~<¬·/š‘.h
>

11 
	~<sys/sock‘.h
>

18 cÚ¡ * 
BASE_CONF_PATH
 ;

19 cÚ¡ * 
REPLICA_NODE_PATH
 ;

20 cÚ¡ * 
ENGINE_NODE_PATH
 ;

21 cÚ¡ * 
BIN_LOG_PATH
 ;

22 cÚ¡ * 
BUCKET_NODE_PATH
 ;

23 cÚ¡ * 
NODE_LIST_PATH
 ;

24 cÚ¡ * 
BUCKET_LIST_PATH
 ;

25 cÚ¡ * 
FARM_LIST_PATH
 ;

26 cÚ¡ * 
COORDINATION
 ;

27 cÚ¡ * 
ROLES_PATH
 ;

28 cÚ¡ * 
VERSION_PATH
 ;

29 cÚ¡ * 
ALIVE_NODES_LIST_PATH
 ;

31 cÚ¡ * 
NAME_SPACE_LIST_PATH
;

32 cÚ¡ * 
NAME_SPACE_1
 ;

33 cÚ¡ * 
NAME_SPACE_2
 ;

38 cÚ¡ * 
REPLICA_NODE_PATH__VALUE
 ;

39 cÚ¡ * 
ENGINE_NODE_PATH__VALUE
 ;

40 cÚ¡ * 
BIN_LOG_PATH__VALUE
 ;

41 cÚ¡ * 
BUCKET_NODE_PATH__VALUE
 ;

44 cÚ¡ 
NODE_LIST_SIZE
 ;

45 cÚ¡ * 
HOST_PORT0
 ;

46 cÚ¡ * 
HOST_PORT1
 ;

47 cÚ¡ * 
HOST_PORT2
 ;

48 cÚ¡ * 
HOST_PORT0_VALUE
 ;

49 cÚ¡ * 
HOST_PORT1_VALUE
 ;

50 cÚ¡ * 
HOST_PORT2_VALUE
 ;

52 cÚ¡ * 
FARM_0_VALUE
 ;

53 cÚ¡ * 
FARM_1_VALUE
 ;

55 cÚ¡ * 
BUCKET_0
 ;

56 cÚ¡ * 
BUCKET_1
;

57 cÚ¡ * 
BUCKET_2
;

58 cÚ¡ * 
BUCKET_0_VALUE
;

59 cÚ¡ * 
BUCKET_1_VALUE
;

60 cÚ¡ * 
BUCKET_2_VALUE
;

64 
	eZkSyncO³¿tiÚTy³
{

65 
	mkü—‹O±Com
 =1,

66 
	mkd–‘eO±Com
 =2,

67 
	mkg‘O±Com
 =3,

68 
	mkg‘Chd»nO±Com
 =4,

69 
	mkexi¡sO±Com
 =5,

70 
	mk£tO±Com
 =6

73 #´agm¨
·ck
(1)

74 
	sZkO±Body_
{

75 
ZkO±Body_
(): 
İt_ty³
(0), 
·th_Ën
(0), 
v®ue_Ën
(0), 
æags
(0){

77 
št8_t
 
	mİt_ty³
;

78 
št32_t
 
	m·th_Ën
;

79 
	m·th
[500];

80 
št32_t
 
	mv®ue_Ën
;

81 
	mv®ue
[2000];

82 
št32_t
 
	mæags
;

84 
ZkO±Body_
 
	tZkO±Body
;

85 #´agm¨
·ck
()

87 
ut_sock‘_pÜt
 ;

88 
ş›Á_sock‘
 ;

89 
sockaddr_š
 
zkStiÚAddr
;

93 
¡©iÚ_sock‘_pÜt
 ;

95 
In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
sockaddr_š
& 
zkStiÚAddr
);

97 
CË¬ZkT»e
(
ş›Á_sock‘
, 
sockaddr_š
& 
zkStiÚAddr
);

99 
C»©eUdpSock‘
(
pÜt
=0);

101 
S’dUDP
(
sock
, 
sockaddr_š
* 
toAdd»ss
, cÚ¡ *
buf
, 
buf_Ën
);

103 
S‘Add»ss
(
sockaddr_š
& 
¡SrvAddr
, * 

, 
pÜt
=0);

105 
£ndAndRecv
(
sock
, 
sockaddr_š
* 
toAdd»ss
, cÚ¡ *
buf
, 
buf_Ën
,

106 * 
»cvbf
, 
»cv_Ën
);

	@/home/libin3-s/ldd/courier/ut/ut_configure.h

3 #iâdeà
_LDD_UT_CONFIGURE_H_


4 
	#_LDD_UT_CONFIGURE_H_


	)

6 
	~"ut_commÚ.h
"

7 
	~"../İtiÚs.h
"

9 
DECLARE_¡ršg
(
ho¡_pÜt
);

11 
usšg
 
Çme¥aû
 
	gldd
::
cour›r
;

13 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

16 
	$TEST
(
CÚfigu»
, 
š™Ÿlize
){

17 cÚ¡ 
£nd_bufãr_Ën
 = 10000;

18 
£nd_bufãr
[
£nd_bufãr_Ën
];

20 cÚ¡ 
»cv_bufãr_Ën
 = 10000;

21 
»cv_bufãr
[
£nd_bufãr_Ën
];

26 
	`In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
zkStiÚAddr
);

28 
timeout
=400; cÚ¡ 
¡d
::
¡ršg
 
roÙ_·th
 = "";

29 
CÚfigu»
* 
cÚfigu»
 = 
NULL
;

30 
»t
 = 0; 
O±iÚs
 
İtiÚ
; o±iÚ.
timeout
 =imeout;

31 
»t
 = 
CÚfigu»
::
	`In™
(
İtiÚ
, 
¡d
::
	`¡ršg
(), 
FLAGS_ho¡_pÜt
,
roÙ_·th
, &
cÚfigu»
);

32 
	`ASSERT_EQ
(
»t
, 0);

33 
	`LOG
(
INFO
)<<"initialize successfully";

36 
buck‘_size
 = 0;

37 
»¶iÿSize
 = 0;

38 
¡d
::
¡ršg
 
’gše_Çme
;

39 
MaxBšLogFe
 = 0;

40 
»t
 = 
cÚfigu»
->
	`G‘R•liÿSize
(&
»¶iÿSize
) ;

41 
»t
 = 
cÚfigu»
->
	`G‘StÜeEngše
(&
’gše_Çme
) ;

42 
»t
 = 
cÚfigu»
->
	`G‘MaxBšLogFe
(&
MaxBšLogFe
) ;

43 
»t
 = 
cÚfigu»
->
	`G‘Buck‘Size
(&
buck‘_size
);

44 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

45 
	`EXPECT_EQ
(
»¶iÿSize
, 
	`©oi
(
REPLICA_NODE_PATH__VALUE
));

46 
	`EXPECT_EQ
(
MaxBšLogFe
, 
	`©oi
(
BIN_LOG_PATH__VALUE
));

47 
	`EXPECT_STREQ
(
’gše_Çme
.
	`d©a
(), 
ENGINE_NODE_PATH__VALUE
);

48 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

50 
št32_t
 
»¶iÿSize22
 = 10; iÁ32_ˆ
MaxBšLogFe22
 = 55555; iÁ32_ˆ
buck‘_size22
 = 2;

51 
¡d
::
¡ršg
 
’gše_Çme22
 = "gfs";

52 
»cv_Ën
 = 0;

54 
ZkO±Body
 
zkİtbody
;

55 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

56 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
»¶iÿSize22
);

57 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
REPLICA_NODE_PATH
);

59 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

60 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

61 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

65 
ZkO±Body
 
zkİtbody
;

66 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

67 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
MaxBšLogFe22
);

68 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
BIN_LOG_PATH
);

70 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

71 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

72 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

76 
ZkO±Body
 
zkİtbody
;

77 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

78 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
buck‘_size22
);

79 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
BUCKET_NODE_PATH
);

81 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

82 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

83 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

87 
ZkO±Body
 
zkİtbody
;

88 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

89 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%s", 
’gše_Çme22
.
	`d©a
());

90 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
ENGINE_NODE_PATH
);

92 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

93 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

94 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

97 
	`u¦“p
(10000);

99 
cÚfigu»
->
	`G‘Buck‘Size
(&
buck‘_size
);

100 
cÚfigu»
->
	`G‘R•liÿSize
(&
»¶iÿSize
) ;

101 
cÚfigu»
->
	`G‘StÜeEngše
(&
’gše_Çme
) ;

102 
cÚfigu»
->
	`G‘MaxBšLogFe
(&
MaxBšLogFe
) ;

105 
	`EXPECT_EQ
(
»¶iÿSize
, 
	`©oi
(
REPLICA_NODE_PATH__VALUE
));

106 
	`EXPECT_EQ
(
MaxBšLogFe
, 
MaxBšLogFe22
);

107 
	`EXPECT_STREQ
(
’gše_Çme
.
	`d©a
(),
ENGINE_NODE_PATH__VALUE
);

108 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

113 
	`DLOG
(
INFO
)<<"before delete";

114 
googË
::
	`FlushLogFes
(googË::
INFO
);

115 
googË
::
	`FlushLogFesUn§ã
(googË::
INFO
);

117 
d–‘e
 
cÚfigu»
;

122 
	}
}

125 cÚ¡ * 
	gHOST_PORT_TEST1
 = "0.0.0.0:400123";

126 
NodeChªgeCB
(
»t
, 
NodeChªgedTy³
 
ty³
, cÚ¡ 
¡d
::
¡ršg
& 
node
){

127 ià(
ty³
 =ğ
kC»©eNode
){

128 if(
¡rcmp
(
node
.
d©a
(), 
HOST_PORT_TEST1
) != 0 ){

129 
årštf
(
¡d”r
, "nÙƒqu®, d©a=%s,e¡1=%s\n", 
node
.
d©a
(), 
HOST_PORT_TEST1
);

130 
ex™
(1);

132 
årštf
(
¡d”r
, "kC»©eNode, d©a=%s\n", 
node
.
d©a
());

133 
DLOG
(
INFO
)<<"kC»©eNode, d©a=%s"<<
	gnode
.
d©a
();

134 }ià(
	gty³
 =ğ
kD–‘eNode
){

135 if(
¡rcmp
(
node
.
d©a
(), 
HOST_PORT0
) == 0 ){

136 
årštf
(
¡d”r
, "kD–‘eNode, d©a=%s\n", 
node
.
d©a
());

137 
DLOG
(
INFO
)<<"kD–‘eNode, d©a=%s"<<
	gnode
.
d©a
();

138 }if(
¡rcmp
(
node
.
d©a
(), "0.0.0.0:400123") == 0 ){

139 
årštf
(
¡d”r
, "kD–‘eNode, d©a=%s\n", 
node
.
d©a
());

140 
DLOG
(
INFO
)<<"kD–‘eNode, d©a=%s"<<
	gnode
.
d©a
();

142 
årštf
(
¡d”r
, "nd©a=%s, HOST_PORT0=0.0.0.0:40000|123\n", 
node
.
d©a
());

143 
ex™
(1);

151 
	$TEST
(
CÚfigu»
, 
NodeLi¡Chªged
){

155 cÚ¡ 
£nd_bufãr_Ën
 = 10000;

156 
£nd_bufãr
[
£nd_bufãr_Ën
];

158 cÚ¡ 
»cv_bufãr_Ën
 = 10000;

159 
»cv_bufãr
[
£nd_bufãr_Ën
];

160 
	`In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
zkStiÚAddr
);

162 
timeout
=400; cÚ¡ 
¡d
::
¡ršg
 
roÙ_·th
 = "";

163 
CÚfigu»
* 
cÚfigu»
 = 
NULL
;

164 
»t
 = 0; 
O±iÚs
 
İtiÚ
; o±iÚ.
timeout
 =imeout;

165 
»t
 = 
CÚfigu»
::
	`In™
(
İtiÚ
, 
¡d
::
	`¡ršg
(), 
FLAGS_ho¡_pÜt
,
roÙ_·th
, &
cÚfigu»
);

166 
	`ASSERT_EQ
(
»t
, 0);

167 
	`LOG
(
INFO
)<<"initialize successfully";

169 
¡d
::
veùÜ
<¡d::
¡ršg
> 
node_li¡
;

170 
cÚfigu»
->
	`G‘NodeLi¡
(
NodeChªgeCB
, &
node_li¡
);

172 
¡d
::
veùÜ
<¡d::
¡ršg
> 
node_li¡
;

173 
cÚfigu»
->
	`G‘NodeLi¡
(
NodeChªgeCB
, &
node_li¡
);

175 
	`EXPECT_EQ
(()
node_li¡
.
	`size
(), 
NODE_LIST_SIZE
);

177 
»cv_Ën
 = 0;

179 
ZkO±Body
 
zkİtbody
;

180 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kd–‘eO±Com
);

181 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s", 
NODE_LIST_PATH
, 
HOST_PORT0
);

183 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

184 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

185 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

187 
	`u¦“p
(100000);
node_li¡
.
	`ş—r
();

188 
cÚfigu»
->
	`G‘NodeLi¡
(
NodeChªgeCB
, &
node_li¡
);

189 
	`EXPECT_EQ
(()
node_li¡
.
	`size
(), 
NODE_LIST_SIZE
-1);

192 
ZkO±Body
 
zkİtbody
;

193 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kü—‹O±Com
);

194 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkoptbody.value), "farm4");

195 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s", 
NODE_LIST_PATH
, 
HOST_PORT_TEST1
);

197 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

198 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

199 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

201 
	`u¦“p
(100000);
node_li¡
.
	`ş—r
();

202 
cÚfigu»
->
	`G‘NodeLi¡
(
NodeChªgeCB
, &
node_li¡
);

203 
	`EXPECT_EQ
(()
node_li¡
.
	`size
(), 
NODE_LIST_SIZE
);

206 
ZkO±Body
 
zkİtbody
;

207 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kd–‘eO±Com
);

208 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s", 
NODE_LIST_PATH
, 
HOST_PORT_TEST1
);

210 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

211 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

212 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

215 
cÚfigu»
->
	`G‘NodeLi¡
(
NULL
, &
node_li¡
);

217 
	`u¦“p
(100000);

218 
	`DLOG
(
INFO
)<<"before delete";

219 
googË
::
	`FlushLogFes
(googË::
INFO
);

220 
googË
::
	`FlushLogFesUn§ã
(googË::
INFO
);

222 
d–‘e
 
cÚfigu»
;

227 
	}
}

228 #undeà
TEST_R


	@/home/libin3-s/ldd/courier/ut/ut_eventlist.h

3 #iâdeà
_LDD_UT_EVENT_LIST_H_


4 
	#_LDD_UT_EVENT_LIST_H_


	)

6 
	~"../Ev’tLi¡.h
"

7 
	~"../zkcÚ‹xt.h
"

9 
usšg
 
Çme¥aû
 
	gldd
::
cour›r
;

11 şas 
	cKeyCom·¿tÜ2
{

12 
	mpublic
:

13 
	$KeyCom·¿tÜ2
(){}

14 
	$İ”©Ü
()(cÚ¡ 
ZkCÚ‹xt
* 
a
, cÚ¡ ZkCÚ‹xt* 
b
) const{

15 ià(
a
->
mli£cÚds_
 < 
b
->milliseconds_){

17 }if(
a
->
mli£cÚds_
 > 
b
->milliseconds_){

22 
	}
}

25 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

26 
	$TEST_R
(
Ev’tLi¡XX
, 
G‘Put
)

28 
KeyCom·¿tÜ2
 
com·¿tÜ_
;

29 
Ev’tLi¡
<cÚ¡ 
	tZkCÚ‹xt
*, 
	tKeyCom·¿tÜ2
> 
	tEv’tLi¡Ex
;

30 
Ev’tLi¡Ex
 
	`ev’t_li¡
(
com·¿tÜ_
);

31 
ZkCÚ‹xt
 
a
 , 
b
, 
c
, 
d
;

32 
a
.
mli£cÚds_
 = 1000; 
b
.mli£cÚds_ = 500; 
c
.milliseconds_ = 3000;

33 
d
.
mli£cÚds_
 = 1;

35 cÚ¡ 
ZkCÚ‹xt
* 
äÚt
 = 
NULL
;

37 
	`EXPECT_TRUE
(
ev’t_li¡
.
	`Em±y
());

39 
ev’t_li¡
.
	`In£¹
(&
a
);

40 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

41 
	`EXPECT_TRUE
Ğ
äÚt
 =ğ&
a
);

43 
	`EXPECT_TRUE
(
ev’t_li¡
.
	`Em±y
(è=ğ
çl£
);

45 
ev’t_li¡
.
	`In£¹
(&
b
);

46 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

47 
	`EXPECT_TRUE
Ğ
äÚt
 =ğ&
b
);

49 
ev’t_li¡
.
	`In£¹
(&
c
);

50 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

51 
	`EXPECT_TRUE
Ğ
äÚt
 =ğ&
b
);

53 
ev’t_li¡
.
	`In£¹
(&
d
);

54 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

55 
	`EXPECT_TRUE
Ğ
äÚt
 =ğ&
d
);

57 
	`EXPECT_TRUE
(
ev’t_li¡
.
	`Em±y
(è=ğ
çl£
);

60 
ev’t_li¡
.
	`PİFrÚt
();

61 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

62 
	`EXPECT_EQ
(
äÚt
->
mli£cÚds_
, 
b
.milliseconds_);

64 
ev’t_li¡
.
	`PİFrÚt
();

65 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

66 
	`EXPECT_EQ
(
äÚt
->
mli£cÚds_
, 
a
.milliseconds_);

68 
ev’t_li¡
.
	`PİFrÚt
();

69 
äÚt
 = 
ev’t_li¡
.
	`FrÚt
();

70 
	`EXPECT_EQ
(
äÚt
->
mli£cÚds_
, 
c
.milliseconds_);

72 
ev’t_li¡
.
	`PİFrÚt
();

73 
ev’t_li¡
.
	`PİFrÚt
();

74 
	`EXPECT_TRUE
(
ev’t_li¡
.
	`Em±y
());

76 
	}
}

78 #undeà
TEST_R


	@/home/libin3-s/ldd/courier/ut/ut_keeper.h

3 #iâdeà
_LDD_UT_KEEPER_H_


4 
	#_LDD_UT_KEEPER_H_


	)

6 
	~"ut_commÚ.h
"

7 
	~"../k“³r.h
"

8 
	~<zook“³r/zook“³r.h
>

9 
	~"../İtiÚs.h
"

12 
usšg
 
Çme¥aû
 
	gldd
::
cour›r
;

14 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

17 
DECLARE_¡ršg
(
ho¡_pÜt
);

19 
	$TEST
(
K“³r
, 
š™Ÿlize
){

21 cÚ¡ 
£nd_bufãr_Ën
 = 10000;

22 
£nd_bufãr
[
£nd_bufãr_Ën
];

24 cÚ¡ 
»cv_bufãr_Ën
 = 10000;

25 
»cv_bufãr
[
£nd_bufãr_Ën
];

30 
	`In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
zkStiÚAddr
);

32 
timeout
=400; cÚ¡ 
¡d
::
¡ršg
 
roÙ_·th
 = "";

33 
K“³r
* 
k“³r_
 = 
NULL
;

34 cÚ¡ 
¡d
::
¡ršg
 
home_ho¡_pÜt
 = 
HOST_PORT0
;

35 
»t
 = 0; 
O±iÚs
 
İtiÚ
; o±iÚ.
timeout
 =imeout;

36 
»t
 = 
K“³r
::
	`In™
(
İtiÚ
, 
FLAGS_ho¡_pÜt
, 
home_ho¡_pÜt
, 
roÙ_·th
, &
k“³r_
);

37 
	`ASSERT_EQ
(
»t
, 0);

38 
	`LOG
(
INFO
)<<"initialize successfully";

41 
buck‘_size
 = 0; 
»¶iÿSize
 = 0; 
¡d
::
¡ršg
 
’gše_Çme
; 
MaxBšLogFe
 = 0;

42 
»t
 = 
k“³r_
->
	`G‘Buck‘Size
(&
buck‘_size
);

43 
»t
 = 
k“³r_
->
	`G‘R•liÿSize
(&
»¶iÿSize
) ;

44 
»t
 = 
k“³r_
->
	`G‘StÜeEngše
(&
’gše_Çme
) ;

45 
»t
 = 
k“³r_
->
	`G‘MaxBšLogFe
(&
MaxBšLogFe
) ;

46 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

47 
	`EXPECT_EQ
(
»¶iÿSize
, 
	`©oi
(
REPLICA_NODE_PATH__VALUE
));

48 
	`EXPECT_EQ
(
MaxBšLogFe
, 
	`©oi
(
BIN_LOG_PATH__VALUE
));

49 
	`EXPECT_STREQ
(
’gše_Çme
.
	`d©a
(), 
ENGINE_NODE_PATH__VALUE
);

50 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

52 
št32_t
 
»¶iÿSize22
 = 10; iÁ32_ˆ
MaxBšLogFe22
 = 55555; iÁ32_ˆ
buck‘_size22
 = 2;

53 
¡d
::
¡ršg
 
’gše_Çme22
 = "gfs";

54 
»cv_Ën
 = 0;

56 
ZkO±Body
 
zkİtbody
;

57 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

58 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
»¶iÿSize22
);

59 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
REPLICA_NODE_PATH
);

61 
	`memıy
(
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

62 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

63 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

67 
ZkO±Body
 
zkİtbody
;

68 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

69 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
MaxBšLogFe22
);

70 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
BIN_LOG_PATH
);

72 
	`memıy
(
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

73 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

74 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

78 
ZkO±Body
 
zkİtbody
;

79 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

80 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%d", 
buck‘_size22
);

81 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
BUCKET_NODE_PATH
);

83 
	`memıy
(
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

84 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

85 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

89 
ZkO±Body
 
zkİtbody
;

90 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
k£tO±Com
);

91 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkİtbody.v®ue), "%s", 
’gše_Çme22
.
	`d©a
());

92 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s%s", 
BASE_CONF_PATH
, 
ENGINE_NODE_PATH
);

94 
	`memıy
(
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

95 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

96 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

99 
	`u¦“p
(10000);

101 
k“³r_
->
	`G‘Buck‘Size
(&
buck‘_size
);

102 
k“³r_
->
	`G‘R•liÿSize
(&
»¶iÿSize
) ;

103 
k“³r_
->
	`G‘StÜeEngše
(&
’gše_Çme
) ;

104 
k“³r_
->
	`G‘MaxBšLogFe
(&
MaxBšLogFe
) ;

106 
	`EXPECT_EQ
(
»¶iÿSize
, 
	`©oi
(
REPLICA_NODE_PATH__VALUE
));

107 
	`EXPECT_EQ
(
MaxBšLogFe
, 
MaxBšLogFe22
);

108 
	`EXPECT_STREQ
(
’gše_Çme
.
	`d©a
(),
ENGINE_NODE_PATH__VALUE
);

109 
	`EXPECT_EQ
(
buck‘_size
, 
	`©oi
(
BUCKET_NODE_PATH__VALUE
));

113 
	`DLOG
(
INFO
)<<"before delete";

114 
googË
::
	`FlushLogFes
(googË::
INFO
);

115 
googË
::
	`FlushLogFesUn§ã
(googË::
INFO
);

117 
d–‘e
 
k“³r_
;

122 
	}
}

126 
AliveNodeChªgeCB
(
»t
, 
NodeChªgedTy³
 
ty³
, cÚ¡ 
¡d
::
¡ršg
& 
node
){

127 ià(
ty³
 =ğ
kC»©eNode
){

128 if(
¡rcmp
(
node
.
d©a
(), 
HOST_PORT2
) != 0 ){

129 
årštf
(
¡d”r
, "nÙƒqu®, d©a=%s,e¡1=%s\n", 
node
.
d©a
(), 
HOST_PORT2
);

130 
ex™
(11);

132 
årštf
(
¡d”r
, "kC»©eNode, d©a=%s\n", 
node
.
d©a
());

133 
DLOG
(
INFO
)<<"kC»©eNode, d©a=%s"<<
	gnode
.
d©a
();

134 }ià(
	gty³
 =ğ
kD–‘eNode
){

135 if(
¡rcmp
(
node
.
d©a
(), 
HOST_PORT0
) == 0 ){

136 
årštf
(
¡d”r
, "kD–‘eNode, d©a=%s\n", 
node
.
d©a
());

137 
DLOG
(
INFO
)<<"kD–‘eNode, d©a=%s"<<
	gnode
.
d©a
();

138 }if(
¡rcmp
(
node
.
d©a
(), 
HOST_PORT2
) == 0 ){

139 
årštf
(
¡d”r
, "kD–‘eNode, d©a=%s\n", 
node
.
d©a
());

140 
DLOG
(
INFO
)<<"kD–‘eNode, d©a=%s"<<
	gnode
.
d©a
();

142 
årštf
(
¡d”r
, "nd©a=%s, HOST_PORT0=10.16.28.11:40000|123\n", 
node
.
d©a
());

143 
ex™
(22);

149 
	$SLECB
(
”r_code
, 
boŞ
 
gÙ_Ëad”sh
){

150 
	`DLOG
(
INFO
)<<"I‡mhËad”. gÙ_Ëad”sh="<<
gÙ_Ëad”sh
;

151 
	`årštf
(
¡d”r
, "I‡mhËad”, gÙ_Ëad”sh=%d,ƒ¼_code=%d\n", 
gÙ_Ëad”sh
, 
”r_code
);

153 
	}
}

155 
	$TEST
(
K“³r
, 
S¹L—d”EËùiÚ0
){

156 cÚ¡ 
£nd_bufãr_Ën
 = 10000;

157 
£nd_bufãr
[
£nd_bufãr_Ën
];

159 cÚ¡ 
»cv_bufãr_Ën
 = 10000;

160 
»cv_bufãr
[
£nd_bufãr_Ën
];

165 
	`In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
zkStiÚAddr
);

167 
timeout
=400; cÚ¡ 
¡d
::
¡ršg
 
roÙ_·th
 = "";

168 
K“³r
* 
k“³r_
 = 
NULL
;

169 
»t
 = 0; 
O±iÚs
 
İtiÚ
; o±iÚ.
timeout
 =imeout;

170 
»t
 = 
K“³r
::
	`In™
(
İtiÚ
, 
FLAGS_ho¡_pÜt
, 
HOST_PORT0
, 
roÙ_·th
, &
k“³r_
);

171 
	`ASSERT_EQ
(
»t
, 0);

172 
	`LOG
(
INFO
)<<"initialize successfully";

174 
k“³r_
->
	`S¹L—d”EËùiÚ
(
SLECB
);

175 
	`u¦“p
(2000000);

177 
¡d
::
veùÜ
<¡d::
¡ršg
> 
£rv”_li¡
 ;

179 
k“³r_
->
	`G‘AliveNodes
(
AliveNodeChªgeCB
, &
£rv”_li¡
);

180 
	`EXPECT_EQ
(()
£rv”_li¡
.
	`size
(), 1);

181 ià(
£rv”_li¡
.
	`size
() > 0){

182 
	`EXPECT_STREQ
(
£rv”_li¡
[0].
	`d©a
(), 
HOST_PORT0
);

185 
»cv_Ën
 = 0;

187 
ZkO±Body
 
zkİtbody
;

188 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kd–‘eO±Com
);

189 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s%s/%s", 
FARM_LIST_PATH
, 
FARM_0_VALUE


190 ,
ALIVE_NODES_LIST_PATH
, 
HOST_PORT0
);

192 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

193 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

194 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

199 
ZkO±Body
 
zkİtbody
; 
»cv_Ën
=0;

200 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kü—‹O±Com
);

201 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkoptbody.value), "%s", "");

202 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s%s/%s", 
FARM_LIST_PATH
, 
FARM_0_VALUE


203 ,
ALIVE_NODES_LIST_PATH
, 
HOST_PORT2
);

204 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

205 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

206 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

210 
ZkO±Body
 
zkİtbody
;

211 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kd–‘eO±Com
);

212 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s%s/%s", 
FARM_LIST_PATH
, 
FARM_0_VALUE


213 ,
ALIVE_NODES_LIST_PATH
, 
HOST_PORT2
);

215 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

216 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

217 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

219 
k“³r_
->
	`G‘AliveNodes
(
NULL
, &
£rv”_li¡
);

220 
	`u¦“p
(1000000);

222 
d–‘e
 
k“³r_
;

223 
	}
}

225 
	$RŞesChªgedcb1
(
”r_code
, 
RŞes
& 
rŞes
){

227 
	`årštf
(
¡d”r
, "RŞesChªgedcb1(èma¡”:%s\n", 
rŞes
.
ma¡”
.
	`d©a
());

228 
	}
}

230 
	$TEST
(
K“³r
, 
S¹L—d”EËùiÚ1
){

231 cÚ¡ 
£nd_bufãr_Ën
 = 10000;

232 
£nd_bufãr
[
£nd_bufãr_Ën
];

234 cÚ¡ 
»cv_bufãr_Ën
 = 10000;

235 
»cv_bufãr
[
£nd_bufãr_Ën
];

240 
	`In™ŸlizeZkT»e
(
ş›Á_sock‘
, 
zkStiÚAddr
);

242 
timeout
=400; cÚ¡ 
¡d
::
¡ršg
 
roÙ_·th
 = "";

243 
K“³r
* 
k“³r_
 = 
NULL
;

244 
»t
 = 0; 
O±iÚs
 
İtiÚ
; o±iÚ.
timeout
 =imeout;

245 
»t
 = 
K“³r
::
	`In™
(
İtiÚ
, 
FLAGS_ho¡_pÜt
,
HOST_PORT0
, 
roÙ_·th
, &
k“³r_
);

246 
	`ASSERT_EQ
(
»t
, 0);

247 
	`LOG
(
INFO
)<<"initialize successfully";

248 cÚ¡ * 
add_com³tÜ
 = "x-9999999999999999-";

249 
·th_ü—‹d
[1000]={0};

252 
ZkO±Body
 
zkİtbody
; 
»cv_Ën
=0;

253 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kü—‹O±Com
); zkİtbody.
æags
 = 
ZOO_EPHEMERAL
|
ZOO_SEQUENCE
;

254 
	`årštf
(
¡d”r
, "ü—‹ fÏgs=%u\n", 
zkİtbody
.
æags
);

255 
zkİtbody
.
v®ue_Ën
 = 
	`¢´štf
(zkİtbody.
v®ue
, (zkoptbody.value), "%s", "");

256 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s/%s%s/%s", 
FARM_LIST_PATH
, 
FARM_0_VALUE


257 ,
COORDINATION
, 
add_com³tÜ
);

258 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

259 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

260 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

261 
j
 = 
	`¡¾’
("OK!!!");

262 
ušt32_t
 
Ën
 = *((ušt32_t*)(
»cv_bufãr
 + 
j
));

263 
Ën
 = 
	`Áohl
(len);

264 
	`memıy
(
·th_ü—‹d
, 
»cv_bufãr
+
j
+(
ušt32_t
), 
Ën
);

265 
	`årštf
(
¡d”r
, "·th„ecv_Ën=%d, c»©ed†’=%u,…©h=%s\n", 
»cv_Ën
, 
Ën
, 
·th_ü—‹d
);

267 
	`u¦“p
(1000000);

269 
	`DLOG
(
INFO
)<<"create 999999";

271 
k“³r_
->
	`S¹L—d”EËùiÚ
(
SLECB
);

272 
	`u¦“p
(1000000);

274 
¡d
::
veùÜ
<¡d::
¡ršg
> 
£rv”_li¡
 ;

276 
k“³r_
->
	`G‘AliveNodes
(
NULL
, &
£rv”_li¡
);

277 
	`DLOG
(
INFO
)<<"GetOnlineNodes";

278 
	`EXPECT_GE
(()
£rv”_li¡
.
	`size
(), 1);

279 
boŞ
 
fšd
 = 
çl£
;

280 
size_t
 
i
=0; i<
£rv”_li¡
.
	`size
(); i++){

281 ià(
	`¡rcmp
(
£rv”_li¡
[
i
].
	`d©a
(), 
HOST_PORT0
) == 0){

282 
fšd
 = 
Œue
;

285 
	`EXPECT_TRUE
(
fšd
);

287 
RŞes
 
g‘_rŞes2
;

288 
k“³r_
->
	`G‘RŞes
(
RŞesChªgedcb1
, &
g‘_rŞes2
);

289 
	`årštf
(
¡d”r
, "ma¡”-----%s\n", 
g‘_rŞes2
.
ma¡”
.
	`d©a
());

294 
ZkO±Body
 
zkİtbody
; 
»cv_Ën
 = 0;

295 
zkİtbody
.
İt_ty³
 = 
	`št8_t
(
kd–‘eO±Com
);

296 
zkİtbody
.
·th_Ën
 = 
	`¢´štf
(zkİtbody.
·th
, (zkİtbody.·th), "%s", 
·th_ü—‹d
);

298 
	`memıy
((*)
£nd_bufãr
, (*)&
zkİtbody
, (
ZkO±Body
));

299 
»cv_Ën
 = 
	`£ndAndRecv
(
ş›Á_sock‘
, &
zkStiÚAddr
, 
£nd_bufãr
, (
ZkO±Body
),
»cv_bufãr
, 
»cv_bufãr_Ën
);

300 
	`ASSERT_EQ
(
	`¡ºcmp
(
»cv_bufãr
, "OK!!!", 
	`¡¾’
("OK!!!")), 0);

301 
	`årštf
(
¡d”r
, "kd–‘eO±Com,…©h=%s", 
·th_ü—‹d
);

303 
	`DLOG
(
INFO
)<<"delete 999999";

305 
RŞes
 
rŞes_Œy
;

307 
bufãr
[1000]; 
bufãr_Ën
 = 1000;

308 
timev®
 
tv
;

309 
	`g‘timeofday
(&
tv
, 
NULL
);

310 
£cÚd
 = 
tv
.
tv_£c
;

311 
bufãr_Ën
 = 
	`¢´štf
(
bufãr
, bufãr_Ën, "10.16.28.11:%d", 
£cÚd
);

313 
rŞes_Œy
.
ma¡”
 = 
¡d
::
	`¡ršg
(
bufãr
, 
bufãr_Ën
);

314 
rŞes_Œy
.
¦aves
.
	`push_back
("10.16.28.11:10001");

315 
rŞes_Œy
.
¦aves
.
	`push_back
("10.16.28.11:10002");

317 
rŞes_Œy
.
fŞlow”s
.
	`push_back
("10.16.28.11:10003");

318 
rŞes_Œy
.
fŞlow”s
.
	`push_back
("10.16.28.11:10004");

319 
rŞes_Œy
.
fŞlow”s
.
	`push_back
("10.16.28.11:10005");

321 
k“³r_
->
	`AddNewRŞes
(
rŞes_Œy
);

322 
	`u¦“p
(100000);

324 
RŞes
 
g‘_rŞes
;

325 
k“³r_
->
	`G‘RŞes
(
RŞesChªgedcb1
, &
g‘_rŞes
);

327 
	`årštf
(
¡d”r
, "ma¡”-----%s\n", 
g‘_rŞes
.
ma¡”
.
	`d©a
());

329 
	`u¦“p
(1000000);

330 
googË
::
	`FlushLogFes
(googË::
INFO
);

331 
googË
::
	`FlushLogFesUn§ã
(googË::
INFO
);

336 
d–‘e
 
k“³r_
;

337 
	}
}

341 #undeà
TEST_R


	@/home/libin3-s/ldd/courier/watcher_action.h

1 #iâdeà
WATCHER__ACTION_H_


2 
	#WATCHER__ACTION_H_


	)

4 
	~<zook“³r/zook“³r.h
>

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

12 şas 
	cW©ch”AùiÚ
{

13 
	gpublic
:

14 
W©ch”AùiÚ
();

15 
	gvœtu®
 ~
W©ch”AùiÚ
();

17 
W©ch”CB
(
zhªdË_t
 *
zh
, 
ty³
, 
¡©e
, cÚ¡ *
·th
,* 
ùx
);

19 
vœtu®
 
ÚNodeC»©ed
(
zhªdË_t
 *, cÚ¡ * 
·th
){}

20 
vœtu®
 
ÚSessiÚExpœed
(
zhªdË_t
*){}

21 
vœtu®
 
ÚCÚÃùiÚE¡ablished
(
zhªdË_t
*){}

22 
vœtu®
 
ÚCÚÃùiÚLo¡
(
zhªdË_t
*){}

23 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*,cÚ¡ * 
·th
){}

24 
vœtu®
 
ÚNodeD–‘ed
(
zhªdË_t
*,cÚ¡ * 
·th
){}

25 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
){}

27 
	g´iv©e
:

28 
W©ch”AùiÚ
(const WatcherAction&);

29 
	gİ”©Ü
=(cÚ¡ 
W©ch”AùiÚ
&);

	@/home/libin3-s/ldd/courier/watcher_action_client.h

2 #iâdeà
__LDD_COURIER_WATCHER_ACTION_CLIENT_H_


3 
	#__LDD_COURIER_WATCHER_ACTION_CLIENT_H_


	)

4 
	~"w©ch”_aùiÚ.h
"

5 
	~"zkbrok”_ş›Á.h
"

6 
	~"»do_pŞicy.h
"

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	gcour›r
{

14 şas 
	cCl›ÁNodeLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

15 
public
:

16 
Cl›ÁNodeLi¡W©ch”AùiÚ
(
ZkBrok”Cl›Á
* 
b
 ): 
brok”_
(b){};

17 
	gvœtu®
 ~
Cl›ÁNodeLi¡W©ch”AùiÚ
(){};

19 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
){

20 ià(
	g·th
){

21 
LOG
(
INFO
)<<"PnodeLi¡W©ch”AùiÚ chd»Àchªged und”…©h:"<<
	g·th
;

22 
LOG
(
INFO
)<<"reGetNodeList()";

24 
RedoPŞicy
* 
	g½
 = 
brok”_
->
CurRedoPŞicy
()->
Cİy
();

25 
	gbrok”_
->
G‘ProxyLi¡
(
½
);

27 
	g´iv©e
:

28 
Cl›ÁNodeLi¡W©ch”AùiÚ
(const ClientNodeListWatcherAction&);

29 
	gİ”©Ü
=(cÚ¡ 
Cl›ÁNodeLi¡W©ch”AùiÚ
&);

31 
	g´iv©e
:

32 
ZkBrok”Cl›Á
* 
brok”_
;

	@/home/libin3-s/ldd/courier/watcher_action_impl.h

2 #iâdeà
__LDD_COURIER_WATCHER_ACTION_IMPL_H_


3 
	#__LDD_COURIER_WATCHER_ACTION_IMPL_H_


	)

4 
	~"w©ch”_aùiÚ.h
"

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	gcour›r
{

11 
şass
 
	gZooK“³rBrok”
;

13 şas 
	cR•liÿNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

14 
public
:

15 
R•liÿNodeW©ch”AùiÚ
(
ZooK“³rBrok”
* 
b
 ) : 
brok”_
(b){}

16 
vœtu®
 ~
R•liÿNodeW©ch”AùiÚ
(){};

18 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

20 
	g´iv©e
:

21 
R•liÿNodeW©ch”AùiÚ
(const ReplicaNodeWatcherAction&);

22 
	gİ”©Ü
=(cÚ¡ 
R•liÿNodeW©ch”AùiÚ
&);

24 
	g´iv©e
:

25 
ZooK“³rBrok”
* 
brok”_
;

28 şas 
	cStÜeEngšeNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

29 
public
:

30 
StÜeEngšeNodeW©ch”AùiÚ
(
ZooK“³rBrok”
* 
b
 ) : 
brok”_
(b){}

32 
vœtu®
 ~
StÜeEngšeNodeW©ch”AùiÚ
(){};

34 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

36 
	g´iv©e
:

37 
StÜeEngšeNodeW©ch”AùiÚ
(const StoreEngineNodeWatcherAction&);

38 
	gİ”©Ü
=(cÚ¡ 
StÜeEngšeNodeW©ch”AùiÚ
&);

40 
	g´iv©e
:

41 
ZooK“³rBrok”
* 
brok”_
;

44 şas 
	cBšLogNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

45 
public
:

46 
BšLogNodeW©ch”AùiÚ
(
ZooK“³rBrok”
* 
b
 ) : 
brok”_
(b){}

48 
vœtu®
 ~
BšLogNodeW©ch”AùiÚ
(){};

50 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

52 
	g´iv©e
:

53 
BšLogNodeW©ch”AùiÚ
(const BinLogNodeWatcherAction&);

54 
	gİ”©Ü
=(cÚ¡ 
BšLogNodeW©ch”AùiÚ
&);

56 
	g´iv©e
:

57 
ZooK“³rBrok”
* 
brok”_
;

60 şas 
	cBuck‘SizeNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

61 
public
:

62 
Buck‘SizeNodeW©ch”AùiÚ
(
ZooK“³rBrok”
* 
b
 ) : 
brok”_
(b){}

64 
vœtu®
 ~
Buck‘SizeNodeW©ch”AùiÚ
(){};

66 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

68 
	g´iv©e
:

69 
Buck‘SizeNodeW©ch”AùiÚ
(const BucketSizeNodeWatcherAction&);

70 
	gİ”©Ü
=(cÚ¡ 
Buck‘SizeNodeW©ch”AùiÚ
&);

72 
	g´iv©e
:

73 
ZooK“³rBrok”
* 
brok”_
;

	@/home/libin3-s/ldd/courier/watcher_action_proxy.h

2 #iâdeà
__LDD_COURIER_WATCHER_ACTION_PROXY_H_


3 
	#__LDD_COURIER_WATCHER_ACTION_PROXY_H_


	)

4 
	~<¡ršg
>

5 
	~"w©ch”_aùiÚ.h
"

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	gcour›r
{

13 
şass
 
	gZkBrok”Proxy
;

15 şas 
	cPnodeLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

16 
public
:

17 
PnodeLi¡W©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
 ): 
brok”_
(b){};

18 
	gvœtu®
 ~
PnodeLi¡W©ch”AùiÚ
(){};

20 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

21 
	g´iv©e
:

22 
PnodeLi¡W©ch”AùiÚ
(const PnodeListWatcherAction&);

23 
	gİ”©Ü
=(cÚ¡ 
PnodeLi¡W©ch”AùiÚ
&);

25 
	g´iv©e
:

26 
ZkBrok”Proxy
* 
brok”_
;

29 şas 
	cNsLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

30 
public
:

31 
NsLi¡W©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
 ): 
brok”_
(b){};

32 
	gvœtu®
 ~
NsLi¡W©ch”AùiÚ
(){};

34 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

36 
	g´iv©e
:

37 
NsLi¡W©ch”AùiÚ
(const NsListWatcherAction&);

38 
	gİ”©Ü
=(cÚ¡ 
NsLi¡W©ch”AùiÚ
&);

40 
	g´iv©e
:

41 
ZkBrok”Proxy
* 
brok”_
;

44 şas 
	cG‘NsIdIÁW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

45 
public
:

46 
G‘NsIdIÁW©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
, 
¡d
::
¡ršg
& 
ns
):

47 
brok”_
(
b
), 
ns_
(
ns
){};

49 
	gvœtu®
 ~
G‘NsIdIÁW©ch”AùiÚ
(){};

51 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*, cÚ¡ * 
·th
);

53 
	g´iv©e
:

54 
G‘NsIdIÁW©ch”AùiÚ
(const GetNsIdIntWatcherAction&);

55 
	gİ”©Ü
=(cÚ¡ 
G‘NsIdIÁW©ch”AùiÚ
&);

57 
	g´iv©e
:

58 
ZkBrok”Proxy
* 
brok”_
;

59 
	g¡d
::
¡ršg
 
ns_
;

62 şas 
	cBuck‘Li¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

63 
public
:

64 
Buck‘Li¡W©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
 ): 
brok”_
(b){};

65 
	gvœtu®
 ~
Buck‘Li¡W©ch”AùiÚ
(){};

67 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

69 
	g´iv©e
:

70 
Buck‘Li¡W©ch”AùiÚ
(const BucketListWatcherAction&);

71 
	gİ”©Ü
=(cÚ¡ 
Buck‘Li¡W©ch”AùiÚ
&);

73 
	g´iv©e
:

74 
ZkBrok”Proxy
* 
brok”_
;

77 şas 
	cF¬mIdNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

78 
public
:

79 
F¬mIdNodeW©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
, 
¡d
::
¡ršg
& 
buck‘ID
):

80 
brok”_
(
b
), 
buck‘ID_
(
buck‘ID
){};

82 
	gvœtu®
 ~
F¬mIdNodeW©ch”AùiÚ
(){};

84 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*, cÚ¡ * 
·th
);

86 
	g´iv©e
:

87 
F¬mIdNodeW©ch”AùiÚ
(const FarmIdNodeWatcherAction&);

88 
	gİ”©Ü
=(cÚ¡ 
F¬mIdNodeW©ch”AùiÚ
&);

90 
	g´iv©e
:

91 
ZkBrok”Proxy
* 
brok”_
;

92 
	g¡d
::
¡ršg
 
buck‘ID_
;

99 şas 
	cF¬mLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

100 
public
:

101 
F¬mLi¡W©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
 ): 
brok”_
(b){};

103 
	gvœtu®
 ~
F¬mLi¡W©ch”AùiÚ
(){};

105 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

107 
	g´iv©e
:

108 
F¬mLi¡W©ch”AùiÚ
(const FarmListWatcherAction&);

109 
	gİ”©Ü
=(cÚ¡ 
F¬mLi¡W©ch”AùiÚ
&);

111 
	g´iv©e
:

112 
ZkBrok”Proxy
* 
brok”_
;

115 şas 
	cProxyRŞesLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

116 
public
:

117 
ProxyRŞesLi¡W©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
 , cÚ¡ 
¡d
::
¡ršg
& 
çrm_id
):

118 
brok”_
(
b
),
çrm_id_
(
çrm_id
){};

119 
	gvœtu®
 ~
ProxyRŞesLi¡W©ch”AùiÚ
(){};

121 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

123 
	g´iv©e
:

124 
ProxyRŞesLi¡W©ch”AùiÚ
(const ProxyRolesListWatcherAction&);

125 
	gİ”©Ü
=(cÚ¡ 
ProxyRŞesLi¡W©ch”AùiÚ
&);

127 
	g´iv©e
:

128 
ZkBrok”Proxy
* 
brok”_
;

129 cÚ¡ 
	g¡d
::
¡ršg
 
çrm_id_
;

132 şas 
	cProxyV”siÚNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

133 
public
:

134 
ProxyV”siÚNodeW©ch”AùiÚ
(
ZkBrok”Proxy
* 
b
,

135 cÚ¡ 
¡d
::
¡ršg
& 
çrm_id
, cÚ¡ std::¡ršg& 
v”siÚ_·th
):

136 
brok”_
(
b
), 
çrm_id_
(
çrm_id
), 
v”siÚ_·th_
(
v”siÚ_·th
){};

138 
	gvœtu®
 ~
ProxyV”siÚNodeW©ch”AùiÚ
(){};

140 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*, cÚ¡ * 
·th
);

142 
	g´iv©e
:

143 
ProxyV”siÚNodeW©ch”AùiÚ
(const ProxyVersionNodeWatcherAction&);

144 
	gİ”©Ü
=(cÚ¡ 
ProxyV”siÚNodeW©ch”AùiÚ
&);

146 
	g´iv©e
:

147 
ZkBrok”Proxy
* 
brok”_
;

148 cÚ¡ 
	g¡d
::
¡ršg
 
çrm_id_
;

149 cÚ¡ 
	g¡d
::
¡ršg
 
v”siÚ_·th_
;

	@/home/libin3-s/ldd/courier/watcher_action_store.h

2 #iâdeà
__LDD_COURIER_WATCHER_ACTION_STORE_H_


3 
	#__LDD_COURIER_WATCHER_ACTION_STORE_H_


	)

4 
	~<¡ršg
>

5 
	~"w©ch”_aùiÚ.h
"

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	gcour›r
{

15 
şass
 
	gZkBrok”StÜe
;

16 şas 
	cP»ûdÜExi¡WA
 : 
public
 
W©ch”AùiÚ
{

17 
public
:

18 
P»ûdÜExi¡WA
(
ZkBrok”StÜe
* 
b
è:
brok”_
(b){}

20 
vœtu®
 ~
P»ûdÜExi¡WA
(){};

22 
vœtu®
 
ÚNodeD–‘ed
(
zhªdË_t
*, cÚ¡ * 
·th
);

24 
	g´iv©e
:

25 
P»ûdÜExi¡WA
(const PrecedorExistWA&);

26 
	gİ”©Ü
=(cÚ¡ 
P»ûdÜExi¡WA
&);

28 
	g´iv©e
:

29 
ZkBrok”StÜe
* 
brok”_
;

32 şas 
	cNodeLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

33 
public
:

34 
NodeLi¡W©ch”AùiÚ
(
ZkBrok”StÜe
* 
b
 ): 
brok”_
(b){};

35 
	gvœtu®
 ~
NodeLi¡W©ch”AùiÚ
(){};

37 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

38 
	g´iv©e
:

39 
NodeLi¡W©ch”AùiÚ
(const NodeListWatcherAction&);

40 
	gİ”©Ü
=(cÚ¡ 
NodeLi¡W©ch”AùiÚ
&);

42 
	g´iv©e
:

43 
ZkBrok”StÜe
* 
brok”_
;

48 şas 
	cRŞesLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

49 
public
:

50 
RŞesLi¡W©ch”AùiÚ
(
ZkBrok”StÜe
* 
b
 ): 
brok”_
(b){};

51 
	gvœtu®
 ~
RŞesLi¡W©ch”AùiÚ
(){};

53 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

55 
	g´iv©e
:

56 
RŞesLi¡W©ch”AùiÚ
(const RolesListWatcherAction&);

57 
	gİ”©Ü
=(cÚ¡ 
RŞesLi¡W©ch”AùiÚ
&);

59 
	g´iv©e
:

60 
ZkBrok”StÜe
* 
brok”_
;

63 şas 
	cV”siÚNodeW©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

64 
public
:

65 
V”siÚNodeW©ch”AùiÚ
(
ZkBrok”StÜe
* 
b
, 
¡d
::
¡ršg
 
v”siÚ_·th
):

66 
brok”_
(
b
), 
v”siÚ_·th_
(
v”siÚ_·th
){};

68 
	gvœtu®
 ~
V”siÚNodeW©ch”AùiÚ
(){};

70 
vœtu®
 
ÚNodeV®ueChªged
(
zhªdË_t
*, cÚ¡ * 
·th
);

72 
	g´iv©e
:

73 
V”siÚNodeW©ch”AùiÚ
(const VersionNodeWatcherAction&);

74 
	gİ”©Ü
=(cÚ¡ 
V”siÚNodeW©ch”AùiÚ
&);

76 
	g´iv©e
:

77 
ZkBrok”StÜe
* 
brok”_
;

78 
	g¡d
::
¡ršg
 
v”siÚ_·th_
;

81 şas 
	cAliveNodeLi¡W©ch”AùiÚ
 : 
public
 
W©ch”AùiÚ
{

82 
public
:

83 
AliveNodeLi¡W©ch”AùiÚ
(
ZkBrok”StÜe
* 
b
 ): 
brok”_
(b){};

84 
	gvœtu®
 ~
AliveNodeLi¡W©ch”AùiÚ
(){};

86 
vœtu®
 
ÚChdChªged
(
zhªdË_t
*,cÚ¡ * 
·th
);

87 
	g´iv©e
:

88 
AliveNodeLi¡W©ch”AùiÚ
(const AliveNodeListWatcherAction&);

89 
	gİ”©Ü
=(cÚ¡ 
AliveNodeLi¡W©ch”AùiÚ
&);

91 
	g´iv©e
:

92 
ZkBrok”StÜe
* 
brok”_
;

	@/home/libin3-s/ldd/courier/zkbroker.h

2 #iâdeà
_LDD_COURIER_ZK_BROKER_H_


3 
	#_LDD_COURIER_ZK_BROKER_H_


	)

5 
	~<¡ršg
>

6 
	~<m­
>

7 
	~<ldd/ut/©omic.h
>

8 
	~<ldd/ut/mu‹x.h
>

9 
	~"İtiÚs.h
"

10 
	~"cour›r.h
"

12 
Çme¥aû
 
	gldd
{

13 
Çme¥aû
 
	gcour›r
{

15 
usšg
 
Çme¥aû
 
	g¡d
;

18 
şass
 
	gZooK“³rR—ùÜ
;

19 
şass
 
	gZkCÚ‹xt
;

20 
şass
 
	gCom¶‘iÚC®lBack
;

22 cÚ¡ * 
BASE_CONF_PATH
 ;

23 cÚ¡ * 
REPLICA_NODE_PATH
 ;

24 cÚ¡ * 
ENGINE_NODE_PATH
 ;

25 cÚ¡ * 
BIN_LOG_PATH
 ;

26 cÚ¡ * 
BUCKET_NODE_PATH
 ;

28 cÚ¡ * 
NODE_LIST_PATH
 ;

29 cÚ¡ * 
NAME_SPACE_LIST_PATH
 ;

30 cÚ¡ * 
BUCKET_LIST_PATH
 ;

31 cÚ¡ * 
FARM_LIST_PATH
 ;

32 cÚ¡ * 
COORDINATION
 ;

33 cÚ¡ * 
ROLES_PATH
 ;

34 cÚ¡ * 
VERSION_PATH
 ;

35 cÚ¡ * 
ALIVE_NODES_LIST_PATH
;

37 cÚ¡ * 
PROXY_NODE_LIST_PATH
 ;

39 cÚ¡ 
HISTORY_ROLES_NUMBER
;

41 
şass
 
	gRedoPŞicy
;

42 şas 
	cZooK“³rBrok”
 {

43 
	gpublic
:

44 
ZooK“³rBrok”
();

45 
	gvœtu®
 ~
ZooK“³rBrok”
();

47 
	gpublic
 :

49 
G‘R•liÿSize
(*
size
) ;

50 
G‘StÜeEngše
(
¡d
::
¡ršg
* 
’gše_Çme
) ;

51 
G‘MaxBšLogFe
(*
size
) ;

52 
G‘Buck‘Size
(*
size
) ;

53 
G‘Buck‘IDLi¡
(
RedoPŞicy
* 
½
);

54 
G‘F¬mIdOfBuck‘ID
(
RedoPŞicy
* 
½
, 
¡d
::
¡ršg
& 
buck‘ID
);

56 
	gpublic
:

57 
LßdCÚf
();

58 
RunFromCÚfig
(cÚ¡ 
O±iÚs
& 
İtiÚ
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
,

59 cÚ¡ 
¡d
::
¡ršg
& 
roÙ_·th
);

60 
vœtu®
 
LßdAµCÚfig
();

61 
vœtu®
 
LßdBa£CÚfig
();

64 
RedoPŞicy
* 
CurRedoPŞicy
();

65 
ZooK“³rR—ùÜ
* 
CurR—ùÜ
();

66 
S‘Cour›rE¼ÜCode
(
Cour›rE¼Ü
 
e
 );

67 
Cour›rE¼ÜCode
();

69 
	g¡d
::
¡ršg
& 
G‘RoÙP©h
();

70 
	gut
::
RWMu‹x
* 
G‘RwLockPŒ
();

72 
SÜtRŞesV”siÚChd»n
(** 
d©a
, 
št32_t
 
couÁ
) ;

73 
boŞ
 
G‘RŞesFromJsÚ
(cÚ¡ 
¡d
::
¡ršg
& 
rŞe_desc
, 
RŞes
* 
rŞes
);

75 
Wa™AÎ
();

76 
	gpublic
:

77 
InüI‹mNum
();

78 
DeüI‹mNum
();

80 
	gpublic
:

82 
_G‘R•liÿSize
(
RedoPŞicy
*
½
);

83 
_G‘StÜeEngše
(
RedoPŞicy
*
½
);

84 
_G‘MaxBšLogFe
(
RedoPŞicy
*
½
);

85 
_G‘Buck‘Size
(
RedoPŞicy
*
½
);

86 
	g´Ùeùed
:

87 
m­
<
¡ršg
, 
	g¡ršg
> 
	gbuck‘_cŞËùiÚ_
;

88 
	gm­
<, > 
	gbuck‘_çrmid_cŞËùiÚ_
;

90 
	g´iv©e
:

91 
ä›nd
 
şass
 
NodeLi¡CB
;

92 
ä›nd
 
şass
 
	gBuck‘Li¡CB
;

93 
ä›nd
 
şass
 
	gR•liÿNodeCB
;

94 
ä›nd
 
şass
 
	gEngšeNodeCB
;

95 
ä›nd
 
şass
 
	gG‘MaxBšLogCB
;

96 
ä›nd
 
şass
 
	gG‘Buck‘SizeCB
;

97 
ä›nd
 
şass
 
	gG‘F¬mIdOfBuck‘IdCB
;

98 
ä›nd
 
şass
 
	gF¬mLi¡CB
;

99 
HªdËZkE¼Ü
 
	ghªdË_”rÜ_
;

101 
ZooK“³rR—ùÜ
* 
	g»aùÜ_
;

103 
	gut
::
RWMu‹x
 
rwmtx_
;

104 
	gut
::
Mu‹x
 
mu_
;

105 
	gut
::
CÚdV¬
 
cv_
;

106 
	glßd_™em_num_
;

108 
	g¡d
::
¡ršg
 
roÙ_·th_
;

110 
	g»¶iÿ_size_
;

111 
	g¡d
::
¡ršg
 
’gše_Çme_
;

112 
	gbšlog_max_
;

113 
	gbuck‘s_size_
;

115 
RedoPŞicy
* 
	g»do_pŞicy_
;

116 
boŞ
 
	gu£r_defše_»do_pŞicy_
;

118 
	gut
::
Atomic
<> 
cur_”rÜ_code_
;

120 
	g´iv©e
:

121 
ZooK“³rBrok”
(const ZooKeeperBroker&);

122 cÚ¡ 
	gZooK“³rBrok”
& 
	gİ”©Ü
=(cÚ¡ 
ZooK“³rBrok”
&);

	@/home/libin3-s/ldd/courier/zkbroker_client.h

2 #iâdeà
__LDD_COURIER_ZK_BROKER_CLIENT_H_


3 
	#__LDD_COURIER_ZK_BROKER_CLIENT_H_


	)

5 
	~<¡ršg
>

6 
	~<m­
>

7 
	~"zkbrok”.h
"

8 
	~"ş›Á.h
"

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	gcour›r
{

14 
şass
 
	gZooK“³rR—ùÜ
;

15 
şass
 
	gZkCÚ‹xt
;

16 
şass
 
	gCom¶‘iÚC®lBack
;

19 şas 
	cZkBrok”Cl›Á
 : 
public
 
ZooK“³rBrok”
{

20 
public
:

21 
ZkBrok”Cl›Á
();

22 
	gvœtu®
 ~
ZkBrok”Cl›Á
();

24 
	gpublic
:

25 
G‘ProxyLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

26 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
) ;

28 
	gpublic
:

29 
vœtu®
 
LßdAµCÚfig
();

30 
vœtu®
 
LßdBa£CÚfig
();

32 
	gpublic
:

34 
G‘ProxyLi¡
(
RedoPŞicy
* 
½
);

36 
	g´iv©e
:

37 
ä›nd
 
şass
 
Cl›ÁNodeLi¡CB
;

41 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
node_cŞËùiÚ_
;

42 
NodeLi¡ChªgedNÙify
 
	gnode_li¡_nÙify_
;

44 
	g´iv©e
:

45 
ZkBrok”Cl›Á
(const ZkBrokerClient&);

46 cÚ¡ 
	gZkBrok”Cl›Á
& 
	gİ”©Ü
=(cÚ¡ 
ZkBrok”Cl›Á
&);

	@/home/libin3-s/ldd/courier/zkbroker_proxy.h

2 #iâdeà
__LDD_COURIER_ZK_BROKER_PROXY_H_


3 
	#__LDD_COURIER_ZK_BROKER_PROXY_H_


	)

5 
	~<¡ršg
>

6 
	~<m­
>

7 
	~"zkbrok”.h
"

8 
	~"cÚfigu».h
"

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	gcour›r
{

14 
şass
 
	gZooK“³rR—ùÜ
;

15 
şass
 
	gZkCÚ‹xt
;

16 
şass
 
	gCom¶‘iÚC®lBack
;

19 şas 
	cZkBrok”Proxy
 : 
public
 
ZooK“³rBrok”
{

20 
public
:

21 
ZkBrok”Proxy
(cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
);

22 
	gvœtu®
 ~
ZkBrok”Proxy
();

24 
	gpublic
:

26 
G‘NameS·ûID
(cÚ¡ 
¡d
::
¡ršg
& 
ns
, * 
id
) ;

27 
FšdF¬mIdInBuck‘Li¡
(cÚ¡ 
buck‘_id
, * 
çrm_id
);

28 
G‘F¬mLi¡
(
¡d
::
veùÜ
<>** 
çrm_li¡
);

29 
G‘RŞes
(cÚ¡ 
çrm_id
, 
RŞes
** 
rŞes
);

30 
G‘NodeLi¡
(
NodeLi¡ChªgedNÙify
 
cb
,

31 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
) ;

33 
	gpublic
:

34 
vœtu®
 
LßdAµCÚfig
();

36 
	gpublic
:

38 
G‘NodeLi¡
(
RedoPŞicy
* 
½
);

39 
C»©eProxyNode
(
RedoPŞicy
* 
½
);

40 
G‘F¬mLi¡
(
RedoPŞicy
* 
½
);

41 
G‘NsIdLi¡
(
RedoPŞicy
* 
½
);

42 
G‘NsIdIÁ
(
RedoPŞicy
* 
½
, 
¡ršg
& 
ns
);

45 
G‘RŞesChd»nLi¡
(
RedoPŞicy
* 
½
, cÚ¡ 
¡ršg
& 
çrm_id
);

46 
G‘RŞesDesc
(
RedoPŞicy
* 
½
, cÚ¡ 
¡ršg
& 
çrm_id
, cÚ¡ sŒšg& 
v”siÚ_·th
);

47 
	g´iv©e
:

48 
ä›nd
 
şass
 
NodeLi¡CB
;

49 
ä›nd
 
şass
 
	gNSLi¡CB
;

50 
ä›nd
 
şass
 
	gG‘NsIdIÁCB
;

51 
ä›nd
 
şass
 
	gBuck‘Li¡CB
;

52 
ä›nd
 
şass
 
	gR•liÿNodeCB
;

53 
ä›nd
 
şass
 
	gEngšeNodeCB
;

54 
ä›nd
 
şass
 
	gG‘F¬mIdOfBuck‘IdCB
;

55 
ä›nd
 
şass
 
	gF¬mLi¡CB
;

56 
ä›nd
 
şass
 
	gProxyRŞesChd»nM­CB
;

57 
ä›nd
 
şass
 
	gProxyG‘V”siÚV®ueCb
;

59 
	g¡d
::
m­
<
¡ršg
, > 
	gns_cŞËùiÚ_
;

60 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
node_cŞËùiÚ_
;

63 
	g¡d
::
m­
<, 
	gRŞes
> 
	gçrm_rŞes_m­_
;

65 
NodeLi¡ChªgedNÙify
 
	gnode_li¡_nÙify_
;

67 
	g¡d
::
veùÜ
<> 
çrm_cŞËùiÚ_
;

69 
	g´iv©e
:

70 
ZkBrok”Proxy
(const ZkBrokerProxy&);

71 cÚ¡ 
	gZkBrok”Proxy
& 
	gİ”©Ü
=(cÚ¡ 
ZkBrok”Proxy
&);

72 
	g¡d
::
¡ršg
 
home_ho¡_pÜt_
;

	@/home/libin3-s/ldd/courier/zkbroker_store.h

2 #iâdeà
__LDD_COURIER_ZK_BROKER_STORE_H_


3 
	#__LDD_COURIER_ZK_BROKER_STORE_H_


	)

5 
	~<veùÜ
>

6 
	~<¡ršg
>

7 
	~<¡dšt.h
>

8 
	~<m­
>

9 
	~<£t
>

10 
	~"k“³r.h
"

11 
	~"zkbrok”.h
"

14 
Çme¥aû
 
	gldd
{

15 
Çme¥aû
 
	gcour›r
{

18 şas 
	cZkBrok”StÜe
 : 
public
 
ZooK“³rBrok”
 {

19 
public
:

20 
ZkBrok”StÜe
(cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
);

21 
	gvœtu®
 ~
ZkBrok”StÜe
();

23 
	gpublic
:

24 
vœtu®
 
LßdAµCÚfig
();

25 
	gpublic
:

28 
S¹L—d”EËùiÚ
(
L—d”ShChªgedNÙify
 
cb
);

29 
DoL—d”EËùiÚ
();

30 
	g¡d
::
£t
<
ušt16_t
>& 
G‘Buck‘S‘
();

31 
AddNewRŞes
(cÚ¡ 
RŞes
& 
rŞes
);

32 
G‘RŞes
(
RŞesChªgedNÙify
 
cb
, 
RŞes
* 
rŞes
);

33 
G‘AliveNodes
(
OÆšeNodesChªgedNÙify
 
cb
, 
¡d
::
veùÜ
<¡d::
¡ršg
>* 
£rv”_li¡
);

37 
RŞesChªgedCB
(
¡d
::
¡ršg
& 
rŞes_desc
);

38 
CheckHomeHo¡PÜt
();

39 
G‘F¬mIdPaœ
(cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
, cÚ¡ std::¡ršg& 
çrm_id
);

42 
G‘NodeLi¡
(
RedoPŞicy
* 
½
);

43 
G‘F¬mIdOfNode
(
RedoPŞicy
* 
½
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡_pÜt
);

44 
C»©eAliveNode
(
RedoPŞicy
* 
½
, cÚ¡ 
¡ršg
& 
ho¡_pÜt
);

45 
G‘AliveNodeLi¡
(
RedoPŞicy
* 
½
);

46 
G‘RŞesChd»nLi¡
(
RedoPŞicy
* 
½
);

47 
G‘RŞesDesc
(
RedoPŞicy
* 
½
, cÚ¡ 
¡ršg
& 
v”siÚ_·th
);

48 
D–‘eRŞesDesc
ĞcÚ¡ 
¡ršg
& 
v”siÚ_·th
 );

51 
CheckCÜdNodeExi¡
(
RedoPŞicy
* 
½
);

52 
G‘CÜdNodeLi¡
(
RedoPŞicy
* 
½
);

53 
C»©eNodeUnd”CÜd
(
RedoPŞicy
* 
½
);

54 
C»©eV”siÚNode
(
RedoPŞicy
* 
½
, 
¡ršg
 & 
v®ue
);

57 
CheckCÜdChd»nLi¡
();

58 
S‘NodeP»fix
();

59 
LookupNode
();

61 
	g´iv©e
:

62 
SÜtChd»n
(** 
d©a
, 
št32_t
 
couÁ
);

63 
¡ršg
 
ChdFloÜ
();

64 
CheckP»ûdÜExi¡
();

65 
F‹rOwnBuck‘ID
();

67 
	g´iv©e
:

68 
ä›nd
 
şass
 
CÜdChd»nLi¡CB
;

69 
ä›nd
 
şass
 
	gC»©eNodeUnd”CÜdCB
;

71 
ä›nd
 
şass
 
	gNodesM­CB
;

72 
ä›nd
 
şass
 
	gG‘F¬mIdOfNodeCb
;

73 
ä›nd
 
şass
 
	gAliveNodeM­CB
;

75 
ä›nd
 
şass
 
	gV”siÚNodeM­CB
;

76 
ä›nd
 
şass
 
	gG‘V”siÚV®ueCb
;

78 
	g¡d
::
¡ršg
 
home_ho¡_pÜt_
;

81 
	g¡d
::
m­
<
¡d
::
¡ršg
, std::¡ršg> 
node_cŞËùiÚ_
;

82 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
®ive_node_cŞËùiÚ_
;

84 
	g¡d
::
£t
<
ušt16_t
> 
buck‘_£t_
;

88 
¡ršg
 
	gcÜd_node_·th_
;

89 
¡ršg
 
	gçrm_id_
;

90 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
cÜd_cŞËùiÚ_
;

91 
¡ršg
 
	gnode_´efix_
;

92 
¡ršg
 
	gnode_id_und”_cÜd_
;

93 
¡ršg
 
	gcur_Ëad”_
;

94 
¡ršg
 
	g´eûdÜ_Çme_
;

95 
boŞ
 
	gisL—d”_
;

96 
L—d”ShChªgedNÙify
 
	gËad”_sh_nÙify_
;

97 
RŞesChªgedNÙify
 
	grŞes_chªge_nÙify_
;

98 
OÆšeNodesChªgedNÙify
 
	gÚlše_nodes_chªged_nÙify_
;

99 
RŞes
 
	gcur_rŞes_¡_
;

100 
¡ršg
 
	gcur_v”siÚ_·th_
;

	@/home/libin3-s/ldd/courier/zkcontext.h

1 #iâdeà 
__LDD_COURIER_ZK_CONTEXT_H_


2 
	#__LDD_COURIER_ZK_CONTEXT_H_


	)

4 
	~<¡ršg
>

5 
	~<zook“³r/zook“³r.h
>

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	gcour›r
{

10 
	eZkO³¿tiÚTy³
{

11 
	gkAü—‹O±
 =1,

12 
	gkAd–‘eO±
 =2,

13 
	gkAwg‘O±
 =3,

14 
	gkAwg‘Chd»nO±
 =4,

15 
	gkAwexi¡sO±
 =5

18 
şass
 
	gCom¶‘iÚC®lBack
;

19 
şass
 
	gW©ch”AùiÚ
;

20 şas 
	cZkCÚ‹xt
{

21 
	gpublic
:

23 
ZkCÚ‹xt
(è: 
mli£cÚds_
(0), 
zhªdË_
(
NULL
), 
v”siÚ_
(0), 
ü—‹_æags_
(0), 
comp_ùx_
(NULL),

24 
w©ch”_â_
(
NULL
), 
w©ch”Ctx_
(NULL){

27 
št64_t
 
	gmli£cÚds_
;

28 
zhªdË_t
* 
	gzhªdË_
;

29 
	g¡d
::
¡ršg
 
·th_
;

31 
	gv”siÚ_
;

32 
	g¡d
::
¡ršg
 
v®ue_
;

33 
	gü—‹_æags_
;

35 
ZkO³¿tiÚTy³
 
	gİt_ty³_
;

38 
void_com¶‘iÚ_t
 
	gvoid_com¶‘iÚ_fun_
;

39 
¡ršg_com¶‘iÚ_t
 
	g¡ršg_com¶‘iÚ_fun_
;

40 
d©a_com¶‘iÚ_t
 
	gd©a_com¶‘iÚ_fun_
;

41 
¡ršgs_com¶‘iÚ_t
 
	g¡ršgs_com¶‘iÚ_fun
;

42 
¡©_com¶‘iÚ_t
 
	g¡©_com¶‘iÚ_t_fun
;

43 }
	gcomp_cb
;

44 
Com¶‘iÚC®lBack
* 
	gcomp_ùx_
;

47 
w©ch”_â
 
	gw©ch”_â_
;

48 
W©ch”AùiÚ
* 
	gw©ch”Ctx_
;

	@/home/libin3-s/ldd/net/address.h

4 #iâdeà
LDD_NET_ADDRESS_H_


5 
	#LDD_NET_ADDRESS_H_


	)

7 
	~<Ãtš‘/š.h
>

8 
	~<¡ršg
>

9 
	~<boo¡/İ”©Üs.hµ
>

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 
şass
 
	gAdd»ss
 : 
boo¡
::
equ®™y_com·¿bË
<
Add»ss
> {

15 
public
:

16 
	eFamy
 {

17 
V4
 = 
AF_INET
,

18 
	gV6
 = 
AF_INET6
,

21 
Add»ss
(
Famy
 
çmy
 = 
V4
);

22 
Add»ss
(cÚ¡ 
š_addr
& 
addr
);

23 
Add»ss
(cÚ¡ 
š6_addr
& 
addr
);

24 
Add»ss
(
ušt32_t
 
addr
);

26 
Add»ss
 
FromSŒšg
(cÚ¡ 
¡d
::
¡ršg
& 
s
, 
Famy
 
çmy
 = 
V4
);

27 
Add»ss
 
Any
(
Famy
 
çmy
 = 
V4
);

28 
Add»ss
 
Loİback
(
Famy
 
çmy
 = 
V4
);

30 
Famy
 
çmy
(ècÚ¡ {  
	gçmy_
; }

31 
boŞ
 
IsUn¥ecif›d
() const;

32 
boŞ
 
IsLoİback
() const;

33 
boŞ
 
IsV4
(ècÚ¡ {  
	gçmy_
 =ğ
V4
; }

34 
boŞ
 
IsV6
(ècÚ¡ {  
	gçmy_
 =ğ
V6
; }

35 
	g¡d
::
¡ršg
 
ToSŒšg
() const;

38 cÚ¡ 
	gš_addr
& 
ToV4
() const;

39 
ušt32_t
 
ToU32
() const;

40 
boŞ
 
IsCÏssA
() const;

41 
boŞ
 
IsCÏssB
() const;

42 
boŞ
 
IsCÏssC
() const;

43 
boŞ
 
IsMuÉiÿ¡
() const;

46 cÚ¡ 
	gš6_addr
& 
ToV6
() const;

48 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Add»ss
& 
rhs
) const;

49 
	g´iv©e
:

51 
š_addr
 
v4
;

52 
š6_addr
 
	gv6
;

53 } 
	gaddr_
;

54 
Famy
 
	gçmy_
;

	@/home/libin3-s/ldd/net/backtrace.h

4 #iâdeà
__BACK_TRACE__


5 
	#__BACK_TRACE__


	)

7 
Çme¥aû
 
	gldd
 {‚ame¥aû 
	gÃt
 {

9 
dump_Œaû
(cÚ¡ 
¡d
::
¡ršg
 &
func_Çme
);

	@/home/libin3-s/ldd/net/buffer.h

1 #iâdeà
LDD_NET_BUFFER_H_


2 
	#LDD_NET_BUFFER_H_


	)

4 
	~<¡ršg
>

5 
	~<m­
>

6 
	~<boo¡/sh¬ed_±r.hµ
>

7 
	~<ldd/ut/©omic.h
>

9 
Çme¥aû
 
	gldd
 {‚ame¥aû 
	gÃt
 {

11 şas 
	cBufãr
 {

12 
	gpublic
:

13 
Bufãr
();

14 
ex¶ic™
 
Bufãr
(
size_t
 
size
);

15 
ex¶ic™
 
Bufãr
(cÚ¡ 
¡d
::
¡ršg
& 
s
);

16 
ex¶ic™
 
Bufãr
(cÚ¡ * 
p
, 
size_t
 
l
);

18 
Bufãr
(cÚ¡ Bufã¸&
bufãr
);

21 ~
Bufãr
();

23 
Re£t
(
size_t
 
size
);

24 
Re£t
(cÚ¡ 
¡d
::
¡ršg
& 
s
);

25 
Re£t
();

27 
boŞ
 
IsEm±y
(ècÚ¡ {  
size
() == 0u; }

29 * 
d©a
(è{  
	gd©a_
.
g‘
(); }

30 cÚ¡ * 
d©a
(ècÚ¡ {  
	gd©a_
.
g‘
(); }

31 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

33 
	g¡d
::
¡ršg
 
ToSŒšg
() const;

36 
Shršk
(
size_t
 
n
);

39 
ReSize
(
size_t
 
n
);

40 * 
±r
(è{  
	gd©a_
.
g‘
(); }

41 cÚ¡ * 
±r
(ècÚ¡ {  
	gd©a_
.
g‘
(); }

42 
size_t
 
Ën
(ècÚ¡ {  
	gsize_
; }

44 
	g´iv©e
:

45 
boo¡
::
sh¬ed_±r
<> 
d©a_
;

46 
size_t
 
	gsize_
;

49 #ifdeà
RES_COUNTER


50 
	g´iv©e
:

51 
ä›nd
 
şass
 
St
;

52 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

53 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

54 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

55 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

59 
	g¡d
::
	tm­
<
	tušt8_t
, 
	tBufãr
> 
	tBufãrM­
;

	@/home/libin3-s/ldd/net/channel.h

1 #iâdeà
LDD_NET_CHANNEL_H_


2 
	#LDD_NET_CHANNEL_H_


	)

4 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

5 
	~<boo¡/make_sh¬ed.hµ
>

6 
	~<boo¡/nÚcİyabË.hµ
>

7 
	~<boo¡/ªy.hµ
>

9 
	~<ldd/ut/time_diff.h
>

10 
	~"ldd/Ãt/£rv”.h
"

11 
	~"ldd/Ãt/ş›Á.h
"

13 
Çme¥aû
 
	gldd
 {

14 
Çme¥aû
 
	gÃt
 {

16 
şass
 
	gEv’tLoİ
;

17 
şass
 
	gOutgošgMsg
;

18 
şass
 
	gEndpošt
;

20 
şass
 
	gChªÃl
 : 
public
 
boo¡
::
’abË_sh¬ed_äom_this
<
ChªÃl
>,

21 
´iv©e
 
	gboo¡
::
nÚcİyabË


23 
public
:

24 
şass
 
Im¶
;

25 
	eTy³
 {

26 
	gkIncomšg
,

27 
	gkOutgošg
,

29 
	eS‹
 {

30 
	gkClo£d
 = 0,

31 
	gkCÚÃùšg
 = 1,

32 
	gkCÚÃùed
 = 2,

34 
ChªÃl
(
Ev’tLoİ
* 
ev’t_loİ
, 
S”v”
::
Im¶
* 
£rv”
);

35 
ChªÃl
(
Ev’tLoİ
* 
ev’t_loİ
, 
Cl›Á
::
Im¶
* 
ş›Á
,

36 cÚ¡ 
¡d
::
¡ršg
&, 
ušt16_t
);

37 
ChªÃl
(
Ev’tLoİ
* 
ev’t_loİ
, 
Cl›Á
::
Im¶
* 
ş›Á
,

38 cÚ¡ 
Endpošt
&);

39 ~
ChªÃl
();

41 
	g¡d
::
¡ršg
 
Çme
() const;

42 
Ty³
 
ty³
() const;

43 
S‹
 
¡©e
() const;

44 
boŞ
 
IsCÚÃùed
(ècÚ¡ {  
¡©e
(è=ğ
kCÚÃùed
; }

45 
boŞ
 
IsCÚÃùšg
(ècÚ¡ {  
¡©e
(è=ğ
kCÚÃùšg
; }

46 
boŞ
 
IsClo£d
(ècÚ¡ {  
¡©e
(è=ğ
kClo£d
; }

47 
Ev’tLoİ
 *
ev’t_loİ
() const;

48 cÚ¡ 
	gEndpošt
& 
£lf_’dpošt
() const;

49 cÚ¡ 
	gEndpošt
& 
³”_’dpošt
() const;

51 
Clo£
();

52 
boŞ
 
Po¡
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
OutgošgMsg
>& 
mes§ge
,

53 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
 = util::TimeDiff(),

54 
boŞ
 
fÜû
 = 
çl£
);

56 
sock‘
();

57 
£t_cÚ‹xt
(cÚ¡ 
boo¡
::
ªy
& 
cÚ‹xt
);

58 cÚ¡ 
	gboo¡
::
ªy
& 
cÚ‹xt
() const;

60 
	g´iv©e
:

61 
DoClo£
();

62 
DoPo¡
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
OutgošgMsg
>& 
mes§ge
,

63 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

64 
ä›nd
 
şass
 
	gCl›Á
;

65 
ä›nd
 
şass
 
	gS”v”
;

66 
ä›nd
 
şass
 
	gIncomšgMsg
;

67 
ä›nd
 
şass
 
	gOutgošgMsg
;

68 
Im¶
 *
	gim¶_
;

	@/home/libin3-s/ldd/net/client.h

4 #iâdeà
LDD_NET_CLIENT_H_


5 
	#LDD_NET_CLIENT_H_


	)

7 
	~<boo¡/funùiÚ.hµ
>

8 
	~<boo¡/sh¬ed_±r.hµ
>

9 
	~<ldd/Ãt/šcomšg_msg_»gi¡ry.h
>

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 
şass
 
	gEv’tLoİ
;

15 
şass
 
	gEndpošt
;

16 
şass
 
	gChªÃl
;

18 şas 
	cCl›Á
 : 
public
 
IncomšgMsgRegi¡ry
 {

19 
public
:

20 
şass
 
Im¶
;

21 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tboo¡
::
	tsh¬ed_±r
<
	tChªÃl
>&)> 
	tNÙif›r
;

22 
	sO±iÚs
 {

25 
	gpul£_š‹rv®
;

29 
boŞ
 
	gpul£_»Ïxed_checkšg
;

33 
boŞ
 
	gpul£_Ïzy_em™tšg
;

37 
	g»sŞve_timeout
;

41 
	gcÚÃù_timeout
;

45 
	gcÚÃù_d–ay_couÁ
;

49 
	gcÚÃù_d–ay_time_š™Ÿl
;

53 
	gcÚÃù_d–ay_time_fš®
;

58 
	gcÚÃù_d–ay_time_¡•
;

62 
NÙif›r
 
	gnÙify_cÚÃùed
;

66 
NÙif›r
 
	gnÙify_cÚÃùšg
;

70 
NÙif›r
 
	gnÙify_şo£d
;

74 
	gsock‘_»ad_bufãr_size
;

76 
O±iÚs
();

79 
ex¶ic™
 
Cl›Á
(cÚ¡ 
O±iÚs
& 
İtiÚs
);

80 ~
Cl›Á
();

82 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
C»©e
(
Ev’tLoİ
* 
ev’t_loİ
,

83 cÚ¡ 
¡d
::
¡ršg
& 
ho¡
, 
ušt16_t
 
pÜt
);

84 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
C»©e
(
Ev’tLoİ
* 
ev’t_loİ
,

85 cÚ¡ 
Endpošt
& 
»mÙe
);

87 cÚ¡ 
	gO±iÚs
& 
İtiÚs
() const;

88 
	g´iv©e
:

89 
Im¶
 *
im¶_
;

	@/home/libin3-s/ldd/net/endpoint.h

4 #iâdeà
LDD_NET_ENDPOING_H_


5 
	#LDD_NET_ENDPOING_H_


	)

7 
	~"ldd/Ãt/add»ss.h
"

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÃt
 {

12 şas 
	cEndpošt
 {

13 
	gpublic
:

14 
Endpošt
(): 
add»ss_
(
Add»ss
::
V4
), 
pÜt_
(0) {}

15 
Endpošt
(
ušt16_t
 
pÜt
): 
add»ss_
(
Add»ss
::
V4
), 
pÜt_
(port) {}

16 
Endpošt
(
Add»ss
::
Famy
 
çmy
, 
ušt16_t
 
pÜt
)

17 : 
add»ss_
(
çmy
), 
pÜt_
(
pÜt
) {}

18 
Endpošt
(cÚ¡ 
Add»ss
& 
add»ss
, 
ušt16_t
 
pÜt
)

19 : 
add»ss_
(
add»ss
), 
pÜt_
(
pÜt
) {}

21 cÚ¡ 
	gAdd»ss
& 
add»ss
(ècÚ¡ {  
	gadd»ss_
; }

22 
ušt16_t
 
pÜt
(ècÚ¡ {  
	gpÜt_
; }

24 
£t_pÜt
(
ušt16_t
 
pÜt
è{ 
	gpÜt_
 =…ort; }

25 
£t_add»ss
(cÚ¡ 
Add»ss
& 
add»ss
è{ 
	gadd»ss_
 =‡ddress; }

27 
	g¡d
::
¡ršg
 
ToSŒšg
() const;

28 
	g´iv©e
:

29 
Add»ss
 
add»ss_
;

30 
ušt16_t
 
	gpÜt_
;

	@/home/libin3-s/ldd/net/event.h

4 #iâdeà
LDD_NET_EVENT_H_


5 
	#LDD_NET_EVENT_H_


	)

7 
	~<boo¡/nÚcİyabË.hµ
>

8 
	~<boo¡/funùiÚ.hµ
>

9 
	~<ldd/ut/time¡amp.h
>

10 
	~<ldd/ut/time_diff.h
>

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÃt
 {

15 
şass
 
	gEv’tLoİ
;

17 şas 
	cFdEv’t
 : 
boo¡
::
nÚcİyabË
 {

18 
public
:

19 
şass
 
Im¶
;

20 
	eTy³
 {

21 
	gkR—dabË
 = 1,

22 
	gkWr™abË
 = 2,

24 
	gboo¡
::
	tfunùiÚ
<()> 
	tFunùÜ
;

25 
FdEv’t
(
Ev’tLoİ
* 
loİ
);

26 ~
FdEv’t
();

27 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
);

28 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
,

29 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

30 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
,

31 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

32 
Cªûl
();

33 
	g´Ùeùed
:

34 
Im¶
* 
im¶_
;

37 şas 
	cTim”Ev’t
 : 
boo¡
::
nÚcİyabË
 {

38 
public
:

39 
şass
 
Im¶
;

40 
	gboo¡
::
	tfunùiÚ
<()> 
	tFunùÜ
;

41 
Tim”Ev’t
(
Ev’tLoİ
* 
loİ
);

42 ~
Tim”Ev’t
();

44 
boŞ
 
ExpœesAt
(
ldd
::
ut
::
Time¡amp
* 
time
);

45 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

46 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

47 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

48 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

49 
Cªûl
();

50 
	g´iv©e
:

51 
Im¶
* 
im¶_
;

54 şas 
	cSigÇlEv’t
 : 
boo¡
::
nÚcİyabË
 {

55 
public
:

56 
şass
 
Im¶
;

57 
	gboo¡
::
	tfunùiÚ
<()> 
	tFunùÜ
;

58 
SigÇlEv’t
(
Ev’tLoİ
* 
loİ
);

59 ~
SigÇlEv’t
();

61 
boŞ
 
Add
(
signo
);

62 
boŞ
 
Remove
(
signo
);

63 
boŞ
 
CË¬
();

65 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
);

66 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

67 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

68 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

69 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

70 
Cªûl
();

71 
	g´iv©e
:

72 
Im¶
* 
im¶_
;

	@/home/libin3-s/ldd/net/event_loop.h

4 #iâdeà
LDD_NET_EVENT_LOOP_H_


5 
	#LDD_NET_EVENT_LOOP_H_


	)

7 
	~<ev’t2/ev’t.h
>

8 
	~<boo¡/nÚcİyabË.hµ
>

9 
	~<boo¡/funùiÚ.hµ
>

10 
	~<boo¡/scİed_±r.hµ
>

11 
	~<ldd/ut/©omic.h
>

12 
	~<ldd/ut/th»ad.h
>

14 
Çme¥aû
 
	gldd
 {

15 
Çme¥aû
 
	gÃt
 {

17 şas 
	cEv’tLoİ
 : 
´iv©e
 
boo¡
::
nÚcİyabË
 {

18 
public
:

19 
şass
 
Im¶
;

20 
	gboo¡
::
	tfunùiÚ
<()> 
	tFunùÜ
;

21 
Ev’tLoİ
();

22 
ex¶ic™
 
Ev’tLoİ
(::
ev’t_ba£
 *
ba£
);

23 ~
Ev’tLoİ
();

25 
Run
();

26 
Stİ
();

27 
Aá”FÜk
();

29 
RunInLoİ
(cÚ¡ 
FunùÜ
& 
hªdËr
);

30 
QueueInLoİ
(cÚ¡ 
FunùÜ
& 
hªdËr
);

31 
ev’t_ba£
 *event_base();

32 
	g´iv©e
:

33 
ä›nd
 
şass
 
FdEv’t
;

34 
ä›nd
 
şass
 
	gSigÇlEv’t
;

35 
ä›nd
 
şass
 
	gTim”Ev’t
;

36 
ä›nd
 
şass
 
	gChªÃl
;

37 
ä›nd
 
şass
 
	gLi¡’”
;

38 
ä›nd
 
şass
 
	gS”v”
;

39 
ä›nd
 
şass
 
	gCl›Á
;

40 
Im¶
* 
	gim¶_
;

43 şas 
	cEv’tLoİTh»ad
 : 
´iv©e
 
boo¡
::
nÚcİyabË
 {

44 
public
:

45 
boo¡
::
	tfunùiÚ
<()> 
	tFunùÜ
;

46 
Ev’tLoİTh»ad
();

47 ~
Ev’tLoİTh»ad
();

49 
boŞ
 
S¹
(cÚ¡ 
FunùÜ
& 
´e
 = 
NULL
, cÚ¡ FunùÜ& 
po¡
 = NULL);

50 
Stİ
();

51 
Još
();

53 
Ev’tLoİ
* 
ev’t_loİ
(ècÚ¡ {  
	gev’t_loİ_
.
g‘
(); }

54 cÚ¡ 
	gut
::
Th»ad
* 
th»ad
(ècÚ¡ {  
th»ad_
.
g‘
(); }

55 
	g´iv©e
:

56 
Run
(cÚ¡ 
FunùÜ
& 
´e
, cÚ¡ FunùÜ& 
po¡
);

57 
	eS‹
 {

58 
	gkS¹šg
,

59 
	gkRuÂšg
,

60 
	gkStİpšg
,

61 
	gkJoššg
,

62 
	gkStİ³d
,

64 
	gboo¡
::
scİed_±r
<
Ev’tLoİ
> 
ev’t_loİ_
;

65 
	gboo¡
::
scİed_±r
<
ut
::
Th»ad
> 
th»ad_
;

66 
	gut
::
Atomic
<
S‹
> 
¡©e_
;

	@/home/libin3-s/ldd/net/event_loop_thread_pool.h

2 #iâdeà
LDD_NET_EVENT_LOOP_THREAD_POOL_H_


3 
	#LDD_NET_EVENT_LOOP_THREAD_POOL_H_


	)

5 
	~<boo¡/nÚcİyabË.hµ
>

6 
	~<boo¡/funùiÚ.hµ
>

7 
	~<boo¡/±r_cÚš”/±r_veùÜ.hµ
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÃt
 {

12 
şass
 
	gEv’tLoİ
;

13 
şass
 
	gEv’tLoİTh»ad
;

15 şas 
	cEv’tLoİTh»adPoŞ
 : 
´iv©e
 
boo¡
::
nÚcİyabË


17 
public
:

18 
Ev’tLoİTh»adPoŞ
(
Ev’tLoİ
* 
ba£Loİ
);

19 ~
Ev’tLoİTh»adPoŞ
();

20 
S‘Th»adNum
(
numTh»ads
è{ 
	gth»ads_num_
 =‚umThreads; }

21 
boŞ
 
S¹
();

22 
Stİ
();

23 
Ev’tLoİ
* 
G‘NextLoİ
();

25 
	gpublic
:

26 
boo¡
::
±r_veùÜ
<
Ev’tLoİTh»ad
>* 
th»ads
(è{  &
th»ads_
; }

28 
	g´iv©e
:

29 
Ev’tLoİ
* 
ba£_loİ_
;

30 
boŞ
 
	g¡¬‹d_
;

31 
	gth»ads_num_
;

32 
size_t
 
	gÃxt_
;

33 
	gboo¡
::
±r_veùÜ
<
Ev’tLoİTh»ad
> 
th»ads_
;

	@/home/libin3-s/ldd/net/factory.h

4 #iâdeà
LDD_NET_FACTORY_H_


5 
	#LDD_NET_FACTORY_H_


	)

7 
	~<boo¡/sh¬ed_±r.hµ
>

8 
	~<boo¡/make_sh¬ed.hµ
>

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 
	gNÚeArg
;

18 
	g‹m¶©e
 <
şass
 
	gT
>

19 
	sFaùÜy
 {

20 
	gvœtu®
 ~
FaùÜy
() {}

21 
vœtu®
 
T
* 
New
() const = 0;

22 
vœtu®
 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
() const = 0;

24 
	g‹m¶©e
 <
şass
 
	gD
>

25 
FaùÜy
* 
NewFaùÜy
();

27 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
>

28 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
);

30 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
>

31 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
);

33 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

34 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
);

36 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

37 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
);

39 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

40 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
);

42 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

43 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
);

45 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

46 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
);

48 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

49 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
);

51 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

52 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
);

54 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

55 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
);

58 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
,

59 
şass
 
	gA1
 = 
NÚeArg
, cÏs 
	gA2
 = NÚeArg, cÏs 
	gA3
 = NoneArg,

60 
şass
 
	gA4
 = 
NÚeArg
, cÏs 
	gA5
 = NÚeArg, cÏs 
	gA6
 = NoneArg,

61 
şass
 
	gA7
 = 
NÚeArg
, cÏs 
	gA8
 = NÚeArg, cÏs 
	gA9
 = NoneArg,

62 
şass
 
	gA10
 = 
NÚeArg
>

63 
FaùÜyIm¶
;

65 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
>

66 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

67 
FaùÜyIm¶
() {}

68 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(); }

69 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(); }

72 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
>

73 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

74 
FaùÜyIm¶
(
A1
 
a1
)

75 :
a1_
(
a1
) {}

76 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
); }

77 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
); }

78 
A1
 
	ga1_
;

81 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
>

82 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

83 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
)

84 :
a1_
(
a1
), 
a2_
(
a2
) {}

85 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
); }

86 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
); }

87 
A1
 
	ga1_
; 
A2
 
	ga2_
;

90 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

91 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

92 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
)

93 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
) {}

94 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
); }

95 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
); }

96 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
;

99 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

100 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

101 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
)

102 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
) {}

103 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
); }

104 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
); }

105 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
;

108 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

109 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

110 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
)

111 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
) {}

112 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
); }

113 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
); }

114 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
;

117 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

118 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gNÚeArg
, NÚeArg, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

119 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
)

120 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
), 
a6_
(
a6
) {}

121 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
, 
a6_
); }

122 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
, 
	ga6_
); }

123 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
; 
A6
 
	ga6_
;

126 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

127 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gNÚeArg
, NÚeArg, NÚeArg> : 
public
 
FaùÜy
<
T
> {

128 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
)

129 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
), 
a6_
(
a6
), 
a7_
(
a7
) {}

130 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
, 
a6_
, 
a7_
); }

131 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
, 
	ga6_
, 
	ga7_
); }

132 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
; 
A6
 
	ga6_
; 
A7
 
	ga7_
;

135 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

136 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gA8
, 
	gNÚeArg
, NÚeArg> : 
public
 
FaùÜy
<
T
> {

137 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
)

138 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
), 
a6_
(
a6
), 
a7_
(
a7
), 
a8_
(
a8
) {}

139 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
, 
a6_
, 
a7_
, 
a8_
); }

140 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
, 
	ga6_
, 
	ga7_
, 
	ga8_
); }

141 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
; 
A6
 
	ga6_
; 
A7
 
	ga7_
; 
A8
 
	ga8_
;

144 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

145 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gA8
, 
	gA9
, 
	gNÚeArg
> : 
public
 
FaùÜy
<
T
> {

146 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
)

147 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
), 
a6_
(
a6
), 
a7_
(
a7
), 
a8_
(
a8
), 
a9_
(
a9
) {}

148 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
, 
a6_
, 
a7_
, 
a8_
, 
a9_
); }

149 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
, 
	ga6_
, 
	ga7_
, 
	ga8_
, 
	ga9_
); }

150 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
; 
A6
 
	ga6_
; 
A7
 
	ga7_
; 
A8
 
	ga8_
; 
A9
 
	ga9_
;

153 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

154 
	gFaùÜyIm¶
 : 
public
 
FaùÜy
<
T
> {

155 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
)

156 :
a1_
(
a1
), 
a2_
(
a2
), 
a3_
(
a3
), 
a4_
(
a4
), 
a5_
(
a5
), 
a6_
(
a6
), 
a7_
(
a7
), 
a8_
(
a8
), 
a9_
(
a9
), 
a10_
(
a10
) {}

157 
T
* 
New
(ècÚ¡ {  
Ãw
 
D
(
a1_
, 
a2_
, 
a3_
, 
a4_
, 
a5_
, 
a6_
, 
a7_
, 
a8_
, 
a9_
, 
a10_
); }

158 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(ècÚ¡ {  
boo¡
::
make_sh¬ed
<
D
>(
a1_
, 
	ga2_
, 
	ga3_
, 
	ga4_
, 
	ga5_
, 
	ga6_
, 
	ga7_
, 
	ga8_
, 
	ga9_
, 
	ga10_
); }

159 
A1
 
	ga1_
; 
A2
 
	ga2_
; 
A3
 
	ga3_
; 
A4
 
	ga4_
; 
A5
 
	ga5_
; 
A6
 
	ga6_
; 
A7
 
	ga7_
; 
A8
 
	ga8_
; 
A9
 
	ga9_
; 
A10
 
	ga10_
;

162 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
>

163 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
() {

164  
Ãw
 
FaùÜyIm¶
<
T
, 
	gD
>();

166 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
>

167 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
) {

168  
Ãw
 
FaùÜyIm¶
<
T
, 
	gD
, 
	gA1
>(
	ga1
);

170 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
>

171 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
) {

172  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
>(
	ga1
, 
	ga2
);

174 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

175 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
) {

176  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
>(
	ga1
, 
	ga2
, 
	ga3
);

178 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

179 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
) {

180  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
);

182 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

183 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
) {

184  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
);

186 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

187 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
) {

188  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
);

190 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

191 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
) {

192  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
);

194 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

195 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
) {

196  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gA8
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
);

198 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

199 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
) {

200  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gA8
, 
	gA9
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
);

202 
	g‹m¶©e
 <
şass
 
	gT
>em¶©<şas 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

203 
šlše
 
	gFaùÜy
<
	gT
>* FaùÜy<T>::
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
) {

204  
Ãw
 
	gFaùÜyIm¶
<
	gT
, 
	gD
, 
	gA1
, 
	gA2
, 
	gA3
, 
	gA4
, 
	gA5
, 
	gA6
, 
	gA7
, 
	gA8
, 
	gA9
, 
	gA10
>(
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
, 
	ga10
);

	@/home/libin3-s/ldd/net/incoming_msg.h

1 #iâdeà
LDD_NET_INCOMING_MSG_H_


2 
	#LDD_NET_INCOMING_MSG_H_


	)

4 
	~<m­
>

5 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

6 
	~<boo¡/nÚcİyabË.hµ
>

7 
	~"ldd/Ãt/·ylßd.h
"

8 
	~"ldd/Ãt/mes§ge.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 
şass
 
	gChªÃl
;

15 
şass
 
	gIncomšgMsg
 : 
public
 
boo¡
::
’abË_sh¬ed_äom_this
<
IncomšgMsg
>,

16 
´iv©e
 
	gboo¡
::
nÚcİyabË
 {

17 
public
:

18 
şass
 
Im¶
;

19 
	gldd
::
	tÃt
::
	tPaylßd
 Payload;

20 
	gldd
::
	tÃt
::
	tMes§geId
 
	tId
;

21 
	gldd
::
	tÃt
::
	tMes§geTy³
 
	tTy³
;

22 
	gldd
::
	tÃt
::
	tCode
 Code;

24 
	eAùiÚ
 { 
	gkWa™
, 
	gkEm™
, 
	gkDÚe
 };

26 
	gvœtu®
 ~
IncomšgMsg
();

27 
vœtu®
 
Ty³
 
ty³
() const = 0;

29 
Id
 
id
() const;

30 
boŞ
 
IsCªûËd
() const;

31 cÚ¡ 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
() const;

35 
NÙify
(
boŞ
 
dÚe
 = 
çl£
);

36 
	g´Ùeùed
:

37 
IncomšgMsg
();

39 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) = 0;

41 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) = 0;

43 
vœtu®
 
DÚe
(
Code
* 
code
) = 0;

45 
vœtu®
 
Cªûl
() = 0;

46 
	g´iv©e
:

47 
DoNÙify
(
boŞ
);

48 
Im¶
* 
	gim¶_
;

49 
ä›nd
 
şass
 
	gChªÃl
;

50 
ä›nd
 
şass
 
	gIncomšgReque¡
;

51 
ä›nd
 
şass
 
	gIncomšgCªûl
;

54 
	g‹m¶©e
 <
Mes§geTy³
 
	gN
>

55 şas 
	cTy³dIncomšgMsg
 : 
public
 
IncomšgMsg
 {

56 
public
:

57 cÚ¡ 
Ty³
 
kTy³
 = 
N
;

58 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

59 
	g´Ùeùed
:

60 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) = 0;

61 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) = 0;

62 
vœtu®
 
DÚe
(
Code
* 
code
) = 0;

63 
vœtu®
 
Cªûl
() {}

67 şas 
	cDyÇmicIncomšgMsg
 : 
public
 
IncomšgMsg
 {

68 
public
:

69 ~
DyÇmicIncomšgMsg
();

70 
£t_ty³
(
Ty³
 
ty³
);

71 
Ty³
 
ty³
(ècÚ¡ {  
	gty³_
; }

72 
	g´Ùeùed
:

73 
DyÇmicIncomšgMsg
(è: 
ty³_
(0) {}

74 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) = 0;

75 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) = 0;

76 
vœtu®
 
DÚe
(
Code
* 
code
) = 0;

77 
vœtu®
 
Cªûl
() {}

78 
	g´iv©e
:

79 
Ty³
 
ty³_
;

82 
	g´iv©e
:

83 
ä›nd
 
şass
 
St
;

85 
	sNextF»e
 {

86 
NextF»e
()

87 : 
Ãxt_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>()),

88 
ä“_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>())

89 { *
Ãxt_id_
 = 0; *
	gä“_id_
 = 0; }

90 ~
NextF»e
() {}

92 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
Ãxt_id_
;

93 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
ä“_id_
;

96 
	g¡d
::
m­
<
Ty³
, 
	gNextF»e
> 
	g¡©_
;

98 
	g¡d
::
	tm­
<
	tTy³
, 
	tNextF»e
>::
	t™”©Ü
 
	tSTAT_IT
;

100 
Inc
(
Ty³
 
ty³
);

101 
Dec
(
Ty³
 
ty³
);

	@/home/libin3-s/ldd/net/incoming_msg_registry.h

4 #iâdeà
LDD_NET_INCOMING_MSG_REGISTRY_H_


5 
	#LDD_NET_INCOMING_MSG_REGISTRY_H_


	)

7 
	~"ldd/Ãt/mes§ge.h
"

8 
	~"ldd/Ãt/»gi¡ry.h
"

9 
	~"ldd/Ãt/šcomšg_msg.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

21 
şass
 
	gIncomšgMsgRegi¡ry
 : 
´iv©e
 
Regi¡ry
<
IncomšgMsg
, 
	gMes§geTy³
> {

22 
	gpublic
:

23 
IncomšgMsgRegi¡ry
(è: 
deçuÉ_
(
NULL
) {}

24 
vœtu®
 ~
IncomšgMsgRegi¡ry
(è{ 
d–‘e
 
deçuÉ_
; }

26 
	gboo¡
::
sh¬ed_±r
<
IncomšgMsg
> 
NewIncomšgMsg
(
Mes§geTy³
 
t
è{  
MakeSh¬ed
(t); }

28 
	gboo¡
::
sh¬ed_±r
<
DyÇmicIncomšgMsg
> 
NewDeçuÉIncomšgMsg
() {

29 ià(
deçuÉ_
 !ğ
NULL
) {

30  
deçuÉ_
->
MakeSh¬ed
();

32  
	gboo¡
::
sh¬ed_±r
<
DyÇmicIncomšgMsg
>();

37 
	g‹m¶©e
 <
şass
 
	gMsg
>

38 
Regi¡”IncomšgMsg
(è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
); }

39 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
>

40 
Regi¡”IncomšgMsg
(
A1
 
a1
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
); }

41 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
>

42 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
); }

43 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

44 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
); }

45 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

46 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
); }

47 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

48 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
); }

49 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

50 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
); }

51 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

52 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
); }

53 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

54 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
); }

55 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

56 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
); }

57 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

58 
Regi¡”IncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
è{ 
	gRegi¡”
<
	gMsg
>(Msg::
kTy³
, 
	ga1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
, 
	ga10
); }

60 
	g‹m¶©e
 <
şass
 
	gMsg
>

61 
Regi¡”DeçuÉIncomšgMsg
() {

62 
as£¹
(!
deçuÉ_
);

63 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>();

65 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
>

66 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
) {

67 
as£¹
(!
deçuÉ_
);

68 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
);

70 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
>

71 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
) {

72 
as£¹
(!
deçuÉ_
);

73 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
);

75 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

76 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
) {

77 
as£¹
(!
deçuÉ_
);

78 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
);

80 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

81 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
) {

82 
as£¹
(!
deçuÉ_
);

83 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
);

85 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

86 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
) {

87 
as£¹
(!
deçuÉ_
);

88 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
);

90 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

91 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
) {

92 
as£¹
(!
deçuÉ_
);

93 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
);

95 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

96 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
) {

97 
as£¹
(!
deçuÉ_
);

98 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
);

100 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

101 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
) {

102 
as£¹
(!
deçuÉ_
);

103 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
);

105 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

106 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
) {

107 
as£¹
(!
deçuÉ_
);

108 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
);

110 
	g‹m¶©e
 <
şass
 
	gMsg
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

111 
Regi¡”DeçuÉIncomšgMsg
(
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
) {

112 
as£¹
(!
deçuÉ_
);

113 
	gdeçuÉ_
 = 
FaùÜy
<
DyÇmicIncomšgMsg
>::
NewFaùÜy
<
Msg
>(
a1
, 
	ga2
, 
	ga3
, 
	ga4
, 
	ga5
, 
	ga6
, 
	ga7
, 
	ga8
, 
	ga9
, 
	ga10
);

115 
	g´iv©e
:

116 
FaùÜy
<
DyÇmicIncomšgMsg
>* 
deçuÉ_
;

	@/home/libin3-s/ldd/net/internal/channel_impl.h

4 #iâdeà
LDD_INTERNAL_CHANNEL_IMPL_H_


5 
	#LDD_INTERNAL_CHANNEL_IMPL_H_


	)

7 
	~<boo¡/ªy.hµ
>

8 
	~<boo¡/funùiÚ.hµ
>

9 
	~<boo¡/scİed_±r.hµ
>

10 
	~<boo¡/±r_cÚš”/±r_veùÜ.hµ
>

11 
	~<boo¡/±r_cÚš”/±r_deque.hµ
>

13 
	~"ldd/Ãt/šcomšg_msg_»gi¡ry.h
"

14 
	~"ldd/Ãt/chªÃl.h
"

15 
	~"ldd/Ãt/ev’t.h
"

16 
	~"ldd/Ãt/’dpošt.h
"

17 
	~"ldd/Ãt/£rv”.h
"

18 
	~"ldd/Ãt/ş›Á.h
"

19 
	~"£rv”_im¶.h
"

20 
	~"ş›Á_im¶.h
"

21 
	~"´ÙocŞ.h
"

22 
	~"sk.h
"

25 
Çme¥aû
 
	gldd
 {

26 
Çme¥aû
 
	gÃt
 {

28 
şass
 
	gOutgošgPack‘
;

29 
şass
 
	gPul£Em™‹r
;

30 
şass
 
	gPul£Check”
;

31 
şass
 
	gOutgošgChªÃl
;

33 şas 
	cEv’tCtx
 {

34 
	gpublic
:

35 
Ev’tCtx
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
> &
owÃr


36 , 
ChªÃl
::
Im¶
 *
im¶
)

37 : 
owÃr_
(
owÃr
)

38 , 
im¶_
(
im¶
)

40 #ifdeà
RES_COUNTER


41 
	gÃxt_id_
++;

45 ~
Ev’tCtx
() {

46 #ifdeà
RES_COUNTER


47 
	gä“_id_
++;

51 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
owÃr_
;

52 
	gChªÃl
::
Im¶
 *
im¶_
;

54 #ifdeà
RES_COUNTER


55 
	g´iv©e
:

56 
ä›nd
 
şass
 
St
;

57 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

58 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

59 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

60 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

64 şas 
	cDnsCtx
 {

65 
	gpublic
:

66 
DnsCtx
(
OutgošgChªÃl
 *
oc


67 , cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
> &
owÃr


68 , 
evdns_ba£
 *
dns_ba£
)

69 : 
oc_
(
oc
)

70 , 
owÃr_
(
owÃr
)

71 , 
dns_ba£_
(
dns_ba£
)

73 #ifdeà
RES_COUNTER


74 
	gÃxt_id_
++;

77 ~
DnsCtx
() {

78 #ifdeà
RES_COUNTER


79 
	gä“_id_
++;

83 
OutgošgChªÃl
 *
	goc_
;

84 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
owÃr_
;

85 
evdns_ba£
 *
	gdns_ba£_
;

87 #ifdeà
RES_COUNTER


88 
	g´iv©e
:

89 
ä›nd
 
şass
 
St
;

90 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

91 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

92 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

93 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

97 şas 
	cChªÃl
::
Im¶
 {

98 
public
:

99 
boo¡
::
	tfunùiÚ
<(cÚ¡ 
	tboo¡
::
	tsh¬ed_±r
<
	tChªÃl
>&)> 
	tNÙif›r
;

100 
ChªÃl
 
	tOwÃr
;

101 
	gChªÃl
::
	tTy³
 Type;

104 
	gkR—dH—d”
=0,

105 
	gkR—dBody
,

109 
Im¶
(
OwÃr
* 
owÃr
, 
Ev’tLoİ
* 
ev’t_loİ
);

110 
	gvœtu®
 ~
Im¶
();

112 
vœtu®
 
Ty³
 
ty³
() const = 0;

113 
vœtu®
 
O³n
() = 0;

114 
Clo£
();

115 
Clo£Sock‘
();

116 
vœtu®
 
IncomšgMsgRegi¡ry
* 
»gi¡ry
() const = 0;

118 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const = 0;

119 
Ev’tLoİ
* 
ev’t_loİ
(ècÚ¡ {  
	gev’t_loİ_
; }

120 
ev’t_ba£
 *event_base();

121 
S‹
 
¡©e
(ècÚ¡ {  
	g¡©e_
; }

122 
£t_¡©e
(
S‹
 
¡©e
è{ 
	g¡©e_
 = state; }

123 
£t_sock‘
(
sock‘
);

125 
	gH—d”
::
P¬£r
 
h—d”
(è{  
H—d”
::P¬£r(
h—d”_
->
d©a
()); }

127 cÚ¡ 
	gEndpošt
& 
£lf_’dpošt
(ècÚ¡ {  
	g£lf_’dpošt_
; }

128 cÚ¡ 
	gEndpošt
& 
³”_’dpošt
(ècÚ¡ {  
	g³”_’dpošt_
; }

129 
ušt64_t
 
id
(ècÚ¡ {  
	gid_
; }

131 
Po¡
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
OutgošgMsg
>& 
mes§ge
,

132 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

134 
boŞ
 
AddIncomšgMsg
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
IncomšgMsg
>& 
šcomšg_msg
);

135 
	gboo¡
::
sh¬ed_±r
<
IncomšgMsg
> 
G‘IncomšgMsg
(

136 
št32_t
 
id
, 
boŞ
 
»move
 = 
çl£
);

137 
	gboo¡
::
sh¬ed_±r
<
OutgošgMsg
> 
G‘OutgošgMsg
(

138 
št32_t
 
id
, 
boŞ
 
»move
 = 
çl£
);

139 
Wr™e
(
OutgošgPack‘
* 
·ck‘
);

141 
sock‘
(è{  
	gsock‘_
; }

142 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
owÃr
(è{  
owÃr_
->
sh¬ed_äom_this
(); }

144 
št32_t
 
NextOutgošgMsgId
() {

145  (++
	goutgošg_msg_id_
) & 0x7fffffff;

148 
£t_cÚ‹xt
(cÚ¡ 
boo¡
::
ªy
& 
cÚ‹xt
)

149 { 
cÚ‹xt_
 = 
cÚ‹xt
; }

151 cÚ¡ 
	gboo¡
::
ªy
& 
cÚ‹xt
() const

152 {  
cÚ‹xt_
; }

154 
vœtu®
 
OnPšg
() = 0;

155 
vœtu®
 
OnPÚg
() = 0;

156 
vœtu®
 
OnE¼Ü
() = 0;

157 
vœtu®
 
OnClo£
() = 0;

158 
vœtu®
 
DoPul£
() = 0;

159 
vœtu®
 
OnCÚÃù
(
”rÜ
) = 0;

161 
OnIncomšgPack‘
();

162 
OnOutgošgPack‘
();

163 
OnPul£Faed
();

165 
	g´Ùeùed
:

166 
ä›nd
 
şass
 
Pack‘R—d”
;

167 
boŞ
 
FlEndpošts
(boŞ 
»mÙe
);

168 
NÙify
(cÚ¡ 
NÙif›r
& 
nÙif›r
);

169 
CË¬IncomšgMsg
();

170 
CË¬OutgošgMsg
();

172 
AddEv’t
(
æag
è{ 
S‘Ev’t
(
ev’ts_
 | flag); }

173 
D–Ev’t
(
æag
è{ 
S‘Ev’t
(
ev’ts_
 & ~flag); }

174 
S‘Ev’t
(
ev’ts
);

176 
OnR—d
();

177 
OnWr™e
();

178 
R—dH—d”
();

179 
R—dBody
();

180 
ProûssPack‘
();

181 
DoWr™e
();

183 
Ev’tNÙify
(
fd
, 
wh©
, *
¬g
);

185 
R—lWr™e
();

187 
	gsock‘_
;

188 
R—dTask
 
	g»ad_h—d”_sk_
;

189 
R—dTask
 
	g»ad_body_sk_
;

190 
Wr™eTask
 
	gwr™e_sk_
;

191 
Ev’tCtx
 *
	gev’t_ùx_
;

193 
	g´iv©e
:

194 
¡d
::
	tm­
<
	tšt32_t
, 
	tboo¡
::
	tsh¬ed_±r
<
	tOutgošgMsg
> > 
	tOutgošgMsgM­
;

195 
	g¡d
::
	tm­
<
	tšt32_t
, 
	tboo¡
::
	tsh¬ed_±r
<
	tIncomšgMsg
> > 
	tIncomšgMsgM­
;

197 
OwÃr
* 
	gowÃr_
;

198 
Ev’tLoİ
* 
	gev’t_loİ_
;

199 
S‹
 
	g¡©e_
;

201 
	gev’ts_
;

202 
	g»ad_¡©e_
;

203 
ev’t
 *
	gsock‘_ev_
;

205 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> 
h—d”_
;

206 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> 
·ck‘_
;

207 
	g·ck‘_size_
;

209 
IncomšgMsgM­
 
	gimsgs_
;

210 
OutgošgMsgM­
 
	gomsgs_
;

212 
	gboo¡
::
±r_deque
<
OutgošgPack‘
> 
³ndšg_·ck‘s_
;

213 
	gboo¡
::
±r_veùÜ
<
OutgošgPack‘
> 
wr™šg_·ck‘s_
;

214 
	g¡d
::
deque
<
boo¡
::
sh¬ed_±r
<
Bufãr
> > 
wr™šg_bufãrs_
;

216 
št32_t
 
	goutgošg_msg_id_
;

218 
	gboo¡
::
ªy
 
cÚ‹xt_
;

219 
ušt64_t
 
	gid_
;

221 
	g´Ùeùed
:

222 
Endpošt
 
£lf_’dpošt_
;

223 
Endpošt
 
	g³”_’dpošt_
;

224 
	gboo¡
::
scİed_±r
<
Pul£Em™‹r
> 
pul£_em™‹r_
;

225 
	gboo¡
::
scİed_±r
<
Pul£Check”
> 
pul£_check”_
;

227 
	g´iv©e
:

228 
ut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

231 şas 
	cIncomšgChªÃl
 : 
public
 
ChªÃl
::
Im¶
 {

232 
ChªÃl
::
	tIm¶
 
	tSu³r
;

233 
	gpublic
:

234 
ChªÃl
::
	tTy³
 Type;

235 
IncomšgChªÃl
(
OwÃr
* 
owÃr
, 
Ev’tLoİ
* 
ev’t_loİ
,

236 
S”v”
::
Im¶
* 
£rv”
);

237 
	gvœtu®
 ~
IncomšgChªÃl
();

238 
vœtu®
 
Ty³
 
ty³
(ècÚ¡ {  
	gChªÃl
::
kIncomšg
; }

239 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

241 
vœtu®
 
O³n
();

242 
vœtu®
 
IncomšgMsgRegi¡ry
* 
»gi¡ry
(ècÚ¡ {  
	g£rv”_
->
owÃr
(); }

243 
	g´iv©e
:

244 
In™Pul£
();

245 
vœtu®
 
OnPšg
();

246 
vœtu®
 
OnPÚg
();

247 
vœtu®
 
OnE¼Ü
();

248 
vœtu®
 
OnClo£
();

249 
vœtu®
 
DoPul£
();

250 
vœtu®
 
OnCÚÃù
(
”rÜ
) {}

252 cÚ¡ 
	gS”v”
::
O±iÚs
& 
İtiÚs
(ècÚ¡ {  
£rv”_
->options(); }

253 
	g´iv©e
:

254 
S”v”
::
Im¶
* 
£rv”_
;

256 #ifdeà
RES_COUNTER


257 
	g´iv©e
:

258 
ä›nd
 
şass
 
St
;

259 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

260 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

261 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

262 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

266 şas 
	cOutgošgChªÃl
 : 
public
 
ChªÃl
::
Im¶
 {

267 
public
:

268 
ChªÃl
::
	tIm¶
 
	tSu³r
;

269 
	gChªÃl
::
	tTy³
 Type;

272 
OutgošgChªÃl
(
OwÃr
* 
owÃr
, 
Ev’tLoİ
* 
ev’t_loİ
,

273 
Cl›Á
::
Im¶
* 
ş›Á
, cÚ¡ 
¡d
::
¡ršg
& 
ho¡
, 
ušt16_t
 
pÜt
);

274 
OutgošgChªÃl
(
OwÃr
* 
owÃr
, 
Ev’tLoİ
* 
ev’t_loİ
,

275 
Cl›Á
::
Im¶
* 
ş›Á
, cÚ¡ 
Endpošt
& 
»mÙe
);

276 
	gvœtu®
 ~
OutgošgChªÃl
();

278 
vœtu®
 
Ty³
 
ty³
(ècÚ¡ {  
	gChªÃl
::
kOutgošg
; }

279 
vœtu®
 
	g¡d
::
¡ršg
 
Çme
() const;

281 
vœtu®
 
O³n
();

282 
vœtu®
 
IncomšgMsgRegi¡ry
* 
»gi¡ry
(ècÚ¡ {  
	gş›Á_
->
owÃr
(); }

283 
	g´iv©e
:

284 
In™Pul£
();

285 
vœtu®
 
OnPšg
();

286 
vœtu®
 
OnPÚg
();

287 
vœtu®
 
OnE¼Ü
();

288 
vœtu®
 
OnClo£
();

289 
vœtu®
 
DoPul£
();

291 
DoCÚÃù
();

292 
RecÚÃù
();

293 
ResŞve
();

294 
OnResŞveTimeout
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
o
);

295 
OnResŞve
(
”rcode


296 , 
evut_addršfo
 *
addr


297 , *
±r
);

298 
DoResŞve
(
”rcode
, 
evut_addršfo
 *
addr
);

299 
CÚÃù
();

300 
OnCÚÃùTimeout
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
o
);

301 
vœtu®
 
OnCÚÃù
(
”rÜ
);

303 
AsyncCÚÃù
(cÚ¡ 
¡d
::
¡ršg
 &
ho¡


304 , 
ušt16_t
 
pÜt


305 , 
timeout
);

307 
D–ayCÚÃù
();

308 
DoD–ayCÚÃù
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>&);

310 cÚ¡ 
	gCl›Á
::
O±iÚs
& 
İtiÚs
(ècÚ¡ {  
ş›Á_
->options(); }

312 
	g´iv©e
:

313 
Cl›Á
::
Im¶
* 
ş›Á_
;

314 
Tim”Ev’t
 
	gtim”_
;

316 
	g¡d
::
¡ršg
 
ho¡_
;

317 
ušt16_t
 
	gpÜt_
;

318 
boŞ
 
	gÃed_»sŞve_
;

319 
	gcÚÃù_çu»_
;

320 
boŞ
 
	gcÚÃù_d–ay_
;

321 
evdns_g‘addršfo_»que¡
 *
	gdns_»q_
;

322 
DnsCtx
 *
	gdns_ùx_
;

324 #ifdeà
RES_COUNTER


325 
	g´iv©e
:

326 
ä›nd
 
şass
 
St
;

327 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

328 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

329 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

330 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/client_impl.h

4 #iâdeà
LDD_NET_INTERNAL_CLIENT_IMPL_H_


5 
	#LDD_NET_INTERNAL_CLIENT_IMPL_H_


	)

7 
	~"ldd/Ãt/ş›Á.h
"

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÃt
 {

12 şas 
	cCl›Á
::
Im¶
 {

13 
public
:

14 
Im¶
(
Cl›Á
* 
ş›Á
, cÚ¡ Cl›Á::
O±iÚs
& 
İtiÚs
);

16 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
C»©e
(
Ev’tLoİ
* 
ev’t_loİ
,

17 cÚ¡ 
¡d
::
¡ršg
& 
ho¡
, 
ušt16_t
 
pÜt
);

18 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
C»©e
(
Ev’tLoİ
* 
ev’t_loİ
,

19 cÚ¡ 
Endpošt
& 
»mÙe
);

21 
Cl›Á
* 
owÃr
(ècÚ¡ {  
	gş›Á_
; }

22 cÚ¡ 
	gCl›Á
::
O±iÚs
& 
İtiÚs
(ècÚ¡ {  
İtiÚs_
; }

24 
	g´iv©e
:

25 
Cl›Á
* 
ş›Á_
;

26 
	gCl›Á
::
O±iÚs
 
İtiÚs_
;

28 #ifdeà
RES_COUNTER


29 
	g´iv©e
:

31 
ä›nd
 
şass
 
St
;

32 
ä›nd
 
şass
 
	gOutgošgChªÃl
;

33 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

34 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

35 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

36 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/event_impl.h

4 #iâdeà
LDD_NET_INTERNAL_EVENT_IMPL_H_


5 
	#LDD_NET_INTERNAL_EVENT_IMPL_H_


	)

7 
	~<ev’t2/ev’t.h
>

9 
	~<£t
>

10 
	~<m­
>

12 
	~<boo¡/sh¬ed_±r.hµ
>

13 
	~<boo¡/w—k_±r.hµ
>

14 
	~"ldd/Ãt/ev’t.h
"

15 
	~"ev’t_loİ_im¶.h
"

17 
Çme¥aû
 
	gldd
 {

18 
Çme¥aû
 
	gÃt
 {

20 şas 
	cFdEv’t
::
Im¶
 {

21 cÚ¡ 
kTimedOut
 = 4;

22 
	gpublic
:

23 
Im¶
(
Ev’tLoİ
::Im¶* 
loİ
);

24 ~
Im¶
();

27 
	gkNoTime
 = 0,

28 
	gkTimeDiff
,

29 
	gkTime¡amp


32 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
);

33 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
,

34 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

35 
AsyncWa™
(
fd
, 
ev’ts
, cÚ¡ 
FunùÜ
& 
hªdËr
,

36 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

37 
Cªûl
();

39 
	g´Ùeùed
:

40 
S¹
(
fd
, 
ev’ts
);

41 
NÙify
(
fd
, 
wh©
, *
¬g
);

43 
	gEv’tLoİ
::
Im¶
* 
loİ_
;

45 
ev’t
 *
	gev_
;

47 
	gldd
::
ut
::
TimeDiff
 
time_diff_
;

48 
	gldd
::
ut
::
Time¡amp
 
time_¡amp_
;

50 
	gtime_æag_
;

52 
FunùÜ
 
	ghªdËr_
;

53 
št8_t
 
	gæags_
;

54 
boŞ
 
	gaùive_
;

56 #ifdeà
RES_COUNTER


57 
	g´iv©e
:

58 
ä›nd
 
şass
 
St
;

59 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

60 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

61 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

62 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

66 şas 
	cTim”Ev’t
::
Im¶
 {

67 
public
:

68 
Im¶
(
Ev’tLoİ
::Im¶* 
loİ
);

69 ~
Im¶
();

72 
	gkNoTime
 = 0,

73 
	gkTimeDiff
,

74 
	gkTime¡amp


77 
boŞ
 
ExpœesAt
(
ldd
::
ut
::
Time¡amp
* 
time
);

78 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

79 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

80 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

81 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

82 
Cªûl
();

84 
	g´iv©e
:

85 
S¹
();

86 
OnTim”
(
fd
, 
wh©
, *
¬g
);

88 
	gEv’tLoİ
::
Im¶
* 
loİ_
;

90 
ev’t
 *
	gtim”_ev_
;

91 
	gldd
::
ut
::
TimeDiff
 
time_diff_
;

92 
	gldd
::
ut
::
Time¡amp
 
time_¡amp_
;

93 
	gtime_æag_
;

95 
	gldd
::
ut
::
Time¡amp
 
¡¬t_¡amp_
;

97 
FunùÜ
 
	ghªdËr_
;

98 
boŞ
 
	gaùive_
;

100 #ifdeà
RES_COUNTER


101 
	g´iv©e
:

102 
ä›nd
 
şass
 
St
;

103 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

104 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

105 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

106 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

110 şas 
	cSigÇlEv’t
::
Im¶
 {

111 
public
:

112 
Im¶
(
Ev’tLoİ
::Im¶* 
loİ
);

113 ~
Im¶
();

115 
boŞ
 
Add
(
signo
);

116 
boŞ
 
Remove
(
signo
);

117 
boŞ
 
CË¬
();

119 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
);

120 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

121 cÚ¡ 
ldd
::
ut
::
Time¡amp
& 
timeout
);

122 
AsyncWa™
(cÚ¡ 
FunùÜ
& 
hªdËr
,

123 cÚ¡ 
ldd
::
ut
::
TimeDiff
& 
timeout
);

124 
Cªûl
();

126 
	g´iv©e
:

127 
OnSigÇl
(
fd
, 
wh©
, *
¬g
);

128 
OnTim”
(
fd
, 
wh©
, *
¬g
);

130 
	gEv’tLoİ
::
Im¶
* 
loİ_
;

131 
ev’t
 *
	gtim”_ev_
;

132 
	g¡d
::
m­
<, 
	gev’t
 *> 
	gsig_ev_
;

134 
FunùÜ
 
	ghªdËr_
;

136 #ifdeà
RES_COUNTER


137 
	g´iv©e
:

138 
ä›nd
 
şass
 
St
;

139 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

140 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

141 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

142 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/event_loop_impl.h

4 #iâdeà
LDD_NET_INTERNAL_EVENT_LOOP_IMPL_H_


5 
	#LDD_NET_INTERNAL_EVENT_LOOP_IMPL_H_


	)

7 
	~<±h»ad.h
>

8 
	~<ev’t2/ev’t.h
>

9 
	~"ldd/Ãt/ev’t_loİ.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 şas 
	cEv’tLoİ
::
Im¶
 {

15 
public
:

16 
Im¶
();

17 
ex¶ic™
 
Im¶
(::
ev’t_ba£
 *
ba£
);

18 ~
Im¶
();

20 
Run
();

21 
Stİ
();

22 
Aá”FÜk
();

23 
RunInLoİ
(cÚ¡ 
FunùÜ
& 
hªdËr
);

24 
QueueInLoİ
(cÚ¡ 
FunùÜ
& 
hªdËr
);

26 
ev’t_ba£
 *ev’t_ba£(è{  
	gev’t_ba£_
; }

28 
	g´iv©e
:

29 
Po¡
(cÚ¡ 
FunùÜ
& 
funùÜ
);

30 
PeNÙify
(
fd
, 
wh©
, *
¬g
);

31 
R—lStİ
();

32 
In™
();

34 
	g´iv©e
:

35 
ev’t_ba£
 *
ev’t_ba£_
;

37 
	gfd_
[2];

38 &
	g»ad_fd_
;

39 &
	gwr™e_fd_
;

40 
ev’t
 *
	g»ad_ev_
;

42 
±h»ad_t
 
	gtid_
;

44 #ifdeà
RES_COUNTER


45 
	g´iv©e
:

46 
ä›nd
 
şass
 
St
;

47 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

48 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

49 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

50 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/incoming_msg_impl.h

4 #iâdeà
LDD_NET_INTERNAL_INCOMING_MSG_IMPL_H_


5 
	#LDD_NET_INTERNAL_INCOMING_MSG_IMPL_H_


	)

7 
	~"ldd/Ãt/šcomšg_msg.h
"

8 
	~"ldd/ut/©omic.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 
şass
 
	gChªÃl
;

14 
şass
 
	gOutgošgRe¥Ú£
;

16 şas 
	cIncomšgMsg
::
Im¶
 {

17 
public
:

18 
ldd
::
	tÃt
::
	tPaylßd
 Payload;

19 
	gldd
::
	tÃt
::
	tCode
 Code;

20 
	gldd
::
	tÃt
::
	tMes§geId
 
	tId
;

21 
	gldd
::
	tÃt
::
	tMes§geTy³
 
	tTy³
;

23 
Im¶
(
IncomšgMsg
* 
m
)

24 : 
owÃr_
(
m
), 
id_
(-1), 
ÿnûËd_
(
çl£
),

25 
wa™šg_
(
çl£
),

26 
»¥Ú£_
(
NULL
)

28 #ifdeà
RES_COUNTER


29 
	gÃxt_id_
++;

33 
	gvœtu®
 ~
Im¶
();

35 
	gboo¡
::
sh¬ed_±r
<
IncomšgMsg
> 
owÃr
() const {

36  
owÃr_
->
sh¬ed_äom_this
();

38 cÚ¡ 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
(ècÚ¡ {  
chªÃl_
; }

39 
Id
 
id
(ècÚ¡ {  
	gid_
; }

40 
boŞ
 
IsCªûËd
(ècÚ¡ {  
	gÿnûËd_
; }

42 
In™
(
Id
 
id
, cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
);

43 
NÙify
(
boŞ
 
dÚe
);

45 
OnReque¡
(cÚ¡ 
Paylßd
& 
·ylßd
);

46 
DoEm™
();

47 
DoDÚe
();

48 
DoCªûl
();

49 
	g´iv©e
:

50 
Wr™eRe¥Ú£
(cÚ¡ 
Paylßd
& 
·ylßd
);

51 
Wr™eDÚe
(
Code
 
code
);

53 
	g´iv©e
:

54 
IncomšgMsg
* 
owÃr_
;

55 
Id
 
	gid_
;

56 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
chªÃl_
;

57 
boŞ
 
	gÿnûËd_
;

58 
boŞ
 
	gwa™šg_
;

59 
OutgošgRe¥Ú£
* 
	g»¥Ú£_
;

62 #ifdeà
RES_COUNTER


63 
	g´iv©e
:

64 
ä›nd
 
şass
 
St
;

65 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

66 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

67 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

68 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/incoming_packet.h

4 #iâdeà
LDD_NET_INTERNAL_INCOMING_PACKET_H_


5 
	#LDD_NET_INTERNAL_INCOMING_PACKET_H_


	)

7 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

8 
	~<boo¡/sh¬ed_±r.hµ
>

10 
	~"´ÙocŞ.h
"

11 
	~"chªÃl_im¶.h
"

13 
Çme¥aû
 
	gldd
 {

14 
Çme¥aû
 
	gÃt
 {

18 
şass
 
	gIncomšgPack‘
 : 
public
 
boo¡
::
’abË_sh¬ed_äom_this
<
IncomšgPack‘
> {

19 
public
:

20 
IncomšgPack‘
(
ChªÃl
::
Im¶
* 
chªÃl
)

21 : 
chªÃl_
(
chªÃl
), 
chªÃl_owÃr_
(chªÃl->
owÃr
())

23 
	gvœtu®
 ~
IncomšgPack‘
();

25 
vœtu®
 
Proûss
() = 0;

26 
	gChªÃl
::
Im¶
* 
chªÃl
(ècÚ¡ {  
chªÃl_
; }

27 
	gH—d”
::
P¬£r
 
h—d”
(ècÚ¡ {  
chªÃl_
->header(); }

28 
	g´iv©e
:

29 
ChªÃl
::
Im¶
* 
chªÃl_
;

30 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
chªÃl_owÃr_
;

33 şas 
	cIncomšgPack‘W™hPaylßd
 : 
public
 
IncomšgPack‘
 {

34 
public
:

35 
IncomšgPack‘W™hPaylßd
(
ChªÃl
::
Im¶
* 
chªÃl


36 , cÚ¡ * 
Çme


37 , cÚ¡ 
boo¡
::
sh¬ed_±r
<
Bufãr
> &
·ck‘
)

38 : 
IncomšgPack‘
(
chªÃl
), 
Çme_
(
Çme
), 
·ck‘_
(
·ck‘
) {}

40 
vœtu®
 
Proûss
();

41 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> 
·ck‘
(è{  
·ck‘_
; }

43 
	g´Ùeùed
:

44 
ProûssPack‘
();

46 
vœtu®
 
DÚe
() = 0;

48 cÚ¡ * 
Çme
(ècÚ¡ {  
	gÇme_
; }

49 cÚ¡ 
	gPaylßd
& 
·ylßd
(ècÚ¡ {  
	g·ylßd_
; }

50 
	g´iv©e
:

51 cÚ¡ * 
Çme_
;

52 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> 
·ck‘_
;

53 
Paylßd
 
	g·ylßd_
;

56 şas 
	cIncomšgPšg
: 
public
 
IncomšgPack‘
 {

57 
public
:

58 
IncomšgPšg
(
ChªÃl
::
Im¶
* 
chªÃl
)

59 : 
IncomšgPack‘
(
chªÃl
) {}

60 
vœtu®
 
Proûss
();

63 şas 
	cIncomšgPÚg
: 
public
 
IncomšgPack‘
 {

64 
public
:

65 
IncomšgPÚg
(
ChªÃl
::
Im¶
* 
chªÃl
)

66 : 
IncomšgPack‘
(
chªÃl
) {}

67 
vœtu®
 
Proûss
();

70 şas 
	cIncomšgReque¡
: 
public
 
IncomšgPack‘W™hPaylßd
 {

71 
public
:

72 
IncomšgReque¡
(
ChªÃl
::
Im¶
* 
chªÃl


73 , cÚ¡ 
boo¡
::
sh¬ed_±r
<
Bufãr
> &
·ck‘
)

74 : 
IncomšgPack‘W™hPaylßd
(
chªÃl
, "»que¡", 
·ck‘
) {}

75 
	g´iv©e
:

76 
vœtu®
 
DÚe
();

79 şas 
	cIncomšgRe¥Ú£
: 
public
 
IncomšgPack‘W™hPaylßd
 {

80 
public
:

81 
IncomšgRe¥Ú£
(
ChªÃl
::
Im¶
* 
chªÃl
, cÚ¡ 
boo¡
::
sh¬ed_±r
<
Bufãr
> &
·ck‘
)

82 : 
IncomšgPack‘W™hPaylßd
(
chªÃl
,

83 
chªÃl
->
h—d”
().
ty³
(è=ğ
H—d”
::
kLa¡
? "last" : "response",

84 
·ck‘
)

86 
	g´iv©e
:

87 
vœtu®
 
DÚe
();

90 şas 
	cIncomšgEnd
: 
public
 
IncomšgPack‘
 {

91 
public
:

92 
IncomšgEnd
(
ChªÃl
::
Im¶
* 
chªÃl
)

93 : 
IncomšgPack‘
(
chªÃl
) {}

94 
vœtu®
 
Proûss
();

97 şas 
	cIncomšgCªûl
: 
public
 
IncomšgPack‘
 {

98 
public
:

99 
IncomšgCªûl
(
ChªÃl
::
Im¶
* 
chªÃl
)

100 : 
IncomšgPack‘
(
chªÃl
) {}

101 
vœtu®
 
Proûss
();

	@/home/libin3-s/ldd/net/internal/listener_impl.h

4 #iâdeà
LDD_NET_INTERNAL_LISTENER_IMPL_H_


5 
	#LDD_NET_INTERNAL_LISTENER_IMPL_H_


	)

7 
	~"ldd/Ãt/’dpošt.h
"

8 
	~"ldd/Ãt/li¡’”.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 şas 
	cLi¡’”
::
Im¶
 {

14 
public
:

15 
Im¶
(
Ev’tLoİ
* 
ev’t_loİ
);

16 ~
Im¶
();

18 
boŞ
 
O³n
(cÚ¡ 
Endpošt
& 
’dpošt
);

19 
Clo£
();

21 
boŞ
 
IsO³n
(ècÚ¡ {  
	gfd_
 >= 0; }

22 
Ev’tLoİ
* 
ev’t_loİ
(ècÚ¡ {  
	gev’t_loİ_
; }

23 
fd
(ècÚ¡ {  
	gfd_
; }

24 
	g´iv©e
:

25 
Ev’tLoİ
* 
ev’t_loİ_
;

26 
	gfd_
;

	@/home/libin3-s/ldd/net/internal/outgoing_msg_impl.h

4 #iâdeà
LDD_NET_INTERNAL_OUTGOING_MSG_IMPL_H_


5 
	#LDD_NET_INTERNAL_OUTGOING_MSG_IMPL_H_


	)

7 
	~<boo¡/sh¬ed_±r.hµ
>

8 
	~<boo¡/scİed_±r.hµ
>

9 
	~"ldd/Ãt/ev’t.h
"

10 
	~"ldd/Ãt/outgošg_msg.h
"

11 
	~"chªÃl_im¶.h
"

13 
Çme¥aû
 
	gldd
 {

14 
Çme¥aû
 
	gÃt
 {

16 
şass
 
	gOutgošgReque¡
;

17 
şass
 
	gChªÃl
;

19 şas 
	cOutgošgMsg
::
Im¶
 {

20 cÚ¡ 
kDeçuÉS’dTimeout
 = 5;

21 cÚ¡ 
	gkDeçuÉRecvTimeout
 = 200;

22 cÚ¡ 
	gkDeçuÉNextTimeout
 = 100;

23 cÚ¡ 
	gkDeçuÉDÚeTimeout
 = 300;

24 
	gpublic
:

25 
Im¶
(
OutgošgMsg
* 
owÃr
)

26 : 
owÃr_
(
owÃr
), 
id_
(-1), 
»que¡_
(
NULL
), 
dÚe_
(
çl£
), 
š™_
(false)

28 #ifdeà
RES_COUNTER


29 
	gÃxt_id_
++;

33 ~
Im¶
() {

34 #ifdeà
RES_COUNTER


35 
	gä“_id_
++;

40 
	gboo¡
::
sh¬ed_±r
<
OutgošgMsg
> 
owÃr
() const {

41  
owÃr_
->
sh¬ed_äom_this
();

44 
Id
 
id
(ècÚ¡ {  
	gid_
; }

45 cÚ¡ 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
(ècÚ¡ {  
chªÃl_
; }

47 
In™
(
Id
 
id
, cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
,

48 cÚ¡ 
ut
::
TimeDiff
& 
£nd_timeout
);

49 
boŞ
 
OnReque¡
(
Paylßd
* 
·ylßd
);

50 
OnRe¥Ú£
(cÚ¡ 
Paylßd
& 
·ylßd
, 
boŞ
 
Ï¡
, 
Code
 
code
);

51 
OnOk
(
Code
 
code
);

52 
OnCªûl
();

53 
OnFaed
();

54 
OnTimeout
();

56 
Cªûl
();

57 
	g´iv©e
:

58 
DoCªûl
();

59 
OnTimeout
(
Tim”Ev’t
* 
tim”
);

60 
S‘Tim”
(
Tim”Ev’t
* 
tim”
, cÚ¡ 
ut
::
TimeDiff
& 
timeout
,

61 cÚ¡ 
ut
::
TimeDiff
& 
deçuÉ_timeout
);

63 
CË¬Tim”
();

64 
CË¬Reque¡
();

65 
CËªUp
();

66 
	g´iv©e
:

67 
OutgošgMsg
* 
owÃr_
;

68 
Id
 
	gid_
;

69 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
chªÃl_
;

70 
	gboo¡
::
scİed_±r
<
Tim”Ev’t
> 
tim”1_
;

71 
	gboo¡
::
scİed_±r
<
Tim”Ev’t
> 
tim”2_
;

72 
OutgošgReque¡
* 
	g»que¡_
;

73 
boŞ
 
	gdÚe_
;

74 
boŞ
 
	gš™_
;

76 #ifdeà
RES_COUNTER


77 
	g´iv©e
:

78 
ä›nd
 
şass
 
St
;

79 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

80 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

81 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

82 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/outgoing_packet.h

4 #iâdeà
LDD_NET_INTERNAL_OUTGOING_PACKET_H_


5 
	#LDD_NET_INTERNAL_OUTGOING_PACKET_H_


	)

7 
	~<veùÜ
>

8 
	~<ldd/ut/cÚ¡_bufãr.h
>

9 
	~"´ÙocŞ.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

16 
şass
 
	gIncomšgMsg
;

17 
şass
 
	gOutgošgMsg
;

19 şas 
	cOutgošgPack‘
 {

20 
	gpublic
:

21 
OutgošgPack‘
();

22 
	gvœtu®
 ~
OutgošgPack‘
() {}

23 
size_t
 
S”ŸlizeTo
(
¡d
::
veùÜ
<
CÚ¡Bufãr
>* 
bufãrs
);

24 
Di§bË
(è{ 
	gdi§bËd_
 = 
Œue
; }

25 
	g´Ùeùed
:

26 
vœtu®
 
boŞ
 
S”Ÿlize
(
¡d
::
veùÜ
<
CÚ¡Bufãr
>* 
bufãrs
,

27 
size_t
* 
size
) {

28 *
	gsize
 = 0;

29  
	gŒue
;

32 
	gh—d”_
[
H—d”
::
kBy‹Size
];

33 
boŞ
 
	gdi§bËd_
;

36 şas 
	cOutgošgPšg
 : 
public
 
OutgošgPack‘
 {

37 
public
:

38 
OutgošgPšg
(
Mes§geId
 
id
) {

39 
H—d”
::
Bud”
 
hdr
(
h—d”_
);

40 
	ghdr
.
£t_ty³
(
H—d”
::
kPšg
);

41 
	ghdr
.
£t_id
(
id
);

42 
	ghdr
.
Bud
();

46 şas 
	cOutgošgPÚg
 : 
public
 
OutgošgPack‘
 {

47 
public
:

48 
OutgošgPÚg
(
Mes§geId
 
id
) {

49 
H—d”
::
Bud”
 
hdr
(
h—d”_
);

50 
	ghdr
.
£t_ty³
(
H—d”
::
kPÚg
);

51 
	ghdr
.
£t_id
(
id
);

52 
	ghdr
.
Bud
();

56 şas 
	cOutgošgPack‘W™hPaylßd
 : 
public
 
OutgošgPack‘
 {

57 
public
:

58 
OutgošgPack‘W™hPaylßd
(cÚ¡ 
Paylßd
& 
·ylßd
)

59 : 
·ylßd_
(
·ylßd
)

61 
OutgošgPack‘W™hPaylßd
() {}

63 
´Ùeùed
:

64 
boŞ
 
S”Ÿlize
(
¡d
::
veùÜ
<
CÚ¡Bufãr
>* 
bufãrs
,

65 
size_t
* 
size
);

66 
vœtu®
 
boŞ
 
In™Paylßd
() = 0;

67 
Paylßd
 
	g·ylßd_
;

68 
Bufãr
 
	gexthdr_
;

71 şas 
	cOutgošgReque¡
 : 
public
 
OutgošgPack‘W™hPaylßd
 {

72 
public
:

73 
OutgošgReque¡
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
OutgošgMsg
>& 
msg
);

74 
vœtu®
 
boŞ
 
In™Paylßd
();

75 
	g´iv©e
:

76 
boo¡
::
sh¬ed_±r
<
OutgošgMsg
> 
msg_
;

79 şas 
	cOutgošgRe¥Ú£
: 
public
 
OutgošgPack‘W™hPaylßd
 {

80 
public
:

81 
OutgošgRe¥Ú£
(
Mes§geId
 
id
, cÚ¡ 
Paylßd
& 
·ylßd
)

82 : 
OutgošgPack‘W™hPaylßd
(
·ylßd
), 
Ï¡_
(
çl£
), 
code_
(0) {

83 
	gH—d”
::
Bud”
 
hdr
(
h—d”_
);

84 
	ghdr
.
£t_ty³
(
H—d”
::
kRe¥Ú£
);

85 
	ghdr
.
£t_id
(
id
);

87 
vœtu®
 
boŞ
 
In™Paylßd
() {

88 ià(
Ï¡
()) {

89 
DLOG
(
INFO
) << "InitPayload,ype: "

90 << 
	gH—d”
::
kLa¡


91 << ", bodyy³: " << 
code
();

92 
	gH—d”
::
Bud”
 
hdr
(
h—d”_
);

93 
	ghdr
.
£t_ty³
(
H—d”
::
kLa¡
);

94 
	ghdr
.
£t_body_ty³
(
code
());

96  
	gŒue
;

98 
£t_Ï¡
(
boŞ
 
Ï¡
è{ 
	gÏ¡_
 =†ast; }

99 
£t_code
(
Code
 
code
è{ 
	gcode_
 = code; }

101 
boŞ
 
Ï¡
(ècÚ¡ {  
	gÏ¡_
; }

102 
Code
 
code
(ècÚ¡ {  
	gcode_
; }

103 
	g´iv©e
:

104 
boŞ
 
Ï¡_
;

105 
Code
 
	gcode_
;

108 şas 
	cOutgošgEnd
 : 
public
 
OutgošgPack‘
 {

109 
public
:

110 
OutgošgEnd
(
Mes§geId
 
id
, 
Code
 
code
) {

111 
	gH—d”
::
Bud”
 
hdr
(
h—d”_
);

112 
	ghdr
.
£t_ty³
(
H—d”
::
kEnd
);

113 
	ghdr
.
£t_id
(
id
);

114 
	ghdr
.
£t_body_ty³
(
code
);

115 
	ghdr
.
Bud
();

119 şas 
	cOutgošgCªûl
 : 
public
 
OutgošgPack‘
 {

120 
public
:

121 
OutgošgCªûl
(
Mes§geId
 
id
) {

122 
H—d”
::
Bud”
 
hdr
(
h—d”_
);

123 
	ghdr
.
£t_ty³
(
H—d”
::
kCªûl
);

124 
	ghdr
.
£t_id
(
id
);

125 
	ghdr
.
Bud
();

	@/home/libin3-s/ldd/net/internal/protocol.h

1 #iâdeà
LDD_NET_PROTOCOL_H_


2 
	#LDD_NET_PROTOCOL_H_


	)

4 
	~<¡dšt.h
>

6 
Çme¥aû
 
	gldd
 {

7 
Çme¥aû
 
	gÃt
 {

21 şas 
	cH—d”
 {

22 
	gpublic
:

23 cÚ¡ 
size_t
 
kBy‹Size
 = 16;

24 cÚ¡ 
ušt8_t
 
	gkMagic
 = 0xA1;

26 
	eTy³
 {

28 
	gkReque¡
 = 0,

29 
	gkPšg
,

30 
	gkCªûl
,

33 
	gkRe¥Ú£
 = 128,

34 
	gkPÚg
,

35 
	gkLa¡
,

36 
	gkEnd
,

39 şas 
	cP¬£r
 {

40 
	gpublic
:

41 
P¬£r
(cÚ¡ * 
buf
);

42 
boŞ
 
IsV®id
() const;

44 
ušt8_t
 
ty³
() const;

45 
ušt32_t
 
id
() const;

46 
ušt16_t
 
body_ty³
() const;

47 
ušt32_t
 
body_size
() const;

48 
ušt8_t
 
ext_couÁ
() const;

49 
ušt16_t
 
ext_Ën
() const;

50 
	g´iv©e
:

51 cÚ¡ * 
buf_
;

54 şas 
	cBud”
 {

55 
	gpublic
:

56 
Bud”
(* 
buf
);

57 
Bud
();

59 
£t_ty³
(
ušt8_t
 
ty³
);

60 
£t_id
(
ušt32_t
 
id
);

61 
£t_body_ty³
(
ušt16_t
 
body_ty³
);

62 
£t_body_size
(
ušt32_t
 
body_size
);

63 
£t_ext_couÁ
(
ušt8_t
 
ext_couÁ
);

64 
£t_ext_Ën
(
ušt16_t
 
ext_Ën
);

65 
	g´iv©e
:

66 * 
buf_
;

70 şas 
	cExtH—d”
 {

71 
	gpublic
:

72 cÚ¡ 
kUn™Size
 = 2;

73 
ušt32_t
 
size
(
couÁ
è{  
	gcouÁ
 * 2; }

75 şas 
	cP¬£r
 {

76 
	gpublic
:

77 
P¬£r
(
ušt8_t
 
ext_couÁ
, cÚ¡ * 
buf
);

78 
boŞ
 
IsV®id
(
ušt16_t
 
ext_Ën
) const;

80 
boŞ
 
G‘ExtI‹m
(
šdex
, 
ušt8_t
 *
ty³
, ušt8_ˆ*
Ën
);

81 
	g´iv©e
:

82 
ušt8_t
 
ext_couÁ_
;

83 cÚ¡ * 
	gext_buf_
;

86 şas 
	cBud”
 {

87 
	gpublic
:

88 
Bud”
(* 
buf
);

89 
AddExtI‹m
(
ušt8_t
 
ty³
, ušt8_ˆ
Ën
);

90 
	g´iv©e
:

91 
ext_couÁ_
;

92 * 
	gext_buf_
;

	@/home/libin3-s/ldd/net/internal/pulse_checker.h

4 #iâdeà
LDD_NET_INTERNAL_PULSE_CHECKER_H_


5 
	#LDD_NET_INTERNAL_PULSE_CHECKER_H_


	)

7 
	~<boo¡/funùiÚ.hµ
>

8 
	~"ldd/Ãt/ev’t.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 
şass
 
	gEv’tLoİ
;

15 şas 
	cPul£Check”
 {

16 
	gpublic
:

17 
boo¡
::
	tfunùiÚ
<()> 
	tR•Ü‹r
;

19 
Pul£Check”
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
R•Ü‹r
& 
»pÜ‹r
,

20 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
);

21 
	gvœtu®
 ~
Pul£Check”
() {}

22 
S¹
();

23 
Stİ
();

24 
NÙifyIncomšgPul£
();

25 
NÙifyIncomšgPack‘
();

26 
boŞ
 
ruÂšg
(ècÚ¡ {  
	gruÂšg_
; }

27 
	g´Ùeùed
:

28 
vœtu®
 
IncomšgPul£
() = 0;

29 
vœtu®
 
IncomšgPack‘
() = 0;

30 
R•Üt
(ècÚ¡ { 
»pÜ‹r_
(); }

31 cÚ¡ 
	gut
::
TimeDiff
& 
š‹rv®
(ècÚ¡ {  
š‹rv®_
; }

32 
	gTim”Ev’t
& 
tim”
(è{  
	gtim”_
; }

33 
	g´iv©e
:

34 
Tim”Ev’t
 
tim”_
;

35 
R•Ü‹r
 
	g»pÜ‹r_
;

36 
	gut
::
TimeDiff
 
š‹rv®_
;

37 
boŞ
 
	gruÂšg_
;

40 şas 
	cSŒiùPul£Check”
 : 
public
 
Pul£Check”
 {

41 
public
:

42 
SŒiùPul£Check”
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
R•Ü‹r
& 
»pÜ‹r
,

43 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

44 : 
Pul£Check”
(
ev’t_loİ
, 
»pÜ‹r
, 
š‹rv®
) {}

45 
vœtu®
 
IncomšgPul£
();

46 
vœtu®
 
IncomšgPack‘
() {

47 
DLOG
(
INFO
) << "enter IncomingPacket,‚othingo do in StrictPulseChecker";

51 şas 
	cR–axedPul£Check”
 : 
public
 
SŒiùPul£Check”
 {

52 
public
:

53 
R–axedPul£Check”
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
R•Ü‹r
& 
»pÜ‹r
,

54 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

55 : 
SŒiùPul£Check”
(
ev’t_loİ
, 
»pÜ‹r
, 
š‹rv®
) {}

56 
vœtu®
 
IncomšgPack‘
() {

57 
DLOG
(
INFO
) << "enter IncomingPacket, call NotifyIncomingPulse in RelaxedPulseChecker";

58 
NÙifyIncomšgPul£
();

	@/home/libin3-s/ldd/net/internal/pulse_emitter.h

4 #iâdeà
LDD_NET_INTERNAL_PULSE_EMITTER_H_


5 
	#LDD_NET_INTERNAL_PULSE_EMITTER_H_


	)

7 
	~<boo¡/nÚcİyabË.hµ
>

8 
	~<boo¡/funùiÚ.hµ
>

9 
	~"ldd/Ãt/ev’t.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 şas 
	cPul£Em™‹r
 : 
boo¡
::
nÚcİyabË
 {

15 
public
:

16 
boo¡
::
	tfunùiÚ
<()> 
	tPul£r
;

17 
Pul£Em™‹r
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
Pul£r
& 
pul£r
,

18 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

19 : 
tim”_
(
ev’t_loİ
), 
pul£r_
(
pul£r
), 
š‹rv®_
(
š‹rv®
),

20 
ruÂšg_
(
çl£
) {}

21 
	gvœtu®
 ~
Pul£Em™‹r
();

22 
S¹
(
boŞ
 
em™
 = 
çl£
);

23 
Stİ
();

24 
boŞ
 
ruÂšg
(ècÚ¡ {  
	gruÂšg_
; }

26 
NÙifyIncomšgPul£
();

27 
NÙifyIncomšgPack‘
();

28 
NÙifyOutgošgPack‘
();

29 
	g´Ùeùed
:

30 
vœtu®
 
DoS¹
() = 0;

31 
vœtu®
 
IncomšgPul£
() = 0;

32 
vœtu®
 
IncomšgPack‘
() = 0;

33 
vœtu®
 
OutgošgPack‘
() = 0;

34 
Pul£
(è{ 
pul£r_
(); }

35 cÚ¡ 
	gut
::
TimeDiff
& 
š‹rv®
(ècÚ¡ {  
š‹rv®_
; }

36 
	gTim”Ev’t
& 
tim”
(è{  
	gtim”_
; }

37 
	g´iv©e
:

38 
Tim”Ev’t
 
tim”_
;

39 
Pul£r
 
	gpul£r_
;

40 
	gut
::
TimeDiff
 
š‹rv®_
;

41 
boŞ
 
	gruÂšg_
;

44 şas 
	cClockPul£Em™‹r
 : 
public
 
Pul£Em™‹r
 {

45 
public
:

46 
ClockPul£Em™‹r
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
Pul£r
& 
pul£r
,

47 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

48 : 
Pul£Em™‹r
(
ev’t_loİ
, 
pul£r
, 
š‹rv®
) {}

49 
vœtu®
 
DoS¹
();

50 
vœtu®
 
IncomšgPul£
() {}

51 
vœtu®
 
IncomšgPack‘
() {}

52 
vœtu®
 
OutgošgPack‘
() {}

53 
	g´iv©e
:

54 
DoPul£
();

57 şas 
	cR•lyPul£Em™‹r
 : 
public
 
Pul£Em™‹r
 {

58 
public
:

59 
R•lyPul£Em™‹r
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
Pul£r
& 
pul£r
,

60 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

61 : 
Pul£Em™‹r
(
ev’t_loİ
, 
pul£r
, 
š‹rv®
) {}

62 
vœtu®
 
DoS¹
();

63 
vœtu®
 
IncomšgPul£
();

64 
vœtu®
 
IncomšgPack‘
() {}

65 
vœtu®
 
OutgošgPack‘
() {}

68 şas 
	cLazyPul£Em™‹r
 : 
public
 
Pul£Em™‹r
 {

69 
public
:

70 
LazyPul£Em™‹r
(
Ev’tLoİ
* 
ev’t_loİ
, cÚ¡ 
Pul£r
& 
pul£r
,

71 cÚ¡ 
ut
::
TimeDiff
& 
š‹rv®
)

72 : 
Pul£Em™‹r
(
ev’t_loİ
, 
pul£r
, 
š‹rv®
) {}

73 
vœtu®
 
DoS¹
();

74 
vœtu®
 
IncomšgPul£
() {}

75 
vœtu®
 
IncomšgPack‘
() {}

76 
vœtu®
 
OutgošgPack‘
();

	@/home/libin3-s/ldd/net/internal/server_impl.h

4 #iâdeà
LDD_NET_INTERNAL_SERVER_IMPL_H_


5 
	#LDD_NET_INTERNAL_SERVER_IMPL_H_


	)

7 
	~"ldd/Ãt/£rv”.h
"

8 
	~"li¡’”_im¶.h
"

9 
	~"ldd/Ãt/ev’t.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 şas 
	cS”v”
::
Im¶
 {

15 
public
:

16 
ex¶ic™
 
Im¶
(
S”v”
* 
£rv”
, cÚ¡ 
O±iÚs
& 
İtiÚs
);

17 ~
Im¶
();

19 
boŞ
 
S¹
(
Li¡’”
::
Im¶
* 
li¡’”
);

20 
Stİ
();

22 
S”v”
* 
owÃr
(è{  
	g£rv”_
; }

23 cÚ¡ 
	gO±iÚs
& 
İtiÚs
(è{  
	gİtiÚs_
; }

24 
	g´iv©e
:

25 
Acû±
();

26 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
NewChªÃl
();

27 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
NewChªÃl
(cÚ¡ 
Add»ss
& 
addr
);

29 
HªdËAcû±
();

30 
O³nChªÃl
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
);

31 
O³nTh»adChªÃl
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
);

33 
S”v”
* 
	g£rv”_
;

34 
O±iÚs
 
	gİtiÚs_
;

35 
	gLi¡’”
::
Im¶
* 
li¡’”_
;

36 
	gboo¡
::
scİed_±r
<
FdEv’t
> 
ev’t_
;

37 
ušt32_t
 
	gth»ad_idx_
;

39 #ifdeà
RES_COUNTER


40 
	g´iv©e
:

42 
ä›nd
 
şass
 
St
;

43 
ä›nd
 
şass
 
	gIncomšgChªÃl
;

44 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

45 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

46 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

47 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/internal/task.h

4 #iâdeà
__TASK_H__


5 
	#__TASK_H__


	)

7 
	~<boo¡/funùiÚ.hµ
>

9 
şass
 
	gBufãr
;

11 
Çme¥aû
 
	gldd
 {‚ame¥aû 
	gÃt
 {

13 şas 
	cTask
 {

14 
	gpublic
:

15 
Task
();

16 
	gvœtu®
 ~
Task
();

18 
S‘
(cÚ¡ 
boo¡
::
sh¬ed_±r
<
Bufãr
> &
bufãr
, 
fd
);

19 
boŞ
 
IsS‘
(è{  
	gis_£t_
; }

20 
Re£t
();

21 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> &
bufãr
(è{  
bufãr_
; }

23 
sock‘
(è{  
	gfd_
; }

25 
vœtu®
 
R—d
() = 0;

26 
vœtu®
 
Wr™e
() = 0;

28 
	g´Ùeùed
:

29 
boŞ
 
is_£t_
;

30 
	gboo¡
::
sh¬ed_±r
<
Bufãr
> 
bufãr_
;

31 
	gfd_
;

33 
ušt32_t
 
	gpos_
;

35 #ifdeà
RES_COUNTER


36 
	g´iv©e
:

37 
ä›nd
 
şass
 
St
;

38 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

39 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

40 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

41 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

45 şas 
	cR—dTask
 : 
public
 
Task
 {

46 
public
:

47 
vœtu®
 
R—d
();

48 
vœtu®
 
Wr™e
();

51 şas 
	cWr™eTask
 : 
public
 
Task
 {

52 
public
:

53 
vœtu®
 
R—d
();

54 
vœtu®
 
Wr™e
();

	@/home/libin3-s/ldd/net/listener.h

4 #iâdeà
LDD_NET_LISTENER_H_


5 
	#LDD_NET_LISTENER_H_


	)

7 
	~<boo¡/nÚcİyabË.hµ
>

8 
	~"ldd/Ãt/’dpošt.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 
şass
 
	gEv’tLoİ
;

14 
şass
 
	gEndpošt
;

16 şas 
	cLi¡’”
 : 
boo¡
::
nÚcİyabË
 {

17 
public
:

18 
şass
 
Im¶
;

19 
Li¡’”
(
Ev’tLoİ
* 
ev’t_loİ
);

20 ~
Li¡’”
();

22 
boŞ
 
O³n
(cÚ¡ 
Endpošt
& 
’dpošt
);

23 
Clo£
();

25 
Ev’tLoİ
* 
ev’t_loİ
() const;

26 
boŞ
 
IsO³n
() const;

27 
	g´iv©e
:

28 
Im¶
* 
im¶_
;

29 
ä›nd
 
şass
 
	gS”v”
;

	@/home/libin3-s/ldd/net/message.h

4 #iâdeà
LDD_NET_MESSAGE_H_


5 
	#LDD_NET_MESSAGE_H_


	)

7 
	~<¡dšt.h
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gÃt
 {

12 
št32_t
 
	tMes§geId
;

13 
ušt16_t
 
	tMes§geTy³
;

14 
št16_t
 
	tCode
;

	@/home/libin3-s/ldd/net/other/client/omsg.h

4 #iâdeà
OMSG_H_


5 
	#OMSG_H_


	)

7 
	~<ldd/Ãt/outgošg_msg.h
>

9 
şass
 
	gMyEm™Msg
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<1333> {

10 
public
:

11 
MyEm™Msg
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, cÚ¡ std::¡ršg& 
¡r2
)

12 : 
¡r_
(
¡r
), 
¡r2_
(
¡r2
) {}

14 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

15 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

16 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

17 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

18 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

19 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

20 
	g´iv©e
:

21 
¡d
::
¡ršg
 
¡r_
;

22 
	g¡d
::
¡ršg
 
¡r2_
;

	@/home/libin3-s/ldd/net/other/imsg.h

4 #iâdeà
IMSG_H_


5 
	#IMSG_H_


	)

7 
	~<ldd/Ãt/šcomšg_msg.h
>

9 
şass
 
	gMyEchoMsg
 : 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<1333> {

10 
public
:

11 
MyEchoMsg
(
size_t
 
couÁ
è: 
couÁ_
(couÁ), 
n_
(0) {}

12 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

13 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

14 
vœtu®
 
DÚe
(
Code
* 
code
);

15 
vœtu®
 
Cªûl
();

16 
	g´iv©e
:

17 
size_t
 
couÁ_
;

18 
size_t
 
	gn_
;

19 
Paylßd
 
	g·ylßd_
;

	@/home/libin3-s/ldd/net/outgoing_msg.h

1 #iâdeà
LDD_NET_OUTGOING_MSG_H_


2 
	#LDD_NET_OUTGOING_MSG_H_


	)

4 
	~<m­
>

5 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

6 
	~<boo¡/nÚcİyabË.hµ
>

7 
	~<ldd/ut/time_diff.h
>

8 
	~"ldd/Ãt/·ylßd.h
"

9 
	~"ldd/Ãt/bufãr.h
"

10 
	~"ldd/Ãt/»suÉ.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÃt
 {

15 
şass
 
	gChªÃl
;

17 
şass
 
	gOutgošgMsg
 : 
public
 
boo¡
::
’abË_sh¬ed_äom_this
<
OutgošgMsg
>,

18 
´iv©e
 
	gboo¡
::
nÚcİyabË
 {

19 
public
:

20 
şass
 
Im¶
;

21 
	gldd
::
	tÃt
::
	tPaylßd
 Payload;

22 
	gldd
::
	tÃt
::
	tMes§geId
 
	tId
;

23 
	gldd
::
	tÃt
::
	tMes§geTy³
 
	tTy³
;

24 
	gldd
::
	tÃt
::
	tResuÉ
 Result;

26 
	gvœtu®
 ~
OutgošgMsg
();

27 
vœtu®
 
Ty³
 
ty³
() const = 0;

29 
Id
 
id
() const;

30 cÚ¡ 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
() const;

33 
Cªûl
();

34 
	g´Ùeùed
:

35 
OutgošgMsg
();

36 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

37 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

38 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

39 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

40 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

41 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

42 
	g´iv©e
:

43 
DoCªûl
();

44 
Im¶
 *
	gim¶_
;

45 
ä›nd
 
şass
 
	gChªÃl
;

46 
ä›nd
 
şass
 
	gOutgošgReque¡
;

47 
ä›nd
 
şass
 
	gIncomšgRe¥Ú£
;

48 
ä›nd
 
şass
 
	gIncomšgEnd
;

51 
	g‹m¶©e
 <
Mes§geTy³
 
	gN
>

52 şas 
	cTy³dOutgošgMsg
 : 
public
 
OutgošgMsg
 {

53 
public
:

54 cÚ¡ 
Ty³
 
kTy³
 = 
N
;

55 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

56 
	g´Ùeùed
:

57 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

58 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

59 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

60 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

61 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

62 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

65 şas 
	cDyÇmicOutgošgMsg
 : 
public
 
OutgošgMsg
 {

66 
public
:

67 ~
DyÇmicOutgošgMsg
();

68 
£t_ty³
(
Ty³
 
ty³
);

69 
Ty³
 
ty³
(ècÚ¡ {  
	gty³_
; }

70 
	g´Ùeùed
:

71 
DyÇmicOutgošgMsg
(): 
ty³_
(0) {}

72 
DyÇmicOutgošgMsg
(
Ty³
 
ty³
);

73 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

74 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

75 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

76 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

77 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

78 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

79 
	g´iv©e
:

80 
Ty³
 
ty³_
;

83 
	g´iv©e
:

84 
ä›nd
 
şass
 
St
;

86 
	sNextF»e
 {

87 
NextF»e
()

88 : 
Ãxt_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>()),

89 
ä“_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>())

90 { *
Ãxt_id_
 = 0; *
	gä“_id_
 = 0; }

91 ~
NextF»e
() {}

93 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
Ãxt_id_
;

94 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
ä“_id_
;

97 
	g¡d
::
m­
<
Ty³
, 
	gNextF»e
> 
	g¡©_
;

99 
	g¡d
::
	tm­
<
	tTy³
, 
	tNextF»e
>::
	t™”©Ü
 
	tSTAT_IT
;

101 
Inc
(
Ty³
 
ty³
);

102 
Dec
(
Ty³
 
ty³
);

	@/home/libin3-s/ldd/net/payload.h

4 #iâdeà
LDD_NET_PAYLOAD_H_


5 
	#LDD_NET_PAYLOAD_H_


	)

7 
	~<¡dšt.h
>

8 
	~<m­
>

9 
	~<ldd/Ãt/bufãr.h
>

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gÃt
 {

14 şas 
	cPaylßd
 {

15 
	gpublic
:

16 cÚ¡ 
size_t
 
kMaxBodyL’
 = (1<<24) - 1;

17 cÚ¡ 
size_t
 
	gkMaxExŒaL’
 = (1<<8) - 1;

19 
Paylßd
();

20 
Paylßd
(cÚ¡ Paylßd &
lßd
);

23 ~
Paylßd
();

25 cÚ¡ 
	gBufãr
& 
body
(ècÚ¡ {  
	gbody_
; }

26 cÚ¡ 
	gBufãrM­
& 
exŒas
(ècÚ¡ {  
	gexŒas_
; }

28 
boŞ
 
S‘Body
(cÚ¡ 
Bufãr
& 
bufãr
);

29 
boŞ
 
S‘ExŒa
(
ušt8_t
 
id
, cÚ¡ 
Bufãr
& 
bufãr
);

30 
D–ExŒa
(
ušt8_t
 
id
);

31 
CË¬ExŒas
();

32 
	g´iv©e
:

33 
Bufãr
 
body_
;

34 
BufãrM­
 
	gexŒas_
;

36 #ifdeà
RES_COUNTER


37 
	g´iv©e
:

38 
ä›nd
 
şass
 
St
;

39 
	gut
::
Atomic
<
ušt64_t
> 
Ãxt_id_
;

40 
	gut
::
Atomic
<
ušt64_t
> 
ä“_id_
;

41 cÚ¡ 
ušt64_t
 
Ãxt_id
(è{  
	gÃxt_id_
; }

42 cÚ¡ 
ušt64_t
 
ä“_id
(è{  
	gä“_id_
; }

	@/home/libin3-s/ldd/net/registry.h

4 #iâdeà
LDD_NET_REGISTRY_H_


5 
	#LDD_NET_REGISTRY_H_


	)

7 
	~<m­
>

8 
	~"ldd/Ãt/çùÜy.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

20 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gTag
 = >

21 şas 
	cRegi¡ry
 {

22 
public
:

23 
vœtu®
 ~
Regi¡ry
();

26 
	g‹m¶©e
 <
şass
 
	gD
>

27 
Regi¡”
(
Tag
 
n
) {

28 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>());

30 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
>

31 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
) {

32 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
));

34 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
>

35 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
) {

36 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
));

38 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
>

39 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
) {

40 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
));

42 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
>

43 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
) {

44 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
));

46 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
>

47 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
) {

48 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
));

50 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
>

51 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
) {

52 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
));

54 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
>

55 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
) {

56 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
));

58 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
>

59 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
) {

60 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
));

62 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
>

63 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
) {

64 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
a9
));

66 
	g‹m¶©e
 <
şass
 
	gD
, cÏs 
	gA1
, cÏs 
	gA2
, cÏs 
	gA3
, cÏs 
	gA4
, cÏs 
	gA5
, cÏs 
	gA6
, cÏs 
	gA7
, cÏs 
	gA8
, cÏs 
	gA9
, cÏs 
	gA10
>

67 
Regi¡”
(
Tag
 
n
, 
A1
 
a1
, 
A2
 
a2
, 
A3
 
a3
, 
A4
 
a4
, 
A5
 
a5
, 
A6
 
a6
, 
A7
 
a7
, 
A8
 
a8
, 
A9
 
a9
, 
A10
 
a10
) {

68 
Regi¡”FaùÜy
(
n
, 
FaùÜy
<
T
>::
‹m¶©e
 
NewFaùÜy
<
D
>(
a1
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
a7
, 
a8
, 
a9
, 
a10
));

71 
T
* 
New
(
Tag
 
n
) const;

72 
	gboo¡
::
sh¬ed_±r
<
T
> 
MakeSh¬ed
(
Tag
 
n
) const;

73 
	g´iv©e
:

74 
Regi¡”FaùÜy
(
Tag
 
n
, 
FaùÜy
<
T
>* 
f
);

75 
	g¡d
::
m­
<
Tag
, 
	gFaùÜy
<
	gT
>*> 
	gçùÜ›s_
;

78 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gTag
>

79 
šlše
 
	gRegi¡ry
<
	gT
, 
	gTag
>::
Regi¡”FaùÜy
(
Tag
 
n
, 
FaùÜy
<
T
>* 
f
) {

80 
ty³Çme
 
	t¡d
::
	tm­
<
	tTag
, 
	tFaùÜy
<
	tT
>*>::
	t™”©Ü
 iterator;

81 
	g¡d
::
·œ
<
™”©Ü
, 
	gboŞ
> 
	g»suÉ
 = 
çùÜ›s_
.
š£¹
(
¡d
::
make_·œ
(
n
, 
f
));

82 ià(!
	g»suÉ
.
	g£cÚd
) {

83 
d–‘e
 
	g»suÉ
.
	gfœ¡
->
	g£cÚd
;

84 
	g»suÉ
.
	gfœ¡
->
	g£cÚd
 = 
f
;

88 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gTag
>

89 
šlše
 
T
* 
	gRegi¡ry
<
	gT
, 
	gTag
>::
New
(
Tag
 
n
) const {

90 
ty³Çme
 
	t¡d
::
	tm­
<
	tTag
, 
	tFaùÜy
<
	tT
>*>::
	tcÚ¡_™”©Ü
 
	t™”©Ü
;

91 
™”©Ü
 
	g™”
 = 
çùÜ›s_
.
fšd
(
n
);

92 ià(
	g™”
 =ğ
çùÜ›s_
.
’d
()) {

93  
NULL
;

95  
	g™”
->
	g£cÚd
->
New
();

98 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gTag
>

99 
šlše
 
	gboo¡
::
sh¬ed_±r
<
T
> 
Regi¡ry
<T, 
	gTag
>::
MakeSh¬ed
(
Tag
 
n
) const {

100 
ty³Çme
 
	t¡d
::
	tm­
<
	tTag
, 
	tFaùÜy
<
	tT
>*>::
	tcÚ¡_™”©Ü
 
	t™”©Ü
;

101 
™”©Ü
 
	g™”
 = 
çùÜ›s_
.
fšd
(
n
);

102 ià(
	g™”
 =ğ
çùÜ›s_
.
’d
()) {

103  
boo¡
::
sh¬ed_±r
<
T
>();

105  
	g™”
->
	g£cÚd
->
MakeSh¬ed
();

108 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gTag
>

109 
šlše
 
	gRegi¡ry
<
	gT
, 
	gTag
>::~
Regi¡ry
() {

110 
ty³Çme
 
	t¡d
::
	tm­
<
	tTag
, 
	tFaùÜy
<
	tT
>*>::
	t™”©Ü
 iterator;

111 
™”©Ü
 
	g™”
 = 
çùÜ›s_
.
begš
(); i‹¸!ğçùÜ›s_.
’d
(); ++iter) {

112 
d–‘e
 
	g™”
->
	g£cÚd
;

114 
	gçùÜ›s_
.
ş—r
();

	@/home/libin3-s/ldd/net/result.h

4 #iâdeà
LDD_NET_RESULT_H_


5 
	#LDD_NET_RESULT_H_


	)

7 
	~<¡ršg
>

8 
	~"ldd/Ãt/mes§ge.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gÃt
 {

13 şas 
	cResuÉ
 {

14 
	gpublic
:

15 
	eTy³
 { 
kOk
, 
	gkFaed
, 
	gkTimedOut
, 
	gkCªûËd
 };

16 
ResuÉ
 
Ok
(
Code
 
code
è{  ResuÉ(
kOk
, code); }

17 
ResuÉ
 
Faed
(è{  ResuÉ(
kFaed
); }

18 
ResuÉ
 
TimedOut
(è{  ResuÉ(
kTimedOut
); }

19 
ResuÉ
 
CªûËd
(è{  ResuÉ(
kCªûËd
); }

21 
boŞ
 
IsOk
(ècÚ¡ {  
	gty³_
 =ğ
kOk
; }

22 
boŞ
 
IsFaed
(ècÚ¡ {  
	gty³_
 =ğ
kFaed
; }

23 
boŞ
 
IsTimedOut
(ècÚ¡ {  
	gty³_
 =ğ
kTimedOut
; }

24 
boŞ
 
IsCªûËd
(ècÚ¡ {  
	gty³_
 =ğ
kCªûËd
; }

26 cÚ¡ 
	g¡d
::
¡ršg
& 
ToSŒšg
() const;

28 
Code
 
code
(ècÚ¡ {  
	gcode_
; }

29 
	g´iv©e
:

30 
ResuÉ
(
Ty³
 
ty³
è: 
ty³_
Ñy³), 
code_
(0) {}

31 
ResuÉ
(
Ty³
 
ty³
, 
št16_t
 
code
è: 
ty³_
Ñy³), 
code_
(code) {}

33 
Ty³
 
	gty³_
;

34 
Code
 
	gcode_
;

	@/home/libin3-s/ldd/net/sample/a.h

4 #iâdeà
_A_H_


5 
	#_A_H_


	)

7 
şass
 
	gNÚeArg
;

9 
	sMsg
 {

10 
	mvœtu®
 ~
Msg
() {}

11 
vœtu®
 
Te¡
() = 0;

14 
	sFaùÜy
 {

15 
	mvœtu®
 ~
FaùÜy
() {}

16 
vœtu®
 
Msg
* 
New
() const = 0;

19 
	m‹m¶©e
 <
şass
 
	mT
, cÏs 
	mA1
, cÏs 
	mA2
>

20 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
);

21 
	m‹m¶©e
 <
şass
 
	mT
, cÏs 
	mA1
>

22 
FaùÜy
* 
NewFaùÜy
(
A1
 
a1
);

23 
	m‹m¶©e
 <
şass
 
	mT
>

24 
FaùÜy
* 
NewFaùÜy
();

27 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA1
 = 
NÚeArg
, cÏs 
	gA2
 = NoneArg>

28 
FaùÜyIm¶
 : 
public
 
FaùÜy
 {

29 
FaùÜyIm¶
(
A1
 
a1
, 
A2
 
a2
)

30 :
a1_
(
a1
), 
a2_
(
a2
) {}

31 
Msg
* 
New
(ècÚ¡ {  
Ãw
 
T
(
a1_
, 
a2_
); }

32 
A1
 
	ga1_
;

33 
A2
 
	ga2_
;

36 
	g‹m¶©e
 <
şass
 
	gT
>

37 
	gFaùÜyIm¶
<
	gT
, 
	gNÚeArg
, NÚeArg> : 
public
 
FaùÜy
 {

38 
FaùÜyIm¶
() {}

39 
Msg
* 
New
(ècÚ¡ {  
Ãw
 
T
(); }

42 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA1
>

43 
	gFaùÜyIm¶
<
	gT
, 
	gA1
, 
	gNÚeArg
> : 
public
 
FaùÜy
{

44 
FaùÜyIm¶
(
A1
 
a1
)

45 :
a1_
(
a1
) {}

46 
Msg
* 
New
(ècÚ¡ {  
Ãw
 
T
(
a1_
); }

47 
A1
 
	ga1_
;

50 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA1
, cÏs 
	gA2
>

51 
šlše
 
FaùÜy
* 
	gFaùÜy
::
	$NewFaùÜy
(
A1
 
a1
, 
A2
 
a2
) {

52  
Ãw
 
FaùÜyIm¶
<
T
, 
A1
, 
A2
>(
a1
, 
a2
);

53 
	}
}

54 
	g‹m¶©e
 <
şass
 
	gT
, cÏs 
	gA1
>

55 
šlše
 
FaùÜy
* 
	gFaùÜy
::
	$NewFaùÜy
(
A1
 
a1
) {

56  
Ãw
 
FaùÜyIm¶
<
T
, 
A1
>(
a1
);

57 
	}
}

58 
	g‹m¶©e
 <
şass
 
	gT
>

59 
šlše
 
FaùÜy
* 
	gFaùÜy
::
	$NewFaùÜy
() {

60  
Ãw
 
FaùÜyIm¶
<
T
>();

61 
	}
}

	@/home/libin3-s/ldd/net/server.h

4 #iâdeà
LDD_NET_SERVER_H_


5 
	#LDD_NET_SERVER_H_


	)

7 
	~<boo¡/funùiÚ.hµ
>

8 
	~<boo¡/sh¬ed_±r.hµ
>

9 
	~<boo¡/±r_cÚš”/±r_veùÜ.hµ
>

10 
	~"ldd/Ãt/šcomšg_msg_»gi¡ry.h
"

11 
	~"ldd/Ãt/ev’t_loİ.h
"

13 
Çme¥aû
 
	gldd
 {

14 
Çme¥aû
 
	gÃt
 {

16 
şass
 
	gLi¡’”
;

18 şas 
	cS”v”
 : 
public
 
IncomšgMsgRegi¡ry
 {

19 
public
:

20 
	eTh»adDi¥©chPŞicy
 {

21 
kNÜm®
,

22 
	gkHashšg
,

24 
şass
 
	gIm¶
;

25 
	gboo¡
::
	tfunùiÚ
<(cÚ¡ 
	tboo¡
::
	tsh¬ed_±r
<
	tChªÃl
>&)> 
	tNÙif›r
;

26 
	sO±iÚs
 {

29 
	gpul£_š‹rv®
;

33 
boŞ
 
	gpul£_»Ïxed_checkšg
;

37 
boŞ
 
	gpul£_Ïzy_em™tšg
;

41 
	gb©ch_acû±
;

45 
NÙif›r
 
	gnÙify_cÚÃùed
;

49 
NÙif›r
 
	gnÙify_şo£d
;

54 
	gboo¡
::
±r_veùÜ
<
Ev’tLoİTh»ad
>* 
th»ads
;

58 
	gth»ads_di¥©chšg
;

62 
	g»ad_bufãr_size
;

63 
	gwr™e_bufãr_size
;

65 
O±iÚs
();

68 
ex¶ic™
 
S”v”
(cÚ¡ 
O±iÚs
& 
İtiÚs
);

69 ~
S”v”
();

71 
boŞ
 
S¹
(
Li¡’”
* 
li¡’”
);

72 
Stİ
();

74 cÚ¡ 
	gO±iÚs
& 
İtiÚs
() const;

75 
	g´iv©e
:

76 
Im¶
* 
im¶_
;

	@/home/libin3-s/ldd/net/stat.h

4 #iâdeà
__STAT_H__


5 
	#__STAT_H__


	)

7 
Çme¥aû
 
	gldd
 {‚ame¥aû 
	gÃt
 {

9 şas 
	cSt
 {

10 
	gpublic
:

11 ~
St
() {}

13 
¡d
::
¡ršg
 
Stus
() const;

14 
	gSt
 &
š¡ªû
(è{  
	gš¡ªû_
; }

16 
	g´iv©e
:

17 
St
();

18 
St
 
	gš¡ªû_
;

	@/home/libin3-s/ldd/net/test/benchmark/client/omsg.h

4 #iâdeà
OMSG_H_


5 
	#OMSG_H_


	)

7 
	~<ldd/Ãt/outgošg_msg.h
>

8 
	~<ldd/ut/time¡amp.h
>

10 
	sInfo
 {

11 
	mldd
::
ut
::
Atomic
<> 
»que¡s
;

12 
	mldd
::
ut
::
Atomic
<> 
sucûss
;

13 
	mldd
::
ut
::
Atomic
<> 
çed
;

16 
şass
 
	gMyEm™Msg
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<2000> {

17 
public
:

18 
MyEm™Msg
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, cÚ¡ std::¡ršg& 
¡r2
);

19 
	gvœtu®
 ~
MyEm™Msg
();

21 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

22 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

23 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

24 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

25 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

26 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

27 
	g´iv©e
:

28 
¡d
::
¡ršg
 
¡r_
;

29 
	g¡d
::
¡ršg
 
¡r2_
;

30 
	g¡•_
;

31 
	gldd
::
ut
::
Time¡amp
 
ts_
;

	@/home/libin3-s/ldd/net/test/benchmark/server/imsg.h

4 #iâdeà
IMSG_H_


5 
	#IMSG_H_


	)

7 
	~<ldd/Ãt/šcomšg_msg.h
>

9 
şass
 
	gMyEchoMsg
 : 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<2000> {

10 
public
:

11 
MyEchoMsg
() {}

12 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

13 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

14 
vœtu®
 
DÚe
(
Code
* 
code
);

15 
vœtu®
 
Cªûl
();

16 
	g´iv©e
:

17 
Paylßd
 
·ylßd_
;

	@/home/libin3-s/ldd/net/test/client/imsg.h

4 #iâdeà
IMSG_H_


5 
	#IMSG_H_


	)

7 
	~<ldd/Ãt/šcomšg_msg.h
>

9 
şass
 
	gMyEchoMsg
 : 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<1333> {

10 
public
:

11 
MyEchoMsg
(
size_t
 
couÁ
è: 
couÁ_
(couÁ), 
n_
(0) {}

12 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

13 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

14 
vœtu®
 
DÚe
(
Code
* 
code
);

15 
vœtu®
 
Cªûl
();

16 
	g´iv©e
:

17 
size_t
 
couÁ_
;

18 
size_t
 
	gn_
;

19 
Paylßd
 
	g·ylßd_
;

	@/home/libin3-s/ldd/net/test/client/omsg.h

4 #iâdeà
OMSG_H_


5 
	#OMSG_H_


	)

7 
	~<ldd/Ãt/outgošg_msg.h
>

9 
şass
 
	gMyEm™Msg
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<1333> {

10 
public
:

11 
MyEm™Msg
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, cÚ¡ std::¡ršg& 
¡r2
)

12 : 
¡r_
(
¡r
), 
¡r2_
(
¡r2
) {}

14 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

15 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

16 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

17 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

18 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

19 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

20 
	g´iv©e
:

21 
¡d
::
¡ršg
 
¡r_
;

22 
	g¡d
::
¡ršg
 
¡r2_
;

	@/home/libin3-s/ldd/net/test/server/imsg.h

4 #iâdeà
IMSG_H_


5 
	#IMSG_H_


	)

7 
	~<ldd/Ãt/šcomšg_msg.h
>

9 
şass
 
	gMyEchoMsg
 : 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<1333> {

10 
public
:

11 
MyEchoMsg
(
size_t
 
couÁ
è: 
couÁ_
(couÁ), 
n_
(0) {}

12 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

13 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

14 
vœtu®
 
DÚe
(
Code
* 
code
);

15 
vœtu®
 
Cªûl
();

16 
	g´iv©e
:

17 
size_t
 
couÁ_
;

18 
size_t
 
	gn_
;

19 
Paylßd
 
	g·ylßd_
;

	@/home/libin3-s/ldd/net/test/server/omsg.h

4 #iâdeà
OMSG_H_


5 
	#OMSG_H_


	)

7 
	~<ldd/Ãt/outgošg_msg.h
>

9 
şass
 
	gMyEm™Msg
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<1333> {

10 
public
:

11 
MyEm™Msg
(cÚ¡ 
¡d
::
¡ršg
& 
¡r
, cÚ¡ std::¡ršg& 
¡r2
)

12 : 
¡r_
(
¡r
), 
¡r2_
(
¡r2
) {}

14 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

15 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

16 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

17 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

18 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

19 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

20 
	g´iv©e
:

21 
¡d
::
¡ršg
 
¡r_
;

22 
	g¡d
::
¡ršg
 
¡r2_
;

	@/home/libin3-s/ldd/net/test1/client/common.h

1 #iâdeà
__COMMON_H__


2 
	#__COMMON_H__


	)

4 
H—¹B—t
(
fd
);

5 
G‘
(
fd
);

6 
Put
(
fd
);

	@/home/libin3-s/ldd/net/test1/client/x_socket.h

1 #iâdeà
_X_SOCKET_H__


2 
	#_X_SOCKET_H__


	)

4 
	#TTL_VALUE
 255

	)

6 
	#MAX_LISTEN_QUEUE
 5

	)

8 #ifdeà
__ılu¥lus


12 
x_£t_sock_deçuÉ_İt
(
s
);

13 
x_£t_sock_no_d–ay
(
s
);

14 
x_£t_sock_no_block
(
s
);

16 
x_ü—‹_tı_£rv”
(cÚ¡ *
l
, 
ÍÜt
);

17 
x_acû±
(
li¡’_fd
, *

, *
pÜt
);

18 
x_ü—‹_tı_ş›Á
(cÚ¡ *
r
, 
½Üt
);

19 
x_şo£
(
fd
);

20 
x_£nd
(
fd
, *
buf
, 
Ën
);

21 
x_»cv
(
fd
, *
buf
, 
Ën
);

22 
x_»cvby‹s
(
fd
, *
buf
, 
Ën
);

23 
x_»cv_w™h_timeout
(
fd
, *
buf
, 
Ën
, 
timeout
);

26 #ifdeà
__ılu¥lus


	@/home/libin3-s/ldd/net/test1/concurrency_connect/x_socket.h

1 #iâdeà
_X_SOCKET_H__


2 
	#_X_SOCKET_H__


	)

4 
	#TTL_VALUE
 255

	)

6 
	#MAX_LISTEN_QUEUE
 5

	)

8 #ifdeà
__ılu¥lus


12 
x_£t_sock_deçuÉ_İt
(
s
);

13 
x_£t_sock_no_d–ay
(
s
);

14 
x_£t_sock_no_block
(
s
);

16 
x_ü—‹_tı_£rv”
(cÚ¡ *
l
, 
ÍÜt
);

17 
x_acû±
(
li¡’_fd
, *

, *
pÜt
);

18 
x_ü—‹_tı_ş›Á
(cÚ¡ *
r
, 
½Üt
);

19 
x_şo£
(
fd
);

20 
x_£nd
(
fd
, *
buf
, 
Ën
);

21 
x_»cv
(
fd
, *
buf
, 
Ën
);

22 
x_»cvby‹s
(
fd
, *
buf
, 
Ën
);

23 
x_»cv_w™h_timeout
(
fd
, *
buf
, 
Ën
, 
timeout
);

26 #ifdeà
__ılu¥lus


	@/home/libin3-s/ldd/net/ut/imsg.h

4 #iâdeà
IMSG_H_


5 
	#IMSG_H_


	)

7 
	~<ldd/Ãt/šcomšg_msg.h
>

9 
şass
 
	gMyLddN‘
;

11 
şass
 
	gMyEchoMsg
 : 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<1333> {

12 
public
:

13 
MyEchoMsg
(
MyLddN‘
 *
ldd_Ãt
è: 
couÁ_
(1), 
n_
(0), 
ldd_Ãt_
(ldd_net) {}

14 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

15 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

16 
vœtu®
 
DÚe
(
Code
* 
code
);

17 
vœtu®
 
Cªûl
();

18 
	g´iv©e
:

19 
size_t
 
couÁ_
;

20 
size_t
 
	gn_
;

21 
Paylßd
 
	g·ylßd_
;

23 
MyLddN‘
 *
	gldd_Ãt_
;

	@/home/libin3-s/ldd/net/ut/my_lddnet.h

4 
	~<ldd/Ãt/ş›Á.h
>

5 
	~<ldd/Ãt/£rv”.h
>

6 
	~<ldd/Ãt/ev’t_loİ.h
>

7 
	~<ldd/Ãt/li¡’”.h
>

9 cÚ¡ 
¡d
::
¡ršg
 
REQUEST
;

10 cÚ¡ 
¡d
::
¡ršg
 
EXTRAS
;

12 şas 
	cMyLddN‘
 {

13 
	mpublic
:

14 
	$MyLddN‘
(è: 
	`li¡’”_
(&
loİ_
), 
	$ok_
(
Œue
) {}

15 ~
	$MyLddN‘
(è{
	}
}

17 
boŞ
 
In™
();

18 
Fš®ize
();

20 
boŞ
 
Echo
();

22 
	$£t_ok
(
boŞ
 
ok
è{ 
ok_
 = ok; 
	}
}

24 
	gldd
::
Ãt
::
Ev’tLoİ
 *
	$ev’t_loİ
(è{  &
loİ_
; 
	}
}

26 
	g´iv©e
:

27 
ldd
::
Ãt
::
Ev’tLoİ
 
loİ_
;

28 
	gldd
::
Ãt
::
Li¡’”
 
li¡’”_
;

29 
	gboo¡
::
scİed_±r
<
ldd
::
Ãt
::
S”v”
> 
£rv”_
;

30 
	gboo¡
::
scİed_±r
<
ldd
::
Ãt
::
Cl›Á
> 
ş›Á_
;

32 
boŞ
 
	gok_
;

	@/home/libin3-s/ldd/net/ut/omsg.h

4 #iâdeà
OMSG_H_


5 
	#OMSG_H_


	)

7 
	~<ldd/Ãt/outgošg_msg.h
>

9 
şass
 
	gMyLddN‘
;

11 
şass
 
	gMyEm™Msg
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<1333> {

12 
public
:

13 
MyEm™Msg
(
MyLddN‘
 *
ldd_Ãt
,

14 cÚ¡ 
¡d
::
¡ršg
& 
¡r
,

15 cÚ¡ 
¡d
::
¡ršg
& 
¡r2
)

16 : 
ldd_Ãt_
(
ldd_Ãt
),

17 
¡r_
(
¡r
),

18 
¡r2_
(
¡r2
) {}

20 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

21 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

22 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

23 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

24 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

25 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

27 
	g´iv©e
:

28 
MyLddN‘
 *
ldd_Ãt_
;

29 
	g¡d
::
¡ršg
 
¡r_
;

30 
	g¡d
::
¡ršg
 
¡r2_
;

	@/home/libin3-s/ldd/net/ut/x_socket.h

1 #iâdeà
_X_SOCKET_H__


2 
	#_X_SOCKET_H__


	)

4 
	#TTL_VALUE
 255

	)

6 
	#SOCK_TYPE_NULL
 0

	)

7 
	#SOCK_TYPE_UNICAST_TCP_SERVER
 1

	)

8 
	#SOCK_TYPE_UNICAST_TCP_CLIENT
 2

	)

9 
	#SOCK_TYPE_UNICAST_UDP_SERVER
 3

	)

10 
	#SOCK_TYPE_UNICAST_UDP_CLIENT
 4

	)

11 
	#SOCK_TYPE_FILEOUTPUT
 5

	)

12 
	#SOCK_TYPE_THIS_LINK
 6

	)

14 
	#MAX_LISTEN_QUEUE
 5

	)

16 #ifdeà
__ılu¥lus


20 
x_£t_sock_deçuÉ_İt
(
s
);

21 
x_£t_sock_no_d–ay
(
s
);

23 
x_ü—‹_tı_£rv”
(cÚ¡ *
l
, 
ÍÜt
);

24 
x_acû±
(
li¡’_fd
, *

, *
pÜt
);

25 
x_ü—‹_tı_ş›Á
(cÚ¡ *
r
, 
½Üt
);

26 
x_şo£
(
fd
);

27 
x_£nd
(
fd
, *
buf
, 
Ën
);

28 
x_»cv
(
fd
, *
buf
, 
Ën
);

29 
x_»cvby‹s
(
fd
, *
buf
, 
Ën
);

30 
x_»cv_w™h_timeout
(
fd
, *
buf
, 
Ën
, 
timeout
);

33 #ifdeà
__ılu¥lus


	@/home/libin3-s/ldd/protocol/client/command_type.h

1 #iâdeà
LDD_PROTOCOL_COMMON_H


2 
	#LDD_PROTOCOL_COMMON_H


	)

5 
Çme¥aû
 
	gldd
{

6 
Çme¥aû
 
	g´ÙocŞ
{

12 
	#LDD_CLIENT_2_PROXY_GET
 0x9910

	)

13 
	#LDD_CLIENT_2_PROXY_CHECK
 0x9920

	)

14 
	#LDD_CLIENT_2_PROXY_MUTATE
 0x9930

	)

15 
	#LDD_CLIENT_2_PROXY_LIST
 0x9940

	)

16 
	#LDD_CLIENT_2_PROXY_ATOMIC_INCR
 0x9950

	)

17 
	#LDD_CLIENT_2_PROXY_ATOMIC_APPEND
 0x9960

	)

	@/home/libin3-s/ldd/protocol/client/proto.h

3 #iâdeà
__LDD__PROTOCOL_PROTO_H_


4 
	#__LDD__PROTOCOL_PROTO_H_


	)

6 
	~<¡dšt.h
>

7 
	~<¡ršg
>

8 
	~<veùÜ
>

9 
	~<m­
>

10 
	~"ldd/ut/¦iû.h
"

11 
	~"ldd/´ÙocŞ/mes§ge.h
"

14 
Çme¥aû
 
	gldd
{

15 
Çme¥aû
 
	g´ÙocŞ
{

22 şas 
	cG‘Mes§ge
 : 
public
 
Mes§ge
{

23 
public
:

24 
G‘Mes§ge
();

25 
	g´Ùeùed
:

26 
vœtu®
 
size_t
 
By‹Size
() const;

27 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

28 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

30 
	gpublic
:

31 
ut
::
Sliû
 
Çme_¥aû_
;

32 
	gut
::
Sliû
 
key_
;

36 şas 
	cCheckMes§ge
 : 
public
 
Mes§ge
{

37 
public
:

38 
CheckMes§ge
();

39 
	g´Ùeùed
:

40 
vœtu®
 
size_t
 
By‹Size
() const;

41 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

42 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

44 
	gpublic
:

45 
ut
::
Sliû
 
Çme_¥aû_
;

46 
	gut
::
Sliû
 
key_
;

49 
	s¡MutiÚ
{

50 
¡MutiÚ
(){

51 
	gİt_ty³
 = 1;

52 
	ghas_ex³ùed_v”siÚ
 = 0;

53 
	ghas_ex³ùed_v®
 = 0;

54 
	gex³ùed_v”siÚ
 = 0;

55 
	ghas_‰l
 = 0;

56 
	g‰l
 = 0;

58 
	gut
::
Sliû
 
key
;

60 
ušt8_t
 
	gİt_ty³
;

61 
ušt8_t
 
	ghas_ex³ùed_v”siÚ
;

62 
št64_t
 
	gex³ùed_v”siÚ
;

63 
ušt8_t
 
	ghas_ex³ùed_v®
;

64 
	gut
::
Sliû
 
ex³ùed_v®ue
;

66 
	gut
::
Sliû
 
v®ue
;

67 
ušt8_t
 
	ghas_‰l
;

68 
ušt64_t
 
	g‰l
;

71 şas 
	cMu‹Mes§ge
 : 
public
 
Mes§ge
{

72 
public
:

73 
Mu‹Mes§ge
();

74 
	g´Ùeùed
:

75 
vœtu®
 
size_t
 
By‹Size
() const;

76 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

77 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

79 
	gpublic
:

80 
ut
::
Sliû
 
Çme_¥aû_
;

81 
¡MutiÚ
 
	gmutiÚ_
;

84 şas 
	cLi¡Mes§ge
 : 
public
 
Mes§ge
{

85 
public
:

86 
Li¡Mes§ge
();

87 
	g´Ùeùed
:

88 
vœtu®
 
size_t
 
By‹Size
() const;

89 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

90 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

92 
	gpublic
:

93 
ut
::
Sliû
 
Çme_¥aû_
;

94 
	gut
::
Sliû
 
key_
;

95 
ušt32_t
 
	gu32lim™_
;

96 
ušt8_t
 
	gu8pos™iÚ_
;

100 şas 
	cAtomicInüMes§ge
 : 
public
 
Mes§ge
 {

101 
public
:

102 
AtomicInüMes§ge
();

103 
	g´Ùeùed
:

104 
vœtu®
 
size_t
 
By‹Size
() const;

105 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

106 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

108 
	gpublic
:

109 
ut
::
Sliû
 
Çme_¥aû_
;

110 
	gut
::
Sliû
 
key_
;

111 
št32_t
 
	gs32İ”ªd_
;

112 
št32_t
 
	gs32š™Ÿl_
;

113 
ušt64_t
 
	gu64‰l_
;

116 şas 
	cAtomicAµ’dMes§ge
 : 
public
 
Mes§ge
{

117 
public
:

118 
AtomicAµ’dMes§ge
();

119 
	g´Ùeùed
:

120 
vœtu®
 
size_t
 
By‹Size
() const;

121 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

122 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

124 
	gpublic
:

125 
ut
::
Sliû
 
Çme_¥aû_
;

126 
	gut
::
Sliû
 
key_
;

127 
ušt8_t
 
	gu8pos™iÚ_
;

128 
	gut
::
Sliû
 
cÚ‹Á_
;

129 
ušt64_t
 
	gu64‰l_
;

	@/home/libin3-s/ldd/protocol/client/response.h

2 #iâdeà
__LDD__RESPONSE_MESSAGE_H_


3 
	#__LDD__RESPONSE_MESSAGE_H_


	)

5 
	~<¡dšt.h
>

6 
	~<veùÜ
>

7 
	~"ldd/ut/¦iû.h
"

8 
	~"ldd/´ÙocŞ/mes§ge.h
"

11 
Çme¥aû
 
	gldd
{

12 
Çme¥aû
 
	g´ÙocŞ
{

15 şas 
	cRe¥Ú£
 : 
public
 
Mes§ge
{

16 
public
:

17 
Re¥Ú£
(){}

18 
vœtu®
 ~
Re¥Ú£
(){};

19 
	g´iv©e
:

20 
Re¥Ú£
(const Response&);

21 cÚ¡ 
	gRe¥Ú£
& 
	gİ”©Ü
=(cÚ¡ 
Re¥Ú£
&);

34 şas 
	cG‘OrLi¡Re¥Ú£
 : 
public
 
Re¥Ú£
{

35 
public
:

36 
G‘OrLi¡Re¥Ú£
();

37 
	g´Ùeùed
:

38 
vœtu®
 
size_t
 
By‹Size
() const;

39 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

40 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

42 
	gpublic
:

43 
št64_t
 
s64V”siÚ_
;

44 
	gut
::
Sliû
 
key_
;

45 
	gut
::
Sliû
 
v®ue_
;

46 
ušt64_t
 
	gu64‰l_
;

56 şas 
	cCheckRe¥Ú£
 : 
public
 
Re¥Ú£
{

57 
public
:

58 
CheckRe¥Ú£
();

59 
	g´Ùeùed
:

60 
vœtu®
 
size_t
 
By‹Size
() const;

61 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

62 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

65 
	gpublic
:

66 
št64_t
 
s64V”siÚ_
;

67 
	gut
::
Sliû
 
key_
;

68 
ušt64_t
 
	gu64‰l_
;

76 şas 
	cMu‹Re¥Ú£
 : 
public
 
Re¥Ú£
{

77 
public
:

78 
Mu‹Re¥Ú£
();

79 
	g´Ùeùed
:

80 
vœtu®
 
size_t
 
By‹Size
() const;

81 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

82 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

84 
	gpublic
:

85 
št64_t
 
s64V”siÚ_
;

90 şas 
	cCasRe¥Ú£
 : 
public
 
Re¥Ú£
{

91 
public
:

92 
CasRe¥Ú£
();

93 
	g´Ùeùed
:

94 
vœtu®
 
size_t
 
By‹Size
() const;

95 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

96 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

97 
	gpublic
:

99 
št64_t
 
s64V”siÚ_
;

100 
	gut
::
Sliû
 
key_
;

101 
	gut
::
Sliû
 
v®ue_
;

108 şas 
	cG‘V”siÚRe¥Ú£
 : 
public
 
Re¥Ú£
{

109 
public
:

110 
G‘V”siÚRe¥Ú£
();

111 
	g´Ùeùed
:

112 
vœtu®
 
size_t
 
By‹Size
() const;

113 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

114 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

115 
	gpublic
:

116 
št64_t
 
s64V”siÚ_
;

117 
	gut
::
Sliû
 
home_ho¡_pÜt_
;

118 
	gut
::
Sliû
 
de¡_ho¡_pÜt_
;

	@/home/libin3-s/ldd/protocol/coded_stream.h

2 #iâdeà
__LDD_CODED_STREAM_H_


3 
	#__LDD_CODED_STREAM_H_


	)

4 
	~<¡dšt.h
>

5 
	~"ldd/ut/¦iû.h
"

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	g´ÙocŞ
{

13 #ià(
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN
)

14 
šlše
 
ušt64_t
 
htÚÎ
(ušt64_ˆ
v
) {

16 ((
	gv
 & 0xff00000000000000ULL) >> 56) |

17 ((
	gv
 & 0x00ff000000000000ULL) >> 40) |

18 ((
	gv
 & 0x0000ff0000000000ULL) >> 24) |

19 ((
	gv
 & 0x000000ff00000000ULL) >> 8) |

20 ((
	gv
 & 0x00000000ff000000ULL) << 8) |

21 ((
	gv
 & 0x0000000000ff0000ULL) << 24) |

22 ((
	gv
 & 0x000000000000ff00ULL) << 40) |

23 ((
	gv
 & 0x00000000000000ffULL) << 56);

26 
šlše
 
ušt64_t
 
htohÎ
(ušt64_ˆ
v
) {

27  
	gv
;

31 
šlše
 
ušt64_t
 
ÁohÎ
(ušt64_ˆ
v
) {

32  
htÚÎ
(
v
);

36 şas 
	cSŒ—mR—d”
{

37 
	gpublic
:

38 
boŞ
 
R—dU8
 (cÚ¡ ** 
p
, * 
Ëá
, 
ušt8_t
 *
v
);

39 
boŞ
 
R—dU16
(cÚ¡ ** 
p
, * 
Ëá
, 
ušt16_t
 *
v
);

40 
boŞ
 
R—dU32
(cÚ¡ ** 
p
, * 
Ëá
, 
ušt32_t
 *
v
);

41 
boŞ
 
R—dU64
(cÚ¡ ** 
p
, * 
Ëá
, 
ušt64_t
 *
v
);

42 
boŞ
 
R—dBy‹s
(cÚ¡ ** 
p
, * 
Ëá
, 
Ën
, 
ut
::
Sliû
* 
»t
);

46 şas 
	cSŒ—mWr™”
{

47 
	gpublic
:

48 
boŞ
 
Wr™eU8
Ğ**
p
, * 
Ëá
, 
ušt8_t
 
v
);

49 
boŞ
 
Wr™eU16
(**
p
, * 
Ëá
, 
ušt16_t
 
v
);

50 
boŞ
 
Wr™eU32
(**
p
, * 
Ëá
, 
ušt32_t
 
v
);

51 
boŞ
 
Wr™eU64
(**
p
, * 
Ëá
, 
ušt64_t
 
v
);

52 
boŞ
 
Wr™eBy‹s
(** 
p
, * 
Ëá
, cÚ¡ *
šput
, 
Ën
);

	@/home/libin3-s/ldd/protocol/message.h

1 #iâdeà
__LDD__PROTOCOL_MESSAGE_H_


2 
	#__LDD__PROTOCOL_MESSAGE_H_


	)

4 
	~<c¡ddef
>

5 
	~<¡ršg
>

7 
Çme¥aû
 
	gldd
{

8 
Çme¥aû
 
	g´ÙocŞ
{

11 şas 
	cMes§ge
{

12 
	gpublic
:

13 
Mes§ge
();

14 
	gvœtu®
 ~
Mes§ge
();

16 
size_t
 
MaxSize
() const;

17 
size_t
 
S”ŸlizeTo
(* 
d©a
);

18 
boŞ
 
P¬£From
(cÚ¡ * 
d©a
, 
size_t
 
size
);

20 
	g´Ùeùed
:

21 
vœtu®
 
size_t
 
By‹Size
() const = 0;

22 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) = 0 ;

23 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
) = 0;

25 
	g´iv©e
:

27 cÚ¡ 
kCom´essRage
 = 0.5;

28 cÚ¡ 
size_t
 
	gkCom´essLim™
 = 128;

29 
size_t
 
TryCom´ess
(* 
d©a
);

31 
	g¡d
::
¡ršg
 
bufãr_
;

	@/home/libin3-s/ldd/protocol/server/command_type.h

2 #iâdeà
__LDD__PROTOCOL_COMMAND_TYPE_H_


3 
	#__LDD__PROTOCOL_COMMAND_TYPE_H_


	)

5 
Çme¥aû
 
	gldd
{

6 
Çme¥aû
 
	g´ÙocŞ
{

11 
	#LDD_PROXY_2_STORE_GET
 0x7710

	)

12 
	#LDD_PROXY_2_STORE_CHECK
 0x7720

	)

13 
	#LDD_PROXY_2_STORE_MUTATE
 0x7730

	)

14 
	#LDD_PROXY_2_STORE_LIST
 0x7740

	)

15 
	#LDD_PROXY_2_STORE_ATOMIC_INCR
 0x7750

	)

16 
	#LDD_PROXY_2_STORE_ATOMIC_APPEND
 0x7760

	)

21 
	#LDD_STORE_2_STORE_GET_VERSION
 0x5510

	)

22 
	#LDD_STORE_2_STORE_MUTATION_PREPARE
 0x5520

	)

	@/home/libin3-s/ldd/protocol/server/store_error.h

2 #iâdeà
__LDD__PROTOCOL_STORE_ERROR_H_


3 
	#__LDD__PROTOCOL_STORE_ERROR_H_


	)

5 
Çme¥aû
 
	gldd
{

6 
Çme¥aû
 
	g´ÙocŞ
{

8 
	eStÜeE¼Ü
{

9 
	gkOk
 = 0,

13 
	gkStÜeFaed
 = -501,

14 
	gkStÜeTimedOut
 = -502,

15 
	gkStÜeCªûËd
 = -503,

17 
	gkInv®idO³¿tiÚ
 = -508,

19 
	gkInv®idP¬am‘”
 = -521,

20 
	gkInv®idPriÜTask
 = -522,

21 
	gkNÙM©chV®ue
 = -523,

22 
	gkNÙM©chV”siÚ
 = -524,

24 
	gkP»·»E¼Ü
 = -525,

27 
	gkNÙFound
 = -531,

28 
	gkCÜru±iÚ
 = -532,

29 
	gkIOE¼Ü
 = -535,

33 
	gkNÙV®idPack‘
 = -540,

34 
	gkTimeout
 = -541,

35 
	gkNoCÚÃùiÚ
 = -542,

39 
	gkMsgNÙFromMa¡”
 = -550,

40 
	gkRŞesNÙR—dy
 = -551,

41 
	gkSÏveNÙR—dy
 = -552,

42 
	gkSynV”siÚE¼Ü
 = -513,

44 
	gkUÄecov”®E¼Ü
 = -1000

	@/home/libin3-s/ldd/protocol/server/store_proto.h

2 #iâdeà
__LDD__PROTOCOL_MSG_PROTO_H_


3 
	#__LDD__PROTOCOL_MSG_PROTO_H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

7 
	~<veùÜ
>

8 
	~"ldd/ut/¦iû.h
"

9 
	~"ldd/´ÙocŞ/mes§ge.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

13 
Çme¥aû
 
	gldd
{

14 
Çme¥aû
 
	g´ÙocŞ
{

28 şas 
	cG‘Mes§geS
 : 
public
 
Mes§ge
{

29 
public
:

30 
G‘Mes§geS
();

31 
	g´Ùeùed
:

32 
vœtu®
 
size_t
 
By‹Size
() const;

33 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

34 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

37 
	gpublic
:

39 
ušt16_t
 
u16Ns_
;

40 
ušt16_t
 
	gu16Buck‘ID_
;

41 
	gut
::
Sliû
 
key_
;

49 şas 
	cCheckMes§geS
 : 
public
 
Mes§ge
{

50 
public
:

51 
CheckMes§geS
();

52 
	g´Ùeùed
:

53 
vœtu®
 
size_t
 
By‹Size
() const;

54 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

55 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

58 
	gpublic
:

59 
ušt16_t
 
u16Ns_
;

60 
ušt16_t
 
	gu16Buck‘ID_
;

61 
	gut
::
Sliû
 
key_
;

68 şas 
	cMu‹Mes§geS
 : 
public
 
Mes§ge
{

69 
public
:

70 
Mu‹Mes§geS
();

71 
	g´Ùeùed
:

72 
vœtu®
 
size_t
 
By‹Size
() const;

73 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

74 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

76 
	gpublic
:

77 
ušt16_t
 
u16Ns_
;

78 
ušt16_t
 
	gu16Buck‘ID_
;

79 
¡MutiÚ
 
	gmutiÚ_
;

80 
št64_t
 
	gs64syn_v”siÚ_
;

81 
ušt8_t
 
	gu8äom_
;

88 şas 
	cLi¡Mes§geS
 : 
public
 
Mes§ge
{

89 
public
:

90 
Li¡Mes§geS
();

91 
	g´Ùeùed
:

92 
vœtu®
 
size_t
 
By‹Size
() const;

93 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

94 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

96 
	gpublic
:

97 
ušt16_t
 
u16Ns_
;

98 
	gut
::
Sliû
 
key_
;

99 
ušt32_t
 
	gu32lim™_
;

100 
ušt8_t
 
	gu8pos™iÚ_
;

109 şas 
	cAtomicInüMes§geS
: 
public
 
Mes§ge
{

110 
public
:

111 
AtomicInüMes§geS
();

112 
	g´Ùeùed
:

113 
vœtu®
 
size_t
 
By‹Size
() const;

114 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

115 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

117 
	gpublic
:

118 
ušt16_t
 
u16Ns_
;

119 
ušt16_t
 
	gu16Buck‘ID_
;

120 
	gut
::
Sliû
 
key_
;

121 
št32_t
 
	gs32İ”ªd_
;

122 
št32_t
 
	gs32š™Ÿl_
;

123 
ušt64_t
 
	gu64‰l_
;

124 
št64_t
 
	gs64syn_v”siÚ_
;

125 
ušt8_t
 
	gu8äom_
;

135 şas 
	cAtomicAµ’dMes§geS
: 
public
 
Mes§ge
{

136 
public
:

137 
AtomicAµ’dMes§geS
();

138 
	g´Ùeùed
:

139 
vœtu®
 
size_t
 
By‹Size
() const;

140 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

141 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

143 
	gpublic
:

144 
ušt16_t
 
u16Ns_
;

145 
ušt16_t
 
	gu16Buck‘ID_
;

146 
	gut
::
Sliû
 
key_
;

147 
ušt8_t
 
	gu8pos™iÚ_
;

148 
	gut
::
Sliû
 
cÚ‹Á_
;

149 
ušt64_t
 
	gu64‰l_
;

150 
št64_t
 
	gs64syn_v”siÚ_
;

151 
ušt8_t
 
	gu8äom_
;

159 şas 
	cG‘V”siÚMes§geS
: 
public
 
Mes§ge
{

160 
public
:

161 
G‘V”siÚMes§geS
(){};

162 
	g´Ùeùed
:

163 
vœtu®
 
size_t
 
By‹Size
() const;

164 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

165 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

167 
	gpublic
:

168 
ut
::
Sliû
 
ho¡_pÜt_
;

171 şas 
	cP»·»Mes§geS
: 
public
 
Mes§ge
{

172 
public
:

173 
P»·»Mes§geS
(){};

174 
	g´Ùeùed
:

175 
vœtu®
 
size_t
 
By‹Size
() const;

176 
vœtu®
 
S”ŸlizeToA¼ay
(* 
d©a
) ;

177 
vœtu®
 
boŞ
 
P¬£FromA¼ay
(cÚ¡ * 
d©a
, 
size
);

179 
	gpublic
:

180 
ut
::
Sliû
 
home_pÜt_
;

181 
	gut
::
Sliû
 
de¡_ho¡_pÜt_
;

	@/home/libin3-s/ldd/protocol/ut/ut_msg_proto.h

2 
	~<glog/loggšg.h
>

3 
	~<g‹¡/g‹¡.h
>

4 
	~"´Ùo.h
"

5 
	~"¡Üe_´Ùo.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
´ÙocŞ
;

8 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

10 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

13 
	$TEST
(
msg_´Ùo
, 
G‘Mes§geS
){

14 
G‘Mes§geS
 
gm
;

15 
gm
.
u16Ns_
 = 14552;

17 
Sliû
 
sss
 = "GetMessageS";

18 
gm
.
key_
 = 
sss
;

19 
gm
.
u16Buck‘ID_
 = 200;

20 
size
 = 
gm
.
	`MaxSize
();

21 * 
bufãr
 = 
Ãw
 [
size
];

22 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

23 
	`ASSERT_GT
(()
»®_Ën
, 0);

25 
G‘Mes§geS
 
exp
;

26 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

27 
	`ASSERT_TRUE
(
»t
);

28 
	`EXPECT_EQ
(
exp
.
u16Ns_
, 
gm
.u16Ns_);

30 
	`ASSERT_EQ
(
exp
.
u16Buck‘ID_
, 
gm
.u16BucketID_);

31 
	`EXPECT_TRUE
(
	`¡ºcmp
(
exp
.
key_
.
	`d©a
(), 
gm
.key_.d©a(), gm.key_.
	`size
() ) == 0);

32 
d–‘e
 [] 
bufãr
;

35 
G‘Mes§geS
 
gm
;

36 
¡d
::
¡ršg
 
ns
 = "GetMessage";

37 * 
s
 = 
Ãw
 [100];

38 
Ën
 = 
	`¢´štf
(
s
, 100, "%d", 200);

39 
Sliû
 
	`sss
(
s
, 
Ën
);

40 
gm
.
key_
 = 
sss
;

41 
gm
.
u16Buck‘ID_
 = 22;

42 
size
 = 
gm
.
	`MaxSize
();

43 * 
bufãr
 = 
Ãw
 [
size
];

44 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

45 
	`ASSERT_GT
(()
»®_Ën
, 0);

46 
d–‘e
 
bufãr
;

48 
	}
}

50 
	$TEST
(
msg_´Ùo
, 
CheckMes§geS
){

51 
CheckMes§geS
 
gm
;

52 
gm
.
u16Ns_
 = 14552;

54 
Sliû
 
sss
 = "CheckMessageS";

55 
gm
.
key_
 = 
sss
;

56 
gm
.
u16Buck‘ID_
 = 22;

57 
size
 = 
gm
.
	`MaxSize
();

58 * 
bufãr
 = 
Ãw
 [
size
];

59 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

60 
	`ASSERT_GT
(()
»®_Ën
, 0);

62 
CheckMes§geS
 
exp
;

63 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

64 
	`ASSERT_TRUE
(
»t
);

65 
	`EXPECT_EQ
(
exp
.
u16Ns_
, 
gm
.u16Ns_);

67 
	`ASSERT_EQ
(
exp
.
u16Buck‘ID_
, 
gm
.u16BucketID_);

68 
	`EXPECT_TRUE
(
	`¡ºcmp
(
exp
.
key_
.
	`d©a
(), 
gm
.key_.d©a(), gm.key_.
	`size
() ) == 0);

69 
d–‘e
 [] 
bufãr
;

72 
CheckMes§geS
 
gm
;

73 
¡d
::
¡ršg
 
ns
 = "GetMessage";

74 * 
s
 = 
Ãw
 [100];

75 
Ën
 = 
	`¢´štf
(
s
, 100, "%d", 100);

76 
Sliû
 
	`sss
(
s
, 
Ën
);

77 
gm
.
key_
 = 
sss
;

78 
gm
.
u16Buck‘ID_
 = 22;

79 
size
 = 
gm
.
	`MaxSize
();

80 * 
bufãr
 = 
Ãw
 [
size
];

81 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

82 
	`ASSERT_GT
(()
»®_Ën
, 0);

83 
d–‘e
 
bufãr
;

85 
	}
}

87 
	$TEST
(
msg_´Ùo
, 
Li¡Mes§geS
)

89 
Li¡Mes§geS
 
lm
;

90 
lm
.
u16Ns_
 = 32342;

91 
lm
.
key_
 = "ListMessageS_key" ;

92 
lm
.
u32lim™_
 = 43543546u;

93 
lm
.
u8pos™iÚ_
 = 1u;

95 
Ën
 = 
lm
.
	`MaxSize
();

96 * 
buf
 = 
Ãw
 [
Ën
];

97 
size_t
 
»®_Ën
 = 
lm
.
	`S”ŸlizeTo
(
buf
);

98 
	`ASSERT_GT
(()
»®_Ën
, 0);

100 
Li¡Mes§geS
 
ex³ù
;

101 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

102 
	`ASSERT_TRUE
(
»t
);

104 
	`ASSERT_EQ
(
ex³ù
.
u16Ns_
, 
lm
.u16Ns_);

105 
	`EXPECT_TRUE
(
	`¡ºcmp
(
lm
.
key_
.
	`d©a
(), 
ex³ù
.key_.d©a(),ƒx³ù.key_.
	`size
() ) == 0);

106 
	`ASSERT_EQ
(
ex³ù
.
u32lim™_
, 
lm
.u32limit_);

107 
	`ASSERT_EQ
(
ex³ù
.
u8pos™iÚ_
, 
lm
.u8position_);

108 
d–‘e
 
buf
;

109 
	}
}

112 
	$TEST
(
msg_´Ùo
, 
AtomicInüMes§geS
)

114 
AtomicInüMes§geS
 
·im
;

115 
·im
.
u16Ns_
 = 5748;

116 
·im
.
u16Buck‘ID_
 = 9999;

117 
·im
.
key_
 = "AtomicIncrMessageSKey";

118 
·im
.
s32İ”ªd_
 = 1139289;

119 
·im
.
s32š™Ÿl_
 = 434535;

120 
·im
.
u64‰l_
 = 329389u;

121 
·im
.
s64syn_v”siÚ_
= 4242445u;

122 
·im
.
u8äom_
 = 99;

124 
Ën
 = 
·im
.
	`MaxSize
();

125 * 
buf
 = 
Ãw
 [
Ën
];

126 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

127 
	`ASSERT_GT
(()
»®_Ën
, 0);

129 
AtomicInüMes§geS
 
ex³ù
;

130 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

132 
	`ASSERT_EQ
(
ex³ù
.
u16Ns_
, 
·im
.u16Ns_);

133 
	`ASSERT_EQ
(
ex³ù
.
u16Buck‘ID_
, 
·im
.u16BucketID_);

135 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

136 
	`ASSERT_EQ
(
ex³ù
.
s32İ”ªd_
, 
·im
.s32operand_);

137 
	`ASSERT_EQ
(
ex³ù
.
s32š™Ÿl_
, 
·im
.s32initial_);

139 
	`ASSERT_EQ
(
ex³ù
.
u64‰l_
, 
·im
.u64ttl_);

140 
	`ASSERT_EQ
(
ex³ù
.
s64syn_v”siÚ_
, 
·im
.s64syn_version_);

141 
	`ASSERT_EQ
(
ex³ù
.
u8äom_
, 
·im
.u8from_);

143 
d–‘e
 
buf
;

144 
	}
}

146 
	$TEST
(
msg_´Ùo
, 
AtomicAµ’dMes§geS
)

148 
AtomicAµ’dMes§geS
 
·im
;

149 
·im
.
u16Ns_
 = 0;

150 
·im
.
u16Buck‘ID_
 = 3;

151 
·im
.
key_
 = "ProxyAtomicAppendMessageKey";

152 
·im
.
u8pos™iÚ_
 = 89;

153 
·im
.
cÚ‹Á_
 = "slice_";

154 
·im
.
u64‰l_
 = 43444444lu;

155 
·im
.
s64syn_v”siÚ_
= 4242445u;

156 
·im
.
u8äom_
 = 99;

158 
Ën
 = 
·im
.
	`MaxSize
();

159 * 
buf
 = 
Ãw
 [
Ën
];

160 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

161 
	`ASSERT_GT
(()
»®_Ën
, 0);

163 
AtomicAµ’dMes§geS
 
ex³ù
;

164 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

166 
	`ASSERT_EQ
(
ex³ù
.
u16Ns_
, 
·im
.u16Ns_);

167 
	`ASSERT_EQ
(
ex³ù
.
u16Buck‘ID_
, 
·im
.u16BucketID_);

168 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

169 
	`ASSERT_EQ
(
ex³ù
.
u8pos™iÚ_
, 
·im
.u8position_);

170 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
cÚ‹Á_
.
	`d©a
(), 
·im
.cÚ‹Á_.d©a(),…aim.cÚ‹Á_.
	`size
())==0);

172 
	`ASSERT_EQ
(
ex³ù
.
u64‰l_
, 
·im
.u64ttl_);

173 
	`ASSERT_EQ
(
ex³ù
.
s64syn_v”siÚ_
, 
·im
.s64syn_version_);

174 
	`ASSERT_EQ
(
ex³ù
.
u8äom_
, 
·im
.u8from_);

175 
d–‘e
 
buf
;

176 
	}
}

179 
	$TEST
(
msg_´Ùo
, 
Mu‹Mes§geS
)

181 
Mu‹Mes§geS
 
gm
;

182 
gm
.
u16Ns_
 = 47857;

184 
i
 =999;

185 
gm
.
u16Buck‘ID_
 = 5798;

186 
gm
.
mutiÚ_
.
key
 = "MutateMessage_key";

187 
gm
.
mutiÚ_
.
İt_ty³
 = 
i
%2+1;

188 
gm
.
mutiÚ_
.
has_ex³ùed_v”siÚ
 = 
i
%2;

189 
gm
.
mutiÚ_
.
ex³ùed_v”siÚ
 = 111111111u;

190 
gm
.
mutiÚ_
.
has_ex³ùed_v®
 = 
i
%2;

191 
gm
.
mutiÚ_
.
ex³ùed_v®ue
 = "MutateMessage_expect_value";

193 
gm
.
mutiÚ_
.
v®ue
 = "MutateMessage_value";

194 
gm
.
mutiÚ_
.
has_‰l
 = 
i
%2;

195 
gm
.
mutiÚ_
.
‰l
 = 243434u;

197 
gm
.
s64syn_v”siÚ_
= 4242445u;

198 
gm
.
u8äom_
 = 99;

200 
size
 = 
gm
.
	`MaxSize
();

201 * 
bufãr
 = 
Ãw
 [
size
];

202 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

203 
	`ASSERT_GT
(()
»®_Ën
, 0);

205 
Mu‹Mes§geS
 
exp
;

206 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

207 
	`ASSERT_TRUE
(
»t
);

208 
	`EXPECT_EQ
(
exp
.
u16Ns_
, 
gm
.u16Ns_);

210 
¡MutiÚ
& 
ex³ù
 = 
exp
.
mutiÚ_
;

211 
¡MutiÚ
& 
right
 = 
gm
.
mutiÚ_
;

212 
	`ASSERT_EQ
Ğ
exp
.
u16Buck‘ID_
, 
gm
.u16BucketID_);

213 
	`ASSERT_EQ
Ğ
exp
.
s64syn_v”siÚ_
, 
gm
.s64syn_version_);

214 
	`ASSERT_EQ
Ğ
exp
.
u8äom_
, 
gm
.u8from_);

216 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key
.
	`d©a
(), 
right
.key.d©a(),ƒx³ù.key.
	`size
() ) == 0);

217 
	`ASSERT_EQ
(
ex³ù
.
İt_ty³
 , 
right
.opt_type);

218 
	`ASSERT_EQ
(
ex³ù
.
has_ex³ùed_v”siÚ
 , 
right
.has_expected_version);

219 ià(
ex³ù
.
has_ex³ùed_v”siÚ
 == 1){

220 
	`ASSERT_EQ
(
ex³ù
.
ex³ùed_v”siÚ
 , 
right
.expected_version);

223 
	`ASSERT_EQ
(
ex³ù
.
has_ex³ùed_v®
 , 
right
.has_expected_val);

225 ià(
ex³ù
.
has_ex³ùed_v®
 == 1){

226 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
ex³ùed_v®ue
.
	`d©a
(), 
right
.ex³ùed_v®ue.d©a(),ƒx³ù.ex³ùed_v®ue.
	`size
() ) == 0);

229 ià(
ex³ù
.
İt_ty³
 == 1){

230 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
v®ue
.
	`d©a
(), 
right
.v®ue.d©a(),ƒx³ù.v®ue.
	`size
() ) == 0);

231 
	`ASSERT_EQ
(
ex³ù
.
has_‰l
 , 
right
.has_ttl);

232 ià(
ex³ù
.
has_‰l
 == 1){

233 
	`ASSERT_EQ
(
ex³ù
.
‰l
 , 
right
.ttl);

236 
d–‘e
 [] 
bufãr
;

237 
	}
}

240 
	$TEST
(
msg_´Ùo
, 
G‘V”siÚMes§geS
){

242 
G‘V”siÚMes§geS
 
gms
;

243 
gms
.
ho¡_pÜt_
 = "0.0.0.0:23456";

244 
size
 = 
gms
.
	`MaxSize
();

245 * 
bufãr
 = 
Ãw
 [
size
];

247 
size_t
 
»®_Ën
 = 
gms
.
	`S”ŸlizeTo
(
bufãr
);

248 
	`ASSERT_GT
(()
»®_Ën
, 0);

250 
G‘V”siÚMes§geS
 
ex³ù
;

251 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
bufãr
, 
size
);

252 
	`ASSERT_TRUE
(
»t
);

254 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
ho¡_pÜt_
.
	`d©a
(), 
gms
.ho¡_pÜt_.d©a(),ƒx³ù.ho¡_pÜt_.
	`size
() ) == 0);

255 
d–‘e
 
bufãr
;

256 
	}
}

258 
	$TEST
(
msg_´Ùo
, 
P»·»Mes§geS
){

260 
P»·»Mes§geS
 
gms
;

261 
gms
.
home_pÜt_
 = "0.0.0.0:23456";

262 
gms
.
de¡_ho¡_pÜt_
 = "0.0.0.0:222222";

264 
size
 = 
gms
.
	`MaxSize
();

265 * 
bufãr
 = 
Ãw
 [
size
];

267 
size_t
 
»®_Ën
 = 
gms
.
	`S”ŸlizeTo
(
bufãr
);

268 
	`ASSERT_GT
(()
»®_Ën
, 0);

270 
P»·»Mes§geS
 
ex³ù
;

271 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
bufãr
, 
size
);

272 
	`ASSERT_TRUE
(
»t
);

274 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
home_pÜt_
.
	`d©a
(), 
gms
.home_pÜt_.d©a(),ƒx³ù.home_pÜt_.
	`size
() ) == 0);

275 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
de¡_ho¡_pÜt_
.
	`d©a
(), 
gms
.de¡_ho¡_pÜt_.d©a(),ƒx³ù.de¡_ho¡_pÜt_.
	`size
() ) == 0);

276 
d–‘e
 
bufãr
;

277 
	}
}

280 #undeà
TEST_R


	@/home/libin3-s/ldd/protocol/ut/ut_proto.h

2 
	~<glog/loggšg.h
>

3 
	~<g‹¡/g‹¡.h
>

4 
	~"´Ùo.h
"

5 
	~"¡Üe_´Ùo.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
´ÙocŞ
;

8 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

11 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

13 
	$TEST
(
´Ùo
, 
G‘Mes§ge
){

14 
G‘Mes§ge
 
gm
;

15 
¡d
::
¡ršg
 
ns
 = "GetMessage";

16 
gm
.
Çme_¥aû_
 = 
ns
;

17 * 
s
 = 
Ãw
 [100];

18 
Ën
 = 
	`¢´štf
(
s
, 100, "%d", 22);

19 
Sliû
 
	`sss
(
s
, 
Ën
);

20 
gm
.
key_
 = 
sss
;

21 
size
 = 
gm
.
	`MaxSize
();

22 * 
bufãr
 = 
Ãw
 [
size
];

23 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

25 
G‘Mes§ge
 
exp
;

26 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

27 
	`ASSERT_TRUE
(
»t
);

28 
	`EXPECT_TRUE
(
	`¡ºcmp
(
exp
.
Çme_¥aû_
.
	`d©a
(), 
gm
.Çme_¥aû_.d©a(),gm.Çme_¥aû_.
	`size
() ) == 0);

30 cÚ¡ * 
a
 = 
exp
.
key_
.
	`d©a
();

31 cÚ¡ * 
b
 = 
gm
.
key_
.
	`d©a
();

32 
	`EXPECT_TRUE
(
	`¡ºcmp
(
a
, 
b
, 
gm
.
key_
.
	`size
() ) == 0);

33 
d–‘e
[] 
gm
.
key_
.
	`d©a
();

34 
d–‘e
 [] 
bufãr
;

37 
G‘Mes§ge
 
gm
;

38 
¡d
::
¡ršg
 
ns
 = "GetMessage";

39 
gm
.
Çme_¥aû_
 = 
ns
;

40 
Sliû
 
sss
 = "test;";

41 
gm
.
key_
 = 
sss
;

42 
size
 = 
gm
.
	`MaxSize
();

43 * 
bufãr
 = 
Ãw
 [
size
];

44 
size_t
 
Ën2
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

46 
G‘Mes§ge
 
»¥Ú
;

47 
»¥Ú
.
	`P¬£From
(
bufãr
, 
Ën2
);

49 
	`ASSERT_TRUE
(
»t
);

50 
d–‘e
 
bufãr
;

52 
	}
}

54 
	$TEST
(
´Ùo
, 
CheckMes§ge
){

55 
CheckMes§ge
 
cm
;

56 
¡d
::
¡ršg
 
ns
 = "CheckMessage";

57 
cm
.
Çme_¥aû_
 = 
ns
;

58 * 
s
 = 
Ãw
 [100];

59 
Ën
 = 
	`¢´štf
(
s
, 100, "%d", 10000);

60 
Sliû
 
	`sss
(
s
, 
Ën
);

61 
cm
.
key_
=
sss
;

62 
size
 = 
cm
.
	`MaxSize
();

63 * 
bufãr
 = 
Ãw
 [
size
];

64 
size_t
 
»®_Ën
 = 
cm
.
	`S”ŸlizeTo
(
bufãr
);

65 
	`ASSERT_GT
(()
»®_Ën
, 0);

67 
CheckMes§ge
 
exp
;

68 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

69 
	`ASSERT_TRUE
(
»t
);

70 
	`EXPECT_TRUE
(
	`¡ºcmp
(
exp
.
Çme_¥aû_
.
	`d©a
(), 
cm
.Çme_¥aû_.d©a(),cm.Çme_¥aû_.
	`size
() ) == 0);

72 cÚ¡ * 
a
 = 
exp
.
key_
.
	`d©a
();

73 cÚ¡ * 
b
 = 
cm
.
key_
.
	`d©a
();

74 
	`EXPECT_TRUE
(
	`¡ºcmp
(
a
, 
b
, 
cm
.
key_
.
	`size
() ) == 0);

75 
d–‘e
[] 
cm
.
key_
.
	`d©a
();

76 
d–‘e
 [] 
bufãr
;

80 
CheckMes§ge
 
cm
;

81 
¡d
::
¡ršg
 
ns
 = "CheckMessage";

82 
cm
.
Çme_¥aû_
 = 
ns
;

83 
Sliû
 
sss
 = "test";

84 
cm
.
key_
=
sss
;

85 
size
 = 
cm
.
	`MaxSize
();

86 * 
bufãr
 = 
Ãw
 [
size
];

87 
size_t
 
»®_Ën
 = 
cm
.
	`S”ŸlizeTo
(
bufãr
);

88 
	`ASSERT_GT
(()
»®_Ën
, 0);

89 
d–‘e
 
bufãr
;

91 
	}
}

93 
	$TEST
(
´Ùo
, 
Li¡Mes§ge
)

95 
Li¡Mes§ge
 
lm
;

96 
lm
.
Çme_¥aû_
 = "ListMessage";

97 
lm
.
key_
 = "ListMessageS_key" ;

98 
lm
.
u32lim™_
 = 43543546u;

99 
lm
.
u8pos™iÚ_
 = 1u;

101 
Ën
 = 
lm
.
	`MaxSize
();

102 * 
buf
 = 
Ãw
 [
Ën
];

103 
size_t
 
»®_Ën
 = 
lm
.
	`S”ŸlizeTo
(
buf
);

104 
	`ASSERT_GT
(()
»®_Ën
, 0);

106 
Li¡Mes§ge
 
ex³ù
;

107 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
»®_Ën
);

108 
	`ASSERT_TRUE
(
»t
);

110 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
Çme_¥aû_
.
	`d©a
(), 
lm
.Çme_¥aû_.d©a(),†m.Çme_¥aû_.
	`size
())==0);

111 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
lm
.key_.d©a(),†m.key_.
	`size
())==0);

112 
	`ASSERT_EQ
(
ex³ù
.
u32lim™_
, 
lm
.u32limit_);

113 
	`ASSERT_EQ
(
ex³ù
.
u8pos™iÚ_
, 
lm
.u8position_);

114 
d–‘e
 
buf
;

115 
	}
}

118 
	$TEST
(
´Ùo
, 
AtomicInüMes§ge
)

120 
AtomicInüMes§ge
 
·im
;

121 
·im
.
Çme_¥aû_
 = "ProxyAtomicIncrMessage";

122 
·im
.
key_
 = "ProxyAtomicIncrMessageKey";

123 
·im
.
s32İ”ªd_
 = 892839289;

124 
·im
.
s32š™Ÿl_
 = 10000;

125 
·im
.
u64‰l_
 = 32329389u;

127 
Ën
 = 
·im
.
	`MaxSize
();

128 * 
buf
 = 
Ãw
 [
Ën
];

129 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

130 
	`ASSERT_GT
(()
»®_Ën
, 0);

132 
AtomicInüMes§ge
 
ex³ù
;

133 
ex³ù
.
	`P¬£From
(
buf
, 
»®_Ën
);

135 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
Çme_¥aû_
.
	`d©a
(), 
·im
.Çme_¥aû_.d©a(),…aim.Çme_¥aû_.
	`size
())==0);

136 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

137 
	`ASSERT_EQ
(
ex³ù
.
s32İ”ªd_
, 
·im
.s32operand_);

138 
	`ASSERT_EQ
(
ex³ù
.
s32š™Ÿl_
, 
·im
.s32initial_);

140 
	`ASSERT_EQ
(
ex³ù
.
u64‰l_
, 
·im
.u64ttl_);

141 
d–‘e
 
buf
;

142 
	}
}

144 
	$TEST
(
´Ùo
, 
AtomicAµ’dMes§ge
)

146 
AtomicAµ’dMes§ge
 
·im
;

147 
·im
.
Çme_¥aû_
 = "ProxyAtomicAppendMessage";

148 
·im
.
key_
 = "ProxyAtomicAppendMessageKey";

149 
·im
.
u8pos™iÚ_
 = 89;

150 
·im
.
cÚ‹Á_
 = "slice_";

151 
·im
.
u64‰l_
 = 43444444lu;

153 
Ën
 = 
·im
.
	`MaxSize
();

154 * 
buf
 = 
Ãw
 [
Ën
];

155 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

156 
	`ASSERT_GT
(()
»®_Ën
, 0);

158 
AtomicAµ’dMes§ge
 
ex³ù
;

159 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

161 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
Çme_¥aû_
.
	`d©a
(), 
·im
.Çme_¥aû_.d©a(),…aim.Çme_¥aû_.
	`size
())==0);

162 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

163 
	`ASSERT_EQ
(
ex³ù
.
u8pos™iÚ_
, 
·im
.u8position_);

164 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
cÚ‹Á_
.
	`d©a
(), 
·im
.cÚ‹Á_.d©a(),…aim.cÚ‹Á_.
	`size
())==0);

166 
	`ASSERT_EQ
(
ex³ù
.
u64‰l_
, 
·im
.u64ttl_);

167 
d–‘e
 
buf
;

168 
	}
}

170 
	$TEST
(
´Ùo
, 
Mu‹Mes§ge
)

172 
Mu‹Mes§ge
 
gm
;

173 
¡d
::
¡ršg
 
ns
 = "MutateMessage";

174 
gm
.
Çme_¥aû_
 = 
ns
;

175 
¡MutiÚ
 
key_v®ue_
;

176 
gm
.
mutiÚ_
.
key
 = "MutateMessage_key";

177 
gm
.
mutiÚ_
.
İt_ty³
 = 22%2+1;

178 
gm
.
mutiÚ_
.
has_ex³ùed_v”siÚ
 = 22%2;

179 
gm
.
mutiÚ_
.
ex³ùed_v”siÚ
 = 111111111u;

180 
gm
.
mutiÚ_
.
has_ex³ùed_v®
 = 22%2;

181 
gm
.
mutiÚ_
.
ex³ùed_v®ue
 = "MutateMessage_expect_value";

183 
gm
.
mutiÚ_
.
v®ue
 = "MutateMessage_value";

184 
gm
.
mutiÚ_
.
has_‰l
 = 22%2;

185 
gm
.
mutiÚ_
.
‰l
 = 243434u;

186 
size
 = 
gm
.
	`MaxSize
();

187 * 
bufãr
 = 
Ãw
 [
size
];

188 
size_t
 
»®_Ën
 = 
gm
.
	`S”ŸlizeTo
(
bufãr
);

189 
	`ASSERT_GT
(()
»®_Ën
, 0);

191 
Mu‹Mes§ge
 
exp
;

192 
boŞ
 
»t
 = 
exp
.
	`P¬£From
(
bufãr
, 
»®_Ën
);

193 
	`ASSERT_TRUE
(
»t
);

194 
	`EXPECT_TRUE
(
	`¡ºcmp
(
exp
.
Çme_¥aû_
.
	`d©a
(), 
gm
.Çme_¥aû_.d©a(),gm.Çme_¥aû_.
	`size
() ) == 0);

196 
¡MutiÚ
& 
ex³ù
 = 
exp
.
mutiÚ_
;

197 
¡MutiÚ
& 
right
 = 
gm
.
mutiÚ_
;

198 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key
.
	`d©a
(), 
right
.key.d©a(),ƒx³ù.key.
	`size
() ) == 0);

199 
	`ASSERT_EQ
(
ex³ù
.
İt_ty³
 , 
right
.opt_type);

200 
	`ASSERT_EQ
(
ex³ù
.
has_ex³ùed_v”siÚ
 , 
right
.has_expected_version);

201 ià(
ex³ù
.
has_ex³ùed_v”siÚ
 == 1){

202 
	`ASSERT_EQ
(
ex³ù
.
ex³ùed_v”siÚ
 , 
right
.expected_version);

205 
	`ASSERT_EQ
(
ex³ù
.
has_ex³ùed_v®
 , 
right
.has_expected_val);

207 ià(
ex³ù
.
has_ex³ùed_v®
 == 1){

208 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
ex³ùed_v®ue
.
	`d©a
(), 
right
.ex³ùed_v®ue.d©a(),ƒx³ù.ex³ùed_v®ue.
	`size
() ) == 0);

211 ià(
ex³ù
.
İt_ty³
 == 1){

212 
	`EXPECT_TRUE
(
	`¡ºcmp
(
ex³ù
.
v®ue
.
	`d©a
(), 
right
.v®ue.d©a(),ƒx³ù.v®ue.
	`size
() ) == 0);

213 
	`ASSERT_EQ
(
ex³ù
.
has_‰l
 , 
right
.has_ttl);

214 ià(
ex³ù
.
has_‰l
 == 1){

215 
	`ASSERT_EQ
(
ex³ù
.
‰l
 , 
right
.ttl);

218 
d–‘e
 [] 
bufãr
;

219 
	}
}

225 #undeà
TEST_R


	@/home/libin3-s/ldd/protocol/ut/ut_response.h

2 
	~<glog/loggšg.h
>

3 
	~<g‹¡/g‹¡.h
>

5 
	~"»¥Ú£.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
´ÙocŞ
;

8 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

10 
	#TEST_R
(
t
, 
n
è
MyTe¡_
##t##
_
##
	`n
()

	)

13 
	$TEST
(
»¥Ú£
, 
G‘OrLi¡Re¥Ú£
)

15 
G‘OrLi¡Re¥Ú£
 
·im
;

17 
·im
.
key_
 = "GetOrListResponse_key";

18 
·im
.
v®ue_
 = "GetOrListResponse_value";

19 
·im
.
s64V”siÚ_
 = 98392839;

20 
·im
.
u64‰l_
 = 983839;

22 
Ën
 = 
·im
.
	`MaxSize
();

23 * 
buf
 = 
Ãw
 [
Ën
];

24 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

25 
	`ASSERT_GT
(()
»®_Ën
, 0);

27 
G‘OrLi¡Re¥Ú£
 
ex³ù
;

28 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
»®_Ën
);

29 
	`ASSERT_TRUE
(
»t
);

30 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

31 
	`ASSERT_EQ
(
ex³ù
.
s64V”siÚ_
, 
·im
.s64Version_);

32 
	`ASSERT_EQ
(
ex³ù
.
u64‰l_
, 
·im
.u64ttl_);

33 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
v®ue_
.
	`d©a
(), 
·im
.v®ue_.d©a(),…aim.v®ue_.
	`size
())==0);

34 
d–‘e
 
buf
;

35 
	}
}

37 
	$TEST
(
»¥Ú£
, 
CheckRe¥Ú£
)

39 
CheckRe¥Ú£
 
·im
;

41 
·im
.
key_
 = "CheckResponse_key";

42 
·im
.
s64V”siÚ_
 = 21222222222;

44 
Ën
 = 
·im
.
	`MaxSize
();

45 * 
buf
 = 
Ãw
 [
Ën
];

46 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

47 
	`ASSERT_GT
(()
»®_Ën
, 0);

49 
CheckRe¥Ú£
 
ex³ù
;

50 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
»®_Ën
);

51 
	`ASSERT_TRUE
(
»t
);

52 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),…aim.key_.
	`size
())==0);

53 
	`ASSERT_EQ
(
ex³ù
.
s64V”siÚ_
, 
·im
.s64Version_);

54 
d–‘e
 
buf
;

55 
	}
}

57 
	$TEST
(
»¥Ú£
, 
Mu‹Re¥Ú£
)

59 
Mu‹Re¥Ú£
 
·im
;

61 
·im
.
s64V”siÚ_
 = 212123244;

63 
Ën
 = 
·im
.
	`MaxSize
();

64 * 
buf
 = 
Ãw
 [
Ën
];

65 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

66 
	`ASSERT_GT
(()
»®_Ën
, 0);

68 
Mu‹Re¥Ú£
 
ex³ù
;

69 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
»®_Ën
);

70 
	`ASSERT_TRUE
(
»t
);

71 
	`ASSERT_EQ
(
ex³ù
.
s64V”siÚ_
, 
·im
.s64Version_);

72 
d–‘e
 
buf
;

73 
	}
}

75 
	$TEST
(
»¥Ú£
, 
CasRe¥Ú£
)

77 
CasRe¥Ú£
 
·im
;

78 
·im
.
s64V”siÚ_
 = 32793729;

79 
·im
.
key_
 = "atkjsdk";

80 
·im
.
v®ue_
 = "fdsul";

82 
Ën
 = 
·im
.
	`MaxSize
();

83 * 
buf
 = 
Ãw
 [
Ën
];

84 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

85 
	`ASSERT_GT
(()
»®_Ën
, 0);

87 
CasRe¥Ú£
 
ex³ù
;

88 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

89 
	`ASSERT_TRUE
(
»t
);

90 
	`ASSERT_EQ
(
ex³ù
.
s64V”siÚ_
, 
·im
.s64Version_);

91 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
key_
.
	`d©a
(), 
·im
.key_.d©a(),ƒx³ù.key_.
	`size
())==0);

92 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
v®ue_
.
	`d©a
(), 
·im
.v®ue_.d©a(),ƒx³ù.v®ue_.
	`size
())==0);

93 
d–‘e
 
buf
;

94 
	}
}

96 
	$TEST
(
»¥Ú£
, 
G‘V”siÚRe¥Ú£
)

98 
G‘V”siÚRe¥Ú£
 
·im
;

99 
·im
.
s64V”siÚ_
 = 32793729;

100 
·im
.
home_ho¡_pÜt_
 = "0.0.0.0:1122";

101 
·im
.
de¡_ho¡_pÜt_
 = "0.0.0.0:1122234";

103 
Ën
 = 
·im
.
	`MaxSize
();

104 * 
buf
 = 
Ãw
 [
Ën
];

105 
size_t
 
»®_Ën
 = 
·im
.
	`S”ŸlizeTo
(
buf
);

106 
	`ASSERT_GT
(()
»®_Ën
, 0);

108 
G‘V”siÚRe¥Ú£
 
ex³ù
;

109 
boŞ
 
»t
 = 
ex³ù
.
	`P¬£From
(
buf
, 
Ën
);

110 
	`ASSERT_TRUE
(
»t
);

111 
	`ASSERT_EQ
(
ex³ù
.
s64V”siÚ_
, 
·im
.s64Version_);

112 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
home_ho¡_pÜt_
.
	`d©a
(), 
·im
.home_ho¡_pÜt_.d©a(),ƒx³ù.home_ho¡_pÜt_.
	`size
())==0);

113 
	`ASSERT_TRUE
(
	`¡ºcmp
(
ex³ù
.
de¡_ho¡_pÜt_
.
	`d©a
(), 
·im
.de¡_ho¡_pÜt_.d©a(),ƒx³ù.de¡_ho¡_pÜt_.
	`size
())==0);

114 
d–‘e
 
buf
;

115 
	}
}

119 #undeà
TEST_R


	@/home/libin3-s/ldd/proxy/c2p/atomic_append.h

1 #iâdeà
__C2P_ATOMIC_APPEND_H__


2 
	#__C2P_ATOMIC_APPEND_H__


	)

4 
	~"ldd/ut/©omic.h
"

6 
	~"ldd/Ãt/·ylßd.h
"

7 
	~"ldd/Ãt/šcomšg_msg.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
şass
 
	gProxy
;

14 
şass
 
	gP2SAtomicAµ’d
;

16 
şass
 
	gC2PAtomicAµ’d
:

17 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_APPEND
>{

18 
public
:

19 
C2PAtomicAµ’d
(
Proxy
 *
´oxy
);

20 
	gvœtu®
 ~
C2PAtomicAµ’d
();

23 
S’dReque¡
();

24 
S’dResuÉ
();

25 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

26 
code_
 = 
code
;

29 
	g´Ùeùed
:

30 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

31 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

32 
vœtu®
 
DÚe
(
Code
* 
code
);

33 
vœtu®
 
Cªûl
() {}

35 
	g´iv©e
:

36 
ä›nd
 
şass
 
P2SAtomicAµ’d
;

37 
Proxy
 *
	g´oxy_
;

38 
	gÇme¥aû_id_
;

39 
	g¡d
::
size_t
 
hash_v®_
;;

40 
	gbuck‘_id_
;

41 
	gçrm_id_
;

42 
	gldd
::
´ÙocŞ
::
AtomicAµ’dMes§ge
 
»q_
;

43 
	gldd
::
´ÙocŞ
::
CasRe¥Ú£
 
»s_
;

46 
	gldd
::
Ãt
::
Paylßd
 
»que¡_
;

47 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

48 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/c2p/atomic_incr.h

1 #iâdeà
__C2P_ATOMIC_INCR_H__


2 
	#__C2P_ATOMIC_INCR_H__


	)

4 
	~"ldd/ut/©omic.h
"

6 
	~"ldd/Ãt/·ylßd.h
"

7 
	~"ldd/Ãt/šcomšg_msg.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
şass
 
	gProxy
;

14 
şass
 
	gP2SAtomicInü
;

16 
şass
 
	gC2PAtomicInü
:

17 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_INCR
>{

18 
public
:

19 
C2PAtomicInü
(
Proxy
 *
´oxy
);

20 
	gvœtu®
 ~
C2PAtomicInü
();

22 
S’dResuÉ
();

23 
S’dReque¡
();

24 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

25 
code_
 = 
code
;

28 
	g´Ùeùed
:

29 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

30 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

31 
vœtu®
 
DÚe
(
Code
* 
code
);

32 
vœtu®
 
Cªûl
() {}

34 
	g´iv©e
:

35 
ä›nd
 
şass
 
P2SAtomicInü
;

36 
Proxy
 *
	g´oxy_
;

37 
	gÇme¥aû_id_
;

38 
	g¡d
::
size_t
 
hash_v®_
;

39 
	gbuck‘_id_
;

40 
	gçrm_id_
;

41 
	gldd
::
´ÙocŞ
::
AtomicInüMes§ge
 
»q_
;

42 
	gldd
::
´ÙocŞ
::
CasRe¥Ú£
 
»s_
;

45 
	gldd
::
Ãt
::
Paylßd
 
»que¡_
;

46 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

47 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/c2p/check.h

1 #iâdeà
__C2P_CHECK_H__


2 
	#__C2P_CHECK_H__


	)

4 
	~"ldd/ut/©omic.h
"

6 
	~"ldd/Ãt/·ylßd.h
"

7 
	~"ldd/Ãt/šcomšg_msg.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
şass
 
	gProxy
;

14 
şass
 
	gP2SCheck
;

16 
şass
 
	gC2PCheck
: 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_CHECK
>{

17 
public
:

18 
C2PCheck
(
Proxy
 *
´oxy
);

19 
	gvœtu®
 ~
C2PCheck
();

21 
S’dResuÉ
();

22 
S’dReque¡
();

23 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

24 
code_
 = 
code
;

27 
	g´Ùeùed
:

28 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

29 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

30 
vœtu®
 
DÚe
(
Code
* 
code
);

31 
vœtu®
 
Cªûl
() {}

33 
	g´iv©e
:

34 
ä›nd
 
şass
 
P2SCheck
;

35 
Proxy
 *
	g´oxy_
;

36 
	gÇme¥aû_id_
;

37 
	g¡d
::
size_t
 
hash_v®_
;

38 
	gbuck‘_id_
;

39 
	gçrm_id_
;

40 
	gldd
::
´ÙocŞ
::
CheckMes§ge
 
»q_
;

41 
	gldd
::
´ÙocŞ
::
CheckRe¥Ú£
 
»s_
;

44 
	gldd
::
Ãt
::
Paylßd
 
»que¡_
;

45 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

46 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/c2p/get.h

1 #iâdeà
__C2P_GET_H__


2 
	#__C2P_GET_H__


	)

4 
	~"ldd/ut/©omic.h
"

6 
	~"ldd/Ãt/·ylßd.h
"

7 
	~"ldd/Ãt/šcomšg_msg.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
şass
 
	gProxy
;

14 
şass
 
	gP2SG‘
;

16 
şass
 
	gC2PG‘
: 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_GET
> {

17 
public
:

18 
C2PG‘
(
Proxy
 *
´oxy
);

19 
	gvœtu®
 ~
C2PG‘
();

21 
S’dReque¡
();

22 
S’dResuÉ
(cÚ¡ 
ldd
::
Ãt
::
Paylßd
 &
bufãr
);

23 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

24 
code_
 = 
code
;

27 
	g´Ùeùed
:

28 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

29 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

30 
vœtu®
 
DÚe
(
Code
* 
code
);

31 
vœtu®
 
Cªûl
() {}

34 
	g´iv©e
:

35 
PrštResuÉ
();

37 
ä›nd
 
şass
 
	gP2SG‘
;

38 
Proxy
 *
	g´oxy_
;

39 
	g¡d
::
size_t
 
hash_v®_
;

40 
	gÇme¥aû_id_
;

41 
	gbuck‘_id_
;

42 
	gçrm_id_
;

43 
	gldd
::
´ÙocŞ
::
G‘Mes§ge
 
»q_
;

44 
	gldd
::
´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 
»s_
;

47 
	gldd
::
Ãt
::
Paylßd
 
»que¡_
;

48 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

49 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/c2p/list.h

1 #iâdeà
__C2P_LIST_H__


2 
	#__C2P_LIST_H__


	)

4 
	~<li¡
>

6 
	~"ldd/ut/©omic.h
"

7 
	~"ldd/ut/mu‹x.h
"

9 
	~"ldd/Ãt/·ylßd.h
"

10 
	~"ldd/Ãt/šcomšg_msg.h
"

12 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

13 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

14 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

16 
şass
 
	gProxy
;

17 
şass
 
	gP2SLi¡
;

19 
şass
 
	gC2PLi¡
: 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_LIST
>{

20 
public
:

21 
C2PLi¡
(
Proxy
 *
´oxy
);

22 
	gvœtu®
 ~
C2PLi¡
();

24 
S’dReque¡
();

25 
S’dResuÉ
(
ldd
::
´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 *
»s
,

26 
ldd
::
Ãt
::
Paylßd
 
»suÉ
, 
šdex
);

27 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

28 
code_
 = 
code
;

30 
Com¶‘e
();

32 
	g´Ùeùed
:

33 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

34 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

35 
vœtu®
 
DÚe
(
Code
* 
code
);

36 
vœtu®
 
Cªûl
();

38 
	g´iv©e
:

39 
ä›nd
 
şass
 
P2SLi¡
;

40 
Proxy
 *
	g´oxy_
;

41 
	g¡d
::
size_t
 
hash_v®_
;

42 
	gÇme¥aû_id_
;

43 
	gbuck‘_id_
;

44 
	gldd
::
´ÙocŞ
::
Li¡Mes§ge
 
»q_
;

46 
	sP2SLi¡Info
 {

47 
P2SLi¡Info
(è: 
com¶‘e
(
çl£
), 
has_Ãw_»suÉ
(false) {

50 
boŞ
 
	gcom¶‘e
;

51 
boŞ
 
	ghas_Ãw_»suÉ
;

52 
	g¡d
::
li¡
<
ldd
::
´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 *> 
»¥Ú£
;

53 
	g¡d
::
veùÜ
<
ldd
::
Ãt
::
Paylßd
> 
»¥Ú£_buff
;

55 
	gboo¡
::
sh¬ed_±r
<
P2SLi¡
> 
p2s_li¡
;

58 
	gcur_šdex_
;

59 
	g¡d
::
veùÜ
<
P2SLi¡Info
> 
p2s_li¡_šfo_
;

60 
ušt32_t
 
	g£nd_couÁ_
;

61 
	gldd
::
ut
::
Mu‹x
 
mu‹x_
;

63 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

64 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/c2p/mutate.h

1 #iâdeà
__C2P_MUTATE_H__


2 
	#__C2P_MUTATE_H__


	)

4 
	~"ldd/ut/©omic.h
"

6 
	~"ldd/Ãt/·ylßd.h
"

7 
	~"ldd/Ãt/šcomšg_msg.h
"

9 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

11 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

13 
şass
 
	gProxy
;

14 
şass
 
	gP2SMu‹
;

16 
şass
 
	gC2PMu‹
: 
public
 
ldd
::
Ãt
::
Ty³dIncomšgMsg
<
LDD_CLIENT_2_PROXY_MUTATE
>{

17 
public
:

18 
C2PMu‹
(
Proxy
 *
´oxy
);

19 
	gvœtu®
 ~
C2PMu‹
();

21 
S’dResuÉ
();

22 
S’dReque¡
();

23 
S‘Code
(
ldd
::
Ãt
::
Code
 
code
){

24 
code_
 = 
code
;

27 
	g´Ùeùed
:

28 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
);

29 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
);

30 
vœtu®
 
DÚe
(
Code
* 
code
);

31 
vœtu®
 
Cªûl
();

33 
	g´iv©e
:

34 
ä›nd
 
şass
 
P2SMu‹
;

35 
Proxy
 *
	g´oxy_
;

36 
	gÇme¥aû_id_
;

37 
	g¡d
::
size_t
 
hash_v®_
;

38 
	gbuck‘_id_
;

39 
	gçrm_id_
;

40 
	gldd
::
´ÙocŞ
::
Mu‹Mes§ge
 
»q_
;

41 
	gldd
::
´ÙocŞ
::
Mu‹Re¥Ú£
 
»s_
;

44 
	gldd
::
Ãt
::
Paylßd
 
»que¡_
;

45 
	gldd
::
Ãt
::
Paylßd
 
»¥Ú£_
;

47 
	gldd
::
Ãt
::
Code
 
code_
;

	@/home/libin3-s/ldd/proxy/p2s/atomic_append_ex.h

4 #iâdeà
__P2S_ATOMIC_APPEND_H__


5 
	#__P2S_ATOMIC_APPEND_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
şass
 
	gC2PAtomicAµ’d
;

14 
şass
 
	gP2SAtomicAµ’d
 :

15 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_ATOMIC_APPEND
>{

16 
public
:

17 
P2SAtomicAµ’d
(
boo¡
::
sh¬ed_±r
<
C2PAtomicAµ’d
> 
©omic_­³nd
,

18 
»cv_timeout
,

19 
dÚe_timeout
)

20 : 
c2p_©omic_­³nd_
(
©omic_­³nd
),

21 
»cv_timeout_
(
»cv_timeout
),

22 
dÚe_timeout_
(
dÚe_timeout
) {

25 
	gvœtu®
 ~
P2SAtomicAµ’d
() {}

27 
	g´Ùeùed
:

28 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

29 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

30 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

31 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

33 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

35 
	g´iv©e
:

36 
ä›nd
 
şass
 
C2PAtomicAµ’d
;

37 
	gboo¡
::
sh¬ed_±r
<
C2PAtomicAµ’d
> 
c2p_©omic_­³nd_
;

38 
	gldd
::
´ÙocŞ
::
AtomicAµ’dMes§geS
 
»q_
;

40 
	g»cv_timeout_
;

41 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/p2s/atomic_incr_ex.h

4 #iâdeà
__P2S_ATOMIC_INCR_H__


5 
	#__P2S_ATOMIC_INCR_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
şass
 
	gC2PAtomicInü
;

14 
şass
 
	gP2SAtomicInü
 :

15 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
 <
LDD_PROXY_2_STORE_ATOMIC_INCR
>{

16 
public
:

17 
P2SAtomicInü
(
boo¡
::
sh¬ed_±r
<
C2PAtomicInü
>
©omic_šü
,

18 
»cv_timeout
,

19 
dÚe_timeout
) :

20 
c2p_©omic_šü_
(
©omic_šü
),

21 
»cv_timeout_
(
»cv_timeout
),

22 
dÚe_timeout_
(
dÚe_timeout
) {}

23 
	gvœtu®
 ~
P2SAtomicInü
() {}

28 
	g´Ùeùed
:

29 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

30 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

31 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

32 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

33 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

34 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

36 
	g´iv©e
:

37 
ä›nd
 
şass
 
C2PAtomicInü
;

38 
	gboo¡
::
sh¬ed_±r
<
C2PAtomicInü
> 
c2p_©omic_šü_
;

39 
	gldd
::
´ÙocŞ
::
AtomicInüMes§geS
 
»q_
;

42 
	g»cv_timeout_
;

43 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/p2s/check_ex.h

4 #iâdeà
__P2S_CHECK_H__


5 
	#__P2S_CHECK_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
şass
 
	gC2PCheck
;

14 
şass
 
	gP2SCheck
 :

15 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_CHECK
> {

16 
public
:

17 
P2SCheck
(
boo¡
::
sh¬ed_±r
<
C2PCheck
>
check
,

18 
»cv_timeout
,

19 
dÚe_timeout
) :

20 
c2p_check_
(
check
),

21 
»cv_timeout_
(
»cv_timeout
),

22 
dÚe_timeout_
(
dÚe_timeout
) {

25 
	gvœtu®
 ~
P2SCheck
() {}

27 
	g´Ùeùed
:

28 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

29 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

30 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

31 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

33 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

35 
	g´iv©e
:

36 
ä›nd
 
şass
 
C2PCheck
;

37 
	gboo¡
::
sh¬ed_±r
<
C2PCheck
> 
c2p_check_
;

38 
	gldd
::
´ÙocŞ
::
CheckMes§geS
 
»q_
;

40 
	g»cv_timeout_
;

41 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/p2s/get_ex.h

4 #iâdeà
__P2S_GET_H__


5 
	#__P2S_GET_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
	~"ldd/´oxy/c2p/g‘.h
"

14 
şass
 
	gP2SG‘
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_GET
> {

15 
public
:

16 
P2SG‘
(
boo¡
::
sh¬ed_±r
<
C2PG‘
> 
c2p_g‘
,

17 
»cv_timeout
,

18 
dÚe_timeout
) :

19 
c2p_g‘_
(
c2p_g‘
),

20 
»cv_timeout_
(
»cv_timeout
),

21 
dÚe_timeout_
(
dÚe_timeout
) {

24 
	gvœtu®
 ~
P2SG‘
() {}

25 
PrštResuÉ
();

27 
	g´Ùeùed
:

28 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

29 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

30 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

31 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

33 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

35 
	g´iv©e
:

36 
ä›nd
 
şass
 
C2PG‘
;

37 
	gboo¡
::
sh¬ed_±r
<
C2PG‘
> 
c2p_g‘_
;

38 
	gldd
::
´ÙocŞ
::
G‘Mes§geS
 
»q_
;

40 
	g»cv_timeout_
;

41 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/p2s/list_ex.h

4 #iâdeà
__P2S_LIST_H__


5 
	#__P2S_LIST_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
şass
 
	gC2PLi¡
;

14 
şass
 
	gP2SLi¡
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_LIST
> {

15 
public
:

16 
P2SLi¡
(
C2PLi¡
 *
li¡
, 
šdex
,

17 
»cv_timeout
,

18 
dÚe_timeout
)

19 : 
c2p_li¡_
(
li¡
), 
šdex_
(
šdex
),

20 
»cv_timeout_
(
»cv_timeout
),

21 
dÚe_timeout_
(
dÚe_timeout
) {

24 
	gvœtu®
 ~
P2SLi¡
() {}

25 
Com¶‘eReque¡
();

27 
	g´Ùeùed
:

28 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

29 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

30 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

31 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

32 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

33 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

35 
	g´iv©e
:

36 
ä›nd
 
şass
 
C2PLi¡
;

37 
C2PLi¡
 *
	gc2p_li¡_
;

38 
	gšdex_
;

39 
	gldd
::
´ÙocŞ
::
Li¡Mes§geS
 
»q_
;

41 
	g»cv_timeout_
;

42 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/p2s/mutate_ex.h

4 #iâdeà
__P2S_MUTATE_H__


5 
	#__P2S_MUTATE_H__


	)

7 
	~"ldd/Ãt/outgošg_msg.h
"

8 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

9 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

12 
	~"ldd/´oxy/c2p/mu‹.h
"

14 
şass
 
	gC2PMu‹
;

16 
şass
 
	gP2SMu‹
 : 
public
 
ldd
::
Ãt
::
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_MUTATE
> {

17 
public
:

18 
P2SMu‹
(
boo¡
::
sh¬ed_±r
<
C2PMu‹
> 
mu‹
,

19 
»cv_timeout
,

20 
dÚe_timeout
) :

21 
c2p_mu‹_
(
mu‹
),

22 
»cv_timeout_
(
»cv_timeout
),

23 
dÚe_timeout_
(
dÚe_timeout
)

27 
	gvœtu®
 ~
P2SMu‹
() {}

29 
	g´Ùeùed
:

30 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

31 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

32 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) ;

33 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

34 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) ;

35 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

37 
	g´iv©e
:

38 
ä›nd
 
şass
 
C2PMu‹
;

39 
	gboo¡
::
sh¬ed_±r
<
C2PMu‹
> 
c2p_mu‹_
;

40 
	gldd
::
´ÙocŞ
::
Mu‹Mes§geS
 
»q_
;

42 
	g»cv_timeout_
;

43 
	gdÚe_timeout_
;

	@/home/libin3-s/ldd/proxy/proxy.h

4 #iâdeà
__PROXY_H__


5 
	#__PROXY_H__


	)

7 
	~<m­
>

8 
	~<boo¡/sh¬ed_±r.hµ
>

10 
	~"ldd/ut/mu‹x.h
"

11 
	~"ldd/Ãt/ş›Á.h
"

13 
	~"ldd/ut/¦iû.h
"

14 
	~"ldd/cour›r/cÚfigu».h
"

16 
	~"ldd/Ãt/ş›Á.h
"

17 
	~"ldd/Ãt/ev’t_loİ.h
"

19 şas 
	cProxy
 {

20 
	mpublic
:

21 
Proxy
(
ldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
,

22 
ldd
::
Ãt
::
Cl›Á
::
O±iÚs
& 
ş›Á_İt
,cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

23 cÚ¡ 
¡d
::
¡ršg
& 
zook“³r_ho¡
,

24 cÚ¡ 
¡d
::
¡ršg
& 
zook“³r_roÙ·th
,

25 
zook“³r_timeout
,

26 
»cv_timeout
,

27 
dÚe_timeout
,

28 
rŞe_ty³
,

29 
boŞ
 
´oxy_¡©
);

30 ~
Proxy
();

32 
boŞ
 
In™
();

34 
G‘NameS·ûID
(cÚ¡ 
¡d
::
¡ršg
 &
ns
);

35 
	m¡d
::
size_t
 
G‘HashV®ue
(cÚ¡ 
ldd
::
ut
::
Sliû
 &
key
);

36 
G‘Buck‘ID
(
¡d
::
size_t
 
hash_v®ue
);

37 
G‘F¬mID
(
buck‘_id
);

38 
	m¡d
::
veùÜ
<> *
G‘F¬mLi¡
();

39 
	mboo¡
::
sh¬ed_±r
<
ldd
::
Ãt
::
ChªÃl
> 
G‘R—dChªÃl
(
¡d
::
size_t
 
hash_v®ue


40 , 
çrm_id
);

41 
	mboo¡
::
sh¬ed_±r
<
ldd
::
Ãt
::
ChªÃl
> 
G‘Wr™eChªÃl
(
çrm_id
);

43 
HªdËE¼Ü
(
”rÜ_code
);

45 
	$g‘_»cv_timeout
(){

46  
»cv_timeout_
;

49 
	$g‘_dÚe_timeout
(){

50  
dÚe_timeout_
;

51 
	}
}

53 
	g´iv©e
:

54 
boŞ
 
In™Cl›Á
();

55 
boŞ
 
P2sIn™
();

57 
boŞ
 
CÚÃùNode
(cÚ¡ 
¡d
::
¡ršg
 &
node
);

58 
boŞ
 
RemoveNode
(cÚ¡ 
¡d
::
¡ršg
 &
node
);

59 
NodeChªgeC®lBack
(
»t


60 , 
ldd
::
cour›r
::
NodeChªgedTy³
 
ty³


61 , cÚ¡ 
¡d
::
¡ršg
& 
node
);

63 
	g´iv©e
:

65 
ldd
::
Ãt
::
Cl›Á
* 
ş›Á_
;

66 
	gldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ_
;

67 
	gldd
::
Ãt
::
Cl›Á
::
O±iÚs
 
İtiÚ_
;

69 
	gboo¡
::
sh¬ed_±r
<
ldd
::
cour›r
::
CÚfigu»
> 
cÚfigu»_
;

72 
	gldd
::
ut
::
RWMu‹x
 
rw_mu‹x_
;

73 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gboo¡
::
sh¬ed_±r
<
ldd
::
Ãt
::
ChªÃl
> > 
nodes_
;

75 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gšt64_t
> 
	g»ad_¡©_
;

76 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gšt64_t
> 
	gwr™e_¡©_
 ;

79 
	gpul£_š‹rv®_
;

81 
	g¡d
::
¡ršg
 
home_ho¡_pÜt_
;

82 
	g¡d
::
¡ršg
 
zook“³r_ho¡_
;

83 
	g¡d
::
¡ršg
 
zook“³r_roÙ·th_
;

84 
	gzook“³r_timeout_
;

85 
	gldd
::
cour›r
::
O±iÚs
 
cour›r_İtiÚ_
;

87 
	g»cv_timeout_
;

88 
	gdÚe_timeout_
;

89 
	grŞe_ty³_
;

90 
boŞ
 
	g´oxy_¡©_
;

	@/home/libin3-s/ldd/proxy/proxy_module.h

1 #iâdeà
__LDD__STORAGE_PROXY_MODULE_H_


2 
	#__LDD__STORAGE_PROXY_MODULE_H_


	)

5 
	~<¡ršg
>

6 
	~"ldd/sk–/moduË.h
"

10 
şass
 
	gProxy
;

11 şas 
	cProxyModuË
 : 
public
 
ldd
::
sk–
::
Sim¶eModuË
{

12 
public
:

13 
ProxyModuË
();

14 ~
ProxyModuË
();

15 
vœtu®
 
boŞ
 
In™ModuË
(
ModuËCtx
* 
ùx
);

18 
	m´iv©e
:

19 
Proxy
* 
´oxy_
;

20 
	mli¡’_pÜt_
;

21 
	mth»ad_numb”_
;

23 
	m¡d
::
¡ršg
 
zook“³r_ho¡_
;

24 
	m¡d
::
¡ršg
 
zook“³r_roÙ·th_
;

25 
	mzook“³r_timeout_
;

	@/home/libin3-s/ldd/proxy/proxy_type.h

3 #iâdeà
__PROXY_TYPE_H__


4 
	#__PROXY_TYPE_H__


	)

7 
	eCodeE¼Ü
{

8 
	mkOk
 = 0,

10 
	mkProxyFaed
 = -701,

11 
	mkProxyTimedOut
 = -702,

12 
	mkProxyCªûËd
 = -703,

14 
	mkNÙV®idNameS·û
 = -704,

15 
	mkNÙV®idBuck‘Id
 = -705,

16 
	mkNÙV®idF¬mId
 = -706,

	@/home/libin3-s/ldd/proxy/test/ut_append.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

3 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

4 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

5 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

9 
şass
 
	gAµ’d
 :

10 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_APPEND
>{

11 
public
:

12 
Aµ’d
(cÚ¡ 
ldd
::
´ÙocŞ
::
AtomicAµ’dMes§ge
 &
»q
è: 
»q_
(req) {}

13 
vœtu®
 ~
Aµ’d
() {}

15 
´Ùeùed
:

16 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

17 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

18 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

19 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

20 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

21 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

23 
	g´iv©e
:

24 
ldd
::
´ÙocŞ
::
AtomicAµ’dMes§ge
 
»q_
;

25 
	gldd
::
´ÙocŞ
::
CasRe¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/proxy/test/ut_check.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

3 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

4 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

5 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

9 
şass
 
	gCheck
 :

10 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_CHECK
>{

11 
public
:

12 
Check
(cÚ¡ 
ldd
::
´ÙocŞ
::
CheckMes§ge
 &
»q
è: 
»q_
(req) {}

13 
vœtu®
 ~
Check
() {}

15 
´Ùeùed
:

16 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

17 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

18 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

19 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

20 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

21 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

24 
	g´iv©e
:

25 
ldd
::
´ÙocŞ
::
CheckMes§ge
 
»q_
;

26 
	gldd
::
´ÙocŞ
::
CheckRe¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/proxy/test/ut_get.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

2 
	~"ldd/ut/mu‹x.h
"

3 
	~<sys/time.h
>

5 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

6 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

9 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

11 
şass
 
	gG‘
 :

12 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_GET
>{

13 
public
:

14 
G‘
(cÚ¡ 
ldd
::
´ÙocŞ
::
G‘Mes§ge
 &
»q
è: 
»q_
(req) {}

15 
vœtu®
 ~
G‘
() {}

17 
´Ùeùed
:

18 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

19 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

20 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

21 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

22 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

23 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

25 
	g´iv©e
:

26 
ldd
::
´ÙocŞ
::
G‘Mes§ge
 
»q_
;

27 
	gldd
::
´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/proxy/test/ut_incr.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

3 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

4 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

5 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

9 
şass
 
	gInü
 :

10 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_ATOMIC_INCR
>{

11 
public
:

12 
Inü
(cÚ¡ 
ldd
::
´ÙocŞ
::
AtomicInüMes§ge
 &
»q
è: 
»q_
(req) {}

13 
vœtu®
 ~
Inü
() {}

15 
´Ùeùed
:

16 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

17 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

18 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

19 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

20 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

21 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

23 
	g´iv©e
:

24 
ldd
::
´ÙocŞ
::
AtomicInüMes§ge
 
»q_
;

25 
	gldd
::
´ÙocŞ
::
CasRe¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/proxy/test/ut_list.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

2 
	~"ldd/ut/mu‹x.h
"

3 
	~<sys/time.h
>

5 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

6 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

7 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

9 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

11 
şass
 
	gLi¡
 :

12 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_LIST
>{

13 
public
:

14 
Li¡
(cÚ¡ 
ldd
::
´ÙocŞ
::
Li¡Mes§ge
 &
»q
è: 
»q_
(req) {}

15 
vœtu®
 ~
Li¡
() {}

17 
´Ùeùed
:

18 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

19 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

20 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

21 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

22 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

23 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

25 
	g´iv©e
:

26 
ldd
::
´ÙocŞ
::
Li¡Mes§ge
 
»q_
;

27 
	gldd
::
´ÙocŞ
::
G‘OrLi¡Re¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/proxy/test/ut_put.h

1 
	~"ldd/Ãt/outgošg_msg.h
"

3 
	~"ldd/´ÙocŞ/ş›Á/commªd_ty³.h
"

4 
	~"ldd/´ÙocŞ/ş›Á/´Ùo.h
"

5 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

9 
şass
 
	gPut
 :

10 
public
 
Ty³dOutgošgMsg
<
LDD_CLIENT_2_PROXY_MUTATE
>{

11 
public
:

12 
Put
(cÚ¡ 
ldd
::
´ÙocŞ
::
Mu‹Mes§ge
 &
»q
è: 
»q_
(req) {}

13 
vœtu®
 ~
Put
() {}

16 
´Ùeùed
:

17 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

18 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

19 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

20 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

21 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

22 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

24 
	g´iv©e
:

25 
ldd
::
´ÙocŞ
::
Mu‹Mes§ge
 
»q_
;

26 
	gldd
::
´ÙocŞ
::
Mu‹Re¥Ú£
 
»s_
;

	@/home/libin3-s/ldd/skel/internal/child.h

4 #iâdeà
LDD_SKEL_CHILD_H_


5 
	#LDD_SKEL_CHILD_H_


	)

7 
	~<ldd/Ãt/ev’t_loİ.h
>

8 
	~<ldd/Ãt/ev’t.h
>

9 
	~<ldd/Ãt/li¡’”.h
>

10 
	~"ldd/sk–/moduË.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gsk–
 {

15 
	gboo¡
::
	t±r_m­
<, 
	tÃt
::
	tLi¡’”
> 
	tLi¡’”M­
;

17 
şass
 
	gCÚfig
;

19 şas 
	cChd
 {

20 
	gpublic
:

21 
Chd
(
CÚfig
* 
cÚfig
, 
ModuË
::
Ty³
 
ty³
);

22 
	gvœtu®
 ~
Chd
();

24 
boŞ
 
In™
();

25 
Run
();

26 
	g´Ùeùed
:

27 
ModuË
* 
moduË
(ècÚ¡ {  
moduË_
; }

28 
CÚfig
* 
cÚfig
(ècÚ¡ {  
	gcÚfig_
; }

29 
	gModuË
::
Ty³
 
ty³
(ècÚ¡ {  
ty³_
; }

30 cÚ¡ 
	g¡d
::
¡ršg
& 
t™Ë
(ècÚ¡ {  
t™Ë_
; }

31 
£t_t™Ë
(cÚ¡ 
¡d
::
¡ršg
& 
t™Ë
è{ 
t™Ë_
 =itle; }

33 
vœtu®
 
boŞ
 
DoIn™
() = 0;

34 
vœtu®
 
DoRun
() = 0;

35 
vœtu®
 
DoCËªUp
() {}

36 
vœtu®
 
HªdËChd
();

37 
	g´iv©e
:

38 
boŞ
 
O³nModuË
();

39 
HªdËSigÇl
(
sig
);

40 
HªdËStİ
();

42 * 
	gdlmoduË_
;

43 
ModuË
* 
	gmoduË_
;

44 
CÚfig
* 
	gcÚfig_
;

45 
	gModuË
::
Ty³
 
ty³_
;

47 
	g¡d
::
¡ršg
 
t™Ë_
;

48 
	g´Ùeùed
:

49 
Ãt
::
Ev’tLoİ
* 
loİ_
;

50 
	gÃt
::
SigÇlEv’t
* 
sigev_
;

53 şas 
	cSšgËPÜtChd
 : 
public
 
Chd
 {

54 
public
:

55 
SšgËPÜtChd
(
CÚfig
* 
cÚfig
, 
ModuË
::
Ty³
 
ty³
,

56 
pÜt
, 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
);

57 
	g´Ùeùed
:

58 
pÜt
(ècÚ¡ {  
pÜt_
; }

59 
	gldd
::
Ãt
::
Li¡’”
* 
li¡’”
(ècÚ¡ {  
li¡’”_
; }

60 
	g´iv©e
:

61 
pÜt_
;

62 
	gldd
::
Ãt
::
Li¡’”
* 
li¡’”_
;

65 şas 
	cSim¶eChd
 : 
public
 
SšgËPÜtChd
 {

66 
public
:

67 
Sim¶eChd
(
CÚfig
* 
cÚfig
, 
pÜt
, 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
);

68 ~
Sim¶eChd
();

69 
	g´iv©e
:

70 
vœtu®
 
boŞ
 
DoIn™
();

71 
vœtu®
 
DoRun
();

73 
Sim¶eModuË
* 
moduË
() const {

74  
	gdyÇmic_ÿ¡
<
	gSim¶eModuË
*>(
	gChd
::
moduË
());

78 şas 
	cWÜk”Chd
 : 
public
 
SšgËPÜtChd
 {

79 
public
:

80 
WÜk”Chd
(
CÚfig
* 
cÚfig
, 
pÜt
,

81 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
);

82 ~
WÜk”Chd
();

83 
	g´iv©e
:

84 
vœtu®
 
boŞ
 
DoIn™
();

85 
vœtu®
 
DoRun
();

86 
vœtu®
 
DoCËªUp
();

87 
vœtu®
 
HªdËChd
();

88 
WÜk”ModuË
* 
moduË
() const {

89  
	gdyÇmic_ÿ¡
<
	gWÜk”ModuË
*>(
	gChd
::
moduË
());

91 
RunWÜk”
();

92 
ReboÙWÜk”
();

93 
	g´iv©e
:

94 
Ãt
::
Ev’tLoİ
* 
mloİ_
;

95 
	gÃt
::
Ev’tLoİ
* 
wloİ_
;

96 
pid_t
 
	gwÜk”_
;

97 
	gÃt
::
Tim”Ev’t
* 
tim”_
;

100 şas 
	cSšgËMa¡”Chd
 : 
public
 
Chd
 {

101 
public
:

102 
SšgËMa¡”Chd
(
CÚfig
* 
cÚfig
, 
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
,

103 
boo¡
::
±r_m­
<, 
ldd
::
Ãt
::
Li¡’”
>& 
li¡’”s
);

104 ~
SšgËMa¡”Chd
();

105 
vœtu®
 
boŞ
 
DoIn™
();

106 
vœtu®
 
DoRun
();

107 
vœtu®
 
DoCËªUp
();

108 
vœtu®
 
HªdËChd
();

109 
	g´iv©e
:

110 
SšgËMa¡”ModuË
* 
moduË
() const {

111  
dyÇmic_ÿ¡
<
SšgËMa¡”ModuË
*>(
Chd
::
moduË
());

113 
RunWÜk”s
();

114 
RunWÜk”
(
pÜt
);

115 
ReboÙWÜk”
(
pÜt
);

116 
	g´iv©e
:

117 
boo¡
::
±r_m­
<, 
	gldd
::
Ãt
::
Li¡’”
>& 
li¡’”s_
;

118 
	gÃt
::
Ev’tLoİ
* 
mloİ_
;

119 
	gÃt
::
Ev’tLoİ
* 
wloİ_
;

120 
	g¡d
::
m­
<
pid_t
, > 
	gwÜk”s_
;

121 
	g¡d
::
m­
<, 
	gÃt
::
Tim”Ev’t
*> 
tim”s_
;

	@/home/libin3-s/ldd/skel/internal/config.h

4 #iâdeà
LDD_SKEL_CONFIG_H_


5 
	#LDD_SKEL_CONFIG_H_


	)

7 
	~<£t
>

8 
	~"ldd/sk–/moduË.h
"

9 
	~"ldd/Ãt/add»ss.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gsk–
 {

14 
usšg
 
	gboo¡
::
´İ”ty_Œ“
::
±»e
;

16 
	sR–ßd
 {

17 
	ePŞicy
 {

18 
	gkPŞicySim¶e
,

19 
	gkPŞicySaã
,

20 
	gkPŞicySŞe
,

25 şas 
	cCÚfig
 {

26 
	gpublic
:

27 
ex¶ic™
 
CÚfig
();

28 ~
CÚfig
();

30 
boŞ
 
In™
(
¡d
::
¡ršg
* 
wh©
);

32 cÚ¡ 
	g¡d
::
¡ršg
& 
fe
(ècÚ¡ {  
fe_
; }

33 cÚ¡ 
	g¡d
::
£t
<>& 
pÜts
(ècÚ¡ {  
pÜts_
; }

34 cÚ¡ 
	gÃt
::
Add»ss
& 
addr
(ècÚ¡ {  
addr_
; }

35 cÚ¡ 
	g¡d
::
¡ršg
& 
u£r
(ècÚ¡ {  
u£r_
; }

36 
	gModuË
::
Ty³
 
ty³
(ècÚ¡ {  
ty³_
; }

37 
	gR–ßd
::
PŞicy
 
»lßd_pŞicy
(ècÚ¡ {  
»lßd_pŞicy_
; }

38 
š™_timeout
(ècÚ¡ {  
	gš™_timeout_
; }

39 
¡İ_timeout
(ècÚ¡ {  
	g¡İ_timeout_
; }

40 
»boÙ_d–ay
(ècÚ¡ {  
	g»boÙ_d–ay_
; }

41 
boŞ
 
auto_»¡¬t
(ècÚ¡ {  
	gauto_»¡¬t_
; }

42 
log_Ëv–
(ècÚ¡ {  
	glog_Ëv–_
; }

43 
log_æush
(ècÚ¡ {  
	glog_æush_
; }

44 
log_size
(ècÚ¡ {  
	glog_size_
; }

46 cÚ¡ 
	g±»e
& 
´İ”t›s
(ècÚ¡ {  
	g´İ”t›s_
; }

47 
	g´iv©e
:

48 
¡d
::
¡ršg
 
fe_
;

49 
	g¡d
::
£t
<> 
pÜts_
;

50 
	g¡d
::
¡ršg
 
u£r_
;

51 
	gÃt
::
Add»ss
 
addr_
;

52 
	gModuË
::
Ty³
 
ty³_
;

53 
	gR–ßd
::
PŞicy
 
»lßd_pŞicy_
;

54 
	gš™_timeout_
;

55 
	g¡İ_timeout_
;

56 
	g»boÙ_d–ay_
;

57 
boŞ
 
	gauto_»¡¬t_
;

58 
	glog_Ëv–_
;

59 
	glog_æush_
;

60 
	glog_size_
;

61 
±»e
 
	g´İ”t›s_
;

	@/home/libin3-s/ldd/skel/internal/context.h

4 #iâdeà
LDD_SKEL_CONTEXT_H_


5 
	#LDD_SKEL_CONTEXT_H_


	)

7 
	~<ldd/Ãt/ev’t_loİ.h
>

8 
	~<ldd/Ãt/li¡’”.h
>

9 
	~"ldd/sk–/moduË.h
"

10 
	~"cÚfig.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gsk–
 {

16 şas 
	cBa£ModuËCtx
 : 
vœtu®
 
public
 
ModuË
::
ModuËCtx
{

17 
public
:

18 
Ba£ModuËCtx
(
CÚfig
* 
cÚfig
, 
ldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
)

19 : 
cÚfig_
(
cÚfig
), 
ev’t_loİ_
(
ev’t_loİ
) {}

20 
vœtu®
 cÚ¡ 
	g±»e
& 
cÚfig
(ècÚ¡ {  
	gcÚfig_
->
´İ”t›s
(); }

21 
vœtu®
 
	gldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
(ècÚ¡ {  
ev’t_loİ_
; }

22 
vœtu®
 cÚ¡ 
	gÃt
::
Add»ss
& 
addr
(ècÚ¡ {  
cÚfig_
->addr(); }

23 
	g´iv©e
:

24 
CÚfig
* 
cÚfig_
;

25 
	gldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ_
;

28 
şass
 
	gSim¶eModuËCtx
 : 
public
 
Sim¶eModuË
::
ModuËCtx
,…ubliø
	gBa£ModuËCtx
 {

29 
	gpublic
:

30 
Sim¶eModuËCtx
(
CÚfig
* 
cÚfig
, 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
, 
pÜt
)

31 : 
Ba£ModuËCtx
(
cÚfig
, 
li¡’”
->
ev’t_loİ
()),

32 
li¡’”_
(
li¡’”
), 
pÜt_
(
pÜt
) {}

33 
vœtu®
 
	gÃt
::
Li¡’”
* 
li¡’”
(ècÚ¡ {  
li¡’”_
; }

34 
vœtu®
 
pÜt
(ècÚ¡ {  
	gpÜt_
; }

35 
	g´iv©e
:

36 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”_
;

37 
	gpÜt_
;

40 
şass
 
	gWÜk”ModuËCtx
 : 
public
 
WÜk”ModuË
::
ModuËCtx
,…ubliø
	gBa£ModuËCtx
 {

41 
	gpublic
:

42 
WÜk”ModuËCtx
(
CÚfig
* 
cÚfig
, 
ldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, 
pÜt
)

43 : 
Ba£ModuËCtx
(
cÚfig
, 
ev’t_loİ
), 
pÜt_
(
pÜt
) {}

44 
vœtu®
 
pÜt
(ècÚ¡ {  
	gpÜt_
; }

45 
	g´iv©e
:

46 
pÜt_
;

49 
şass
 
	gSšgËMa¡”ModuËCtx
 : 
public
 
SšgËMa¡”ModuË
::
ModuËCtx
,

50 
public
 
	gBa£ModuËCtx
 {

51 
	gpublic
:

52 
SšgËMa¡”ModuËCtx
(
CÚfig
* 
cÚfig
, 
ldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
,

53 cÚ¡ 
¡d
::
£t
<>& 
pÜts
)

54 : 
Ba£ModuËCtx
(
cÚfig
, 
ev’t_loİ
), 
pÜts_
(
pÜts
) {}

55 
vœtu®
 cÚ¡ 
	g¡d
::
£t
<>& 
pÜts
(ècÚ¡ {  
pÜts_
; }

56 
	g´iv©e
:

57 
¡d
::
£t
<> 
pÜts_
;

62 şas 
	cBa£WÜk”Ctx
 : 
vœtu®
 
public
 
ModuË
::
WÜk”Ctx
 {

63 
public
:

64 
Ba£WÜk”Ctx
(
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
)

65 : 
li¡’”_
(
li¡’”
) {}

66 
vœtu®
 
ldd
::
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
() const {

67  
li¡’”_
->
ev’t_loİ
();

69 
vœtu®
 
	gÃt
::
Li¡’”
* 
li¡’”
() const {

70  
li¡’”_
;

72 
	g´iv©e
:

73 
ldd
::
Ãt
::
Li¡’”
* 
li¡’”_
;

76 
şass
 
	gWÜk”WÜk”Ctx
 : 
public
 
WÜk”ModuË
::
WÜk”Ctx
,…ubliø
	gBa£WÜk”Ctx
 {

77 
	gpublic
:

78 
WÜk”WÜk”Ctx
(
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
)

79 : 
Ba£WÜk”Ctx
(
li¡’”
) {}

82 
şass
 
	gSšgËMa¡”WÜk”Ctx
 : 
public
 
SšgËMa¡”ModuË
::
WÜk”Ctx
,

83 
public
 
	gBa£WÜk”Ctx
 {

84 
	gpublic
:

85 
SšgËMa¡”WÜk”Ctx
(
ldd
::
Ãt
::
Li¡’”
* 
li¡’”
, 
pÜt
)

86 : 
Ba£WÜk”Ctx
(
li¡’”
), 
pÜt_
(
pÜt
) {}

87 
vœtu®
 
pÜt
(ècÚ¡ {  
	gpÜt_
; }

88 
	g´iv©e
:

89 
pÜt_
;

	@/home/libin3-s/ldd/skel/internal/log_flusher.h

4 #iâdeà
LDD_SKEL_INTERNAL_LOG_FLUSHER_H_


5 
	#LDD_SKEL_INTERNAL_LOG_FLUSHER_H_


	)

7 
	~<ldd/Ãt/ev’t.h
>

8 
	~<ldd/Ãt/ev’t_loİ.h
>

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gsk–
 {

13 şas 
	cLogFlush”
 {

14 
	gpublic
:

15 
LogFlush”
(
Ãt
::
Ev’tLoİ
* 
ev’t_loİ
, 
£cÚds
, 
boŞ
 
¡¬t
 = 
Œue
);

16 ~
LogFlush”
();

18 
S¹
();

19 
Stİ
();

21 
£t_£cÚds
(
£cÚds
è{ 
	g£cÚds_
 = seconds; }

22 
	g´iv©e
:

23 
Flush
();

24 
	gÃt
::
Tim”Ev’t
 
tim”_
;

25 
	g£cÚds_
;

	@/home/libin3-s/ldd/skel/internal/monitor.h

4 #iâdeà
LDD_SKEL_MONITOR_H_


5 
	#LDD_SKEL_MONITOR_H_


	)

7 
	~<boo¡/scİed_±r.hµ
>

8 
	~<boo¡/sh¬ed_±r.hµ
>

9 
	~<boo¡/±r_cÚš”/±r_m­.hµ
>

10 
	~<ldd/ut/©omic.h
>

11 
	~<ldd/Ãt/ev’t_loİ.h
>

12 
	~<ldd/Ãt/li¡’”.h
>

13 
	~<ldd/Ãt/ev’t.h
>

14 
	~"cÚfig.h
"

16 
Çme¥aû
 
	gldd
 {

17 
Çme¥aû
 
	gsk–
 {

19 
	gboo¡
::
	t±r_m­
<, 
	tÃt
::
	tLi¡’”
> 
	tLi¡’”M­
;

21 
şass
 
	gLogFlush”
;

23 şas 
	cMÚ™Ü
 {

24 
	gpublic
:

25 
MÚ™Ü
();

26 ~
MÚ™Ü
();

27 
boŞ
 
In™
(
¬gc
, ** 
¬gv
);

28 
Run
();

29 
	g´iv©e
:

30 
RunMa¡”s
();

31 
RunMa¡”
(
pÜt
);

32 
RunMa¡”
();

33 
W©chSigÇls
();

34 
Loİ
();

35 
StİChd»n
();

36 
StİChd
();

37 
HªdËSigÇl
(
sig
);

38 
HªdËStİ
();

39 
HªdËChd
();

40 
HªdËChd»n
();

41 
HªdËR–ßd
();

42 
ChªgeU£r
();

43 
DoR–ßd
();

44 
R–ßdSšgËChd
();

45 
R–ßdMuÉiChd
();

49 
DrİChd
(
pid_t
 
pid
, 
pÜt
 = 0);

50 
OnDrİChdTimeout
(
pid_t
 
pid
);

51 
boŞ
 
IsDrİ³d
(
pid_t
 
pid
, * 
pÜt
 = 
NULL
);

52 
CË¬Drİ³d
(
pid_t
 
pid
);

53 
OnSšgËMa¡”In™
(
ev
, 
fd
);

55 
	gboo¡
::
sh¬ed_±r
<
CÚfig
> 
cÚfig_
;

56 
	gboo¡
::
scİed_±r
<
Ãt
::
Ev’tLoİ
> 
mloİ_
;

57 
	gboo¡
::
scİed_±r
<
Ãt
::
Ev’tLoİ
> 
şoİ_
;

58 
	gboo¡
::
scİed_±r
<
Ãt
::
SigÇlEv’t
> 
sigev_
;

59 
	gboo¡
::
±r_m­
<, 
	gÃt
::
Li¡’”
> 
li¡’”s_
;

60 
	gboo¡
::
scİed_±r
<
LogFlush”
> 
æush”_
;

63 
pid_t
 
	gchd_
;

64 
pid_t
 
	gÃw_chd_
;

65 
	gboo¡
::
scİed_±r
<
Ãt
::
Tim”Ev’t
> 
»boÙ_tim”_
;

66 
	gboo¡
::
scİed_±r
<
Ãt
::
FdEv’t
> 
ev’t_
;

69 
	g¡d
::
m­
<
pid_t
, > 
	gchd»n_
;

70 
	gboo¡
::
±r_m­
<, 
	gÃt
::
Tim”Ev’t
> 
»boÙ_tim”s_
;

73 
	gboo¡
::
sh¬ed_±r
<
CÚfig
> 
rcÚfig_
;

76 
	gboo¡
::
±r_m­
<
pid_t
, 
	gÃt
::
Tim”Ev’t
> 
drİ³d_chd»n_
;

77 
	g¡d
::
m­
<
pid_t
, > 
	gdrİ³d_pÜts_
;

	@/home/libin3-s/ldd/skel/internal/option.h

4 #iâdeà
LDD_SKEL_OPTION_H_


5 
	#LDD_SKEL_OPTION_H_


	)

7 
	~<boo¡/nÚcİyabË.hµ
>

8 
	~<boo¡/´og¿m_İtiÚs.hµ
>

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gsk–
 {

13 cÚ¡ 
	gkDeçuÉIn™Timeout
 = 5;

14 cÚ¡ 
	gkDeçuÉStİTimeout
 = 5;

15 cÚ¡ 
	gkDeçuÉReboÙD–ay
 = 1;

18 şas 
	cO±iÚ
 : 
boo¡
::
nÚcİyabË
 {

19 
public
:

20 
O±iÚ
();

21 ~
O±iÚ
();

23 
boŞ
 
In™
(
¬gc
, ** 
¬gv
);

25 cÚ¡ 
	g¡d
::
¡ršg
& 
Çme
(ècÚ¡ {  
Çme_
; }

26 
boŞ
 
kl
(ècÚ¡ {  
	gkl_
; }

27 
boŞ
 
»lßd
(ècÚ¡ {  
	g»lßd_
; }

28 
boŞ
 
¡©us
(ècÚ¡ {  
	g¡©us_
; }

29 
boŞ
 
fÜeground
(ècÚ¡ {  
	gfÜeground_
; }

30 cÚ¡ 
	g¡d
::
¡ršg
& 
log_dœ
(ècÚ¡ {  
log_dœ_
; }

31 cÚ¡ 
	g¡d
::
¡ršg
& 
lib_dœ
(ècÚ¡ {  
lib_dœ_
; }

32 cÚ¡ 
	g¡d
::
¡ršg
& 
pid_fe
(ècÚ¡ {  
pid_fe_
; }

33 cÚ¡ 
	g¡d
::
¡ršg
& 
cfg_fe
(ècÚ¡ {  
cfg_fe_
; }

35 cÚ¡ 
	gboo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
&

36 
vm
(ècÚ¡ {  
vm_
; }

38 
MakeCÚfigs
(

39 
boo¡
::
´og¿m_İtiÚs
::
İtiÚs_desütiÚ
* 
İtiÚs
);

41 
	gO±iÚ
& 
š¡ªû
(è{  
	gš¡ªû_
; }

42 
	g´iv©e
:

43 
boo¡
::
´og¿m_İtiÚs
::
v¬ŸbËs_m­
 
vm_
;

46 
	g¡d
::
¡ršg
 
Çme_
;

47 
boŞ
 
	gkl_
;

48 
boŞ
 
	g»lßd_
;

49 
boŞ
 
	g¡©us_
;

50 
boŞ
 
	gfÜeground_
;

51 
	g¡d
::
¡ršg
 
log_dœ_
;

52 
	g¡d
::
¡ršg
 
lib_dœ_
;

53 
	g¡d
::
¡ršg
 
pid_fe_
;

54 
	g¡d
::
¡ršg
 
cfg_fe_
;

56 
O±iÚ
 
	gš¡ªû_
;

	@/home/libin3-s/ldd/skel/internal/proctitle.h

4 #iâdeà
LDD_SKEL_PROCTITLE_H_


5 
	#LDD_SKEL_PROCTITLE_H_


	)

7 
	~<¡ršg
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gsk–
 {

12 şas 
	cProcT™Ë
 {

13 
	gpublic
:

14 
boŞ
 
In™
(
¬gc
, ** 
¬gv
);

15 
S‘
(cÚ¡ 
¡d
::
¡ršg
& 
t™Ë
);

	@/home/libin3-s/ldd/skel/internal/skel.h

4 #iâdeà
LDD_SKEL_SKEL_H_


5 
	#LDD_SKEL_SKEL_H_


	)

7 
	~<¡ršg
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gsk–
 {

12 
şass
 
	gMÚ™Ü
;

14 şas 
	cSk–
 {

15 
	gpublic
:

16 
Sk–
();

17 ~
Sk–
();

19 
boŞ
 
In™
(
¬gc
, ** 
¬gv
);

20 
Run
();

21 
	g´iv©e
:

22 
RunFÜeground
();

23 
RunAsD«mÚ
();

24 
RunMÚ™Ü
();

25 
KlD«mÚ
();

26 
R–ßdD«mÚ
();

27 
CheckStus
();

29 
MÚ™Ü
* 
	gmÚ™Ü_
;

	@/home/libin3-s/ldd/skel/module.h

4 #iâdeà
LDD_SKEL_MODULE_H_


5 
	#LDD_SKEL_MODULE_H_


	)

7 
	~<£t
>

8 
	~<boo¡/´İ”ty_Œ“/±»e.hµ
>

9 
	~<boo¡/±r_cÚš”/±r_m­.hµ
>

10 
	~<ldd/Ãt/li¡’”.h
>

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gsk–
 {

15 şas 
	cModuË
 {

16 
	gpublic
:

17 
boo¡
::
	t´İ”ty_Œ“
::
	t±»e
 
	tCÚfig
;

18 
	eTy³
 {

19 
	gkTy³Sim¶e
,

20 
	gkTy³WÜk”
,

21 
	gkTy³SšgËMa¡”
,

23 
	sModuËCtx
 {

24 
	gvœtu®
 ~
ModuËCtx
() {}

25 
vœtu®
 cÚ¡ 
	gCÚfig
& 
cÚfig
() const = 0;

26 
vœtu®
 cÚ¡ 
	gÃt
::
Add»ss
& 
addr
() const = 0;

27 
vœtu®
 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ
() const = 0;

29 
	sWÜk”Ctx
 {

30 
	gvœtu®
 ~
WÜk”Ctx
() {}

31 
vœtu®
 
	gÃt
::
Ev’tLoİ
* 
ev’t_loİ
() const = 0;

32 
vœtu®
 
	gÃt
::
Li¡’”
* 
li¡’”
() const = 0;

34 
	gvœtu®
 ~
ModuË
() {}

35 
vœtu®
 
Ty³
 
ty³
() = 0;

42 şas 
	cSim¶eModuË
 : 
public
 
ModuË
 {

43 
public
:

44 
Ty³
 
ty³
(è{  
kTy³Sim¶e
; }

45 
	gModuËCtx
 : 
vœtu®
 
public
 
ModuË
::
ModuËCtx
 {

46 
vœtu®
 
Ãt
::
Li¡’”
* 
li¡’”
() const = 0;

47 
vœtu®
 
pÜt
() const = 0;

50 
vœtu®
 
boŞ
 
In™ModuË
(
ModuËCtx
* 
ùx
) = 0;

53 şas 
	cWÜk”ModuË
 : 
public
 
ModuË
 {

54 
public
:

55 
Ty³
 
ty³
(è{  
kTy³WÜk”
; }

56 
	gModuËCtx
 : 
vœtu®
 
public
 
ModuË
::
ModuËCtx
 {

57 
vœtu®
 
pÜt
() const = 0;

59 
	gWÜk”Ctx
 : 
vœtu®
 
public
 
ModuË
::
WÜk”Ctx
 {

62 
vœtu®
 
boŞ
 
In™ModuË
(
ModuËCtx
* 
ùx
) = 0;

63 
vœtu®
 
boŞ
 
In™WÜk”
(
WÜk”Ctx
* 
ùx
) = 0;

72 şas 
	cSšgËMa¡”ModuË
 : 
public
 
ModuË
 {

73 
public
:

74 
Ty³
 
ty³
(è{  
kTy³SšgËMa¡”
; }

75 
	gModuËCtx
 : 
vœtu®
 
public
 
ModuË
::
ModuËCtx
 {

76 
vœtu®
 cÚ¡ 
¡d
::
£t
<>& 
pÜts
() const = 0;

78 
	gWÜk”Ctx
 : 
vœtu®
 
public
 
ModuË
::
WÜk”Ctx
 {

79 
vœtu®
 
pÜt
() const = 0;

82 
vœtu®
 
boŞ
 
In™ModuË
(
ModuËCtx
* 
ùx
) = 0;

83 
vœtu®
 
boŞ
 
In™WÜk”
(
WÜk”Ctx
* 
ùx
) = 0;

89 
	#LDD_SKEL_SIMPLE_MODULE
(
M
) \

90 "C" ::
ldd
::
sk–
::
Sim¶eModuË
* 
	`LddSk–_NewSim¶eModuË
() \

91 { 
Ãw
 
M
;}

	)

92 
	#LDD_SKEL_WORKER_MODULE
(
M
) \

93 "C" ::
ldd
::
sk–
::
WÜk”ModuË
* 
	`LddSk–_NewWÜk”ModuË
() \

94 { 
Ãw
 
M
;}

	)

95 
	#LDD_SKEL_SINGLE_MASTER_MODULE
(
M
) \

96 "C" ::
ldd
::
sk–
::
SšgËMa¡”ModuË
* 
	`LddSk–_NewSšgËMa¡”ModuË
()\

97 { 
Ãw
 
M
;}

	)

	@/home/libin3-s/ldd/store/config_manager.h

2 #iâdeà
_LDD_STORAGE_CONFIG_MANAGER_H_


3 
	#_LDD_STORAGE_CONFIG_MANAGER_H_


	)

6 
	~<m­
>

7 
	~<veùÜ
>

8 
	~<£t
>

9 
	~<¡ršg
>

10 
	~<boo¡/sh¬ed_±r.hµ
>

11 
	~<ldd/ut/©omic.h
>

12 
	~<ldd/ut/mu‹x.h
>

14 
	~"ldd/cour›r/cour›r.h
"

15 
	~"ldd/cour›r/k“³r.h
"

17 
	~"ldd/Ãt/chªÃl.h
"

18 
	~"ldd/Ãt/ev’t_loİ.h
"

19 
	~"ldd/Ãt/ş›Á.h
"

24 
usšg
 
Çme¥aû
 
	gldd
::
cour›r
;

25 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

28 
Çme¥aû
 
	gldd
{

29 
Çme¥aû
 
	g¡Üage
{

31 
şass
 
	gV”siÚInfoMes§geS
;

32 
şass
 
	gG‘V”siÚCÚ‹xt
;

33 
şass
 
	gDB
;

35 şas 
	cCÚfigMªag”
{

36 
	gpublic
:

37 
CÚfigMªag”
(
Ev’tLoİ
* 
–
, 
Cl›Á
::
O±iÚs
& 
İt
,

38 cÚ¡ 
¡d
::
¡ršg
& 
home_ho¡_pÜt
,

39 
boŞ
 
fÜû_cÚsi¡’cy
,

40 
»cv_timeout
,

41 
dÚe_timeout
,

42 
´•¬e_š‹rv®
);

43 ~
CÚfigMªag”
();

45 
	gpublic
:

46 
S‘UpCour›r
(
O±iÚs
& 
İtiÚ
, 
¡d
::
¡ršg
& 
cour›r_ho¡_pÜt
,

47 
¡d
::
¡ršg
& 
cour›r_roÙ_·th
);

48 
V”siÚInfoC®lBack
(
¡d
::
¡ršg
& 
ho¡_pÜt
, 
št64_t
 
v”siÚ
);

49 
	g¡d
::
¡ršg
& 
G‘HomeHo¡PÜt
();

54 
	sNT
{

55 
NT
():
have_echo
(0), 
v”siÚ
(0), 
echo_time
(0){

56 
	gchªÃl
.
»£t
();

59 
	g¡d
::
¡ršg
 
ho¡_pÜt
;

60 
ušt8_t
 
	ghave_echo
;

61 
št64_t
 
	gv”siÚ
;

62 
ušt64_t
 
	gecho_time
;

63 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
> 
chªÃl
;

65 }
	tNÙifiÿtiÚ
;

70 cÚ¡ 
	g¡d
::
veùÜ
<
boo¡
::
sh¬ed_±r
<
ChªÃl
> >* 
G‘SÏveChªÃls
();

71 
boŞ
 
IsMa¡”
();

72 cÚ¡ 
	g¡d
::
£t
<
ušt16_t
>& 
G‘Buck‘IdS‘
();

73 
S‘Db
(
DB
* 
db_im¶
){

74 
	gdb_im¶_
 = 
db_im¶
;

77 
DB
* 
G‘Db
(){

78  
	gdb_im¶_
;

81 
	eRŞeTy³
{

82 
	gkTy³FromSÏve
 = 1,

83 
	gkTy³FromMa¡”
= 2

86 
RŞeTy³
 
G‘FromTy³ofMa¡”
(){

87  
	gkTy³FromMa¡”
;

90 
boŞ
 
IsFromMa¡”
(
ušt8_t
 
e
 ){

91 ià((
	gRŞeTy³
)
	ge
 =ğ
kTy³FromMa¡”
){

92  
Œue
;

94  
	gçl£
;

97 
	eS–eùiÚTy³
{

98 
	gkNuÎ
,

99 
	gkOnS–eùšg
,

100 
	gkDÚe
,

101 
	gkP”ãù
,

103 
boŞ
 
IsR—dy
();

105 
g‘_»cv_timeout
(){

106  
	g»cv_timeout_
;

109 
g‘_dÚe_timeout
(){

110  
	gdÚe_timeout_
;

113 
S‘P»·»Time
(
št64_t
 
t
);

114 
boŞ
 
N“dDoP»·»
();

116 
	g´iv©e
:

117 
CÚfigMªag”
(const ConfigManager&);

118 
	gCÚfigMªag”
& 
	gİ”©Ü
=(cÚ¡ 
CÚfigMªag”
&);

120 
G‘RŞesHªdËr
(
”r_code
, 
RŞes
& 
rŞes
);

121 
GÙL—d”ShHªdËr
(
”r_code
, 
boŞ
 
gÙ_Ëad”sh
);

122 
AliveNodeChªgedHªdËr
(
”r_code
, 
NodeChªgedTy³
 
ty³
,

123 cÚ¡ 
¡d
::
¡ršg
& 
node
);

125 
boŞ
 
CheckHi¡ÜyRŞes
();

126 
CË¬ChªÃls
();

127 
C»©eChªÃls
();

128 
S¹AssignRŞes
();

129 
DoAssignRŞes
();

130 
boŞ
 
AssignSÏveChªÃl
();

131 
boŞ
 
Com·»
(
CÚfigMªag”
::
NÙifiÿtiÚ
 
a
,

132 
CÚfigMªag”
::
NÙifiÿtiÚ
 
b
);

135 
	g´iv©e
:

136 
K“³r
* 
k“³r_
 ;

137 
	g¡d
::
¡ršg
 
cour›r_ho¡_pÜt_
;

138 
	g¡d
::
¡ršg
 
cour›r_roÙ_·th_
;

140 
	g»¶iÿ_size_
;

141 
	gbšlog_size_
;

142 
	gbuck‘_size_
;

143 
	g¡d
::
¡ršg
 
¡Üe_’gše_
;

144 
boŞ
 
	gIsCoÜdš©Ü_
;

145 
	gldd
::
ut
::
Mu‹x
 
mu‹x_
;

146 
	gldd
::
ut
::
CÚdV¬
 
cÚd_
;

147 
	gldd
::
ut
::
Atomic
<
S–eùiÚTy³
> 
£ËùiÚ_ty³_
;

149 
RŞes
 
	grŞes_
;

150 
	g¡d
::
¡ršg
 
home_ho¡_pÜt_
;

152 
	g¡d
::
veùÜ
<
¡d
::
¡ršg
> 
®ive_node_vec_
;

153 
	g¡d
::
m­
<
¡d
::
¡ršg
, 
	gCÚfigMªag”
::
NÙifiÿtiÚ
> 
®ive_node_m­_
;

154 
	g¡d
::
veùÜ
<
boo¡
::
sh¬ed_±r
<
ChªÃl
> > 
¦ave_chªÃls_
;

155 
	gldd
::
ut
::
Atomic
<
boŞ
> 
¦ave_chªÃl_£t_
;

157 
size_t
 
	gv”siÚ_»¥Ú£_size_
;

158 
	gCl›Á
::
O±iÚs
 
İtiÚ_
;

159 
Cl›Á
* 
	gş›Á_
;

160 
Ev’tLoİ
* 
	gev’t_loİ_
;

161 
DB
* 
	gdb_im¶_
;

163 
boŞ
 
	gis_ma¡”_
;

165 
boŞ
 
	gfÜû_cÚsi¡’cy_
;

166 
	g»cv_timeout_
;

167 
	gdÚe_timeout_
 ;

169 
	gut
::
Atomic
<
št64_t
> 
Ï¡_´•¬ed_MliSecÚd_
;

170 
št64_t
 
	g´•¬e_š‹rv®_
;

	@/home/libin3-s/ldd/store/context.h

1 #iâdeà
__LDD__STORAGE_CONTEXT_H_


2 
	#__LDD__STORAGE_CONTEXT_H_


	)

4 
	~<¡dšt.h
>

5 
	~"ldd/Ãt/·ylßd.h
"

6 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

7 
	~"ldd/Ãt/outgošg_msg.h
"

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	g´ÙocŞ
{

11 
şass
 
	gP»·»Mes§geS
;

12 
şass
 
	gMu‹Mes§geS
;

13 
şass
 
	gMes§ge
;

14 
şass
 
	gAtomicInüMes§geS
;

15 
şass
 
	gAtomicAµ’dMes§geS
;

16 
şass
 
	gMu‹Re¥Ú£
;

21 
Çme¥aû
 
	gldd
{

22 
Çme¥aû
 
	g¡Üage
{

24 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

25 
usšg
 
	gldd
::
´ÙocŞ
::
P»·»Mes§geS
;

26 
usšg
 
	gldd
::
´ÙocŞ
::
Mes§ge
;

27 
usšg
 
	gldd
::
´ÙocŞ
::
Mu‹Mes§geS
;

28 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicInüMes§geS
;

29 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicAµ’dMes§geS
;

30 
usšg
 
	gldd
::
´ÙocŞ
::
Mu‹Re¥Ú£
;

32 
şass
 
	gCÚfigMªag”
;

33 
şass
 
	gModifyBa£Task
;

34 
şass
 
	gJob
;

36 
şass
 
	gMu‹CÚ‹xt
 :

37 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_MUTATE
>{

38 
public
:

39 
Mu‹CÚ‹xt
(
CÚfigMªag”
* 
cm
, 
Job
* 
job
, 
Mes§ge
* 
gms
,

40 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

41 
»cv_timeout
, 
dÚe_timeout
);

42 
	gvœtu®
 ~
Mu‹CÚ‹xt
();

44 
	g´Ùeùed
:

45 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

46 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

47 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

48 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

49 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

50 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

52 
	g´iv©e
:

53 
CÚfigMªag”
* 
cm_
;

54 
Job
* 
	gjob_
;

55 
Mes§ge
* 
	ggms_
;

56 
	gÃt
::
Paylßd
 
·ylßd_
;

57 
	gÃt
::
Bufãr
 
bufãr_
;

58 
	g»cv_timeout_
;

59 
	gdÚe_timeout_
;

60 
št64_t
 
	gs64V”siÚ_
;

63 
şass
 
	gAtomicInüCÚ‹xt
 :

64 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_ATOMIC_INCR
>{

65 
public
:

66 
AtomicInüCÚ‹xt
(
CÚfigMªag”
* 
cm
, 
Job
* 
job
, 
Mes§ge
* 
gms
,

67 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

68 
»cv_timeout
, 
dÚe_timeout
) :

69 
cm_
(
cm
),

70 
job_
(
job
),

71 
gms_
(
gms
), 
·ylßd_
(
·ylßd
),

72 
»cv_timeout_
(
»cv_timeout
),
dÚe_timeout_
(
dÚe_timeout
) {

75 
	gvœtu®
 ~
AtomicInüCÚ‹xt
();

77 
	g´Ùeùed
:

78 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

79 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

80 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

81 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

82 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

83 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

85 
	g´iv©e
:

86 
CÚfigMªag”
* 
cm_
;

87 
Job
* 
	gjob_
;

88 
Mes§ge
* 
	ggms_
;

89 
	gÃt
::
Paylßd
 
·ylßd_
;

90 
	g»cv_timeout_
;

91 
	gdÚe_timeout_
;

94 
şass
 
	gAtomicAµ’dCÚ‹xt
 :

95 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_ATOMIC_APPEND
>{

96 
public
:

97 
AtomicAµ’dCÚ‹xt
(
CÚfigMªag”
* 
cm
, 
Job
* 
job
, 
Mes§ge
* 
gms
,

98 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

99 
»cv_timeout
, 
dÚe_timeout
) :

100 
cm_
(
cm
),

101 
job_
(
job
),

102 
gms_
(
gms
), 
·ylßd_
(
·ylßd
),

103 
»cv_timeout_
(
»cv_timeout
),

104 
dÚe_timeout_
(
dÚe_timeout
){

107 
	gvœtu®
 ~
AtomicAµ’dCÚ‹xt
();

109 
	g´Ùeùed
:

110 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

111 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

112 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

113 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

114 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

115 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

117 
	g´iv©e
:

118 
CÚfigMªag”
* 
cm_
;

119 
Job
* 
	gjob_
;

120 
Mes§ge
* 
	ggms_
;

121 
	gÃt
::
Paylßd
 
·ylßd_
;

122 
	g»cv_timeout_
;

123 
	gdÚe_timeout_
;

126 şas 
	cCÚ‹xtFaùÜy
{

127 
	gpublic
:

128 
boo¡
::
sh¬ed_±r
<
Ãt
::
OutgošgMsg
> 
MakeCÚ‹xt
(

129 
CÚfigMªag”
* 
cm
,

130 
Job
* 
job
,

131 
ty³
,

132 
´ÙocŞ
::
Mes§ge
* 
msg
,

133 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

134 
»cv_timeout
,

135 
dÚe_timeout
);

136 
	g´iv©e
:

137 
CÚ‹xtFaùÜy
();

138 
CÚ‹xtFaùÜy
(const ContextFactory&);

139 
	gCÚ‹xtFaùÜy
& 
	gİ”©Ü
=(cÚ¡ 
CÚ‹xtFaùÜy
&);

143 
şass
 
	gG‘V”siÚCÚ‹xt
 :

144 
public
 
Ty³dOutgošgMsg
<
LDD_STORE_2_STORE_GET_VERSION
>{

145 
public
:

146 
G‘V”siÚCÚ‹xt
(
CÚfigMªag”
* 
m
, cÚ¡ 
¡d
::
¡ršg
&
ho¡_pÜt
)

147 : 
mªag”_
(
m
), 
ho¡_pÜt_
(
ho¡_pÜt
){

150 
	gvœtu®
 ~
G‘V”siÚCÚ‹xt
();

152 
	g´Ùeùed
:

153 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

154 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

155 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

156 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

157 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

158 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

160 
	g´iv©e
:

161 
CÚfigMªag”
* 
mªag”_
;

162 
	g¡d
::
¡ršg
 
ho¡_pÜt_
;

163 
št64_t
 
	gv”siÚ
;

166 
şass
 
	gP»·»ResuÉH
;

167 
şass
 
	gP»·»CÚ‹xt
 :

168 
public
 
Ty³dOutgošgMsg
<
LDD_STORE_2_STORE_MUTATION_PREPARE
>{

169 
public
:

170 
P»·»CÚ‹xt
(
P»·»ResuÉH
* 
»suÉH
, 
P»·»Mes§geS
* 
pm
, 
ušt64_t
& 
v”siÚ
)

171 : 
´•¬e_»suÉ_
(
»suÉH
), 
pm_
(
pm
), 
v”siÚ_
(
v”siÚ
){

174 
	gvœtu®
 ~
P»·»CÚ‹xt
();

176 
	g´Ùeùed
:

177 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

178 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

179 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

180 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

181 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

182 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

184 
	g´iv©e
:

185 
P»·»ResuÉH
* 
´•¬e_»suÉ_
;

186 
P»·»Mes§geS
* 
	gpm_
;

187 
ušt64_t
 
	gv”siÚ_
;

191 şas 
	cP»·»ResuÉH
{

192 
	gpublic
:

193 
P»·»ResuÉH
(
CÚfigMªag”
* 
cÚfig_mªag”
, 
ModifyBa£Task
* 
sk
) :

194 
cÚfig_mªag”_
(
cÚfig_mªag”
), 
sk_
(
sk
),

195 
»suÉ_num_
(0), 
’abË_wr™e
(
Œue
){

197 
boŞ
 
S’dP»·»Mes§ge
(
ušt64_t
& 
v”siÚ
);

198 
boŞ
 
AddResuÉ
(boŞ 
right
);

199 
g‘_dÚe_timeout
();

200 
g‘_»cv_timeout
();

202 
	g´iv©e
:

203 
CÚfigMªag”
* 
cÚfig_mªag”_
;

204 
ModifyBa£Task
* 
	gsk_
;

205 
	g»suÉ_num_
;

206 
boŞ
 
	g’abË_wr™e
;

210 şas 
	cSynWr™eMes§geHªdË
{

211 
	gpublic
:

212 
SynWr™eMes§geHªdË
(
CÚfigMªag”
* 
cÚfig_mªag”
) :

213 
cÚfig_mªag”_
(
cÚfig_mªag”
){

215 ~
SynWr™eMes§geHªdË
(){};

217 
boŞ
 
SynToSÏves
(
Job
* 
job
, 
ty³
,

218 
Mes§ge
* 
msg
 , cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
);

219 
	g´iv©e
:

220 
CÚfigMªag”
* 
cÚfig_mªag”_
;

	@/home/libin3-s/ldd/store/db/db.h

4 #iâdeà
LDD_STORE_DB_H_


5 
	#LDD_STORE_DB_H_


	)

7 
	~<£t
>

8 
	~<xËv–db/¡©us.h
>

9 
	~"ldd/ut/¦iû.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	g¡Üage
 {

14 
	gusšg
 ::
ldd
::
ut
::
Sliû
;

16 
usšg
 
	gxËv–db
::
Stus
;

18 şas 
	cI‹¿tÜ
 {

19 
	gpublic
:

20 
I‹¿tÜ
() {}

21 
vœtu®
 ~
I‹¿tÜ
() {}

23 
vœtu®
 
boŞ
 
V®id
() const = 0;

24 
vœtu®
 
Next
() = 0;

25 
vœtu®
 
ušt16_t
 
buck‘
() const = 0;

26 
vœtu®
 
ušt16_t
 
domaš
() const = 0;

27 
vœtu®
 
Sliû
 
rowkey
() const = 0;

28 
vœtu®
 
Sliû
 
cŞumn
() const = 0;

29 
vœtu®
 
Sliû
 
v®ue
() const = 0;

30 
vœtu®
 
ušt64_t
 
£q
() const = 0;

31 
vœtu®
 
ušt64_t
 
‰l
() const = 0;

32 
vœtu®
 
Stus
 
¡©us
() const = 0;

33 
	g´iv©e
:

34 
I‹¿tÜ
(const Iterator&);

35 
	gİ”©Ü
=(cÚ¡ 
I‹¿tÜ
&);

38 şas 
	cDB
 {

39 
	gpublic
:

40 
DB
() {}

41 
vœtu®
 ~
DB
() {}

43 
vœtu®
 
In£¹Buck‘
(
ušt16_t
 
buck‘
) = 0;

44 
vœtu®
 
D–‘eBuck‘
(
ušt16_t
 
buck‘
) = 0;

46 
vœtu®
 
Stus
 
Put
(
ušt16_t
 
buck‘
, ušt16_ˆ
domaš
,

47 cÚ¡ 
Sliû
& 
rowkey
, cÚ¡ Sliû& 
cŞumn
,

48 cÚ¡ 
Sliû
& 
v®ue
, 
ušt64_t
* 
£q
, ušt64_ˆ
‰l
) = 0;

49 
vœtu®
 
Stus
 
D–
(
ušt16_t
 
buck‘
, ušt16_ˆ
domaš
,

50 cÚ¡ 
Sliû
& 
rowkey
, cÚ¡ Sliû& 
cŞumn
,

51 
ušt64_t
* 
£q
) = 0;

52 
vœtu®
 
Stus
 
G‘
(
ušt16_t
 
buck‘
, ušt16_ˆ
domaš
,

53 cÚ¡ 
Sliû
& 
rowkey
, cÚ¡ Sliû& 
cŞumn
,

54 
¡d
::
¡ršg
* 
v®ue
,

55 
ušt64_t
* 
£q
, ušt64_t* 
‰l
) = 0;

56 
vœtu®
 
ušt64_t
 
La¡Sequ’û
() = 0;

57 
vœtu®
 
I‹¿tÜ
* 
Li¡From
(
ušt16_t
 
domaš
,

58 cÚ¡ 
Sliû
& 
rowkey
, cÚ¡ Sliû& 
cŞumn
, 
lim™
) = 0;

59 
vœtu®
 
I‹¿tÜ
* 
Li¡Aá”
(
ušt16_t
 
domaš
,

60 cÚ¡ 
Sliû
& 
rowkey
, cÚ¡ Sliû& 
cŞumn
, 
lim™
) = 0;

63 
Stus
 
NewXLev–DB
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

64 cÚ¡ 
¡d
::
£t
<
ušt16_t
>& 
buck‘s
, 
DB
** 
db±r
);

66 
Stus
 
NewMemÜyDB
(cÚ¡ 
¡d
::
¡ršg
& 
·th
,

67 cÚ¡ 
¡d
::
£t
<
ušt16_t
>& 
buck‘s
, 
DB
** 
db±r
);

	@/home/libin3-s/ldd/store/db/util.h

4 #iâdeà
LDD_STORAGE_DB_UTIL_H_


5 
	#LDD_STORAGE_DB_UTIL_H_


	)

7 
	~<¡dšt.h
>

8 
	~"ldd/ut/¦iû.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	g¡Üage
 {

13 
	gusšg
 ::
ldd
::
ut
::
Sliû
;

15 
EncodeRowKey
(
ušt16_t
 
buck‘
, ušt16_ˆ
domaš
, cÚ¡ 
Sliû
& 
rowkey
,

16 
¡d
::
¡ršg
* 
key
);

17 
boŞ
 
DecodeRowKey
(cÚ¡ 
Sliû
& 
key
, 
ušt16_t
* 
buck‘
, ušt16_t* 
domaš
,

18 
Sliû
* 
rowkey
);

20 
boŞ
 
ExŒaùBuck‘
(cÚ¡ 
Sliû
& 
key
, 
ušt16_t
* 
buck‘
);

21 
boŞ
 
ExŒaùDomaš
(cÚ¡ 
Sliû
& 
key
, 
ušt16_t
* 
buck‘
);

22 
Sliû
 
ExŒaùRow
(cÚ¡ Sliû& 
key
);

	@/home/libin3-s/ldd/store/job.h

2 #iâdeà
__LDD__JOB_H_


3 
	#__LDD__JOB_H_


	)

5 
	~<¡dšt.h
>

6 
	~<veùÜ
>

7 
	~<boo¡/sh¬ed_±r.hµ
>

9 
	~"ldd/ut/¦iû.h
"

10 
	~"ldd/´ÙocŞ/ş›Á/»¥Ú£.h
"

11 
	~"£ssiÚ.h
"

15 
Çme¥aû
 
	gldd
{

16 
Çme¥aû
 
	g¡Üage
{

19 
şass
 
	gTask
;

24 şas 
	cJob
{

25 
	gpublic
:

26 
Job
(
boo¡
::
sh¬ed_±r
<
SessiÚ
>
msg
);

27 
	gvœtu®
 ~
Job
();

28 
AddTask
(
Task
* 
sk
, 
boŞ
 
couÁ_sk
);

29 
RescheduËTask
(
Task
* 
sk
, 
boŞ
 
couÁ_sk
);

30 
vœtu®
 
AddResuÉ
(
ldd
::
´ÙocŞ
::
Re¥Ú£
* 
»¥Ú£
) ;

31 
vœtu®
 
DÚe
(){};

33 
	g´Ùeùed
:

35 
boo¡
::
sh¬ed_±r
<
SessiÚ
> 
£ssiÚ_
;

36 
	gsk_num_
;

41 şas 
	cLi¡Job
 : 
public
 
Job
{

42 
public
:

43 
Li¡Job
(
boo¡
::
sh¬ed_±r
<
SessiÚ
>
msg
): 
Job
(msg){

47 
vœtu®
 
AddResuÉ
(
ldd
::
´ÙocŞ
::
Re¥Ú£
* 
»¥Ú£
);

48 
vœtu®
 
DÚe
();

	@/home/libin3-s/ldd/store/level_bench/histogram.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


6 
	#STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


	)

8 
	~<¡ršg
>

9 
	~"ldd/ut/¦iû.h
"

10 
	~"‹¡ut.h
"

11 
	~<gæags/gæags.h
>

14 
	gusšg
 ::
ldd
::
ut
::
Sliû
;

16 
Aµ’dW™hS·û
(
¡d
::
¡ršg
* 
¡r
, 
Sliû
 
msg
);

20 
DECLARE_boŞ
(
hi¡og¿m
);

21 
DECLARE_doubË
(
com´essiÚ_¿tio
);

23 şas 
	cHi¡og¿m
 {

24 
	mpublic
:

25 
	$Hi¡og¿m
() { }

26 ~
	$Hi¡og¿m
(è{ 
	}
}

28 
CË¬
();

29 
Add
(
v®ue
);

30 
M”ge
(cÚ¡ 
Hi¡og¿m
& 
Ùh”
);

32 
	g¡d
::
¡ršg
 
	$ToSŒšg
() const;

34 
´iv©e
:

35 
mš_
;

36 
max_
;

37 
num_
;

38 
sum_
;

39 
sum_squ¬es_
;

41 ’um { 
kNumBuck‘s
 = 154 
	}
};

42 cÚ¡ 
	gkBuck‘Lim™
[
kNumBuck‘s
];

43 
	gbuck‘s_
[
kNumBuck‘s
];

45 
	$MedŸn
() const;

46 
	$P”ûÁe
(
p
) const;

47 
	$Av”age
() const;

48 
	$Snd¬dDevŸtiÚ
() const;

49 
	}
};

53 şas 
	cSts
 {

54 
	m´iv©e
:

55 
¡¬t_
;

56 
	mfšish_
;

57 
	m£cÚds_
;

58 
	mdÚe_
;

59 
	mÃxt_»pÜt_
;

60 
št64_t
 
	mby‹s_
;

61 
	mÏ¡_İ_fšish_
;

62 
Hi¡og¿m
 
	mhi¡_
;

63 
	m¡d
::
¡ršg
 
mes§ge_
;

65 
	mpublic
:

66 
	$Sts
(è{ 
	`S¹
(); }

68 
	$S¹
() {

69 
Ãxt_»pÜt_
 = 100;

70 
Ï¡_İ_fšish_
 = 
¡¬t_
;

71 
hi¡_
.
	`CË¬
();

72 
dÚe_
 = 0;

73 
by‹s_
 = 0;

74 
£cÚds_
 = 0;

75 
¡¬t_
 = 
	`NowMiüos
();

76 
fšish_
 = 
¡¬t_
;

77 
mes§ge_
.
	`ş—r
();

78 
	}
}

80 
	$M”ge
(cÚ¡ 
Sts
& 
Ùh”
) {

81 
hi¡_
.
	`M”ge
(
Ùh”
.hist_);

82 
dÚe_
 +ğ
Ùh”
.done_;

83 
by‹s_
 +ğ
Ùh”
.bytes_;

85 ià(
Ùh”
.
¡¬t_
 < start_) start_ = other.start_;

86 ià(
Ùh”
.
fšish_
 > finish_) finish_ = other.finish_;

89 ià(
mes§ge_
.
	`em±y
()èmes§ge_ = 
Ùh”
.message_;

90 
	}
}

92 
	$Stİ
() {

93 
fšish_
 = 
	`NowMiüos
();

94 
£cÚds_
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

95 
	}
}

97 
	$AddMes§ge
(
Sliû
 
msg
) {

98 
	`Aµ’dW™hS·û
(&
mes§ge_
, 
msg
);

99 
	}
}

101 
	$FšishedSšgËOp
() {

102 ià(
FLAGS_hi¡og¿m
) {

103 
now
 = 
	`NowMiüos
();

104 
miüos
 = 
now
 - 
Ï¡_İ_fšish_
;

105 
hi¡_
.
	`Add
(
miüos
);

106 ià(
miüos
 > 20000) {

107 
	`årštf
(
¡d”r
, "lÚg op: %.1àmiüos%30s\r", 
miüos
, "");

108 
	`fæush
(
¡d”r
);

110 
Ï¡_İ_fšish_
 = 
now
;

113 
dÚe_
++;

114 ià(
dÚe_
 >ğ
Ãxt_»pÜt_
) {

115 ià(
Ãxt_»pÜt_
 < 1000)‚ext_report_ += 100;

116 ià(
Ãxt_»pÜt_
 < 5000)‚ext_report_ += 500;

117 ià(
Ãxt_»pÜt_
 < 10000)‚ext_report_ += 1000;

118 ià(
Ãxt_»pÜt_
 < 50000)‚ext_report_ += 5000;

119 ià(
Ãxt_»pÜt_
 < 100000)‚ext_report_ += 10000;

120 ià(
Ãxt_»pÜt_
 < 500000)‚ext_report_ += 50000;

121 
Ãxt_»pÜt_
 += 100000;

122 
	`årštf
(
¡d”r
, "... fšished %d ops%30s\r", 
dÚe_
, "");

123 
	`fæush
(
¡d”r
);

125 
	}
}

127 
	$AddBy‹s
(
št64_t
 
n
) {

128 
by‹s_
 +ğ
n
;

129 
	}
}

131 
	$R•Üt
(cÚ¡ 
Sliû
& 
Çme
) {

134 ià(
dÚe_
 < 1) done_ = 1;

136 
¡d
::
¡ršg
 
exŒa
;

137 ià(
by‹s_
 > 0) {

140 
–­£d
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

141 
¿‹
[100];

142 
	`¢´štf
(
¿‹
, (rate), "%6.1f MB/s",

143 (
by‹s_
 / 1048576.0è/ 
–­£d
);

144 
exŒa
 = 
¿‹
;

146 
	`Aµ’dW™hS·û
(&
exŒa
, 
mes§ge_
);

148 
	`årštf
(
¡dout
, "%-12s : %11.3f micros/op; %11.3f op/second; %s%s\n",

149 
Çme
.
	`ToSŒšg
().
	`c_¡r
(),

150 
£cÚds_
 * 1e6 / 
dÚe_
, (done_*1e6)/(seconds_ * 1e6),

151 (
exŒa
.
	`em±y
() ? "" : " "),

152 
exŒa
.
	`c_¡r
());

153 ià(
FLAGS_hi¡og¿m
) {

154 
	`årštf
(
¡dout
, "Miüo£cÚd ³¸İ:\n%s\n", 
hi¡_
.
	`ToSŒšg
().
	`c_¡r
());

156 
	`fæush
(
¡dout
);

157 
	}
}

162 şas 
	cRªdomG’”©Ü
 {

163 
	m´iv©e
:

164 
¡d
::
¡ršg
 
d©a_
;

165 
	mpos_
;

167 
	mpublic
:

168 
	$RªdomG’”©Ü
() {

172 
Rªdom
 
	`ºd
(301);

173 
¡d
::
¡ršg
 
p›û
;

174 
d©a_
.
	`size
() < 1048576) {

177 
	`Com´essibËSŒšg
(&
ºd
, 
FLAGS_com´essiÚ_¿tio
, 100, &
p›û
);

178 
d©a_
.
	`­³nd
(
p›û
);

180 
pos_
 = 0;

183 
Sliû
 
	$G’”©e
(
Ën
) {

184 ià((
size_t
)
pos_
 + 
Ën
 > 
d©a_
.
	`size
()) {

185 
pos_
 = 0;

186 
	`as£¹
((
size_t
)
Ën
 < 
d©a_
.
	`size
());

188 
pos_
 +ğ
Ën
;

189  
	`Sliû
(
d©a_
.
	`d©a
(è+ 
pos_
 - 
Ën
,†en);

190 
	}
}

	@/home/libin3-s/ldd/store/level_bench/random.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_RANDOM_H_


6 
	#STORAGE_LEVELDB_UTIL_RANDOM_H_


	)

8 
	~<¡dšt.h
>

15 şas 
	cRªdom
 {

16 
	m´iv©e
:

17 
ušt32_t
 
£ed_
;

18 
	mpublic
:

19 
ex¶ic™
 
	$Rªdom
(
ušt32_t
 
s
è: 
	$£ed_
(
s
 & 0x7fffffffu) {

21 ià(
£ed_
 == 0 || seed_ == 2147483647L) {

22 
£ed_
 = 1;

25 
ušt32_t
 
	$Next
() {

26 cÚ¡ 
ušt32_t
 
M
 = 2147483647L;

27 cÚ¡ 
ušt64_t
 
A
 = 16807;

34 
ušt64_t
 
´oduù
 = 
£ed_
 * 
A
;

37 
£ed_
 = 
¡©ic_ÿ¡
<
ušt32_t
>((
´oduù
 >> 31è+ (´oduù & 
M
));

41 ià(
£ed_
 > 
M
) {

42 
£ed_
 -ğ
M
;

44  
£ed_
;

45 
	}
}

48 
ušt32_t
 
	$UnifÜm
(
n
è{  
	`Next
(è%‚; 
	}
}

52 
boŞ
 
	$OÃIn
(
n
è{  (
	`Next
(è%‚è=ğ0; 
	}
}

57 
ušt32_t
 
	$Skewed
(
max_log
) {

58  
	`UnifÜm
(1 << UnifÜm(
max_log
 + 1));

59 
	}
}

	@/home/libin3-s/ldd/store/level_bench/testutil.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_TESTUTIL_H_


6 
	#STORAGE_LEVELDB_UTIL_TESTUTIL_H_


	)

9 
	~"ldd/ut/¦iû.h
"

10 
	~"¿ndom.h
"

12 
	gusšg
 ::
ldd
::
ut
::
Sliû
;

14 
ušt64_t
 
NowMiüos
();

16 
SË•FÜMiüo£cÚds
(
miüos
);

19 
	g¡d
::
¡ršg
 
TimeToSŒšg
();

24 
Sliû
 
RªdomSŒšg
(
Rªdom
* 
ºd
, 
Ën
, 
¡d
::
¡ršg
* 
d¡
);

28 
	g¡d
::
¡ršg
 
RªdomKey
(
Rªdom
* 
ºd
, 
Ën
);

33 
Sliû
 
Com´essibËSŒšg
(
Rªdom
* 
ºd
, 
com´es£d_äaùiÚ
,

34 
Ën
, 
¡d
::
¡ršg
* 
d¡
);

	@/home/libin3-s/ldd/store/plant.h

1 #iâdeà
__LDD__STORAGE_PLANT_H_


2 
	#__LDD__STORAGE_PLANT_H_


	)

5 
	~<ldd/ut/mu‹x.h
>

6 
	~<ldd/ut/©omic.h
>

7 
	~"th»ad_mªag”.h
"

13 
Çme¥aû
 
	gldd
{

14 
Çme¥aû
 
	g¡Üage
{

18 şas 
	cReque¡ProûssPÏÁ
 : 
public
 
RuÂabË


20 
public
:

21 
Reque¡ProûssPÏÁ
();

22 
	gvœtu®
 ~
Reque¡ProûssPÏÁ
();

23 
vœtu®
 
run
();

25 
	gpublic
:

26 
vœtu®
 
scheduË
() = 0;

27 
	gpublic
:

28 
Stİ
();

30 
	g´iv©e
:

31 
ldd
::
ut
::
Atomic
<
boŞ
> 
¡İ_
;

34 şas 
	cR—dReque¡ProûssPÏÁ
 : 
public
 
Reque¡ProûssPÏÁ


36 
public
:

37 
R—dReque¡ProûssPÏÁ
(){};

38 
	gvœtu®
 ~
R—dReque¡ProûssPÏÁ
();

39 
vœtu®
 
scheduË
();

40 
	g´iv©e
:

43 şas 
	cWr™eReque¡ProûssPÏÁ
 : 
public
 
Reque¡ProûssPÏÁ


45 
public
:

46 
Wr™eReque¡ProûssPÏÁ
(){};

47 
	gvœtu®
 ~
Wr™eReque¡ProûssPÏÁ
();

48 
vœtu®
 
scheduË
();

49 
	g´iv©e
:

	@/home/libin3-s/ldd/store/plant_pool.h

2 #iâdeà
__LDD__STORAGE_PLANT_POOL_H_


3 
	#__LDD__STORAGE_PLANT_POOL_H_


	)

5 
	~"th»ad_mªag”.h
"

6 
	~"¶ªt.h
"

9 
Çme¥aû
 
	gldd
{

10 
Çme¥aû
 
	g¡Üage
{

13 şas 
	cPÏÁPoŞ
{

14 
	gpublic
:

15 
PÏÁPoŞ
(
»ad_th»ad_num
, 
wr™e_th»ad_num
)

16 : 
»ad_th»ad_num_
(
»ad_th»ad_num
), 
wr™e_th»ad_num_
(
wr™e_th»ad_num
)

17 ,
tm1_
(
NULL
), 
»ad_job_
(NULL), 
wr™e_job_
(NULL){

20 ~
PÏÁPoŞ
(){

22 
LOG
(
INFO
)<<"~PlantPool()";

23 
	gi
=0; i < 
	g»ad_th»ad_num_
; i++){

24 
	g»ad_job_
[
i
].
Stİ
();

25 
LOG
(
ERROR
)<<"~PÏÁPoŞ(è»ad stİ i="<<
	gi
;

27 
	gd–‘e
[] 
	g»ad_job_
;

29 
	gi
=0; i < 
	gwr™e_th»ad_num_
; i++){

30 
	gwr™e_job_
[
i
].
Stİ
();

31 
LOG
(
ERROR
)<<"~PÏÁPoŞ(èwr™¡İ i="<<
	gi
;

34 
	gd–‘e
[] 
	gwr™e_job_
;

35 
d–‘e
 
	gtm1_
;

37 
	gpublic
:

38 
S‘UpPÏÁPoŞ
(){

39 ià(
»ad_th»ad_num_
 ==0 ){

40 
»ad_th»ad_num_
 =1;

43 ià(
	gwr™e_th»ad_num_
 == 0 ){

44 
wr™e_th»ad_num_
 = 1;

47 
	gtm1_
 = 
Ãw
 
Th»adMªag”
(
»ad_th»ad_num_
 + 
wr™e_th»ad_num_
);

48 
	g»ad_job_
 = 
Ãw
 
R—dReque¡ProûssPÏÁ
[
»ad_th»ad_num_
];

49 
	gi
=0; i < 
	g»ad_th»ad_num_
; i++){

50 
	gtm1_
->
­³nd
(&(
»ad_job_
[
i
]));

51 
LOG
(
INFO
)<<"S‘UpPÏÁPoŞ(èadd„—d i="<<
	gi
;

54 
	gwr™e_job_
 = 
Ãw
 
Wr™eReque¡ProûssPÏÁ
[
wr™e_th»ad_num_
];

55 
	gi
=0; i < 
	gwr™e_th»ad_num_
; i++){

56 
	gtm1_
->
­³nd
(&
wr™e_job_
[
i
]);

57 
LOG
(
INFO
)<<"S‘UpPÏÁPoŞ(èadd wr™i="<<
	gi
;

59 
LOG
(
INFO
)<<"S‘UpPÏÁPoŞ(è£ˆwr™¶ªˆnum="<<
	gwr™e_th»ad_num_
;

60 
LOG
(
INFO
)<<"S‘UpPÏÁPoŞ(è£ˆ»ad…ÏÁ‚um="<<
	g»ad_th»ad_num_
;

62 
	g´iv©e
:

63 
»ad_th»ad_num_
;

64 
	gwr™e_th»ad_num_
;

65 
Th»adMªag”
* 
	gtm1_
;

66 
R—dReque¡ProûssPÏÁ
* 
	g»ad_job_
;

67 
Wr™eReque¡ProûssPÏÁ
* 
	gwr™e_job_
;

	@/home/libin3-s/ldd/store/session.h

2 #iâdeà
__LDD__STORAGE_SESSION_H_


3 
	#__LDD__STORAGE_SESSION_H_


	)

5 
	~<m­
>

6 
	~"ldd/Ãt/šcomšg_msg.h
"

7 
	~"ldd/Ãt/bufãr.h
"

8 
	~"ldd/´ÙocŞ/£rv”/¡Üe_´Ùo.h
"

9 
	~"ldd/´ÙocŞ/£rv”/commªd_ty³.h
"

11 
usšg
 
Çme¥aû
 
	g¡d
;

12 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

15 
Çme¥aû
 
	gldd
{

16 
Çme¥aû
 
	g¡Üage
{

18 
şass
 
	gTask
;

19 
şass
 
	gJob
;

20 
şass
 
	gCÚfigMªag”
;

22 şas 
	cSessiÚ
 : 
public
 
IncomšgMsg
{

23 
public
:

24 
SessiÚ
(è: 
job_
(
NULL
){

27 ~
SessiÚ
();

28 
S‘Body
(
Ãt
::
Bufãr
 
buf
);

29 
DÚe
();

30 
	g´Ùeùed
:

31 
Job
* 
job_
;

32 
	g¡d
::
veùÜ
<
Task
*> 
sk_vec_
;

33 
Paylßd
 
	gbufãr_
;

34 
Paylßd
 
	g»¥Ú£_
;

37 şas 
	cR—dSessiÚ
 : 
public
 
SessiÚ
{

38 
public
:

39 
R—dSessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

42 
vœtu®
 ~
R—dSessiÚ
(){

46 cÚ¡ 
Ty³
 
	gkTy³
 = 
LDD_PROXY_2_STORE_GET
;

47 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

50 
	g´Ùeùed
:

51 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

52 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

53 
vœtu®
 
DÚe
(
Code
* 
code
) ;

54 
vœtu®
 
Cªûl
() ;

56 
	g´iv©e
:

57 
CÚfigMªag”
* 
cÚfig_mªag”_
;

60 şas 
	cCheckSessiÚ
 : 
public
 
SessiÚ
{

61 
public
:

62 
CheckSessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

65 
vœtu®
 ~
CheckSessiÚ
(){

69 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_PROXY_2_STORE_CHECK
;

70 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

72 
	g´Ùeùed
:

73 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

74 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

75 
vœtu®
 
DÚe
(
Code
* 
code
) ;

76 
vœtu®
 
Cªûl
() ;

78 
	g´iv©e
:

79 
CÚfigMªag”
* 
cÚfig_mªag”_
;

82 şas 
	cMu‹SessiÚ
 : 
public
 
SessiÚ
{

83 
public
:

84 
Mu‹SessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

87 
vœtu®
 ~
Mu‹SessiÚ
(){

91 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_PROXY_2_STORE_MUTATE
;

92 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

94 
	g´Ùeùed
:

95 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

96 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

97 
vœtu®
 
DÚe
(
Code
* 
code
) ;

98 
vœtu®
 
Cªûl
() ;

100 
	g´iv©e
:

101 
CÚfigMªag”
* 
cÚfig_mªag”_
;

105 şas 
	cLi¡SessiÚ
 : 
public
 
SessiÚ
{

106 
public
:

107 
Li¡SessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

110 
vœtu®
 ~
Li¡SessiÚ
(){

114 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_PROXY_2_STORE_LIST
;

115 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

117 
	g´Ùeùed
:

118 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

119 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

120 
vœtu®
 
DÚe
(
Code
* 
code
) ;

121 
vœtu®
 
Cªûl
() ;

123 
	g´iv©e
:

124 
CÚfigMªag”
* 
cÚfig_mªag”_
;

127 şas 
	cAtomicInüSessiÚ
 : 
public
 
SessiÚ
{

128 
public
:

129 
AtomicInüSessiÚ
(
CÚfigMªag”
* 
cÚfig
):
cÚfig_mªag”_
(config){

132 
vœtu®
 ~
AtomicInüSessiÚ
(){

136 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_PROXY_2_STORE_ATOMIC_INCR
;

137 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

139 
	g´Ùeùed
:

140 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

141 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

142 
vœtu®
 
DÚe
(
Code
* 
code
) ;

143 
vœtu®
 
Cªûl
() ;

144 
	g´iv©e
:

145 
CÚfigMªag”
* 
cÚfig_mªag”_
;

148 şas 
	cAtomicAµ’dSessiÚ
 : 
public
 
SessiÚ
{

149 
public
:

150 
AtomicAµ’dSessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

153 
vœtu®
 ~
AtomicAµ’dSessiÚ
(){

157 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_PROXY_2_STORE_ATOMIC_APPEND
;

158 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

161 
	g´Ùeùed
:

162 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

163 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

164 
vœtu®
 
DÚe
(
Code
* 
code
) ;

165 
vœtu®
 
Cªûl
() ;

168 
	g´iv©e
:

169 
CÚfigMªag”
* 
cÚfig_mªag”_
;

175 şas 
	cG‘V”siÚSessiÚ
 : 
public
 
SessiÚ
{

176 
public
:

177 
G‘V”siÚSessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

180 
vœtu®
 ~
G‘V”siÚSessiÚ
();

182 cÚ¡ 
Ty³
 
	gkTy³
 = 
LDD_STORE_2_STORE_GET_VERSION
;

183 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

185 
	g´Ùeùed
:

186 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

187 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

188 
vœtu®
 
DÚe
(
Code
* 
code
) ;

189 
vœtu®
 
Cªûl
() ;

191 
	g´iv©e
:

192 
CÚfigMªag”
* 
cÚfig_mªag”_
;

195 şas 
	cMutiÚP»·»SessiÚ
 : 
public
 
SessiÚ
{

196 
public
:

197 
MutiÚP»·»SessiÚ
(
CÚfigMªag”
* 
cÚfig
è: 
cÚfig_mªag”_
(config){

200 
vœtu®
 ~
MutiÚP»·»SessiÚ
(){

204 cÚ¡ 
Ty³
 
kTy³
 = 
LDD_STORE_2_STORE_MUTATION_PREPARE
;

205 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

207 
	g´Ùeùed
:

208 
vœtu®
 
In™
(cÚ¡ 
Paylßd
& 
»que¡
, 
AùiÚ
* 
Ãxt
) ;

209 
vœtu®
 
Em™
(
Paylßd
* 
»¥Ú£
, 
AùiÚ
* 
Ãxt
) ;

210 
vœtu®
 
DÚe
(
Code
* 
code
) ;

211 
vœtu®
 
Cªûl
() ;

213 
	g´iv©e
:

214 
CÚfigMªag”
* 
cÚfig_mªag”_
;

215 
	g¡d
::
¡ršg
 
ho¡_pÜt_
;

	@/home/libin3-s/ldd/store/singleton_holder.h

2 #iâdeà
__LDD__SINGLETON_HOLDER_H_


3 
	#__LDD__SINGLETON_HOLDER_H_


	)

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	g¡Üage
{

11 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

12 şas 
	cSšgËtÚHŞd”


14 
	g´iv©e
:

15 
SšgËtÚHŞd”
();

16 
SšgËtÚHŞd”
(const SingletonHolder&);

17 
	gSšgËtÚHŞd”
& 
	gİ”©Ü
=(
SšgËtÚHŞd”
&);

18 
	gpublic
:

19 
T
& 
In¡ªû
()

21 
T
 
š¡ªû_
;

22  
	gš¡ªû_
;

25 
De¡Üy
(){

26 
In¡ªû
().
De¡Üy
();

28 
	g´iv©e
:

	@/home/libin3-s/ldd/store/store_module.h

1 #iâdeà
__LDD__STORAGE_STORE_MODULE_H_


2 
	#__LDD__STORAGE_STORE_MODULE_H_


	)

5 
	~<¡ršg
>

6 
	~<ldd/sk–/moduË.h
>

7 
	~<ldd/cour›r/İtiÚs.h
>

11 
Çme¥aû
 
	gldd
{

12 
Çme¥aû
 
	g¡Üage
{

15 
şass
 
	gCÚfigMªag”
;

16 
şass
 
	gPÏÁPoŞ
;

17 
şass
 
	gDB
;

20 şas 
	cStÜeModuË
 : 
public
 
ldd
::
sk–
::
Sim¶eModuË
{

21 
public
:

22 
StÜeModuË
();

23 ~
StÜeModuË
();

24 
vœtu®
 
boŞ
 
In™ModuË
(
ModuËCtx
* 
ùx
);

26 
	g´iv©e
:

27 
boŞ
 
RunStÜe
();

28 
HªdËZkE¼Ü
(
”rÜ_code
);

30 
	g´iv©e
:

32 
CÚfigMªag”
* 
cÚfig_mªag”_
;

33 
PÏÁPoŞ
* 
	g¶ªt_poŞ_
;

34 
DB
* 
	gdb_im¶_
;

36 
	gli¡’_pÜt_
;

38 
	g»ad_th»ad_num_
;

39 
	gwr™e_th»ad_num_
;

42 
	g¡d
::
¡ršg
 
zk_ho¡_pÜt_
;

43 
	g¡d
::
¡ršg
 
zk_roÙ_·th_
;

45 
	g¡d
::
¡ršg
 
db_·th_
;

46 
	gldd
::
cour›r
::
O±iÚs
 
İtiÚ_
;

	@/home/libin3-s/ldd/store/string_util.h

30 #iâdeà
__LDD_STORE_STRING_UTIL_H


31 
	#__LDD_STORE_STRING_UTIL_H


	)

33 
¡ršgm©chËn
(cÚ¡ *
p
, 
¶’
, cÚ¡ *
s
, 
¦’
, 
noÿ£
);

34 
¡ršgm©ch
(cÚ¡ *
p
, cÚ¡ *
s
, 
noÿ£
);

35 
memtŞl
(cÚ¡ *
p
, *
”r
);

36 
Î2¡ršg
(*
s
, 
size_t
 
Ën
, 
v®ue
);

37 
¡ršg2Î
(cÚ¡ *
s
, 
size_t
 
¦’
, *
v®ue
);

38 
¡ršg2l
(cÚ¡ *
s
, 
size_t
 
¦’
, *
v®ue
);

39 
d2¡ršg
(*
buf
, 
size_t
 
Ën
, 
v®ue
);

	@/home/libin3-s/ldd/store/task.h

3 #iâdeà
__LDD__STORAGE_TASK_H_


4 
	#__LDD__STORAGE_TASK_H_


	)

7 
	~<¡dšt.h
>

8 
	~<¡ršg
>

9 
	~"ldd/ut/¦iû.h
"

10 
	~"ldd/Ãt/·ylßd.h
"

12 
Çme¥aû
 
	gldd
{

13 
Çme¥aû
 
	g´ÙocŞ
{

14 
şass
 
	gG‘V”siÚMes§geS
;

15 
şass
 
	gG‘Mes§geS
;

16 
şass
 
	gCheckMes§geS
;

17 
şass
 
	gMu‹Mes§geS
;

18 
şass
 
	gLi¡Mes§geS
;

19 
şass
 
	gAtomicInüMes§geS
;

20 
şass
 
	gAtomicAµ’dMes§geS
;

21 
şass
 
	gRe¥Ú£
;

26 
Çme¥aû
 
	gldd
{

27 
Çme¥aû
 
	g¡Üage
{

29 
usšg
 
	gldd
::
ut
::
Sliû
;

30 
usšg
 
	gldd
::
´ÙocŞ
::
G‘V”siÚMes§geS
;

31 
usšg
 
	gldd
::
´ÙocŞ
::
G‘Mes§geS
;

32 
usšg
 
	gldd
::
´ÙocŞ
::
CheckMes§geS
;

33 
usšg
 
	gldd
::
´ÙocŞ
::
Mu‹Mes§geS
;

34 
usšg
 
	gldd
::
´ÙocŞ
::
Li¡Mes§geS
;

35 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicInüMes§geS
;

36 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicAµ’dMes§geS
;

37 
usšg
 
	gldd
::
´ÙocŞ
::
Re¥Ú£
;

40 
	eTaskTy³
{

41 
	gkTy³R—d
 = 1,

42 
	gkTy³Wr™e
,

43 
	gkTy³R—dSubTask
,

44 
	gkTy³Wr™eSubTask


47 
şass
 
	gJob
;

48 
şass
 
	gCÚfigMªag”
;

49 
şass
 
	gDB
;

51 şas 
	cTask
{

52 
	gpublic
:

53 
Task
(
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

54 : 
ty³_
(
ty³
), 
job_
(
job
), 
db_
(
db
),

55 
Ãxt_
(
NULL
), 
´iÜ_
(NULL),
sk_id_
(0){

58 
	gvœtu®
 ~
Task
();

59 
vœtu®
 
Execu‹
() = 0;

60 
vœtu®
 
S‘NextTask
(
Task
* 
sk
);

61 
vœtu®
 
S‘PriÜTask
(
Task
* 
sk
);

62 
Run
();

63 
ReScheduË
();

64 
TaskTy³
 
G‘Ty³Task
();

65 
S‘Seq
(
£q
){

66 
	gsk_id_
 = 
£q
;

69 
Seq
(){

70  
	gsk_id_
;

72 
	g´Ùeùed
:

73 
TaskTy³
 
ty³_
;

74 
Job
* 
	gjob_
;

75 
DB
* 
	gdb_
;

76 
Task
* 
	gÃxt_
;

77 
Task
* 
	g´iÜ_
;

78 
	gsk_id_
;

81 şas 
	cG‘Task
 : 
public
 
Task
{

82 
public
:

83 
G‘Task
(
G‘Mes§geS
* 
msg
, 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

84 : 
Task
(
ty³
, 
job
, 
db
), 
msg_
(
msg
), 
»pÚ£_
(
NULL
){

87 ~
G‘Task
();

88 
	gpublic
:

89 
vœtu®
 
Execu‹
();

90 
Re¥Ú£
* 
G‘Re¥Ú£
(){

91  
	g»pÚ£_
;

94 
	g´iv©e
:

95 
G‘Mes§geS
* 
msg_
;

96 
	g¡d
::
¡ršg
 
v®ue_
;

97 
Re¥Ú£
* 
	g»pÚ£_
;

101 şas 
	cCheckTask
 : 
public
 
Task
{

102 
public
:

103 
CheckTask
(
CheckMes§geS
* 
msg
, 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

104 : 
Task
(
ty³
, 
job
, 
db
), 
msg_
(
msg
){

107 ~
CheckTask
();

108 
	gpublic
:

109 
vœtu®
 
Execu‹
();

111 
	g´iv©e
:

112 
CheckMes§geS
* 
msg_
;

115 
şass
 
	gP»·»ResuÉH
;

116 
şass
 
	gSynWr™eMes§geHªdË
;

117 şas 
	cModifyBa£Task
 : 
public
 
Task
 {

118 
public
:

119 
ModifyBa£Task
(cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
, 
TaskTy³
 
ty³
,

120 
Job
* 
job
, 
DB
* 
db
,

121 
CÚfigMªag”
* 
cÚfig_mªag”
)

122 : 
Task
(
ty³
, 
job
, 
db
), 
cÚfig_mªag”_
(
cÚfig_mªag”
),

123 
´•¬e_hªdË_
(
NULL
),
syn_hªdË_
(NULL),
v”siÚ_
(0),

124 
´•¬e_checked_
(
çl£
),
ÿn_mu‹_
(false){

125 
	g·ylßd_
.
S‘Body
(
·ylßd
.
body
());

127 ~
ModifyBa£Task
();

128 
’abË_mu‹
(
boŞ
 
yes
){

129 
	gÿn_mu‹_
 = 
yes
;

131 
boŞ
 
´•¬ed
(){

132  
	g´•¬e_checked_
;

134 
´•¬e_checked
(){

135 
	g´•¬e_checked_
 = 
Œue
;

137 
boŞ
 
ÿn_mu‹
(){

138  
	gÿn_mu‹_
;

141 
vœtu®
 
Execu‹
();

142 
vœtu®
 
DoExecu‹
() = 0;

143 
vœtu®
 
št64_t
 
G‘SynV”siÚ
() = 0;

144 
vœtu®
 
ušt8_t
 
G‘MsgFrom
() = 0;

146 
	g´Ùeùed
:

147 
Ãt
::
Paylßd
 
·ylßd_
;

148 
CÚfigMªag”
* 
	gcÚfig_mªag”_
;

149 
P»·»ResuÉH
* 
	g´•¬e_hªdË_
;

150 
SynWr™eMes§geHªdË
* 
	gsyn_hªdË_
;

151 
ušt64_t
 
	gv”siÚ_
;

153 
	g´iv©e
:

154 
boŞ
 
´•¬e_checked_
;

155 
boŞ
 
	gÿn_mu‹_
;

159 şas 
	cMu‹Task
 : 
public
 
ModifyBa£Task
{

160 
public
:

161 
Mu‹Task
(
CÚfigMªag”
* 
cÚfig_mªag”
, 
Mu‹Mes§geS
* 
msg
,

162 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

163 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

164 : 
ModifyBa£Task
(
·ylßd
, 
ty³
, 
job
, 
db
, 
cÚfig_mªag”
), 
msg_
(
msg
){

167 ~
Mu‹Task
();

168 
	gpublic
:

169 
vœtu®
 
DoExecu‹
();

170 
vœtu®
 
št64_t
 
G‘SynV”siÚ
();

171 
vœtu®
 
ušt8_t
 
G‘MsgFrom
();

173 
	g´iv©e
:

174 
Mu‹Mes§geS
* 
msg_
;

175 
	g¡d
::
¡ršg
 
v®ue_
;

180 şas 
	cLi¡Task
 : 
public
 
Task
{

181 
public
:

182 
Li¡Task
(
Li¡Mes§geS
* 
msg
, 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

183 : 
Task
(
ty³
, 
job
, 
db
), 
msg_
(
msg
){

186 ~
Li¡Task
();

187 
	gpublic
:

188 
vœtu®
 
Execu‹
();

189 
	g´iv©e
:

190 
Li¡Mes§geS
* 
msg_
;

194 şas 
	cAtomicInüTask
 : 
public
 
ModifyBa£Task
{

195 
public
:

196 
AtomicInüTask
(
CÚfigMªag”
* 
cÚfig_mªag”
, 
AtomicInüMes§geS
* 
msg
,

197 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

198 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

199 : 
ModifyBa£Task
(
·ylßd
, 
ty³
, 
job
,
db
, 
cÚfig_mªag”
), 
msg_
(
msg
){

202 ~
AtomicInüTask
();

203 
	gpublic
:

204 
vœtu®
 
DoExecu‹
();

205 
vœtu®
 
št64_t
 
G‘SynV”siÚ
();

206 
vœtu®
 
ušt8_t
 
G‘MsgFrom
();

208 
	g´iv©e
:

209 
AtomicInüMes§geS
* 
msg_
;

213 şas 
	cAtomicAµ’dTask
 : 
public
 
ModifyBa£Task
{

214 
public
:

215 
AtomicAµ’dTask
(
CÚfigMªag”
* 
cÚfig_mªag”
, 
AtomicAµ’dMes§geS
* 
msg
,

216 cÚ¡ 
Ãt
::
Paylßd
& 
·ylßd
,

217 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

218 :
ModifyBa£Task
(
·ylßd
, 
ty³
, 
job
, 
db
, 
cÚfig_mªag”
), 
msg_
(
msg
){

221 ~
AtomicAµ’dTask
();

222 
	gpublic
:

223 
vœtu®
 
DoExecu‹
();

224 
vœtu®
 
št64_t
 
G‘SynV”siÚ
();

225 
vœtu®
 
ušt8_t
 
G‘MsgFrom
();

227 
	g´iv©e
:

228 
AtomicAµ’dMes§geS
* 
msg_
;

229 
	g¡d
::
¡ršg
 
Ãw_v®ue_
;

233 şas 
	cG‘V”siÚTask
 : 
public
 
Task
{

234 
public
:

235 
G‘V”siÚTask
(
Sliû
 
home_pÜt
, 
G‘V”siÚMes§geS
* 
msg
,

236 
TaskTy³
 
ty³
, 
Job
* 
job
, 
DB
* 
db
)

237 : 
Task
(
ty³
, 
job
, 
db
), 
home_pÜt_
(
home_pÜt
), 
msg_
(
msg
){

240 ~
G‘V”siÚTask
();

241 
	gpublic
:

242 
vœtu®
 
Execu‹
();

244 
	g´iv©e
:

245 
Sliû
 
home_pÜt_
;

246 
G‘V”siÚMes§geS
* 
	gmsg_
;

247 
	g¡d
::
¡ršg
 
v®ue_
;

	@/home/libin3-s/ldd/store/task_queue.h

2 #iâdeà
__LDD__TAST_QUEUE_H_


3 
	#__LDD__TAST_QUEUE_H_


	)

5 
	~<deque
>

6 
	~<glog/loggšg.h
>

7 
	~"ldd/ut/mu‹x.h
"

8 
	~"sšgËtÚ_hŞd”.h
"

9 
	~"sk.h
"

12 
Çme¥aû
 
	gldd
{

13 
Çme¥aû
 
	g¡Üage
{

16 şas 
	cBlockQueue
{

17 
	gpublic
:

18 
BlockQueue
(è: 
cÚd_
(&
mu‹x_
), 
de¡roy_
(
çl£
),
£q_
(0){

21 ~
BlockQueue
(){

25 
De¡Üy
(){

26 
	gldd
::
ut
::
Mu‹xLock
 
l
(&
mu‹x_
);

27 
	gde¡roy_
 = 
Œue
;

28 
	gcÚd_
.
SigÇlAÎ
();

29 
DLOG
(
INFO
)<<"BlockQueue::Destory(), SignalAll()";

32 
push_back
(
Task
* 
t
){

33 
	gldd
::
ut
::
Mu‹xLock
 
l
(&
mu‹x_
);

34 ià(
	gde¡roy_
=ğ
çl£
){

36 
sk_queue_
.
push_back
(
t
);

37 
	g£q_
++;

38 
	gt
->
S‘Seq
(
£q_
);

40 
	gcÚd_
.
SigÇl
();

41 
DLOG
(
INFO
)<<"BlockQueue::push_back() Signal()";

43 
DLOG
(
INFO
)<<"BlockQueue::push_back()ƒxit";

47 
push_äÚt
(
Task
* 
t
){

48 
	gldd
::
ut
::
Mu‹xLock
 
l
(&
mu‹x_
);

49 ià(
	gde¡roy_
=ğ
çl£
){

51 
sk_queue_
.
push_äÚt
(
t
);

55 
	gcÚd_
.
SigÇl
();

56 
DLOG
(
INFO
)<<"BlockQueue::push_front() Signal!!";

58 
DLOG
(
INFO
)<<"BlockQueue::push_front()ƒxit";

62 
Task
* 
pİ_äÚt
(){

63 
Task
* 
	gt
 = 
NULL
;

64 
	gldd
::
ut
::
Mu‹xLock
 
l
(&
mu‹x_
);

65 ià(
	gde¡roy_
 =ğ
Œue
){

66  
t
;

69 
	gsk_queue_
.
em±y
(è=ğ
Œue
 && 
de¡roy_
 =ğ
çl£
){

70 
DLOG
(
INFO
)<<"BlockQueue::Waiting()";

71 
	gcÚd_
.
Wa™
();

74 ià(
	gsk_queue_
.
size
() > 0){

75 
	gt
 = 
sk_queue_
.
äÚt
();

76 
	gsk_queue_
.
pİ_äÚt
();

78 
DLOG
(
INFO
)<<"BlockQueue::front(),ƒxit";

79  
	gt
;

82 
	g´iv©e
:

83 
¡d
::
deque
<
Task
*> 
sk_queue_
;

84 
	gldd
::
ut
::
Mu‹x
 
mu‹x_
;

85 
	gldd
::
ut
::
CÚdV¬
 
cÚd_
;

86 
boŞ
 
	gde¡roy_
;

87 
	g£q_
;

91 şas 
	cWr™eTaskQueue
 : 
public
 
BlockQueue
{

92 
public
:

93 
Wr™eTaskQueue
(){

97 
´iv©e
:

101 şas 
	cR—dTaskQueue
 : 
public
 
BlockQueue
{

102 
public
:

103 
R—dTaskQueue
(){

107 
´iv©e
:

	@/home/libin3-s/ldd/store/thread_manager.h

3 #iâdeà
__LDD__STORAGE_THREAD_MANAGER_H_


4 
	#__LDD__STORAGE_THREAD_MANAGER_H_


	)

6 
	~<±h»ad.h
>

7 
	~<ÿs£¹
>

8 
	~<queue
>

9 
	~<c¡dio
>

10 
	~<c¡dlib
>

11 
	~<uni¡d.h
>

12 
	~<ldd/ut/mu‹x.h
>

13 
	~<ldd/ut/©omic.h
>

15 
usšg
 
Çme¥aû
 
	g¡d
;

17 
Çme¥aû
 
	gldd
{

18 
Çme¥aû
 
	g¡Üage
{

23 şas 
	cRuÂabË
 {

24 
	gpublic
:

25 
RuÂabË
();

26 
	gvœtu®
 ~
RuÂabË
();

27 
vœtu®
 
run
();

30 şas 
	cTh»adMªag”
{

35 
	gpublic
:

36 
Th»adMªag”
 (
size
);

37 ~
Th»adMªag”
 ();

39 
size
();

40 
­³nd
(
RuÂabË
 *);

41 
sync
();

42 
wÜk”
();

44 
	g´iv©e
:

45 
ldd
::
ut
::
Mu‹x
 
mu‹x0_
, 
	gmu‹x1_
;

46 
	gldd
::
ut
::
CÚdV¬
 
cÚd_
;

47 
	gldd
::
ut
::
Atomic
<
boŞ
> 
ruÂšg_
;

48 
	gth»ad_num_
;

49 
	gruÂšg_jobs_
;

50 
	gqueue
<
	gRuÂabË
 *> 
	gjobs_
;

51 
±h»ad_t
 * 
	gth»ads_
;

59 şas 
	cTask1
 :
public
 
RuÂabË
{

60 
public
:

61 
	$run
()

63 
mut
.
	`lock
();

64 
i
 = 0;i < 100;i++) {

65 
	`u¦“p
(1);

66 
	`´štf
("1");

67 
	`fæush
(
¡dout
);

69 
	`putch¬
(10); 
	`fæush
(
¡dout
);

70 
mut
.
	`uÆock
();

72 
	}
};

74 şas 
	cTask2
: 
public
 
Task1


76 
public
:

77 
	$run
()

79 
mut
.
	`lock
();

80 
i
 = 0;i < 100;i++) {

81 
	`u¦“p
(1);

82 
	`´štf
("2");

83 
	`fæush
(
¡dout
);

85 
	`putch¬
(10); 
	`fæush
(
¡dout
);

86 
mut
.
	`uÆock
();

88 
	}
};

91 şas 
	cTask3
 :
public
 
Job
{

92 
public
:

93 
	$run
()

95 
i
 = 0;i < 100;i++) {

96 
	`u¦“p
(1);

97 
	`´štf
("1");

98 
	`fæush
(
¡dout
);

100 
	`putch¬
(10); 
	`fæush
(
¡dout
);

102 
	}
};

104 şas 
	cTask4
: 
public
 
Task1


106 
public
:

107 
	$run
()

109 
i
 = 0;i < 100;i++) {

110 
	`u¦“p
(1);

111 
	`´štf
("2");

112 
	`fæush
(
¡dout
);

114 
	`putch¬
(10); 
	`fæush
(
¡dout
);

116 
	}
};

117 
	$maš
()

119 
Th»adMªag”
 
	`tm1
(2);

120 
Task1
 
a
;

121 
Task2
 
b
;

122 
Task3
 
c
;

123 
Task4
 
d
;

124 
tm1
.
	`­³nd
(&
a
);

125 
tm1
.
	`­³nd
(&
b
);

126 
	`putch¬
(10);

127 
tm1
.
	`sync
();

128 
tm1
.
	`­³nd
(&
c
);

129 
tm1
.
	`­³nd
(&
d
);

131 
	}
}

	@/home/libin3-s/ldd/store/ut/ut_context.h

1 #iâdeà
__LDD__STORAGE_UT_CONTEXT_H_


2 
	#__LDD__STORAGE_UT_CONTEXT_H_


	)

4 
	~<¡dšt.h
>

5 
	~"../£rv”/commªd_ty³.h
"

6 
	~"Ãt/outgošg_msg.h
"

8 
Çme¥aû
 
	gldd
{

9 
Çme¥aû
 
	g´ÙocŞ
{

10 
şass
 
	gP»·»Mes§geS
;

11 
şass
 
	gMu‹Mes§geS
;

12 
şass
 
	gMes§ge
;

13 
şass
 
	gAtomicInüMes§geS
;

14 
şass
 
	gAtomicAµ’dMes§geS
;

19 
Çme¥aû
 
	gldd
{

20 
Çme¥aû
 
	g¡Üage
{

22 
usšg
 
Çme¥aû
 
	gldd
::
Ãt
;

23 
usšg
 
	gldd
::
´ÙocŞ
::
P»·»Mes§geS
;

24 
usšg
 
	gldd
::
´ÙocŞ
::
Mes§ge
;

25 
usšg
 
	gldd
::
´ÙocŞ
::
Mu‹Mes§geS
;

26 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicInüMes§geS
;

27 
usšg
 
	gldd
::
´ÙocŞ
::
AtomicAµ’dMes§geS
;

29 
şass
 
	gCÚfigMªag”
;

30 
şass
 
	gModifyBa£Task
;

32 
şass
 
	gR—dCÚ‹xt
 :

33 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_GET
>{

34 
public
:

35 
R—dCÚ‹xt
(
Mes§ge
* 
gms
) :

36 
gms_
(
gms
){

39 
	gvœtu®
 ~
R—dCÚ‹xt
();

41 
	g´Ùeùed
:

42 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

43 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

44 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

45 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

46 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

47 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

49 
	g´iv©e
:

50 
Mes§ge
* 
gms_
;

51 
	gÃt
::
Bufãr
 
bufãr_
;

54 
şass
 
	gCheckCÚ‹xt
 :

55 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_CHECK
>{

56 
public
:

57 
CheckCÚ‹xt
(
Mes§ge
* 
gms
) :

58 
gms_
(
gms
){

61 
	gvœtu®
 ~
CheckCÚ‹xt
();

63 
	g´Ùeùed
:

64 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

65 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

66 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

67 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

68 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

69 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

71 
	g´iv©e
:

72 
Mes§ge
* 
gms_
;

73 
	gÃt
::
Bufãr
 
bufãr_
;

76 
şass
 
	gMu‹CÚ‹xt
 :

77 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_MUTATE
>{

78 
public
:

79 
Mu‹CÚ‹xt
(
Mes§ge
* 
gms
) :

80 
gms_
(
gms
){

83 
	gvœtu®
 ~
Mu‹CÚ‹xt
();

85 
	g´Ùeùed
:

86 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

87 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

88 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

89 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

90 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

91 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

93 
	g´iv©e
:

94 
Mes§ge
* 
gms_
;

95 
	gÃt
::
Bufãr
 
bufãr_
;

98 
şass
 
	gLi¡CÚ‹xt
 :

99 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_LIST
>{

100 
public
:

101 
Li¡CÚ‹xt
(
Mes§ge
* 
gms
) :

102 
gms_
(
gms
){

105 
	gvœtu®
 ~
Li¡CÚ‹xt
();

107 
	g´Ùeùed
:

108 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

109 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

110 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

111 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

112 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

113 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

115 
	g´iv©e
:

116 
Mes§ge
* 
gms_
;

117 
	gÃt
::
Bufãr
 
bufãr_
;

120 
şass
 
	gAtomicInüCÚ‹xt
 :

121 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_ATOMIC_INCR
>{

122 
public
:

123 
AtomicInüCÚ‹xt
(
Mes§ge
* 
gms
) :

124 
gms_
(
gms
){

127 
	gvœtu®
 ~
AtomicInüCÚ‹xt
();

129 
	g´Ùeùed
:

130 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

131 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

132 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

133 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

134 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

135 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

137 
	g´iv©e
:

138 
Mes§ge
* 
gms_
;

139 
	gÃt
::
Bufãr
 
bufãr_
;

142 
şass
 
	gAtomicAµ’dCÚ‹xt
 :

143 
public
 
Ty³dOutgošgMsg
<
LDD_PROXY_2_STORE_ATOMIC_APPEND
>{

144 
public
:

145 
AtomicAµ’dCÚ‹xt
(
Mes§ge
* 
gms
) :

146 
gms_
(
gms
){

149 
	gvœtu®
 ~
AtomicAµ’dCÚ‹xt
();

151 
	g´Ùeùed
:

152 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

153 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

154 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
);

155 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

156 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
);

157 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
);

159 
	g´iv©e
:

160 
Mes§ge
* 
gms_
;

161 
	gÃt
::
Bufãr
 
bufãr_
;

	@/home/libin3-s/ldd/syn_client/internal/countdownlatch.h

1 #iâdeà
__LDD_CLIENT_SYN_COUNT_DOWN_LATCH_H_


2 
	#__LDD_CLIENT_SYN_COUNT_DOWN_LATCH_H_


	)

4 
	~<glog/loggšg.h
>

5 
	~"ldd/ut/mu‹x.h
"

7 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gş›Á
 {

12 
Çme¥aû
 
	gsyn
 {

14 şas 
	cCouÁDownL©ch
{

15 
	gpublic
:

16 
CouÁDownL©ch
(
couÁ
è: 
couÁ_
(couÁ),
cÚd_
(&
mu‹x_
){

20 
	gpublic
:

21 
Wa™
(){

22 
Mu‹xLock
 
lock
(&
mu‹x_
);

23 
	gcouÁ_
 > 0){

24 
	gcÚd_
.
Wa™
();

28 
CouÁDown
(){

29 
Mu‹xLock
 
lock
(&
mu‹x_
);

30 
	gcouÁ_
--;

31 ià(
	gcouÁ_
 == 0 )

33 
cÚd_
.
SigÇlAÎ
();

37 
	g´iv©e
:

38 
couÁ_
;

39 
Mu‹x
 
	gmu‹x_
;

40 
CÚdV¬
 
	gcÚd_
;

	@/home/libin3-s/ldd/syn_client/internal/syn_completion.h

1 #iâdeà
__LDD_CLIENT_SYN_CLIENT_COMPLETION__H_


2 
	#__LDD_CLIENT_SYN_CLIENT_COMPLETION__H_


	)

4 
	~<glog/loggšg.h
>

5 
	~"ldd/ut/mu‹x.h
"

6 
	~"couÁdowÆ©ch.h
"

8 
usšg
 
Çme¥aû
 
	gldd
::
ut
;

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gş›Á
 {

13 
Çme¥aû
 
	gsyn
 {

15 şas 
	cSynCom¶‘iÚ
{

16 
	gpublic
:

17 
SynCom¶‘iÚ
(è: 
v”siÚ_
(-1),
‰l_
(0), 
cÚd_
(&
mu‹x_
),

18 
com¶‘ed_
(
çl£
), 
Ïtch_
(
NULL
){

22 
	gpublic
:

23 
D©aCom¶‘iÚ
(
št64_t
 
v”siÚ
, cÚ¡ 
¡d
::
¡ršg
& 
v®ue
, 
ušt32_t
 
‰l
){

24 
	gv”siÚ_
 = 
v”siÚ
;

25 
	gv®ue_
 = 
v®ue
;

26 
	g‰l_
 = 
‰l
;

27 
LOG
(
INFO
)<<"DataCompletion() Signal()";

28 ià(
	gÏtch_
){

29 
	gÏtch_
->
CouÁDown
();

31 
SigÇl
();

33 
CheckCom¶‘iÚ
(
št64_t
 
v”siÚ
, 
ušt32_t
 
‰l
){

34 
	gv”siÚ_
 = 
v”siÚ
;

35 
	g‰l_
 = 
‰l
;

36 
LOG
(
INFO
)<<"CheckCompletion() Signal()";

37 ià(
	gÏtch_
){

38 
	gÏtch_
->
CouÁDown
();

40 
SigÇl
();

43 
Mu‹Com¶‘iÚ
(
št64_t
 
v”siÚ
){

44 
	gv”siÚ_
 = 
v”siÚ
;

45 
LOG
(
INFO
)<<"MutateCompletion() Signal()";

46 ià(
	gÏtch_
){

47 
	gÏtch_
->
CouÁDown
();

49 
SigÇl
();

52 
CasCom¶‘iÚ
(
št64_t
 
v”siÚ
, cÚ¡ 
¡d
::
¡ršg
& 
v®ue
){

53 
v”siÚ_
 = 
v”siÚ
;

54 
	gv®ue_
 = 
v®ue
;

55 
LOG
(
INFO
)<<"CasCompletion() Signal()";

56 ià(
	gÏtch_
){

57 
	gÏtch_
->
CouÁDown
();

59 
SigÇl
();

62 
Wa™Com¶‘iÚ
(){

63 
Mu‹xLock
 
lock
(&
mu‹x_
);

64 !
	gcom¶‘ed_
){

65 
LOG
(
INFO
)<<"wait()";

66 
	gcÚd_
.
Wa™
();

70 
	g¡d
::
¡ršg
& 
key
(){

71  
key_
;

74 
št64_t
 
v”siÚ
(){

75  
	gv”siÚ_
;

78 
ušt32_t
 
‰l
(){

79  
	g‰l_
;

82 
	g¡d
::
¡ršg
& 
v®ue
(){

83  
v®ue_
;

86 
S‘Info
(
¡d
::
¡ršg
 
key
, 
CouÁDownL©ch
* 
Ïtch
){

87 
	gkey_
ğ
key
;

88 
	gÏtch_
 = 
Ïtch
;

91 
	g´iv©e
:

92 
SigÇl
(){

93 
Mu‹xLock
 
lock
(&
mu‹x_
);

94 
	gcom¶‘ed_
 = 
Œue
;

95 
	gcÚd_
.
SigÇl
();

98 
	g´iv©e
:

99 
št64_t
 
v”siÚ_
;

100 
ušt32_t
 
	g‰l_
;

101 
	g¡d
::
¡ršg
 
key_
;

102 
	g¡d
::
¡ršg
 
v®ue_
;

104 
Mu‹x
 
	gmu‹x_
;

105 
CÚdV¬
 
	gcÚd_
;

106 
boŞ
 
	gcom¶‘ed_
;

108 
CouÁDownL©ch
* 
	gÏtch_
;

	@/home/libin3-s/ldd/syn_client/internal/synclient_impl.h

1 #iâdeà
__LDD_CLIENT_SYN_CLIENT_IMPL__H_


2 
	#__LDD_CLIENT_SYN_CLIENT_IMPL__H_


	)

5 
Çme¥aû
 
	gldd
 {

6 
Çme¥aû
 
	gş›Á
 {

7 
Çme¥aû
 
	g¿w
 {

9 
şass
 
	gCl›Á
;

10 
şass
 
	gRedoPŞicySim¶e
;

16 
Çme¥aû
 
	gldd
 {

17 
Çme¥aû
 
	gÃt
{

18 
şass
 
	gEv’tLoİTh»ad
;

19 
şass
 
	gCl›Á
;

23 
usšg
 
	gldd
::
ş›Á
::
¿w
::
Cl›Á
;

24 
usšg
 
	gldd
::
ş›Á
::
¿w
::
RedoPŞicySim¶e
;

25 
usšg
 
	gldd
::
Ãt
::
Ev’tLoİTh»ad
;

27 
	~"../syn_ş›Á.h
"

29 
Çme¥aû
 
	gldd
 {

30 
Çme¥aû
 
	gş›Á
 {

31 
Çme¥aû
 
	gsyn
 {

35 şas 
	cSynCl›ÁIm¶
 : 
public
 
SynCl›Á
{

36 
public
:

37 
SynCl›ÁIm¶
(cÚ¡ 
¡d
::
¡ršg
& 
ns
);

38 ~
SynCl›ÁIm¶
();

39 
In™
(cÚ¡ 
O±iÚ
& 
İtiÚ
, 
¿w
::
Provid”
* 
´ovid”
);

40 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
,cÚ¡ std::¡ršg& 
v®ue
) ;

41 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ std::¡ršg& 
v®ue
,

42 
št64_t
 
v”siÚ
) ;

43 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ std::¡ršg& 
v®ue
,

44 cÚ¡ 
¡d
::
¡ršg
& 
ex³ù_v®ue
) ;

45 
vœtu®
 
Put
(
¡d
::
m­
<¡d::
¡ršg
,

46 
¡d
::
·œ
<¡d::
¡ršg
, 
ušt64_t
> >& 
kvs
) ;

49 
vœtu®
 
G‘
(cÚ¡ 
¡d
::
¡ršg
&
key
, std::¡ršg* 
v®ue
) ;

50 
vœtu®
 
G‘
(
¡d
::
m­
<¡d::
¡ršg
,

51 
¡d
::
·œ
<
ušt64_t
, std::
¡ršg
> >& 
kvs
);

52 
vœtu®
 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
key
) ;

54 
vœtu®
 
Li¡
(cÚ¡ 
¡d
::
¡ršg
& 
key
, 
ušt32_t
 
lim™
, 
ušt8_t
 
pos™iÚ
);

56 
	gpublic
:

57 
¡d
::
¡ršg
& 
NameS·û
();

58 
	g´iv©e
:

59 
DoPut
(
ldd
::
ş›Á
::
¿w
::
MutiÚ
& 
mu
);

60 
	g´iv©e
:

61 
ldd
::
Ãt
::
Ev’tLoİTh»ad
* 
ev’t_th»ad_loİ_
;

62 
	gldd
::
Ãt
::
Cl›Á
* 
Ãt_ş›Á_
;

63 
Cl›Á
* 
	gldd_ş›Á_
;

64 
RedoPŞicySim¶e
* 
	g½_
;

65 
ušt64_t
 
	g‰l_
;

66 
	g¡d
::
¡ršg
 
Çme_¥aû_
;

67 
	gş›Á
::
¿w
::
Provid”
* 
´ovid”_
;

	@/home/libin3-s/ldd/syn_client/ldd_bench/histogram.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


6 
	#STORAGE_LEVELDB_UTIL_HISTOGRAM_H_


	)

8 
	~<¡ršg
>

9 
	~"¦iû.h
"

10 
	~"‹¡ut.h
"

11 
	~<gæags/gæags.h
>

13 
Aµ’dW™hS·û
(
¡d
::
¡ršg
* 
¡r
, 
Sliû
 
msg
);

17 
DECLARE_boŞ
(
hi¡og¿m
);

18 
DECLARE_doubË
(
com´essiÚ_¿tio
);

20 şas 
	cHi¡og¿m
 {

21 
	mpublic
:

22 
	$Hi¡og¿m
() { }

23 ~
	$Hi¡og¿m
(è{ 
	}
}

25 
CË¬
();

26 
Add
(
v®ue
);

27 
M”ge
(cÚ¡ 
Hi¡og¿m
& 
Ùh”
);

29 
	g¡d
::
¡ršg
 
	$ToSŒšg
() const;

31 
´iv©e
:

32 
mš_
;

33 
max_
;

34 
num_
;

35 
sum_
;

36 
sum_squ¬es_
;

38 ’um { 
kNumBuck‘s
 = 154 
	}
};

39 cÚ¡ 
	gkBuck‘Lim™
[
kNumBuck‘s
];

40 
	gbuck‘s_
[
kNumBuck‘s
];

42 
	$MedŸn
() const;

43 
	$P”ûÁe
(
p
) const;

44 
	$Av”age
() const;

45 
	$Snd¬dDevŸtiÚ
() const;

46 
	}
};

50 şas 
	cSts
 {

51 
	m´iv©e
:

52 
¡¬t_
;

53 
	mfšish_
;

54 
	m£cÚds_
;

55 
	mdÚe_
;

56 
	mÃxt_»pÜt_
;

57 
št64_t
 
	mby‹s_
;

58 
	mÏ¡_İ_fšish_
;

59 
Hi¡og¿m
 
	mhi¡_
;

60 
	m¡d
::
¡ršg
 
mes§ge_
;

62 
	mpublic
:

63 
	$Sts
(è{ 
	`S¹
(); }

65 
	$S¹
() {

66 
Ãxt_»pÜt_
 = 100;

67 
Ï¡_İ_fšish_
 = 
¡¬t_
;

68 
hi¡_
.
	`CË¬
();

69 
dÚe_
 = 0;

70 
by‹s_
 = 0;

71 
£cÚds_
 = 0;

72 
¡¬t_
 = 
	`NowMiüos
();

73 
fšish_
 = 
¡¬t_
;

74 
mes§ge_
.
	`ş—r
();

75 
	}
}

77 
	$M”ge
(cÚ¡ 
Sts
& 
Ùh”
) {

78 
hi¡_
.
	`M”ge
(
Ùh”
.hist_);

79 
dÚe_
 +ğ
Ùh”
.done_;

80 
by‹s_
 +ğ
Ùh”
.bytes_;

82 ià(
Ùh”
.
¡¬t_
 < start_) start_ = other.start_;

83 ià(
Ùh”
.
fšish_
 > finish_) finish_ = other.finish_;

86 ià(
mes§ge_
.
	`em±y
()èmes§ge_ = 
Ùh”
.message_;

87 
	}
}

89 
	$Stİ
() {

90 
fšish_
 = 
	`NowMiüos
();

91 
£cÚds_
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

92 
	}
}

94 
	$AddMes§ge
(
Sliû
 
msg
) {

95 
	`Aµ’dW™hS·û
(&
mes§ge_
, 
msg
);

96 
	}
}

98 
	$FšishedSšgËOp
() {

99 ià(
FLAGS_hi¡og¿m
) {

100 
now
 = 
	`NowMiüos
();

101 
miüos
 = 
now
 - 
Ï¡_İ_fšish_
;

102 
hi¡_
.
	`Add
(
miüos
);

103 ià(
miüos
 > 20000) {

107 
Ï¡_İ_fšish_
 = 
now
;

110 
dÚe_
++;

111 ià(
dÚe_
 >ğ
Ãxt_»pÜt_
) {

112 ià(
Ãxt_»pÜt_
 < 1000)‚ext_report_ += 100;

113 ià(
Ãxt_»pÜt_
 < 5000)‚ext_report_ += 500;

114 ià(
Ãxt_»pÜt_
 < 10000)‚ext_report_ += 1000;

115 ià(
Ãxt_»pÜt_
 < 50000)‚ext_report_ += 5000;

116 ià(
Ãxt_»pÜt_
 < 100000)‚ext_report_ += 10000;

117 ià(
Ãxt_»pÜt_
 < 500000)‚ext_report_ += 50000;

118 
Ãxt_»pÜt_
 += 100000;

122 
	}
}

124 
	$AddBy‹s
(
št64_t
 
n
) {

125 
by‹s_
 +ğ
n
;

126 
	}
}

128 
	$R•Üt
(cÚ¡ 
Sliû
& 
Çme
) {

131 ià(
dÚe_
 < 1) done_ = 1;

133 
¡d
::
¡ršg
 
exŒa
;

134 ià(
by‹s_
 > 0) {

137 
–­£d
 = (
fšish_
 - 
¡¬t_
) * 1e-6;

138 
¿‹
[100];

139 
	`¢´štf
(
¿‹
, (rate), "%6.1f MB/s",

140 (
by‹s_
 / 1048576.0è/ 
–­£d
);

141 
exŒa
 = 
¿‹
;

143 
	`Aµ’dW™hS·û
(&
exŒa
, 
mes§ge_
);

145 
	`årštf
(
¡dout
, "%-12s : %11.3f micros/op; %11.3f op/second; %s%s\n",

146 
Çme
.
	`ToSŒšg
().
	`c_¡r
(),

147 
£cÚds_
 * 1e6 / 
dÚe_
, (done_*1e6)/(seconds_ * 1e6),

148 (
exŒa
.
	`em±y
() ? "" : " "),

149 
exŒa
.
	`c_¡r
());

150 ià(
FLAGS_hi¡og¿m
) {

151 
	`årštf
(
¡dout
, "Miüo£cÚd ³¸İ:\n%s\n", 
hi¡_
.
	`ToSŒšg
().
	`c_¡r
());

153 
	`fæush
(
¡dout
);

154 
	}
}

159 şas 
	cRªdomG’”©Ü
 {

160 
	m´iv©e
:

161 
¡d
::
¡ršg
 
d©a_
;

162 
	mpos_
;

164 
	mpublic
:

165 
	$RªdomG’”©Ü
() {

169 
Rªdom
 
	`ºd
(301);

170 
¡d
::
¡ršg
 
p›û
;

171 
d©a_
.
	`size
() < 10485760) {

174 
	`Com´essibËSŒšg
(&
ºd
, 
FLAGS_com´essiÚ_¿tio
, 100, &
p›û
);

175 
d©a_
.
	`­³nd
(
p›û
);

177 
pos_
 = 0;

180 
Sliû
 
	$G’”©e
(
Ën
) {

181 ià((
size_t
)
pos_
 + 
Ën
 > 
d©a_
.
	`size
()) {

182 
pos_
 = 0;

183 
	`as£¹
((
size_t
)
Ën
 < 
d©a_
.
	`size
());

185 
pos_
 +ğ
Ën
;

186  
	`Sliû
(
d©a_
.
	`d©a
(è+ 
pos_
 - 
Ën
,†en);

187 
	}
}

	@/home/libin3-s/ldd/syn_client/ldd_bench/random.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_RANDOM_H_


6 
	#STORAGE_LEVELDB_UTIL_RANDOM_H_


	)

8 
	~<¡dšt.h
>

15 şas 
	cRªdom
 {

16 
	m´iv©e
:

17 
ušt32_t
 
£ed_
;

18 
	mpublic
:

19 
ex¶ic™
 
	$Rªdom
(
ušt32_t
 
s
è: 
	$£ed_
(
s
 & 0x7fffffffu) {

21 ià(
£ed_
 == 0 || seed_ == 2147483647L) {

22 
£ed_
 = 1;

25 
ušt32_t
 
	$Next
() {

26 cÚ¡ 
ušt32_t
 
M
 = 2147483647L;

27 cÚ¡ 
ušt64_t
 
A
 = 16807;

34 
ušt64_t
 
´oduù
 = 
£ed_
 * 
A
;

37 
£ed_
 = 
¡©ic_ÿ¡
<
ušt32_t
>((
´oduù
 >> 31è+ (´oduù & 
M
));

41 ià(
£ed_
 > 
M
) {

42 
£ed_
 -ğ
M
;

44  
£ed_
;

45 
	}
}

48 
ušt32_t
 
	$UnifÜm
(
n
è{  
	`Next
(è%‚; 
	}
}

52 
boŞ
 
	$OÃIn
(
n
è{  (
	`Next
(è%‚è=ğ0; 
	}
}

57 
ušt32_t
 
	$Skewed
(
max_log
) {

58  
	`UnifÜm
(1 << UnifÜm(
max_log
 + 1));

59 
	}
}

	@/home/libin3-s/ldd/syn_client/ldd_bench/slice.h

15 #iâdeà
STORAGE_LEVELDB_INCLUDE_SLICE_H_


16 
	#STORAGE_LEVELDB_INCLUDE_SLICE_H_


	)

18 
	~<as£¹.h
>

19 
	~<¡ddef.h
>

20 
	~<¡ršg.h
>

21 
	~<¡ršg
>

24 şas 
	cSliû
 {

25 
	mpublic
:

27 
	$Sliû
(è: 
	`d©a_
(""), 
	$size_
(0) { }

30 
	$Sliû
(cÚ¡ * 
d
, 
size_t
 
n
è: 
	`d©a_
(d), 
	$size_
(
n
è{ 
	}
}

33 
Sliû
(cÚ¡ 
¡d
::
¡ršg
& 
s
è: 
d©a_
(s.
d©a
()), 
size_
(s.
	$size
()è{ 
	}
}

36 
	$Sliû
(cÚ¡ * 
s
è: 
	`d©a_
(s), 
	`size_
(
	$¡¾’
(
s
)è{ 
	}
}

39 cÚ¡ * 
	$d©a
(ècÚ¡ {  
d©a_
; 
	}
}

42 
size_t
 
	$size
(ècÚ¡ {  
size_
; 
	}
}

45 
boŞ
 
	$em±y
(ècÚ¡ {  
size_
 =ğ0; 
	}
}

49 
	gİ”©Ü
[](
size_t
 
	gn
) const {

50 
as£¹
(
n
 < 
size
());

51  
	gd©a_
[
n
];

55 
	$ş—r
(è{ 
d©a_
 = ""; 
size_
 = 0; 
	}
}

58 
	$»move_´efix
(
size_t
 
n
) {

59 
	`as£¹
(
n
 <ğ
	`size
());

60 
d©a_
 +ğ
n
;

61 
size_
 -ğ
n
;

62 
	}
}

65 
	g¡d
::
¡ršg
 
	$ToSŒšg
(ècÚ¡ {  
¡d
::
	`¡ršg
(
d©a_
, 
size_
); 
	}
}

71 
	$com·»
(cÚ¡ 
Sliû
& 
b
) const;

74 
boŞ
 
	$¡¬ts_w™h
(cÚ¡ 
Sliû
& 
x
) const {

75  ((
size_
 >ğ
x
.size_) &&

76 (
	`memcmp
(
d©a_
, 
x
.d©a_, x.
size_
) == 0));

77 
	}
}

79 
	g´iv©e
:

80 cÚ¡ * 
d©a_
;

81 
size_t
 
	gsize_
;

86 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
) {

87  ((
	gx
.
size
(è=ğ
y
.size()) &&

88 (
memcmp
(
x
.
d©a
(), 
y
.d©a(), x.
size
()) == 0));

91 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
) {

92  !(
	gx
 =ğ
y
);

95 
šlše
 
	gSliû
::
	$com·»
(cÚ¡ 
Sliû
& 
b
) const {

96 cÚ¡ 
mš_Ën
 = (
size_
 < 
b
.size_) ? size_ : b.size_;

97 
r
 = 
	`memcmp
(
d©a_
, 
b
.d©a_, 
mš_Ën
);

98 ià(
r
 == 0) {

99 ià(
size_
 < 
b
.size_è
r
 = -1;

100 ià(
size_
 > 
b
.size_è
r
 = +1;

102  
r
;

103 
	}
}

	@/home/libin3-s/ldd/syn_client/ldd_bench/testutil.h

5 #iâdeà
STORAGE_LEVELDB_UTIL_TESTUTIL_H_


6 
	#STORAGE_LEVELDB_UTIL_TESTUTIL_H_


	)

9 
	~"¦iû.h
"

10 
	~"¿ndom.h
"

14 
ušt64_t
 
NowMiüos
();

16 
SË•FÜMiüo£cÚds
(
miüos
);

19 
	g¡d
::
¡ršg
 
TimeToSŒšg
();

24 
Sliû
 
RªdomSŒšg
(
Rªdom
* 
ºd
, 
Ën
, 
¡d
::
¡ršg
* 
d¡
);

28 
	g¡d
::
¡ršg
 
RªdomKey
(
Rªdom
* 
ºd
, 
Ën
);

33 
Sliû
 
Com´essibËSŒšg
(
Rªdom
* 
ºd
, 
com´es£d_äaùiÚ
,

34 
Ën
, 
¡d
::
¡ršg
* 
d¡
);

	@/home/libin3-s/ldd/syn_client/syn_client.h

1 #iâdeà
__LDD_SYN_CLIENT__H_


2 
	#__LDD_SYN_CLIENT__H_


	)

5 
	~<¡dšt.h
>

6 
	~<¡ršg
>

7 
	~<m­
>

10 
Çme¥aû
 
	gldd
{

11 
Çme¥aû
 
	gş›Á
{

12 
Çme¥aû
 
	g¿w
{

13 
şass
 
	gProvid”
;

19 
Çme¥aû
 
	gldd
 {

20 
Çme¥aû
 
	gş›Á
 {

21 
Çme¥aû
 
	gsyn
 {

23 
	eE¼ÜCode
{

24 
	gkOk
 = 0,

26 
	gkNÙEnoughMem
 = -808,

27 
	gkUnknown
 = -809,

28 
	gkDbLßdE¼Ü
 = -810,

29 
	gkCacheLßdE¼Ü
 = -811,

30 
	gkInv®idP¬am‘”
 = -812

34 
	sO±iÚ
{

35 
O±iÚ
(è: 
pul£_š‹rv®
(100),

36 
cÚÃù_timeout
(10),

37 
»sŞve_timeout
(10),

38 
»cv_timeout
(100),

39 
dÚe_timeout
(300),

40 
‰l
(0),

41 
»Œy_š‹rv®
(0),

42 
zk_timeout
(200){

45 
	gpul£_š‹rv®
 ;

46 
	gcÚÃù_timeout
 ;

47 
	g»sŞve_timeout
 ;

48 
	g»cv_timeout
 ;

49 
	gdÚe_timeout
 ;

50 
	g‰l
;

53 
	g¡d
::
¡ršg
 
Çme_¥aû
;

54 
ušt32_t
 
	g»Œy_š‹rv®
;

55 
	g¡d
::
¡ršg
 
zk_ho¡_pÜt
;

56 
	g¡d
::
¡ršg
 
zk_ba£_·th
;

57 
	gzk_timeout
;

61 şas 
	cSynCl›Á
{

62 
	gpublic
:

63 
vœtu®
 ~
SynCl›Á
();

68 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
,cÚ¡ std::¡ršg& 
v®ue
) = 0;

74 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ std::¡ršg& 
v®ue
,

75 
št64_t
 
v”siÚ
) = 0;

81 
vœtu®
 
Put
(cÚ¡ 
¡d
::
¡ršg
& 
key
, cÚ¡ std::¡ršg& 
v®ue
,

82 cÚ¡ 
¡d
::
¡ršg
& 
ex³ù_v®ue
) = 0;

88 
vœtu®
 
Put
(
¡d
::
m­
<¡d::
¡ršg
,

89 
¡d
::
·œ
<¡d::
¡ršg
, 
ušt64_t
> >& 
kvs
) = 0;

91 
vœtu®
 
G‘
(cÚ¡ 
¡d
::
¡ršg
&
key
, std::¡ršg* 
v®ue
)= 0;

97 
vœtu®
 
G‘
(
¡d
::
m­
<¡d::
¡ršg
,

98 
¡d
::
·œ
<
ušt64_t
, std::
¡ršg
> >& 
kvs
)= 0;

100 
vœtu®
 
D–‘e
(cÚ¡ 
¡d
::
¡ršg
& 
key
)= 0;

106 
vœtu®
 
Li¡
(cÚ¡ 
¡d
::
¡ršg
& 
key
, 
ušt32_t
 
lim™
, 
ušt8_t
 
pos™iÚ
)=0;

116 
NewSynCl›Á
(
SynCl›Á
** 
sc
, 
¿w
::
Provid”
* 
´ovid”
, cÚ¡ 
O±iÚ
& 
İtiÚ
);

	@/home/libin3-s/ldd/util/atomic.h

4 #iâdeà
LDD_UTIL_ATOMIC_H_


5 
	#LDD_UTIL_ATOMIC_H_


	)

7 
	~<c¡ddef
>

8 
	~<boo¡/c¡dšt.hµ
>

9 
	~<boo¡/ty³_Œa™s/is_sigÃd.hµ
>

10 
	~<boo¡/ty³_Œa™s/is_š‹g¿l.hµ
>

11 
	~"ldd/ut/memÜy_Üd”.h
"

12 
	~"ldd/ut/d‘a/©omic/¶©fÜm.h
"

13 
	~"ldd/ut/d‘a/©omic/şassifiÿtiÚ.h
"

15 
Çme¥aû
 
	gldd
 {

16 
Çme¥aû
 
	gut
 {

18 
	g‹m¶©e
 <
ty³Çme
 
	gT
>

19 
şass
 
	gAtomic
 :

20 
public
 
d‘a
::
AtomicBa£
<

21 
T
,

22 
ty³Çme
 
	gd‘a
::
CÏssify
<
T
>::
Ty³
,

23 
	gd‘a
::
StÜageSizeOf
<
T
>::
v®ue
,

24 
	gboo¡
::
is_sigÃd
<
T
>::
v®ue


27 
´iv©e
:

28 
T
 
	tV®ue
;

29 
	gd‘a
::
	tAtomicBa£
<
	tT
,

30 
	tty³Çme
 
	td‘a
::
	tCÏssify
<
	tT
>::
	tTy³
,

31 
	td‘a
::
	tStÜageSizeOf
<
	tT
>::
	tv®ue
,

32 
	tboo¡
::
	tis_sigÃd
<
	tT
>::
	tv®ue
> 
	tSu³r
;

33 
	gpublic
:

34 
Atomic
(è: 
Su³r
() {}

35 
Atomic
(
V®ue
 
v
è: 
Su³r
(v) {}

37 
V®ue
 
İ”©Ü
=(V®u
v
) volatile {

38 
this
->
StÜe
(
v
);

39  
	gv
;

41 
İ”©Ü
 
V®ue
() volatile const {

42  
	gthis
->
Lßd
();

44 
	g´iv©e
:

45 
Atomic
(const Atomic&);

46 
	gAtomic
& 
	gİ”©Ü
=(cÚ¡ 
Atomic
&) volatile;

49 #iâdeà
LDD_UTIL_ATOMIC_FLAG_LOCK_FREE


50 
	#LDD_UTIL_ATOMIC_FLAG_LOCK_FREE
 0

	)

51 şas 
	cAtomicFÏg
 {

52 
	gpublic
:

53 
AtomicFÏg
(è: 
v_
(
çl£
) {}

55 
boŞ


56 
Te¡AndS‘
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) {

57  
v_
.
Exchªge
(
Œue
, 
Üd”
);

61 
CË¬
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

62 
v_
.
StÜe
(
çl£
, 
Üd”
);

64 
	g´iv©e
:

65 
AtomicFÏg
(const AtomicFlag&);

66 
	gAtomicFÏg
& 
	gİ”©Ü
=(cÚ¡ 
AtomicFÏg
&);

67 
	gAtomic
<
	gboŞ
> 
	gv_
;

	@/home/libin3-s/ldd/util/const_buffer.h

4 #iâdeà
LDD_UTIL_CONST_BUFFER_H_


5 
	#LDD_UTIL_CONST_BUFFER_H_


	)

7 
	~<ldd/ut/mubË_bufãr.h
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gut
 {

12 şas 
	cCÚ¡Bufãr
 {

13 
	gpublic
:

14 
CÚ¡Bufãr
(): 
d©a_
(""), 
size_
(0) {}

15 
CÚ¡Bufãr
(cÚ¡ * 
buf
, 
size_t
 
size
)

16 : 
d©a_
(
¡©ic_ÿ¡
<cÚ¡ *>(
buf
)), 
size_
(
size
) {}

17 
CÚ¡Bufãr
(cÚ¡ * 
buf
, 
size_t
 
size
)

18 : 
d©a_
(
buf
), 
size_
(
size
 ) {}

19 
CÚ¡Bufãr
(cÚ¡ 
MubËBufãr
& 
b
): 
d©a_
(b.
d©a
()), 
size_
(b.
size
()) {}

20 
CÚ¡Bufãr
(cÚ¡ 
¡d
::
¡ršg
& 
s
): 
d©a_
(s.
d©a
()), 
size_
(s.
size
()) {}

21 
CÚ¡Bufãr
(cÚ¡ * 
s
): 
d©a_
(s), 
size_
(
¡¾’
(s)) {}

23 cÚ¡ * 
d©a
(ècÚ¡ {  
	gd©a_
; }

24 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

25 
boŞ
 
em±y
(ècÚ¡ {  
	gsize_
 == 0; }

26 
	gİ”©Ü
[](
size_t
 
	gn
) const {

27 
as£¹
(
n
 < 
size
());

28  
	gd©a_
[
n
];

31 
CË¬
(è{ 
	gd©a_
 = ""; 
	gsize_
 = 0; }

32 
RemoveP»fix
(
size_t
 
n
) {

33 
as£¹
(
n
 <ğ
size
());

34 
	gd©a_
 +ğ
n
;

35 
	gsize_
 -ğ
n
;

37 
RemovePo¡fix
(
size_t
 
n
) {

38 
as£¹
(
n
 <ğ
size
());

39 
	gsize_
 -ğ
n
;

41 
	g¡d
::
¡ršg
 
ToSŒšg
(ècÚ¡ {  
¡d
::¡ršg(
d©a_
, 
size_
); }

43 
boŞ
 
S¹sW™h
(cÚ¡ 
CÚ¡Bufãr
& 
x
) const {

44  ((
	gsize_
 >ğ
x
.
size_
) &&

45 (
memcmp
(
d©a_
, 
x
.d©a_, x.
size_
) == 0));

47 
boŞ
 
EndsW™h
(cÚ¡ 
CÚ¡Bufãr
& 
x
) const {

48  ((
	gsize_
 >ğ
x
.
size_
) &&

49 (
memcmp
(
d©a_
 + 
size_
 - 
x
.size_, x.data_, x.size_) == 0));

52 
Com·»
(cÚ¡ 
CÚ¡Bufãr
& 
b
) const;

53 
	g´iv©e
:

54 cÚ¡ * 
d©a_
;

55 
size_t
 
	gsize_
;

58 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
CÚ¡Bufãr
& 
x
, cÚ¡ 
	gCÚ¡Bufãr
& 
	gy
) {

59  ((
	gx
.
size
(è=ğ
y
.size()) &&

60 (
memcmp
(
x
.
d©a
(), 
y
.d©a(), x.
size
()) == 0));

62 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
CÚ¡Bufãr
& 
x
, cÚ¡ 
	gCÚ¡Bufãr
& 
	gy
) {

63  !(
	gx
 =ğ
y
);

66 
šlše
 
	gCÚ¡Bufãr
::
Com·»
(cÚ¡ 
CÚ¡Bufãr
& 
b
) const {

67 cÚ¡ 
mš_Ën
 = (
size_
 < 
b
.size_) ? size_ : b.size_;

68 
	gr
 = 
memcmp
(
d©a_
, 
b
.d©a_, 
mš_Ën
);

69 ià(
	gr
 == 0) {

70 ià(
size_
 < 
b
.size_è
r
 = -1;

71 ià(
	gsize_
 > 
	gb
.size_è
	gr
 = +1;

73  
	gr
;

	@/home/libin3-s/ldd/util/detail/atomic/base.h

4 #iâdeà
LDD_UTIL_DETAIL_ATOMIC_BASE_H_


5 
	#LDD_UTIL_DETAIL_ATOMIC_BASE_H_


	)

7 
	~<¡ršg.h
>

8 
	~<¡dšt.h
>

9 
	~<c¡ddef
>

10 
	~"ldd/ut/d‘a/©omic/lockpoŞ.h
"

12 
	#LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS
 \

13 
boŞ
 \

14 
	`Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
, \

15 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile { \

16  
	`Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
, \

17 
Üd”
, 
	`C®cuÏ‹Fau»Ord”
(order)); \

19 
boŞ
 \

20 
	`Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
, \

21 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile { \

22  
	`Com·»ExchªgeW—k
(
ex³ùed
, 
desœed
, \

23 
Üd”
, 
	`C®cuÏ‹Fau»Ord”
(order)); \

25 

	)

26 
	#LDD_UTIL_ATOMIC_DECLARE_ADDITIVE_OPERATORS
 \

27 
V®ue
 
İ”©Ü
++() volatile { \

28  
	`F‘chAdd
(1); \

30 
V®ue
 
İ”©Ü
++() volatile { \

31  
	`F‘chAdd
(1) + 1; \

33 
V®ue
 
İ”©Ü
--() volatile { \

34  
	`F‘chSub
(1); \

36 
V®ue
 
İ”©Ü
--() volatile { \

37  
	`F‘chSub
(1) -1; \

39 
V®ue
 
İ”©Ü
+=(
Difã»nû
 
v
) volatile { \

40  
	`F‘chAdd
(
v
) + v; \

42 
V®ue
 
İ”©Ü
-=(
Difã»nû
 
v
) volatile { \

43  
	`F‘chSub
(
v
) - v; \

45 

	)

46 
	#LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_ADDITIVE_OPERATORS
 \

47 
V®ue
 
İ”©Ü
++() volatile { \

48  
	`F‘chAdd
(1); \

50 
V®ue
 
İ”©Ü
++() volatile { \

51  (*)
	`F‘chAdd
(1) + 1; \

53 
V®ue
 
İ”©Ü
--() volatile { \

54  
	`F‘chSub
(1); \

56 
V®ue
 
İ”©Ü
--() volatile { \

57  (*)
	`F‘chSub
(1) - 1; \

59 
V®ue
 
İ”©Ü
+=(
Difã»nû
 
v
) volatile { \

60  (*)
	`F‘chAdd
(
v
) + v; \

62 
V®ue
 
İ”©Ü
-=(
Difã»nû
 
v
) volatile { \

63  (*)
	`F‘chSub
(
v
) - v; \

65 

	)

66 
	#LDD_UTIL_ATOMIC_DECLARE_BIT_OPERATORS
 \

67 
V®ue
 
İ”©Ü
&=(
Difã»nû
 
v
) volatile { \

68  
	`F‘chAnd
(
v
) & v; \

70 
V®ue
 
İ”©Ü
|=(
Difã»nû
 
v
) volatile { \

71  
	`F‘chOr
(
v
) | v; \

73 
V®ue
 
İ”©Ü
^=(
Difã»nû
 
v
) volatile { \

74  
	`F‘chXÜ
(
v
) ^ v; \

76 

	)

77 
	#LDD_UTIL_ATOMIC_DECLARE_POINTER_OPERATORS
 \

78 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS
 \

79 
LDD_UTIL_ATOMIC_DECLARE_ADDITIVE_OPERATORS
 \

80 

	)

81 
	#LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_OPERATORS
 \

82 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS
 \

83 
LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_ADDITIVE_OPERATORS
 \

84 

	)

85 
	#LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS
 \

86 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS
 \

87 
LDD_UTIL_ATOMIC_DECLARE_ADDITIVE_OPERATORS
 \

88 
LDD_UTIL_ATOMIC_DECLARE_BIT_OPERATORS
 \

89 

	)

90 
Çme¥aû
 
	gldd
 {

91 
Çme¥aû
 
	gut
 {

92 
Çme¥aû
 
	gd‘a
 {

94 
šlše
 
	gMemÜyOrd”
::
Ty³


95 
C®cuÏ‹Fau»Ord”
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

96 
Üd”
) {

97 
MemÜyOrd”
::
kAcquœeR–—£
:

98  
MemÜyOrd”
::
kAcquœe
;

99 
	gMemÜyOrd”
::
kR–—£
:

100  
MemÜyOrd”
::
kR–axed
;

102  
Üd”
;

106 
	g‹m¶©e
 <
ty³Çme
 
	gT
,y³Çm
	gC
, 
	gSize
, 
boŞ
 
	gSign
>

107 şas 
	cAtomicBa£
 {

108 
	g´iv©e
:

109 
AtomicBa£
 
	tThis
;

110 
T
 
	tV®ue
;

111 
T
 
	tDifã»nû
;

112 
	gLockPoŞ
::
	tScİedLock
 
	tGu¬d
;

113 
	tStÜage
[(
V®ue
)];

115 
	gpublic
:

116 
AtomicBa£
() {}

117 
ex¶ic™
 
AtomicBa£
(
V®ue
 cÚ¡& 
v
): 
v_
(v) {}

120 
StÜe
(
V®ue
 cÚ¡& 
v
,

121 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile

123 * 
¡Üage
 = 
¡Üage_±r
();

124 
Gu¬d
 
gu¬d
(
¡Üage
);

125 
memıy
(
¡Üage
, &
v
, (
V®ue
));

128 
V®ue


129 
Lßd
(
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile const{

130 * 
¡Üage
 = 
¡Üage_±r
();

131 
Gu¬d
 
gu¬d
(
¡Üage
);

132 
V®ue
 
	gv
;

133 
memıy
(&
v
, 
¡Üage
, (
V®ue
));

134  
	gv
;

137 
boŞ


138 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

139 
MemÜyOrd”
::
Ty³
 ,

140 
MemÜyOrd”
::
Ty³
 ) volatile {

141 * 
¡Üage
 = 
¡Üage_±r
();

142 
Gu¬d
 
gu¬d
(
¡Üage
);

143 ià(
memcmp
(
¡Üage
, 
ex³ùed
, (
V®ue
)) == 0) {

144 
memıy
(
¡Üage
, &
desœed
, (
V®ue
));

145  
	gŒue
;

147 
memıy
(
ex³ùed
, 
¡Üage
, (
V®ue
));

148  
	gçl£
;

152 
boŞ


153 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

154 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

155 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

156  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

157 
sucûss_Üd”
, 
çu»_Üd”
);

160 
V®ue


161 
Exchªge
(
V®ue
 cÚ¡& 
v
,

162 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

163 * 
¡Üage
 = 
¡Üage_±r
();

164 
Gu¬d
 
gu¬d
(
¡Üage
);

165 
V®ue
 
	gtmp
;

166 
memıy
(&
tmp
, 
¡Üage
, (
V®ue
));

167 
memıy
(
¡Üage
, &
v
, (
V®ue
));

168  
	gtmp
;

171 
boŞ
 
IsLockF»e
() const volatile {

172  
	gçl£
;

175 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS


176 
	g´iv©e
:

177 * 
¡Üage_±r
() volatile const {

178  
cÚ¡_ÿ¡
<*>(&
»š‹½»t_ÿ¡
<cÚ¡ vŞ©e&>(
v_
));

181 
AtomicBa£
(const AtomicBase&);

182 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

183 
V®ue
 
	gv_
;

186 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
boŞ
 
	gSign
>

187 
şass
 
	gAtomicBa£
<
	gT
, , 
	gSize
, 
	gSign
>

189 
	g´iv©e
:

190 
AtomicBa£
 
	tThis
;

191 
T
 
	tV®ue
;

192 
T
 
	tDifã»nû
;

193 
	gLockPoŞ
::
	tScİedLock
 
	tGu¬d
;

194 
	gpublic
:

195 
AtomicBa£
() {}

196 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

199 
StÜe
(
V®ue
 
v
,

200 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

201 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

202 
	gv_
 = 
v
;

205 
V®ue


206 
Lßd
(
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) const volatile{

207 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

208 
V®ue
 
	gv
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

209  
	gv
;

212 
V®ue


213 
Exchªge
(
V®ue
 
v
,

214 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

215 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

216 
V®ue
 
	gŞd
 = 
v_
;

217 
	gv_
 = 
v
;

218  
	gŞd
;

221 
boŞ


222 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

223 
MemÜyOrd”
::
Ty³
 ,

224 
MemÜyOrd”
::
Ty³
 ) volatile {

225 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

226 ià(
	gv_
 =ğ*
ex³ùed
) {

227 
v_
 = 
desœed
;

228  
	gŒue
;

230 *
	gex³ùed
 = 
v_
;

231  
	gçl£
;

235 
boŞ


236 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

237 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

238 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

239  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

240 
sucûss_Üd”
, 
çu»_Üd”
);

243 
V®ue


244 
F‘chAdd
(
Difã»nû
 
v
,

245 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

246 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

247 
V®ue
 
	gŞd
 = 
v_
;

248 
	gv_
 +ğ
v
;

249  
	gŞd
;

252 
V®ue


253 
F‘chSub
(
Difã»nû
 
v
,

254 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

255 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

256 
V®ue
 
	gŞd
 = 
v_
;

257 
	gv_
 -ğ
v
;

258  
	gŞd
;

261 
V®ue


262 
F‘chAnd
(
V®ue
 
v
,

263 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

264 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

265 
V®ue
 
	gŞd
 = 
v_
;

266 
	gv_
 &ğ
v
;

267  
	gŞd
;

270 
V®ue


271 
F‘chOr
(
V®ue
 
v
,

272 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

273 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

274 
V®ue
 
	gŞd
 = 
v_
;

275 
	gv_
 |ğ
v
;

276  
	gŞd
;

279 
V®ue


280 
F‘chXÜ
(
V®ue
 
v
,

281 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

282 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

283 
V®ue
 
	gŞd
 = 
v_
;

284 
	gv_
 ^ğ
v
;

285  
	gŞd
;

288 
boŞ
 
IsLockF»e
() const volatile {

289  
	gçl£
;

292 
LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS


293 
	g´iv©e
:

294 
AtomicBa£
(const AtomicBase&);

295 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

296 
V®ue
 
	gv_
;

299 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
	gSize
, 
boŞ
 
	gSign
>

300 
şass
 
	gAtomicBa£
<
	gT
*, *, 
	gSize
, 
	gSign
>

302 
	g´iv©e
:

303 
AtomicBa£
 
	tThis
;

304 
T
* 
	tV®ue
;

305 
±rdiff_t
 
	tDifã»nû
;

306 
	gLockPoŞ
::
	tScİedLock
 
	tGu¬d
;

307 
	gpublic
:

308 
AtomicBa£
() {}

309 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
): 
v_
(v) {}

312 
StÜe
(
V®ue
 
v
,

313 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

314 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

315 
	gv_
 = 
v
;

318 
V®ue


319 
Lßd
(
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) const volatile{

320 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

321 
V®ue
 
	gv
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

322  
	gv
;

325 
V®ue


326 
Exchªge
(
V®ue
 
v
,

327 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

328 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

329 
V®ue
 
	gŞd
 = 
v_
;

330 
	gv_
 = 
v
;

331  
	gŞd
;

334 
boŞ


335 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

336 
MemÜyOrd”
::
Ty³
 ,

337 
MemÜyOrd”
::
Ty³
 ) volatile {

338 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

339 ià(
	gv_
 =ğ*
ex³ùed
) {

340 
v_
 = 
desœed
;

341  
	gŒue
;

343 *
	gex³ùed
 = 
v_
;

344  
	gçl£
;

348 
boŞ


349 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

350 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

351 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

352  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

353 
sucûss_Üd”
, 
çu»_Üd”
);

356 
V®ue


357 
F‘chAdd
(
Difã»nû
 
v
,

358 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

359 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

360 
V®ue
 
	gŞd
 = 
v_
;

361 
	gv_
 +ğ
v
;

362  
	gŞd
;

365 
V®ue


366 
F‘chSub
(
Difã»nû
 
v
,

367 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

368 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

369 
V®ue
 
	gŞd
 = 
v_
;

370 
	gv_
 -ğ
v
;

371  
	gŞd
;

374 
boŞ
 
IsLockF»e
() const volatile {

375  
	gçl£
;

378 
LDD_UTIL_ATOMIC_DECLARE_POINTER_OPERATORS


379 
	g´iv©e
:

380 
AtomicBa£
(const AtomicBase&);

381 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

382 
V®ue
 
	gv_
;

385 
	g‹m¶©e
<
	gSize
, 
boŞ
 
	gSign
>

386 
şass
 
	gAtomicBa£
<*, *, 
	gSize
, 
	gSign
>

388 
	g´iv©e
:

389 
AtomicBa£
 
	tThis
;

390 
±rdiff_t
 
	tDifã»nû
;

391 * 
	tV®ue
;

392 
	gLockPoŞ
::
	tScİedLock
 
	tGu¬d
;

393 
	gpublic
:

394 
AtomicBa£
() {}

395 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

398 
StÜe
(
V®ue
 
v
,

399 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

400 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

401 
	gv_
 = 
v
;

404 
V®ue


405 
Lßd
(
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) const volatile{

406 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

407 
V®ue
 
	gv
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

408  
	gv
;

411 
V®ue


412 
Exchªge
(
V®ue
 
v
,

413 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

414 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

415 
V®ue
 
	gŞd
 = 
v_
;

416 
	gv_
 = 
v
;

417  
	gŞd
;

420 
boŞ


421 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

422 
MemÜyOrd”
::
Ty³
 ,

423 
MemÜyOrd”
::
Ty³
 ) volatile {

424 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

425 ià(
	gv_
 = *
ex³ùed
) {

426 
v_
 = 
desœed
;

427  
	gŒue
;

429 *
	gex³ùed
 = 
v_
;

430  
	gçl£
;

434 
boŞ


435 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

436 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

437 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

438  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

439 
sucûss_Üd”
, 
çu»_Üd”
);

442 
boŞ
 
IsLockF»e
() const volatile {

443  
	gçl£
;

446 
V®ue
 
F‘chAdd
(
Difã»nû
 
v
,

447 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

448 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

449 
V®ue
 
	gŞd
 = 
v_
;

450 * 
	gcv
 = 
»š‹½»t_ÿ¡
<*>(
Şd
);

451 
	gcv
 +ğ
v
;

452 
	gv_
 = 
cv
;

453  
	gŞd
;

456 
V®ue
 
F‘chSub
(
Difã»nû
 
v
,

457 
MemÜyOrd”
::
Ty³
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

458 
Gu¬d
 
gu¬d
(
cÚ¡_ÿ¡
<
V®ue
*>(&
v_
));

459 
V®ue
 
	gŞd
 = 
v_
;

460 * 
	gcv
 = 
»š‹½»t_ÿ¡
<*>(
Şd
);

461 
	gcv
 -ğ
v
;

462 
	gv_
 = 
cv
;

463  
	gŞd
;

466 
LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_OPERATORS


467 
	g´iv©e
:

468 
AtomicBa£
(const AtomicBase&);

469 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

470 
V®ue
 
	gv_
;

	@/home/libin3-s/ldd/util/detail/atomic/classification.h

4 #iâdeà
LDD_UTIL_DETAIL_ATOMIC_CLASSIFICATION_H_


5 
	#LDD_UTIL_DETAIL_ATOMIC_CLASSIFICATION_H_


	)

7 
	~<boo¡/ty³_Œa™s/is_š‹g¿l.hµ
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gut
 {

11 
Çme¥aû
 
	gd‘a
 {

13 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gIsIÁ
 = 
boo¡
::
is_š‹g¿l
<
T
>::
v®ue
>

14 
	sCÏssify
 {

15 
	tTy³
;

18 
	g‹m¶©e
<
ty³Çme
 
	gT
>

19 
	gCÏssify
 <
	gT
, 
	gŒue
> { 
	tTy³
; };

21 
	g‹m¶©e
<
ty³Çme
 
	gT
>

22 
	gCÏssify
 <
	gT
*, 
	gçl£
> { * 
	tTy³
; };

24 
	g‹m¶©e
<
ty³Çme
 
	gT
>

25 
	sStÜageSizeOf
 {

26 
	e_
 {

27 
	gsize
 = (
T
),

28 
	gv®ue
 = (
size
 == 3 ?

29 4 : (
size
 == 5 || size == 6 || size == 7 ?

30 8 : 
size
))

	@/home/libin3-s/ldd/util/detail/atomic/gcc_x86.h

4 #iâdeà
LDD_UTIL_DETAIL_ATOMIC_GCC_X86_H_


5 
	#LDD_UTIL_DETAIL_ATOMIC_GCC_X86_H_


	)

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gut
 {

9 
Çme¥aû
 
	gd‘a
 {

11 #ià
defšed
(
__x86_64__
è|| defšed(
__SSE2__
)

12 
	#LDD_UTIL_ATOMIC_X86_FENCE_INSTR
 "mãnû\n"

	)

14 
	#LDD_UTIL_ATOMIC_X86_FENCE_INSTR
 "lock ;‡ddÈ$0, (%%e¥)\n"

	)

17 
	#LDD_UTIL_ATOMIC_X86_PAUSE
(è
__asm__
 
	`__vŞ©e__
 ("·u£\n")

	)

19 
šlše
 
F’ûBefÜe
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

20 
Üd”
) {

21 
MemÜyOrd”
::
kR–axed
:

22 
MemÜyOrd”
::
kAcquœe
:

23 
MemÜyOrd”
::
kCÚsume
:

25 
	gMemÜyOrd”
::
kR–—£
:

26 
MemÜyOrd”
::
kAcquœeR–—£
:

27 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

29 
	gMemÜyOrd”
::
kSequ’tŸl
:

30 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

36 
šlše
 
F’ûAá”
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

37 
Üd”
) {

38 
MemÜyOrd”
::
kR–axed
:

39 
MemÜyOrd”
::
kR–—£
:

41 
	gMemÜyOrd”
::
kAcquœe
:

42 
MemÜyOrd”
::
kAcquœeR–—£
:

43 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

45 
	gMemÜyOrd”
::
kCÚsume
:

47 
	gMemÜyOrd”
::
kSequ’tŸl
:

48 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

54 
šlše
 
F’ûAá”Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

55 
Üd”
) {

56 
MemÜyOrd”
::
kR–axed
:

57 
MemÜyOrd”
::
kR–—£
:

59 
	gMemÜyOrd”
::
kAcquœe
:

60 
MemÜyOrd”
::
kAcquœeR–—£
:

61 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

63 
	gMemÜyOrd”
::
kCÚsume
:

65 
	gMemÜyOrd”
::
kSequ’tŸl
:

66 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

72 
šlše
 
F’ûBefÜeStÜe
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

73 
Üd”
) {

74 
MemÜyOrd”
::
kR–axed
:

75 
MemÜyOrd”
::
kAcquœe
:

76 
MemÜyOrd”
::
kCÚsume
:

78 
	gMemÜyOrd”
::
kR–—£
:

79 
MemÜyOrd”
::
kAcquœeR–—£
:

80 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

82 
	gMemÜyOrd”
::
kSequ’tŸl
:

83 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

89 
šlše
 
F’ûAá”StÜe
(
MemÜyOrd”
::
Ty³
 
Üd”
) {

90 
Üd”
) {

91 
MemÜyOrd”
::
kR–axed
:

92 
MemÜyOrd”
::
kR–—£
:

94 
	gMemÜyOrd”
::
kAcquœe
:

95 
MemÜyOrd”
::
kAcquœeR–—£
:

96 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

98 
	gMemÜyOrd”
::
kCÚsume
:

100 
	gMemÜyOrd”
::
kSequ’tŸl
:

101 
__asm__
 
__vŞ©e__
 ("" ::: "memory");

109 şas 
	cAtomicFÏg
 {

110 
	g´iv©e
:

111 
AtomicFÏg
(const AtomicFlag&);

112 
	gAtomicFÏg
& 
	gİ”©Ü
=(cÚ¡ 
AtomicFÏg
&);

113 
ušt32_t
 
	gv_
;

114 
	gpublic
:

115 
AtomicFÏg
(è: 
v_
(0) {}

117 
boŞ


118 
Te¡AndS‘
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

119 
ušt32_t
 
v
 = 1;

120 
	gd‘a
::
F’ûBefÜe
(
Üd”
);

121 
__asm__
 
__vŞ©e__
 (

123 : "+r" (
v
), "+m" (
v_
)

125 
	gd‘a
::
F’ûAá”
(
Üd”
);

126  
	gv
;

130 
CË¬
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

131 ià(
Üd”
 =ğ
MemÜyOrd”
::
kSequ’tŸl
) {

132 
ušt32_t
 
v
 = 0;

133 
__asm__
 
__vŞ©e__
 (

135 : "+r" (
v
), "+m" (
v_
)

138 
	gd‘a
::
F’ûBefÜe
(
Üd”
);

139 
	gv_
 = 0;

147 
	#LDD_UTIL_ATOMIC_FLAG_LOCK_FREE
 1

	)

148 
	~"ldd/ut/d‘a/©omic/ba£.h
"

150 
Çme¥aû
 
	gldd
 {

151 
Çme¥aû
 
	gut
 {

152 
Çme¥aû
 
	gd‘a
 {

154 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

155 
şass
 
	gAtomicBa£
<
	gT
, , 1, 
	gSign
>

157 
AtomicBa£
 
	tThis
;

158 
T
 
	tV®ue
;

159 
T
 
	tDifã»nû
;

160 
	gpublic
:

161 
AtomicBa£
() {}

162 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

165 
StÜe
(
V®ue
 
v
,

166 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

167 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

168 
F’ûBefÜe
(
Üd”
);

169 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

171 
Exchªge
(
v
, 
Üd”
);

175 
V®ue


176 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

177 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

178 
F’ûAá”Lßd
(
Üd”
);

179  
	gv
;

182 
V®ue


183 
F‘chAdd
(
V®ue
 
v
,

184 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

185 
F’ûBefÜe
(
Üd”
);

186 
__asm__
 (

188 : "+q" (
v
), "+m" (
v_
)

190 
F’ûAá”
(
Üd”
);

191  
	gv
;

194 
V®ue


195 
F‘chSub
(
V®ue
 
v
,

196 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

197  
F‘chAdd
(-
v
, 
Üd”
);

200 
V®ue


201 
Exchªge
(
V®ue
 
v
,

202 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

203 
F’ûBefÜe
(
Üd”
);

204 
__asm__
 (

206 : "+q" (
v
), "+m" (
v_
)

208 
F’ûAá”
(
Üd”
);

209  
	gv
;

212 
boŞ


213 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

214 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

215 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

216 
V®ue
 
´evious
 = *
ex³ùed
;

217 
F’ûBefÜe
(
sucûss_Üd”
);

218 
__asm__
 (

220 : "+a" (
´evious
), "+m" (
v_
)

221 : "q" (
desœed
)

223 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

224 ià(
	gsucûss
) {

225 
F’ûAá”
(
sucûss_Üd”
);

227 
F’ûAá”
(
çu»_Üd”
);

229 *
	gex³ùed
 = 
´evious
;

230  
	gsucûss
;

233 
boŞ


234 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

235 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

236 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

237  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

238 
sucûss_Üd”
, 
çu»_Üd”
);

241 
V®ue


242 
F‘chAnd
(
V®ue
 
v
,

243 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

244 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

245 ;!
Com·»ExchªgeW—k
(&
tmp
,mp&
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

246 
LDD_UTIL_ATOMIC_X86_PAUSE
();

248  
	gtmp
;

251 
V®ue


252 
F‘chOr
(
V®ue
 
v
,

253 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

254 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

255 ;!
Com·»ExchªgeW—k
(
tmp
,mp|
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

256 
LDD_UTIL_ATOMIC_X86_PAUSE
();

258  
	gtmp
;

261 
V®ue


262 
F‘chXÜ
(
V®ue
 
v
,

263 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

264 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

265 ;!
Com·»ExchªgeW—k
(
tmp
,mp^
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

266 
LDD_UTIL_ATOMIC_X86_PAUSE
();

268  
	gtmp
;

271 
boŞ
 
IsLockF»e
() const volatile {

272  
	gŒue
;

275 
LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS


276 
	g´iv©e
:

277 
AtomicBa£
(const AtomicBase&);

278 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

279 
V®ue
 
	gv_
;

282 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

283 
şass
 
	gAtomicBa£
<
	gT
, , 2, 
	gSign
>

285 
AtomicBa£
 
	tThis
;

286 
T
 
	tV®ue
;

287 
T
 
	tDifã»nû
;

288 
	gpublic
:

289 
AtomicBa£
() {}

290 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

293 
StÜe
(
V®ue
 
v
,

294 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

295 ià(
Üd”
 =ğ
MemÜyOrd”
::
kSequ’tŸl
) {

296 
F’ûBefÜe
(
Üd”
);

297 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

299 
Exchªge
(
v
, 
Üd”
);

303 
V®ue


304 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

305 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<vŞ©V®ue&>(
v_
);

306 
F’ûAá”Lßd
(
Üd”
);

307  
	gv
;

310 
V®ue


311 
F‘chAdd
(
V®ue
 
v
,

312 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

313 
F’ûBefÜe
(
Üd”
);

314 
__asm__
 (

316 : "+q" (
v
), "+m" (
v_
)

318 
F’ûAá”
(
Üd”
);

319  
	gv
;

322 
V®ue


323 
F‘chSub
(
V®ue
 
v
,

324 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

325  
F‘chAdd
(-
v
, 
Üd”
);

328 
V®ue


329 
Exchªge
(
V®ue
 
v
,

330 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

331 
F’ûBefÜe
(
Üd”
);

332 
__asm__
(

334 : "+q" (
v
), "+m" (
v_
)

336 
F’ûAá”
(
Üd”
);

337  
	gv
;

340 
boŞ


341 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

342 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

343 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

344 
V®ue
 
´evious
 = *
ex³ùed
;

345 
F’ûBefÜe
(
sucûss_Üd”
);

346 
__asm__
(

348 : "+a" (
´evious
), "+m" (
v_
)

349 : "q" (
desœed
)

351 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

352 ià(
	gsucûss
) {

353 
F’ûAá”
(
sucûss_Üd”
);

355 
F’ûAá”
(
çu»_Üd”
);

357 *
	gex³ùed
 = 
´evious
;

358  
	gsucûss
;

361 
boŞ


362 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

363 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

364 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

365  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

366 
sucûss_Üd”
, 
çu»_Üd”
);

369 
V®ue


370 
F‘chAnd
(
V®ue
 
v
,

371 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

372 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

373 ; !
Com·»ExchªgeW—k
(
tmp
,mp&
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

374 
LDD_UTIL_ATOMIC_X86_PAUSE
();

376  
	gtmp
;

379 
V®ue


380 
F‘chOr
(
V®ue
 
v
,

381 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

382 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

383 ; !
Com·»ExchªgeW—k
(
tmp
,mp|
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

384 
LDD_UTIL_ATOMIC_X86_PAUSE
();

386  
	gtmp
;

389 
V®ue


390 
F‘chXÜ
(
V®ue
 
v
,

391 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

392 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

393 ; !
Com·»ExchªgeW—k
(
tmp
,mp^
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

394 
LDD_UTIL_ATOMIC_X86_PAUSE
();

396  
	gtmp
;

399 
boŞ
 
IsLockF»e
() const volatile {

400  
	gŒue
;

403 
LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS


404 
	g´iv©e
:

405 
AtomicBa£
(const AtomicBase&);

406 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

407 
V®ue
 
	gv_
;

410 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

411 
şass
 
	gAtomicBa£
<
	gT
, , 4, 
	gSign
>

413 
AtomicBa£
 
	tThis
;

414 
T
 
	tV®ue
;

415 
T
 
	tDifã»nû
;

416 
	gpublic
:

417 
AtomicBa£
() {}

418 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

421 
StÜe
(
V®ue
 
v
,

422 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

423 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

424 
F’ûBefÜe
(
Üd”
);

425 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

427 
Exchªge
(
v
, 
Üd”
);

431 
V®ue


432 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

433 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

434 
F’ûAá”Lßd
(
Üd”
);

435  
	gv
;

438 
V®ue


439 
F‘chAdd
(
V®ue
 
v
,

440 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

441 
F’ûBefÜe
(
Üd”
);

442 
__asm__
(

444 : "+r" (
v
), "+m" (
v_
)

446 
F’ûAá”
(
Üd”
);

447  
	gv
;

450 
V®ue


451 
F‘chSub
(
V®ue
 
v
,

452 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

453  
F‘chAdd
(-
v
, 
Üd”
);

456 
V®ue


457 
Exchªge
(
V®ue
 
v
,

458 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

459 
F’ûBefÜe
(
Üd”
);

460 
__asm__
(

462 : "+r" (
v
), "+m" (
v_
)

464 
F’ûAá”
(
Üd”
);

465  
	gv
;

468 
boŞ


469 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

470 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

471 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

472 
V®ue
 
´evious
 = *
ex³ùed
;

473 
F’ûBefÜe
(
sucûss_Üd”
);

474 
__asm__
(

476 : "+a" (
´evious
), "+m" (
v_
)

477 : "r" (
desœed
)

479 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

480 ià(
	gsucûss
) {

481 
F’ûAá”
(
sucûss_Üd”
);

483 
F’ûAá”
(
çu»_Üd”
);

485 *
	gex³ùed
 = 
´evious
;

486  
	gsucûss
;

489 
boŞ


490 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

491 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

492 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

493  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

494 
sucûss_Üd”
, 
çu»_Üd”
);

497 
V®ue


498 
F‘chAnd
(
V®ue
 
v
,

499 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

500 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

501 ; !
Com·»ExchªgeW—k
(
tmp
,mp&
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

502 
LDD_UTIL_ATOMIC_X86_PAUSE
();

504  
	gtmp
;

507 
V®ue


508 
F‘chOr
(
V®ue
 
v
,

509 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

510 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

511 ; !
Com·»ExchªgeW—k
(
tmp
,mp|
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

512 
LDD_UTIL_ATOMIC_X86_PAUSE
();

514  
	gtmp
;

516 
V®ue


517 
F‘chXÜ
(
V®ue
 
v
,

518 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

519 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

520 ; !
Com·»ExchªgeW—k
(
tmp
,mp^
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

521 
LDD_UTIL_ATOMIC_X86_PAUSE
();

523  
	gtmp
;

526 
boŞ
 
IsLockF»e
() const volatile {

527  
	gŒue
;

530 
LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS


531 
	g´iv©e
:

532 
AtomicBa£
(const AtomicBase&);

533 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

534 
V®ue
 
	gv_
;

537 #ià
defšed
(
__x86_64__
)

538 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

539 
şass
 
	gAtomicBa£
<
	gT
, , 8, 
	gSign
>

541 
AtomicBa£
 
	tThis
;

542 
T
 
	tV®ue
;

543 
T
 
	tDifã»nû
;

544 
	gpublic
:

545 
AtomicBa£
() {}

546 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

549 
StÜe
(
V®ue
 
v
,

550 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

551 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

552 
F’ûBefÜe
(
Üd”
);

553 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

555 
Exchªge
(
v
, 
Üd”
);

559 
V®ue


560 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

561 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

562 
F’ûAá”Lßd
(
Üd”
);

563  
	gv
;

566 
V®ue


567 
F‘chAdd
(
V®ue
 
v
,

568 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

569 
F’ûBefÜe
(
Üd”
);

570 
__asm__
(

572 : "+r" (
v
), "+m" (
v_
)

574 
F’ûAá”
(
Üd”
);

575  
	gv
;

578 
V®ue


579 
F‘chSub
(
V®ue
 
v
,

580 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

581  
F‘chAdd
(-
v
, 
Üd”
);

584 
V®ue


585 
Exchªge
(
V®ue
 
v
,

586 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

587 
F’ûBefÜe
(
Üd”
);

588 
__asm__
(

590 : "+r" (
v
), "+m" (
v_
)

592 
F’ûAá”
(
Üd”
);

593  
	gv
;

596 
boŞ


597 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

598 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

599 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

600 
V®ue
 
´evious
 = *
ex³ùed
;

601 
F’ûBefÜe
(
sucûss_Üd”
);

602 
__asm__
 (

604 : "+a" (
´evious
), "+m" (
v_
)

605 : "r" (
desœed
)

607 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

608 ià(
	gsucûss
) {

609 
F’ûAá”
(
sucûss_Üd”
);

611 
F’ûAá”
(
çu»_Üd”
);

613 *
	gex³ùed
 = 
´evious
;

614  
	gsucûss
;

617 
boŞ


618 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

619 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

620 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

621  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

622 
sucûss_Üd”
, 
çu»_Üd”
);

625 
V®ue


626 
F‘chAnd
(
V®ue
 
v
,

627 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

628 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

629 ; !
Com·»ExchªgeW—k
(
tmp
,mp&
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

630 
LDD_UTIL_ATOMIC_X86_PAUSE
();

632  
	gtmp
;

635 
V®ue


636 
F‘chOr
(
V®ue
 
v
,

637 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

638 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

639 ; !
Com·»ExchªgeW—k
(
tmp
,mp|
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

640 
LDD_UTIL_ATOMIC_X86_PAUSE
();

642  
	gtmp
;

645 
V®ue


646 
F‘chXÜ
(
V®ue
 
v
,

647 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

648 
V®ue
 
tmp
 = 
Lßd
(
MemÜyOrd”
::
kR–axed
);

649 ; !
Com·»ExchªgeW—k
(
tmp
,mp^
v
, 
Üd”
, 
MemÜyOrd”
::
kR–axed
);){

650 
LDD_UTIL_ATOMIC_X86_PAUSE
();

652  
	gtmp
;

655 
boŞ
 
IsLockF»e
() const volatile {

656  
	gŒue
;

659 
LDD_UTIL_ATOMIC_DECLARE_INTEGRAL_OPERATORS


660 
	g´iv©e
:

661 
AtomicBa£
(const AtomicBase&);

662 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

663 
V®ue
 
	gv_
;

669 #ià!
defšed
(
__x86_64__
)

670 
	g‹m¶©e
 <
boŞ
 
	gSign
>

671 
şass
 
	gAtomicBa£
<*, *, 4, 
	gSign
>

673 
AtomicBa£
 
	tThis
;

674 * 
	tV®ue
;

675 
±rdiff_t
 
	tDifã»nû
;

676 
	gpublic
:

677 
AtomicBa£
() {}

678 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

681 
StÜe
(
V®ue
 
v
,

682 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

683 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

684 
F’ûBefÜe
(
Üd”
);

685 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

687 
Exchªge
(
v
, 
Üd”
);

691 
V®ue


692 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

693 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

694 
F’ûAá”Lßd
(
Üd”
);

695  
	gv
;

698 
V®ue


699 
Exchªge
(
V®ue
 
v
,

700 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

701 
F’ûBefÜe
(
Üd”
);

702 
__asm__
(

704 : "+r" (
v
), "+m" (
v_
)

706 
F’ûAá”
(
Üd”
);

707  
	gv
;

710 
boŞ


711 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

712 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

713 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

714 
V®ue
 
´evious
 = *
ex³ùed
;

715 
F’ûBefÜe
(
sucûss_Üd”
);

716 
__asm__
(

718 : "+a" (
´evious
), "+m" (
v_
)

719 : "r" (
desœe
)

721 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

722 ià(
	gsucûss
) {

723 
F’ûAá”
(
sucûss_Üd”
);

725 
F’ûAá”
(
çu»_Üd”
);

727 *
	gex³ùed
 = 
´evious
;

728  
	gsucûss
;

731 
boŞ


732 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

733 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

734 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

735  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

736 
sucûss_Üd”
, 
çu»_Üd”
);

739 
boŞ
 
IsLockF»e
() const volatile {

740  
	gŒue
;

743 
V®ue


744 
F‘chAdd
(
Difã»nû
 
v
,

745 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

746 
F’ûBefÜe
(
Üd”
);

747 
__asm__
(

749 : "+r" (
v
), "+m" (
v_
)

751 
F’ûAá”
(
Üd”
);

752  
	g»š‹½»t_ÿ¡
<
	gV®ue
>(
	gv
);

755 
V®ue


756 
F‘chSub
(
Difã»nû
 
v
,

757 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

758  
F‘chAdd
(-
v
, 
Üd”
);

761 
LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_OPERATORS


762 
	g´iv©e
:

763 
AtomicBa£
(const AtomicBase&);

764 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

765 
V®ue
 
	gv_
;

768 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

769 
şass
 
	gAtomicBa£
<
	gT
*, *, 4, 
	gSign
>

771 
AtomicBa£
 
	tThis
;

772 
T
* 
	tV®ue
;

773 
±rdiff_t
 
	tDifã»nû
;

774 
	gpublic
:

775 
AtomicBa£
() {}

776 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

779 
StÜe
(
V®ue
 
v
,

780 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

781 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

782 
F’ûBefÜe
(
Üd”
);

783 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

785 
Exchªge
(
v
, 
Üd”
);

789 
V®ue


790 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

791 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

792 
F’ûAá”Lßd
(
Üd”
);

793  
	gv
;

796 
V®ue


797 
Exchªge
(
V®ue
 
v
,

798 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

799 
F’ûBefÜe
(
Üd”
);

800 
__asm__
(

802 : "+r" (
v
), "+m" (
v_
)

804 
F’ûAá”
(
Üd”
);

805  
	gv
;

808 
boŞ


809 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

810 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

811 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

812 
V®ue
 
´evious
 = *
ex³ùed
;

813 
F’ûBefÜe
(
sucûss_Üd”
);

814 
__asm__
(

816 : "+a" (
´evious
), "+m" (
v_
)

817 : "r" (
desœed
)

819 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

820 ià(
	gsucûss
) {

821 
F’ûAá”
(
sucûss_Üd”
);

823 
F’ûAá”
(
çu»_Üd”
);

825 *
	gex³ùed
 = 
´evious
;

826  
	gsucûss
;

829 
boŞ


830 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, 
VAlue
 
desœed
,

831 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

832 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

833  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

834 
sucûss_Üd”
, 
çu»_Üd”
);

837 
V®ue


838 
F‘chAdd
(
Difã»nû
 
v
,

839 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

840 
v
 = v * (*
v_
);

841 
F’ûBefÜe
(
Üd”
);

842 
__asm__
 (

844 : "+r" (
v
), "+m" (
v_
)

846 
F’ûAá”
(
Üd”
);

847  
	g»š‹½»t_ÿ¡
<
	gV®ue
>(
	gv
);

850 
V®ue


851 
F‘chSub
(
Difã»nû
 
v
,

852 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

853  
F‘chAdd
(-
v
, 
Üd”
);

856 
boŞ
 
IsLockF»e
() const volatile {

857  
	gŒue
;

860 
LDD_UTIL_ATOMIC_DECLARE_POINTER_OPERATORS


861 
	g´iv©e
:

862 
AtomicBa£
(const AtomicBase&);

863 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

864 
V®ue
 
	gv_
;

869 
	g‹m¶©e
 <
boŞ
 
	gSign
>

870 
şass
 
	gAtomicBa£
<*, *, 8, 
	gSign
>

872 
AtomicBa£
 
	tThis
;

873 * 
	tV®ue
;

874 
±rdiff_t
 
	tDifã»nû
;

875 
	gpublic
:

876 
AtomicBa£
() {}

877 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

880 
StÜe
(
V®ue
 
v
,

881 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

882 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

883 
F’ûBefÜe
(
Üd”
);

884 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

886 
Exchªge
(
v
, 
Üd”
);

890 
V®ue


891 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

892 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

893 
F’ûAá”Lßd
(
Üd”
);

894  
	gv
;

897 
V®ue


898 
Exchªge
(
V®ue
 
v
,

899 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

900 
F’ûBefÜe
(
Üd”
);

901 
__asm__
(

903 : "+r" (
v
), "+m" (
v_
)

905 
F’ûAá”
(
Üd”
);

906  
	gv
;

909 
boŞ


910 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

911 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

912 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

913 
V®ue
 
´evious
 = *
ex³ùed
;

914 
F’ûBefÜe
(
sucûss_Üd”
);

915 
__asm__
(

917 : "+a" (
´evious
), "+m" (
v_
)

918 : "r" (
desœed
)

920 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

921 ià(
	gsucûss
) {

922 
F’ûAá”
(
sucûss_Üd”
);

924 
F’ûAá”
(
çu»_Üd”
);

926 *
	gex³ùed
 = 
´evious
;

927  
	gsucûss
;

930 
boŞ


931 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

932 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

933 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

934  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

935 
sucûss_Üd”
, 
çu»_Üd”
);

938 
boŞ
 
IsLockF»e
() const volatile {

939  
	gŒue
;

942 
V®ue


943 
F‘chAdd
(
Difã»nû
 
v
,

944 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

945 
F’ûBefÜe
(
Üd”
);

946 
__asm__
(

948 : "+r" (
v
), "+m" (
v_
)

950 
F’ûAá”
(
Üd”
);

951  
	g»š‹½»t_ÿ¡
<
	gV®ue
>(
	gv
);

954 
V®ue


955 
F‘chSub
(
Difã»nû
 
v
,

956 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

957  
F‘chAdd
(-
v
, 
Üd”
);

960 
LDD_UTIL_ATOMIC_DECLARE_VOID_POINTER_OPERATORS


961 
	g´iv©e
:

962 
AtomicBa£
(const AtomicBase&);

963 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

964 
V®ue
 
	gv_
;

967 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

968 
şass
 
	gAtomicBa£
<
	gT
*, *, 8, 
	gSign
>

970 
AtomicBa£
 
	tThis
;

971 
T
* 
	tV®ue
;

972 
±rdiff_t
 
	tDifã»nû
;

973 
	gpublic
:

974 
AtomicBa£
() {}

975 
ex¶ic™
 
AtomicBa£
(
V®ue
 
v
è: 
v_
(v) {}

978 
StÜe
(
V®ue
 
v
,

979 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

980 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

981 
F’ûBefÜe
(
Üd”
);

982 
	gcÚ¡_ÿ¡
<vŞ©
	gV®ue
&>(
	gv_
èğ
v
;

984 
Exchªge
(
v
, 
Üd”
);

988 
V®ue


989 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

990 
V®ue
 
v
 = 
cÚ¡_ÿ¡
<cÚ¡ vŞ©V®ue&>(
v_
);

991 
F’ûAá”Lßd
(
Üd”
);

992  
	gv
;

995 
V®ue


996 
Exchªge
(
V®ue
 
v
,

997 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

998 
F’ûBefÜe
(
Üd”
);

999 
__asm__
(

1001 : "+r" (
v
), "+m" (
v_
)

1003 
F’ûAá”
(
Üd”
);

1004  
	gv
;

1007 
boŞ


1008 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®u
desœed
,

1009 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1010 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1011 
V®ue
 
´evious
 = *
ex³ùed
;

1012 
F’ûBefÜe
(
sucûss_Üd”
);

1013 
__asm__
(

1015 : "+a" (
´evious
), "+m" (
v_
)

1016 : "r" (
desœed
)

1018 
boŞ
 
	gsucûss
 = (
´evious
 =ğ*
ex³ùed
);

1019 ià(
	gsucûss
) {

1020 
F’ûAá”
(
sucûss_Üd”
);

1022 
F’ûAá”
(
çu»_Üd”
);

1024 *
	gex³ùed
 = 
´evious
;

1025  
	gsucûss
;

1028 
boŞ


1029 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®u
desœed
,

1030 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1031 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1032  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

1033 
sucûss_Üd”
, 
çu»_Üd”
);

1036 
V®ue


1037 
F‘chAdd
(
Difã»nû
 
v
,

1038 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1039 
v
 = v * (*
v_
);

1040 
F’ûBefÜe
(
Üd”
);

1041 
__asm__
 (

1043 : "+r" (
v
), "+m" (
v_
)

1045 
F’ûAá”
(
Üd”
);

1046  
	g»š‹½»t_ÿ¡
<
	gV®ue
>(
	gv
);

1049 
V®ue


1050 
F‘chSub
(
Difã»nû
 
v
,

1051 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1052  
F‘chAdd
(-
v
, 
Üd”
);

1055 
boŞ
 
IsLockF»e
() const volatile {

1056  
	gŒue
;

1059 
LDD_UTIL_ATOMIC_DECLARE_POINTER_OPERATORS


1060 
	g´iv©e
:

1061 
AtomicBa£
(const AtomicBase&);

1062 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

1063 
V®ue
 
	gv_
;

1068 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

1069 
şass
 
	gAtomicBa£
<
	gT
, , 1, 
	gSign
>

1071 
AtomicBa£
 
	tThis
;

1072 
T
 
	tV®ue
;

1073 
ušt8_t
 
	tStÜage
;

1074 
	gpublic
:

1075 
AtomicBa£
() {}

1076 
ex¶ic™
 
AtomicBa£
(
V®ue
 cÚ¡& 
v
)

1077 : 
v_
(
»š‹½»t_ÿ¡
<
StÜage
 cÚ¡&>(
v
)) {}

1080 
StÜe
(
V®ue
 cÚ¡& 
v
,

1081 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1082 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

1083 
StÜage
 
tmp
;

1084 
memıy
(&
tmp
, &
v
, (
V®ue
));

1085 
F’ûBefÜe
(
Üd”
);

1086 
	gcÚ¡_ÿ¡
<vŞ©
	gStÜage
&>(
	gv_
èğ
tmp
;

1088 
Exchªge
(
v
, 
Üd”
);

1092 
V®ue


1093 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

1094 
StÜage
 
tmp
 = 
cÚ¡_ÿ¡
<vŞ©StÜage&>(
v_
);

1095 
F’ûAá”Lßd
(
Üd”
);

1096 
V®ue
 
	gv
;

1097 
memıy
(&
v
, &
tmp
, (
V®ue
));

1098  
	gv
;

1101 
V®ue


1102 
Exchªge
(
V®ue
 cÚ¡& 
v
,

1103 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1104 
StÜage
 
tmp
;

1105 
memıy
(&
tmp
, &
v
, (
V®ue
));

1106 
F’ûBefÜe
(
Üd”
);

1107 
__asm__
(

1109 : "+q" (
tmp
), "+m" (
v_
)

1111 
F’ûAá”
(
Üd”
);

1112 
V®ue
 
	g»s
;

1113 
memıy
(&
»s
, &
tmp
, (
V®ue
));

1114  
	g»s
;

1117 
boŞ


1118 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1119 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1120 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1121 
StÜage
 
ex³ùed_s
, 
	gdesœed_s
;

1122 
memıy
(&
ex³ùed_s
, 
ex³ùed
, (
V®ue
));

1123 
memıy
(&
desœed_s
, &
desœed
, (
V®ue
));

1124 
StÜage
 
	g´evious_s
 = 
ex³ùed_s
;

1125 
F’ûBefÜe
(
sucûss_Üd”
);

1126 
__asm__
(

1128 : "+a" (
´evious_s
), "+m" (
v_
)

1129 : "q" (
desœed_s
)

1131 
boŞ
 
	gsucûss
 = (
´evious_s
 =ğ
ex³ùed_s
);

1132 ià(
	gsucûss
) {

1133 
F’ûAá”
(
sucûss_Üd”
);

1135 
F’ûAá”
(
çu»_Üd”
);

1137 
memıy
(
ex³ùed
, &
´evious_s
, (
V®ue
));

1138  
	gsucûss
;

1141 
boŞ


1142 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1143 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1144 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1145  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

1146 
sucûss_Üd”
, 
çu»_Üd”
);

1149 
boŞ
 
IsLockF»e
() const volatile {

1150  
	gŒue
;

1153 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS


1154 
	g´iv©e
:

1155 
AtomicBa£
(const AtomicBase&);

1156 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

1157 
StÜage
 
	gv_
;

1160 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

1161 
şass
 
	gAtomicBa£
<
	gT
, , 2, 
	gSign
>

1163 
AtomicBa£
 
	tThis
;

1164 
T
 
	tV®ue
;

1165 
ušt16_t
 
	tStÜage
;

1166 
	gpublic
:

1167 
AtomicBa£
() {}

1168 
ex¶ic™
 
AtomicBa£
(
V®ue
 cÚ¡& 
v
)

1169 : 
v_
(
»š‹½»t_ÿ¡
<
StÜage
 cÚ¡&>(
v
)) {}

1172 
StÜe
(
V®ue
 cÚ¡& 
v
,

1173 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1174 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

1175 
StÜage
 
tmp
;

1176 
memıy
(&
tmp
, &
v
, (
V®ue
));

1177 
F’ûBefÜe
(
Üd”
);

1178 
	gcÚ¡_ÿ¡
<vŞ©
	gStÜage
&>(
	gv_
èğ
tmp
;

1180 
Exchªge
(
v
, 
Üd”
);

1184 
V®ue


1185 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

1186 
StÜage
 
tmp
 = 
cÚ¡_ÿ¡
<vŞ©StÜage&>(
v_
);

1187 
F’ûAá”Lßd
(
Üd”
);

1188 
V®ue
 
	gv
;

1189 
memıy
(&
v
, &
tmp
, (
V®ue
));

1190  
	gv
;

1193 
V®ue


1194 
Exchªge
(
V®ue
 cÚ¡& 
v
,

1195 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1196 
StÜage
 
tmp
;

1197 
memıy
(&
tmp
, &
v
, (
V®ue
));

1198 
F’ûBefÜe
(
Üd”
);

1199 
__asm__
(

1201 : "+q" (
tmp
), "+m" (
v_
)

1203 
F’ûAá”
(
Üd”
);

1204 
V®ue
 
	g»s
;

1205 
memıy
(&
»s
, &
tmp
, (
V®ue
));

1206  
	g»s
;

1209 
boŞ


1210 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1211 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1212 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1213 
StÜage
 
ex³ùed_s
, 
	gdesœed_s
;

1214 
memıy
(&
ex³ùed_s
, 
ex³ùed
, (
V®ue
));

1215 
memıy
(&
desœed_s
, &
desœed
, (
V®ue
));

1216 
StÜage
 
	g´evious_s
 = 
ex³ùed_s
;

1217 
F’ûBefÜe
(
sucûss_Üd”
);

1218 
__asm__
(

1220 : "+a" (
´evious_s
), "+m" (
v_
)

1221 : "q" (
desœed_s
)

1223 
boŞ
 
	gsucûss
 = (
´evious_s
 =ğ
ex³ùed_s
);

1224 ià(
	gsucûss
) {

1225 
F’ûAá”
(
sucûss_Üd”
);

1227 
F’ûAá”
(
çu»_Üd”
);

1229 
memıy
(
ex³ùed
, &
´evious_s
, (
V®ue
));

1230  
	gsucûss
;

1233 
boŞ


1234 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1235 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1236 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1237  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

1238 
sucûss_Üd”
, 
çu»_Üd”
);

1241 
boŞ
 
IsLockF»e
() const volatile {

1242  
	gŒue
;

1245 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS


1246 
	g´iv©e
:

1247 
AtomicBa£
(const AtomicBase&);

1248 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

1249 
StÜage
 
	gv_
;

1252 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

1253 
şass
 
	gAtomicBa£
<
	gT
, , 4, 
	gSign
>

1255 
AtomicBa£
 
	tThis
;

1256 
T
 
	tV®ue
;

1257 
ušt32_t
 
	tStÜage
;

1258 
	gpublic
:

1259 
AtomicBa£
() {}

1260 
ex¶ic™
 
AtomicBa£
(
V®ue
 cÚ¡& 
v
è: 
v_
(0) {

1261 
memıy
(&
v_
, &
v
, (
V®ue
));

1265 
StÜe
(
V®ue
 cÚ¡& 
v
,

1266 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1267 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

1268 
StÜage
 
tmp
;

1269 
memıy
(&
tmp
, &
v
, (
V®ue
));

1270 
F’ûBefÜe
(
Üd”
);

1271 
	gcÚ¡_ÿ¡
<vŞ©
	gStÜage
&>(
	gv_
èğ
tmp
;

1273 
Exchªge
(
v
, 
Üd”
);

1277 
V®ue


1278 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

1279 
StÜage
 
tmp
 = 
cÚ¡_ÿ¡
<vŞ©StÜage&>(
v_
);

1280 
F’ûAá”Lßd
(
Üd”
);

1281 
V®ue
 
	gv
;

1282 
memıy
(&
v
, &
tmp
, (
V®ue
));

1283  
	gv
;

1286 
V®ue


1287 
Exchªge
(
V®ue
 cÚ¡& 
v
,

1288 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1289 
StÜage
 
tmp
;

1290 
memıy
(&
tmp
, &
v
, (
V®ue
));

1291 
F’ûBefÜe
(
Üd”
);

1292 
__asm__
(

1294 : "+q" (
tmp
), "+m" (
v_
)

1296 
F’ûAá”
(
Üd”
);

1297 
V®ue
 
	g»s
;

1298 
memıy
(&
»s
, &
tmp
, (
V®ue
));

1299  
	g»s
;

1302 
boŞ


1303 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1304 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1305 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1306 
StÜage
 
ex³ùed_s
, 
	gdesœed_s
;

1307 
memıy
(&
ex³ùed_s
, 
ex³ùed
, (
V®ue
));

1308 
memıy
(&
desœed_s
, &
desœed
, (
V®ue
));

1309 
StÜage
 
	g´evious_s
 = 
ex³ùed_s
;

1310 
F’ûBefÜe
(
sucûss_Üd”
);

1311 
__asm__
(

1313 : "+a" (
´evious_s
), "+m" (
v_
)

1314 : "q" (
desœed_s
)

1316 
boŞ
 
	gsucûss
 = (
´evious_s
 =ğ
ex³ùed_s
);

1317 ià(
	gsucûss
) {

1318 
F’ûAá”
(
sucûss_Üd”
);

1320 
F’ûAá”
(
çu»_Üd”
);

1322 
memıy
(
ex³ùed
, &
´evious_s
, (
V®ue
));

1323  
	gsucûss
;

1326 
boŞ


1327 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1328 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1329 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1330  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

1331 
sucûss_Üd”
, 
çu»_Üd”
);

1334 
boŞ
 
IsLockF»e
() const volatile {

1335  
	gŒue
;

1338 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS


1339 
	g´iv©e
:

1340 
AtomicBa£
(const AtomicBase&);

1341 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

1342 
StÜage
 
	gv_
;

1345 #ià
defšed
(
__x86_64__
)

1346 
	g‹m¶©e
<
ty³Çme
 
	gT
, 
boŞ
 
	gSign
>

1347 
şass
 
	gAtomicBa£
<
	gT
, , 8, 
	gSign
>

1349 
AtomicBa£
 
	tThis
;

1350 
T
 
	tV®ue
;

1351 
ušt64_t
 
	tStÜage
;

1352 
	gpublic
:

1353 
AtomicBa£
() {}

1354 
ex¶ic™
 
AtomicBa£
(
V®ue
 cÚ¡& 
v
è: 
v_
(0) {

1355 
memıy
(&
v_
, &
v
, (
V®ue
));

1359 
StÜe
(
V®ue
 cÚ¡& 
v
,

1360 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1361 ià(
Üd”
 !ğ
MemÜyOrd”
::
kSequ’tŸl
) {

1362 
StÜage
 
tmp
;

1363 
memıy
(&
tmp
, &
v
, (
V®ue
));

1364 
F’ûBefÜe
(
Üd”
);

1365 
	gcÚ¡_ÿ¡
<vŞ©
	gStÜage
&>(
	gv_
èğ
tmp
;

1367 
Exchªge
(
v
, 
Üd”
);

1371 
V®ue


1372 
Lßd
(
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) const volatile {

1373 
StÜage
 
tmp
 = 
cÚ¡_ÿ¡
<vŞ©StÜage&>(
v_
);

1374 
F’ûAá”Lßd
(
Üd”
);

1375 
V®ue
 
	gv
;

1376 
memıy
(&
v
, &
tmp
, (
V®ue
));

1377  
	gv
;

1380 
V®ue


1381 
Exchªge
(
V®ue
 cÚ¡& 
v
,

1382 
MemÜyOrd”
::
Ty³
 
Üd”
 = MemÜyOrd”::
kSequ’tŸl
) volatile {

1383 
StÜage
 
tmp
;

1384 
memıy
(&
tmp
, &
v
, (
V®ue
));

1385 
F’ûBefÜe
(
Üd”
);

1386 
__asm__
(

1388 : "+q" (
tmp
), "+m" (
v_
)

1390 
F’ûAá”
(
Üd”
);

1391 
V®ue
 
	g»s
;

1392 
memıy
(&
»s
, &
tmp
, (
V®ue
));

1393  
	g»s
;

1396 
boŞ


1397 
Com·»ExchªgeSŒÚg
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1398 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1399 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1400 
StÜage
 
ex³ùed_s
, 
	gdesœed_s
;

1401 
memıy
(&
ex³ùed_s
, 
ex³ùed
, (
V®ue
));

1402 
memıy
(&
desœed_s
, &
desœed
, (
V®ue
));

1403 
StÜage
 
	g´evious_s
 = 
ex³ùed_s
;

1404 
F’ûBefÜe
(
sucûss_Üd”
);

1405 
__asm__
(

1407 : "+a" (
´evious_s
), "+m" (
v_
)

1408 : "q" (
desœed_s
)

1410 
boŞ
 
	gsucûss
 = (
´evious_s
 =ğ
ex³ùed_s
);

1411 ià(
	gsucûss
) {

1412 
F’ûAá”
(
sucûss_Üd”
);

1414 
F’ûAá”
(
çu»_Üd”
);

1416 
memıy
(
ex³ùed
, &
´evious_s
, (
V®ue
));

1417  
	gsucûss
;

1420 
boŞ


1421 
Com·»ExchªgeW—k
(
V®ue
* 
ex³ùed
, V®ucÚ¡& 
desœed
,

1422 
MemÜyOrd”
::
Ty³
 
sucûss_Üd”
,

1423 
MemÜyOrd”
::
Ty³
 
çu»_Üd”
) volatile {

1424  
Com·»ExchªgeSŒÚg
(
ex³ùed
, 
desœed
,

1425 
sucûss_Üd”
, 
çu»_Üd”
);

1428 
boŞ
 
IsLockF»e
() const volatile {

1429  
	gŒue
;

1432 
LDD_UTIL_ATOMIC_DECLARE_BASE_OPERATORS


1433 
	g´iv©e
:

1434 
AtomicBa£
(const AtomicBase&);

1435 
	gİ”©Ü
=(cÚ¡ 
AtomicBa£
&);

1436 
StÜage
 
	gv_
;

	@/home/libin3-s/ldd/util/detail/atomic/lockpool.h

4 #iâdeà
LDD_UTIL_DETAIL_ATOMIC_LOCKPOOL_H_


5 
	#LDD_UTIL_DETAIL_ATOMIC_LOCKPOOL_H_


	)

7 #iâdeà
LDD_UTIL_ATOMIC_FLAG_LOCK_FREE


8 
	~"ldd/ut/mu‹x.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gut
 {

13 
Çme¥aû
 
	gd‘a
 {

15 #iâdeà
LDD_UTIL_ATOMIC_FLAG_LOCK_FREE


16 şas 
	cLockPoŞ
 {

17 
	gpublic
:

18 
Mu‹x
 
	tLock
;

19 şas 
	cScİedLock
 {

20 
Lock
* 
	gmtx_
;

21 
ScİedLock
(ScopedLock const&);

22 
	gScİedLock
& 
	gİ”©Ü
=(
ScİedLock
 const&);

23 
	gpublic
:

24 
ex¶ic™
 
ScİedLock
(cÚ¡ vŞ©* 
addr
): 
mtx_
(
G‘LockFÜ
(addr)) {

25 
mtx_
->
Lock
();

27 ~
ScİedLock
() {

28 
	gmtx_
->
UÆock
();

31 
	g´iv©e
:

32 
Lock
* 
G‘LockFÜ
(cÚ¡ vŞ©* 
addr
);

37 şas 
	cLockPoŞ
 {

38 
	gpublic
:

39 
AtomicFÏg
 
	tLock
;

41 şas 
	cScİedLock
 {

42 
AtomicFÏg
* 
	gæag_
;

43 
ušt8_t
 
	g·ddšg
[128 - (
AtomicFÏg
)];

44 
ScİedLock
(const ScopedLock&);

45 
	gScİedLock
& 
	gİ”©Ü
=(cÚ¡ 
ScİedLock
&);

46 
	gpublic
:

47 
ex¶ic™
 
ScİedLock
(cÚ¡ vŞ©* 
addr
): 
æag_
(
G‘LockFÜ
(addr)){

48 ; 
	gæag_
->
Te¡AndS‘
(
MemÜyOrd”
::
kAcquœe
); ) {

49 #ià
defšed
(
LDD_UTIL_ATOMIC_X86_PAUSE
)

50 
LDD_UTIL_ATOMIC_X86_PAUSE
();

54 ~
ScİedLock
() {

55 
	gæag_
->
CË¬
(
MemÜyOrd”
::
kR–—£
);

58 
	g´iv©e
:

59 
Lock
* 
G‘LockFÜ
(cÚ¡ vŞ©* 
addr
);

	@/home/libin3-s/ldd/util/detail/atomic/platform.h

4 #iâdeà
LDD_UTIL_DETAIL_ATOMIC_PLATFORM_H_


5 
	#LDD_UTIL_DETAIL_ATOMIC_PLATFORM_H_


	)

7 #ià
defšed
(
__GNUC__
è&& (defšed(
__i386__
è|| defšed(
__x86_64__
))

8 
	~"ldd/ut/d‘a/©omic/gcc_x86.h
"

10 
	~"ldd/ut/d‘a/©omic/ba£.h
"

	@/home/libin3-s/ldd/util/memory_order.h

4 #iâdeà
LDD_UTIL_MEMORY_ORDER_H_


5 
	#LDD_UTIL_MEMORY_ORDER_H_


	)

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gut
 {

10 
	sMemÜyOrd”
 {

11 
	eTy³
 {

12 
	gkR–axed
 = 0,

13 
	gkAcquœe
 = 1,

14 
	gkR–—£
 = 2,

15 
	gkAcquœeR–—£
 = 3,

16 
	gkSequ’tŸl
 = 7,

17 
	gkCÚsume
 = 8,

	@/home/libin3-s/ldd/util/mutable_buffer.h

4 #iâdeà
LDD_UTIL_MUTABLE_BUFFER_H_


5 
	#LDD_UTIL_MUTABLE_BUFFER_H_


	)

7 
	~<as£¹.h
>

8 
	~<¡ddef.h
>

9 
	~<¡ršg.h
>

10 
	~<¡ršg
>

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gut
 {

15 şas 
	cMubËBufãr
 {

16 
	gpublic
:

17 
MubËBufãr
(): 
d©a_
((*)""), 
size_
(0) {}

18 
MubËBufãr
(* 
buf
, 
size_t
 
size
)

19 : 
d©a_
(
¡©ic_ÿ¡
<*>(
buf
)), 
size_
(
size
) {}

20 
MubËBufãr
(* 
buf
, 
size_t
 
size
)

21 : 
d©a_
(
buf
), 
size_
(
size
 ) {}

23 * 
d©a
(ècÚ¡ {  
	gd©a_
; }

24 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

25 
boŞ
 
em±y
(ècÚ¡ {  
	gsize_
 == 0; }

26 & 
	gİ”©Ü
[](
size_t
 
	gn
) const {

27 
as£¹
(
n
 < 
size
());

28  
	gd©a_
[
n
];

30 
CË¬
(è{ 
	gd©a_
 = (*)""; 
	gsize_
 = 0; }

31 
RemoveP»fix
(
size_t
 
n
) {

32 
as£¹
(
n
 <ğ
size
());

33 
	gd©a_
 +ğ
n
;

34 
	gsize_
 -ğ
n
;

36 
RemovePo¡fix
(
size_t
 
n
) {

37 
as£¹
(
n
 <ğ
size
());

38 
	gsize_
 -ğ
n
;

40 
	g´iv©e
:

41 * 
d©a_
;

42 
size_t
 
	gsize_
;

	@/home/libin3-s/ldd/util/mutex.h

1 #iâdeà
LDD_UTIL_MUTEX_H_


2 
	#LDD_UTIL_MUTEX_H_


	)

4 
Çme¥aû
 
	gldd
 {

5 
Çme¥aû
 
	gut
 {

7 şas 
	cMu‹x
 {

8 
	gpublic
:

9 
Mu‹x
();

10 ~
Mu‹x
();

12 
Lock
();

13 
UÆock
();

14 
As£¹H–d
();

16 
	g´iv©e
:

17 
ä›nd
 
şass
 
CÚdV¬
;

18 
	gIÁ”Çl
;

19 
IÁ”Çl
* 
	gš‹º®_
;

21 
Mu‹x
(const Mutex&);

22 
	gİ”©Ü
=(cÚ¡ 
Mu‹x
&);

25 şas 
	cMu‹xLock
 {

26 
	gpublic
:

27 
ex¶ic™
 
Mu‹xLock
(
Mu‹x
 *
mu
): 
mu_
(muè{ 
this
->mu_->
Lock
(); }

28 ~
Mu‹xLock
(è{ 
	gthis
->
	gmu_
->
UÆock
(); }

29 
	g´iv©e
:

30 
Mu‹x
* cÚ¡ 
mu_
;

32 
Mu‹xLock
(const MutexLock&);

33 
	gİ”©Ü
=(cÚ¡ 
Mu‹xLock
&);

36 şas 
	cCÚdV¬
 {

37 
	gpublic
:

38 
ex¶ic™
 
CÚdV¬
(
Mu‹x
* 
mu
);

39 ~
CÚdV¬
();

40 
Wa™
();

41 
SigÇl
();

42 
SigÇlAÎ
();

43 
	g´iv©e
:

44 
IÁ”Çl
;

45 
IÁ”Çl
* 
	gš‹º®_
;

46 
Mu‹x
* 
	gmu_
;

48 
CÚdV¬
(const CondVar&);

49 
	gİ”©Ü
=(cÚ¡ 
CÚdV¬
&);

52 şas 
	cRWMu‹x
 {

53 
	gpublic
:

54 
RWMu‹x
();

55 ~
RWMu‹x
();

56 
RLock
();

57 
WLock
();

58 
UÆock
();

59 
	g´iv©e
:

60 
IÁ”Çl
;

61 
IÁ”Çl
* 
	gš‹º®_
;

63 
RWMu‹x
(const RWMutex&);

64 
	gİ”©Ü
=(cÚ¡ 
RWMu‹x
&);

67 şas 
	cRWMu‹xLock
 {

68 
	gpublic
:

69 
RWMu‹xLock
(
RWMu‹x
* 
mu
, 
boŞ
 
wr™e
 = 
çl£
)

70 : 
mu_
(
mu
) {

71 ià(
wr™e
) {

72 
mu_
->
WLock
();

74 
	gmu_
->
RLock
();

77 ~
RWMu‹xLock
() {

78 
	gmu_
->
UÆock
();

80 
	g´iv©e
:

81 
RWMu‹x
* 
mu_
;

83 
RWMu‹xLock
(const RWMutexLock&);

84 
	gİ”©Ü
=(cÚ¡ 
RWMu‹xLock
&);

	@/home/libin3-s/ldd/util/slice.h

1 #iâdeà
LDD_UTIL_SLICE_H_


2 
	#LDD_UTIL_SLICE_H_


	)

4 
	~<as£¹.h
>

5 
	~<¡ddef.h
>

6 
	~<¡ršg.h
>

7 
	~<¡ršg
>

9 
Çme¥aû
 
	gldd
 {

10 
Çme¥aû
 
	gut
 {

12 şas 
	cSliû
 {

13 
	gpublic
:

15 
Sliû
(è: 
d©a_
(""), 
size_
(0) { }

18 
Sliû
(cÚ¡ * 
d
, 
size_t
 
n
è: 
d©a_
(d), 
size_
(n) { }

21 
Sliû
(cÚ¡ 
¡d
::
¡ršg
& 
s
è: 
d©a_
(s.
d©a
()), 
size_
(s.
size
()) { }

24 
Sliû
(cÚ¡ * 
s
è: 
d©a_
(s), 
size_
(
¡¾’
(s)) { }

27 cÚ¡ * 
d©a
(ècÚ¡ {  
	gd©a_
; }

30 
size_t
 
size
(ècÚ¡ {  
	gsize_
; }

33 
boŞ
 
em±y
(ècÚ¡ {  
	gsize_
 == 0; }

37 
	gİ”©Ü
[](
size_t
 
	gn
) const {

38 
as£¹
(
n
 < 
size
());

39  
	gd©a_
[
n
];

43 
CË¬
(è{ 
	gd©a_
 = ""; 
	gsize_
 = 0; }

46 
RemoveP»fix
(
size_t
 
n
) {

47 
as£¹
(
n
 <ğ
size
());

48 
	gd©a_
 +ğ
n
;

49 
	gsize_
 -ğ
n
;

51 
RemovePo¡fix
(
size_t
 
n
) {

52 
as£¹
(
n
 <ğ
size
());

53 
	gsize_
 -ğ
n
;

57 
	g¡d
::
¡ršg
 
ToSŒšg
(ècÚ¡ {  
¡d
::¡ršg(
d©a_
, 
size_
); }

63 
Com·»
(cÚ¡ 
Sliû
& 
b
) const;

66 
boŞ
 
S¹sW™h
(cÚ¡ 
Sliû
& 
x
) const {

67  ((
	gsize_
 >ğ
x
.
size_
) &&

68 (
memcmp
(
d©a_
, 
x
.d©a_, x.
size_
) == 0));

71 
	g´iv©e
:

72 cÚ¡ * 
d©a_
;

73 
size_t
 
	gsize_
;

78 
šlše
 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
) {

79  ((
	gx
.
size
(è=ğ
y
.size()) &&

80 (
memcmp
(
x
.
d©a
(), 
y
.d©a(), x.
size
()) == 0));

83 
šlše
 
boŞ
 
	gİ”©Ü
!=(cÚ¡ 
Sliû
& 
x
, cÚ¡ 
	gSliû
& 
	gy
) {

84  !(
	gx
 =ğ
y
);

87 
šlše
 
	gSliû
::
Com·»
(cÚ¡ 
Sliû
& 
b
) const {

88 cÚ¡ 
mš_Ën
 = (
size_
 < 
b
.size_) ? size_ : b.size_;

89 
	gr
 = 
memcmp
(
d©a_
, 
b
.d©a_, 
mš_Ën
);

90 ià(
	gr
 == 0) {

91 ià(
size_
 < 
b
.size_è
r
 = -1;

92 ià(
	gsize_
 > 
	gb
.size_è
	gr
 = +1;

94  
	gr
;

	@/home/libin3-s/ldd/util/thread.h

1 #iâdeà
LDD_UTIL_THREAD_H_


2 
	#LDD_UTIL_THREAD_H_


	)

4 
	~<¡dšt.h
>

5 
	~<Œ1/funùiÚ®
>

7 
Çme¥aû
 
	gldd
 {

8 
Çme¥aû
 
	gut
 {

10 şas 
	cTh»ad
 {

11 
	gpublic
:

12 
ušt64_t
 
	tId
;

13 
	g¡d
::
	tŒ1
::
	tfunùiÚ
<()> 
	tFunùiÚ
;

14 
Th»ad
(cÚ¡ 
FunùiÚ
& 
funùiÚ
);

15 ~
Th»ad
();

17 
boŞ
 
S¹
();

18 
Još
();

20 
Id
 
id
() const;

22 
Id
 
Cu¼’tId
();

23 
SË•FÜMs
(
št64_t
 
mli£cÚds
);

24 
SË•FÜUs
(
št64_t
 
miüo£cÚds
);

25 
SË•FÜNs
(
št64_t
 
Çno£cÚds
);

26 
Y›ld
();

27 
	g´iv©e
:

28 
IÁ”Çl
;

29 
IÁ”Çl
* 
	gš‹º®_
;

30 
FunùiÚ
 
	gfunùiÚ_
;

31 * 
Th»adMaš
(*);

33 
Th»ad
(const Thread&);

34 
	gİ”©Ü
=(cÚ¡ 
Th»ad
&);

	@/home/libin3-s/ldd/util/time.h

1 #iâdeà
LDD_UTIL_TIME_H_


2 
	#LDD_UTIL_TIME_H_


	)

4 
	~<¡dšt.h
>

5 
	~<time.h
>

6 
	~<sys/time.h
>

8 
Çme¥aû
 
	gldd
 {

9 
Çme¥aû
 
	gut
 {

11 şas 
	cTime
 {

12 
	gpublic
:

14 
št64_t
 
Cu¼’tSecÚds
();

15 
št64_t
 
Cu¼’tMli£cÚds
();

16 
št64_t
 
Cu¼’tMiüo£cÚds
();

17 
št64_t
 
Cu¼’tNªo£cÚds
();

20 
Mli£cÚdsTo
(
št64_t
 
ms
, 
time¥ec
* 
»suÉ
);

21 
Mli£cÚdsTo
(
št64_t
 
ms
, 
timev®
* 
»suÉ
);

22 
Miüo£cÚdsTo
(
št64_t
 
us
, 
time¥ec
* 
»suÉ
);

23 
Miüo£cÚdsTo
(
št64_t
 
us
, 
timev®
* 
»suÉ
);

24 
Nªo£cÚdsTo
(
št64_t
 
ns
, 
time¥ec
* 
»suÉ
);

25 
Nªo£cÚdsTo
(
št64_t
 
ns
, 
timev®
* 
»suÉ
);

26 
SecÚdsTo
(
št64_t
 
s
, 
timev®
* 
»suÉ
);

27 
SecÚdsTo
(
št64_t
 
s
, 
time¥ec
* 
»suÉ
);

30 
št64_t
 
ToMli£cÚds
(cÚ¡ 
time¥ec
& 
t
);

31 
št64_t
 
ToMli£cÚds
(cÚ¡ 
timev®
& 
t
);

32 
št64_t
 
ToMiüo£cÚds
(cÚ¡ 
time¥ec
& 
t
);

33 
št64_t
 
ToMiüo£cÚds
(cÚ¡ 
timev®
& 
t
);

34 
št64_t
 
ToNªo£cÚds
(cÚ¡ 
time¥ec
& 
t
);

35 
št64_t
 
ToNªo£cÚds
(cÚ¡ 
timev®
& 
t
);

36 
št64_t
 
ToSecÚds
(cÚ¡ 
time¥ec
& 
t
);

37 
št64_t
 
ToSecÚds
(cÚ¡ 
timev®
& 
t
);

39 
	gpublic
:

41 
	eUn™
 {

42 
kSecÚd
 = 1LL,

43 
	gkMli£cÚd
 = 1000LL,

44 
	gkMiüo£cÚd
 = 1000000LL,

45 
	gkNªo£cÚd
 = 1000000000LL,

48 
št64_t
 
Cu¼’tTicks
(št64_ˆ
un™
);

50 
TicksTo
(
št64_t
 
ticks
, iÁ64_ˆ
un™
,

51 
time¥ec
* 
»suÉ
);

52 
TicksTo
(
št64_t
 
ticks
, iÁ64_ˆ
un™
,

53 
timev®
* 
»suÉ
);

56 
št64_t
 
ToTicks
(cÚ¡ 
time¥ec
& 
t
, iÁ64_ˆ
un™
);

57 
št64_t
 
ToTicks
(cÚ¡ 
timev®
& 
t
, iÁ64_ˆ
un™
);

58 
št64_t
 
ToTicks
(št64_ˆ
£cÚds
, iÁ64_ˆ
Şd_ticks
,

59 
št64_t
 
Şd_un™
, iÁ64_ˆ
Ãw_un™
);

62 
št64_t
 
TicksToTicks
(št64_ˆ
ticks
,

63 
št64_t
 
un™
, iÁ64_ˆ
Ãw_un™
);

69 
	~"time.šl
"

	@/home/libin3-s/ldd/util/time_diff.h

4 #iâdeà
LDD_UTIL_TIME_DIFF_H_


5 
	#LDD_UTIL_TIME_DIFF_H_


	)

7 
	~<boo¡/İ”©Üs.hµ
>

8 
	~"ldd/ut/time.h
"

10 
Çme¥aû
 
	gldd
 {

11 
Çme¥aû
 
	gut
 {

13 
şass
 
	gTimeDiff
 : 
boo¡
::
Ëss_thª_com·¿bË
<
TimeDiff
>,

14 
	gboo¡
::
equ®™y_com·¿bË
<
TimeDiff
>,

15 
	gboo¡
::
addabË
<
TimeDiff
>,

16 
	gboo¡
::
subŒaùabË
<
TimeDiff
>,

17 
	gboo¡
::
muÉlŸbË
<
TimeDiff
, >,

18 
	gboo¡
::
dividabË
<
TimeDiff
, >

20 
ä›nd
 
şass
 
	gTime¡amp
;

21 
	gpublic
:

22 
TimeDiff
();

24 
TimeDiff
(cÚ¡ 
time¥ec
& 
t
);

25 
TimeDiff
(cÚ¡ 
timev®
& 
t
);

28 
TimeDiff
 
SecÚds
(
št64_t
 
s
);

29 
TimeDiff
 
Mli£cÚds
(
št64_t
 
ms
);

30 
TimeDiff
 
Miüo£cÚds
(
št64_t
 
us
);

31 
TimeDiff
 
Nªo£cÚds
(
št64_t
 
ns
);

34 
št64_t
 
ToSecÚds
() const;

35 
št64_t
 
ToMli£cÚds
() const;

36 
št64_t
 
ToMiüo£cÚds
() const;

37 
št64_t
 
ToNªo£cÚds
() const;

40 
To
(
time¥ec
* 
t
) const;

41 
To
(
timev®
* 
t
) const;

44 
boŞ
 
IsZ”o
() const;

45 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gTimeDiff
& 
	grhs
) const;

46 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
TimeDiff
& 
rhs
) const;

49 
TimeDiff
 
	gİ”©Ü
+=(cÚ¡ TimeDiff& 
rhs
);

50 
TimeDiff
 
	gİ”©Ü
-=(cÚ¡ TimeDiff& 
rhs
);

51 
TimeDiff
 
	gİ”©Ü
*=(
n
);

52 
TimeDiff
 
	gİ”©Ü
/=(
n
);

53 
	gpublic
:

54 
TimeDiff
(
št64_t
 
ticks
, iÁ64_ˆ
un™
);

55 
	g´iv©e
:

56 
ex¶ic™
 
TimeDiff
(
št64_t
 
us
);

57 
št64_t
 
	gus_
;

63 
	~"time_diff.šl
"

	@/home/libin3-s/ldd/util/timestamp.h

4 #iâdeà
LDD_UTIL_TIMESTAMP_H_


5 
	#LDD_UTIL_TIMESTAMP_H_


	)

7 
	~<boo¡/İ”©Üs.hµ
>

8 
	~"ldd/ut/time.h
"

9 
	~"ldd/ut/time_diff.h
"

11 
Çme¥aû
 
	gldd
 {

12 
Çme¥aû
 
	gut
 {

14 
şass
 
	gTime¡amp
 : 
boo¡
::
Ëss_thª_com·¿bË
<
Time¡amp
>,

15 
	gboo¡
::
equ®™y_com·¿bË
<
Time¡amp
>

17 
public
:

19 
Time¡amp
();

20 
Time¡amp
 
Epoch
();

23 
Time¡amp
(cÚ¡ 
time¥ec
& 
t
);

24 
Time¡amp
(cÚ¡ 
timev®
& 
t
);

27 
Time¡amp
 
SecÚds
(
št64_t
 
s
);

28 
Time¡amp
 
Mli£cÚds
(
št64_t
 
ms
);

29 
Time¡amp
 
Miüo£cÚds
(
št64_t
 
us
);

30 
Time¡amp
 
Nªo£cÚds
(
št64_t
 
ns
);

33 
Time¡amp
 
Now
();

36 
št64_t
 
ToSecÚds
() const;

37 
št64_t
 
ToMli£cÚds
() const;

38 
št64_t
 
ToMiüo£cÚds
() const;

39 
št64_t
 
ToNªo£cÚds
() const;

42 
To
(
time¥ec
* 
t
) const;

43 
To
(
timev®
* 
t
) const;

46 
boŞ
 
IsEpoch
() const;

47 
boŞ
 
	gİ”©Ü
< (cÚ¡ 
	gTime¡amp
& 
	grhs
) const;

48 
boŞ
 
	gİ”©Ü
==(cÚ¡ 
Time¡amp
& 
rhs
) const;

51 
Time¡amp
 
	gİ”©Ü
+=(cÚ¡ 
TimeDiff
& 
rhs
);

52 
Time¡amp
 
	gİ”©Ü
+ (cÚ¡ 
	gTimeDiff
& 
	grhs
) const;

53 
Time¡amp
 
	gİ”©Ü
-=(cÚ¡ 
TimeDiff
& 
rhs
);

54 
Time¡amp
 
	gİ”©Ü
- (cÚ¡ 
	gTimeDiff
& 
	grhs
) const;

55 
TimeDiff
 
	gİ”©Ü
- (cÚ¡ 
	gTime¡amp
& 
	grhs
) const;

56 
	gpublic
:

57 
Time¡amp
(
št64_t
 
ticks
, iÁ64_ˆ
un™
);

58 
	g´iv©e
:

59 
ex¶ic™
 
Time¡amp
(
št64_t
 
us
);

60 
št64_t
 
	gus_
;

66 
	~"time¡amp.šl
"

	@net/outgoing_msg.h

1 #iâdeà
LDD_NET_OUTGOING_MSG_H_


2 
	#LDD_NET_OUTGOING_MSG_H_


	)

4 
	~<m­
>

5 
	~<boo¡/’abË_sh¬ed_äom_this.hµ
>

6 
	~<boo¡/nÚcİyabË.hµ
>

7 
	~<ldd/ut/time_diff.h
>

8 
	~"ldd/Ãt/·ylßd.h
"

9 
	~"ldd/Ãt/bufãr.h
"

10 
	~"ldd/Ãt/»suÉ.h
"

12 
Çme¥aû
 
	gldd
 {

13 
Çme¥aû
 
	gÃt
 {

15 
şass
 
	gChªÃl
;

17 
şass
 
	gOutgošgMsg
 : 
public
 
boo¡
::
’abË_sh¬ed_äom_this
<
OutgošgMsg
>,

18 
´iv©e
 
	gboo¡
::
nÚcİyabË
 {

19 
public
:

20 
şass
 
Im¶
;

21 
	gldd
::
	tÃt
::
	tPaylßd
 Payload;

22 
	gldd
::
	tÃt
::
	tMes§geId
 
	tId
;

23 
	gldd
::
	tÃt
::
	tMes§geTy³
 
	tTy³
;

24 
	gldd
::
	tÃt
::
	tResuÉ
 Result;

26 
	gvœtu®
 ~
OutgošgMsg
();

27 
vœtu®
 
Ty³
 
ty³
() const = 0;

29 
Id
 
id
() const;

30 cÚ¡ 
	gboo¡
::
sh¬ed_±r
<
ChªÃl
>& 
chªÃl
() const;

33 
Cªûl
();

34 
	g´Ùeùed
:

35 
OutgošgMsg
();

36 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

37 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

38 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

39 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

40 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

41 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

42 
	g´iv©e
:

43 
DoCªûl
();

44 
Im¶
 *
	gim¶_
;

45 
ä›nd
 
şass
 
	gChªÃl
;

46 
ä›nd
 
şass
 
	gOutgošgReque¡
;

47 
ä›nd
 
şass
 
	gIncomšgRe¥Ú£
;

48 
ä›nd
 
şass
 
	gIncomšgEnd
;

51 
	g‹m¶©e
 <
Mes§geTy³
 
	gN
>

52 şas 
	cTy³dOutgošgMsg
 : 
public
 
OutgošgMsg
 {

53 
public
:

54 cÚ¡ 
Ty³
 
kTy³
 = 
N
;

55 
Ty³
 
ty³
(ècÚ¡ {  
	gkTy³
; }

56 
	g´Ùeùed
:

57 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

58 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

59 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

60 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

61 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

62 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

65 şas 
	cDyÇmicOutgošgMsg
 : 
public
 
OutgošgMsg
 {

66 
public
:

67 ~
DyÇmicOutgošgMsg
();

68 
£t_ty³
(
Ty³
 
ty³
);

69 
Ty³
 
ty³
(ècÚ¡ {  
	gty³_
; }

70 
	g´Ùeùed
:

71 
DyÇmicOutgošgMsg
(): 
ty³_
(0) {}

72 
DyÇmicOutgošgMsg
(
Ty³
 
ty³
);

73 
vœtu®
 
boŞ
 
In™
(
Paylßd
* 
»que¡
,

74 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
,

75 
ldd
::
ut
::
TimeDiff
* 
dÚe_timeout
) = 0;

76 
vœtu®
 
boŞ
 
Recv
(cÚ¡ 
Paylßd
& 
»¥Ú£
,

77 
ldd
::
ut
::
TimeDiff
* 
»cv_timeout
) = 0;

78 
vœtu®
 
DÚe
(cÚ¡ 
ResuÉ
& 
»suÉ
) = 0;

79 
	g´iv©e
:

80 
Ty³
 
ty³_
;

83 
	g´iv©e
:

84 
ä›nd
 
şass
 
St
;

86 
	sNextF»e
 {

87 
NextF»e
()

88 : 
Ãxt_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>()),

89 
ä“_id_
(
Ãw
 
ut
::
Atomic
<
ušt64_t
>())

90 { *
Ãxt_id_
 = 0; *
	gä“_id_
 = 0; }

91 ~
NextF»e
() {}

93 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
Ãxt_id_
;

94 
	gboo¡
::
sh¬ed_±r
<
ut
::
Atomic
<
ušt64_t
> > 
ä“_id_
;

97 
	g¡d
::
m­
<
Ty³
, 
	gNextF»e
> 
	g¡©_
;

99 
	g¡d
::
	tm­
<
	tTy³
, 
	tNextF»e
>::
	t™”©Ü
 
	tSTAT_IT
;

101 
Inc
(
Ty³
 
ty³
);

102 
Dec
(
Ty³
 
ty³
);

	@
1
.
0
213
8956
/home/libin3-s/ldd/cage/acl.h
/home/libin3-s/ldd/cage/cage.h
/home/libin3-s/ldd/cage/cage_state.h
/home/libin3-s/ldd/cage/callback.h
/home/libin3-s/ldd/cage/event.h
/home/libin3-s/ldd/cage/internal/cage_impl.h
/home/libin3-s/ldd/cage/internal/callback_wrapper.h
/home/libin3-s/ldd/cage/internal/failure_result.h
/home/libin3-s/ldd/cage/internal/functions.h
/home/libin3-s/ldd/cage/internal/keeper_impl.h
/home/libin3-s/ldd/cage/internal/op_result.h
/home/libin3-s/ldd/cage/internal/operation.h
/home/libin3-s/ldd/cage/internal/result_impl.h
/home/libin3-s/ldd/cage/internal/retry_loop.h
/home/libin3-s/ldd/cage/internal/retry_loop_impl.h
/home/libin3-s/ldd/cage/internal/retry_policy.h
/home/libin3-s/ldd/cage/internal/util.h
/home/libin3-s/ldd/cage/keeper.h
/home/libin3-s/ldd/cage/keeper_state.h
/home/libin3-s/ldd/cage/mode.h
/home/libin3-s/ldd/cage/op.h
/home/libin3-s/ldd/cage/recipes/election.h
/home/libin3-s/ldd/cage/result.h
/home/libin3-s/ldd/cage/retry_policy.h
/home/libin3-s/ldd/cage/stat.h
/home/libin3-s/ldd/cage/status.h
/home/libin3-s/ldd/cage/util.h
/home/libin3-s/ldd/client/client.h
/home/libin3-s/ldd/client/internal/atomic_append.h
/home/libin3-s/ldd/client/internal/atomic_incr.h
/home/libin3-s/ldd/client/internal/check.h
/home/libin3-s/ldd/client/internal/client_impl.h
/home/libin3-s/ldd/client/internal/get.h
/home/libin3-s/ldd/client/internal/list.h
/home/libin3-s/ldd/client/internal/mutate.h
/home/libin3-s/ldd/client/internal/str_util.h
/home/libin3-s/ldd/client/provider.h
/home/libin3-s/ldd/client/redo_policy.h
/home/libin3-s/ldd/client/redo_simple_policy.h
/home/libin3-s/ldd/courier/EventList.h
/home/libin3-s/ldd/courier/client.h
/home/libin3-s/ldd/courier/client_impl.h
/home/libin3-s/ldd/courier/completion_callback.h
/home/libin3-s/ldd/courier/completion_callback_client.h
/home/libin3-s/ldd/courier/completion_callback_impl.h
/home/libin3-s/ldd/courier/completion_callback_proxy.h
/home/libin3-s/ldd/courier/completion_callback_store.h
/home/libin3-s/ldd/courier/configure.h
/home/libin3-s/ldd/courier/configure_impl.h
/home/libin3-s/ldd/courier/courier.h
/home/libin3-s/ldd/courier/keeper.h
/home/libin3-s/ldd/courier/keeper_impl.h
/home/libin3-s/ldd/courier/options.h
/home/libin3-s/ldd/courier/rapidjson/document.h
/home/libin3-s/ldd/courier/rapidjson/filestream.h
/home/libin3-s/ldd/courier/rapidjson/internal/pow10.h
/home/libin3-s/ldd/courier/rapidjson/internal/stack.h
/home/libin3-s/ldd/courier/rapidjson/internal/strfunc.h
/home/libin3-s/ldd/courier/rapidjson/prettywriter.h
/home/libin3-s/ldd/courier/rapidjson/rapidjson.h
/home/libin3-s/ldd/courier/rapidjson/reader.h
/home/libin3-s/ldd/courier/rapidjson/stringbuffer.h
/home/libin3-s/ldd/courier/rapidjson/writer.h
/home/libin3-s/ldd/courier/reactor.h
/home/libin3-s/ldd/courier/redo_policy.h
/home/libin3-s/ldd/courier/redo_simple_policy.h
/home/libin3-s/ldd/courier/ut/ut_common.h
/home/libin3-s/ldd/courier/ut/ut_configure.h
/home/libin3-s/ldd/courier/ut/ut_eventlist.h
/home/libin3-s/ldd/courier/ut/ut_keeper.h
/home/libin3-s/ldd/courier/watcher_action.h
/home/libin3-s/ldd/courier/watcher_action_client.h
/home/libin3-s/ldd/courier/watcher_action_impl.h
/home/libin3-s/ldd/courier/watcher_action_proxy.h
/home/libin3-s/ldd/courier/watcher_action_store.h
/home/libin3-s/ldd/courier/zkbroker.h
/home/libin3-s/ldd/courier/zkbroker_client.h
/home/libin3-s/ldd/courier/zkbroker_proxy.h
/home/libin3-s/ldd/courier/zkbroker_store.h
/home/libin3-s/ldd/courier/zkcontext.h
/home/libin3-s/ldd/net/address.h
/home/libin3-s/ldd/net/backtrace.h
/home/libin3-s/ldd/net/buffer.h
/home/libin3-s/ldd/net/channel.h
/home/libin3-s/ldd/net/client.h
/home/libin3-s/ldd/net/endpoint.h
/home/libin3-s/ldd/net/event.h
/home/libin3-s/ldd/net/event_loop.h
/home/libin3-s/ldd/net/event_loop_thread_pool.h
/home/libin3-s/ldd/net/factory.h
/home/libin3-s/ldd/net/incoming_msg.h
/home/libin3-s/ldd/net/incoming_msg_registry.h
/home/libin3-s/ldd/net/internal/channel_impl.h
/home/libin3-s/ldd/net/internal/client_impl.h
/home/libin3-s/ldd/net/internal/event_impl.h
/home/libin3-s/ldd/net/internal/event_loop_impl.h
/home/libin3-s/ldd/net/internal/incoming_msg_impl.h
/home/libin3-s/ldd/net/internal/incoming_packet.h
/home/libin3-s/ldd/net/internal/listener_impl.h
/home/libin3-s/ldd/net/internal/outgoing_msg_impl.h
/home/libin3-s/ldd/net/internal/outgoing_packet.h
/home/libin3-s/ldd/net/internal/protocol.h
/home/libin3-s/ldd/net/internal/pulse_checker.h
/home/libin3-s/ldd/net/internal/pulse_emitter.h
/home/libin3-s/ldd/net/internal/server_impl.h
/home/libin3-s/ldd/net/internal/task.h
/home/libin3-s/ldd/net/listener.h
/home/libin3-s/ldd/net/message.h
/home/libin3-s/ldd/net/other/client/omsg.h
/home/libin3-s/ldd/net/other/imsg.h
/home/libin3-s/ldd/net/outgoing_msg.h
/home/libin3-s/ldd/net/payload.h
/home/libin3-s/ldd/net/registry.h
/home/libin3-s/ldd/net/result.h
/home/libin3-s/ldd/net/sample/a.h
/home/libin3-s/ldd/net/server.h
/home/libin3-s/ldd/net/stat.h
/home/libin3-s/ldd/net/test/benchmark/client/omsg.h
/home/libin3-s/ldd/net/test/benchmark/server/imsg.h
/home/libin3-s/ldd/net/test/client/imsg.h
/home/libin3-s/ldd/net/test/client/omsg.h
/home/libin3-s/ldd/net/test/server/imsg.h
/home/libin3-s/ldd/net/test/server/omsg.h
/home/libin3-s/ldd/net/test1/client/common.h
/home/libin3-s/ldd/net/test1/client/x_socket.h
/home/libin3-s/ldd/net/test1/concurrency_connect/x_socket.h
/home/libin3-s/ldd/net/ut/imsg.h
/home/libin3-s/ldd/net/ut/my_lddnet.h
/home/libin3-s/ldd/net/ut/omsg.h
/home/libin3-s/ldd/net/ut/x_socket.h
/home/libin3-s/ldd/protocol/client/command_type.h
/home/libin3-s/ldd/protocol/client/proto.h
/home/libin3-s/ldd/protocol/client/response.h
/home/libin3-s/ldd/protocol/coded_stream.h
/home/libin3-s/ldd/protocol/message.h
/home/libin3-s/ldd/protocol/server/command_type.h
/home/libin3-s/ldd/protocol/server/store_error.h
/home/libin3-s/ldd/protocol/server/store_proto.h
/home/libin3-s/ldd/protocol/ut/ut_msg_proto.h
/home/libin3-s/ldd/protocol/ut/ut_proto.h
/home/libin3-s/ldd/protocol/ut/ut_response.h
/home/libin3-s/ldd/proxy/c2p/atomic_append.h
/home/libin3-s/ldd/proxy/c2p/atomic_incr.h
/home/libin3-s/ldd/proxy/c2p/check.h
/home/libin3-s/ldd/proxy/c2p/get.h
/home/libin3-s/ldd/proxy/c2p/list.h
/home/libin3-s/ldd/proxy/c2p/mutate.h
/home/libin3-s/ldd/proxy/p2s/atomic_append_ex.h
/home/libin3-s/ldd/proxy/p2s/atomic_incr_ex.h
/home/libin3-s/ldd/proxy/p2s/check_ex.h
/home/libin3-s/ldd/proxy/p2s/get_ex.h
/home/libin3-s/ldd/proxy/p2s/list_ex.h
/home/libin3-s/ldd/proxy/p2s/mutate_ex.h
/home/libin3-s/ldd/proxy/proxy.h
/home/libin3-s/ldd/proxy/proxy_module.h
/home/libin3-s/ldd/proxy/proxy_type.h
/home/libin3-s/ldd/proxy/test/ut_append.h
/home/libin3-s/ldd/proxy/test/ut_check.h
/home/libin3-s/ldd/proxy/test/ut_get.h
/home/libin3-s/ldd/proxy/test/ut_incr.h
/home/libin3-s/ldd/proxy/test/ut_list.h
/home/libin3-s/ldd/proxy/test/ut_put.h
/home/libin3-s/ldd/skel/internal/child.h
/home/libin3-s/ldd/skel/internal/config.h
/home/libin3-s/ldd/skel/internal/context.h
/home/libin3-s/ldd/skel/internal/log_flusher.h
/home/libin3-s/ldd/skel/internal/monitor.h
/home/libin3-s/ldd/skel/internal/option.h
/home/libin3-s/ldd/skel/internal/proctitle.h
/home/libin3-s/ldd/skel/internal/skel.h
/home/libin3-s/ldd/skel/module.h
/home/libin3-s/ldd/store/config_manager.h
/home/libin3-s/ldd/store/context.h
/home/libin3-s/ldd/store/db/db.h
/home/libin3-s/ldd/store/db/util.h
/home/libin3-s/ldd/store/job.h
/home/libin3-s/ldd/store/level_bench/histogram.h
/home/libin3-s/ldd/store/level_bench/random.h
/home/libin3-s/ldd/store/level_bench/testutil.h
/home/libin3-s/ldd/store/plant.h
/home/libin3-s/ldd/store/plant_pool.h
/home/libin3-s/ldd/store/session.h
/home/libin3-s/ldd/store/singleton_holder.h
/home/libin3-s/ldd/store/store_module.h
/home/libin3-s/ldd/store/string_util.h
/home/libin3-s/ldd/store/task.h
/home/libin3-s/ldd/store/task_queue.h
/home/libin3-s/ldd/store/thread_manager.h
/home/libin3-s/ldd/store/ut/ut_context.h
/home/libin3-s/ldd/syn_client/internal/countdownlatch.h
/home/libin3-s/ldd/syn_client/internal/syn_completion.h
/home/libin3-s/ldd/syn_client/internal/synclient_impl.h
/home/libin3-s/ldd/syn_client/ldd_bench/histogram.h
/home/libin3-s/ldd/syn_client/ldd_bench/random.h
/home/libin3-s/ldd/syn_client/ldd_bench/slice.h
/home/libin3-s/ldd/syn_client/ldd_bench/testutil.h
/home/libin3-s/ldd/syn_client/syn_client.h
/home/libin3-s/ldd/util/atomic.h
/home/libin3-s/ldd/util/const_buffer.h
/home/libin3-s/ldd/util/detail/atomic/base.h
/home/libin3-s/ldd/util/detail/atomic/classification.h
/home/libin3-s/ldd/util/detail/atomic/gcc_x86.h
/home/libin3-s/ldd/util/detail/atomic/lockpool.h
/home/libin3-s/ldd/util/detail/atomic/platform.h
/home/libin3-s/ldd/util/memory_order.h
/home/libin3-s/ldd/util/mutable_buffer.h
/home/libin3-s/ldd/util/mutex.h
/home/libin3-s/ldd/util/slice.h
/home/libin3-s/ldd/util/thread.h
/home/libin3-s/ldd/util/time.h
/home/libin3-s/ldd/util/time_diff.h
/home/libin3-s/ldd/util/timestamp.h
net/outgoing_msg.h
